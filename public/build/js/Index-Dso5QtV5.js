import{X as e,r as t,j as a,S as s,x as i,A as l}from"./react-core-DkDn4djD.js";import{u as n,a as r}from"./games-DpW3R6Xv.js";import{B as o,Y as d,T as c,I as m,M as p}from"./ui-libs-OX6CH3yX.js";import"./inertia-BBHw8PYu.js";import"./vendor-D-GzWRLi.js";import"./maps-CVSyMViq.js";import"./animation-Dcgp7Est.js";const x=e=>e.replace(/&laquo;|&raquo;/g,"").replace(/&lsaquo;|&rsaquo;/g,"").replace(/&nbsp;/g," ").trim(),u=e=>e.replace(/[_-]+/g," ").replace(/\b\w/g,e=>e.toUpperCase()),h=e=>null==e?"":"string"==typeof e||"number"==typeof e||"boolean"==typeof e?String(e):JSON.stringify(e);function g(){const{props:g}=e(),{notifications:b,filters:f={},status:y}=g,v=f.status??"all",{translations:j}=n("notifications"),w=g.locale??"en",N=g.space.slug,[k,_]=t.useState(null),[S,C]=t.useState(!1),[M,A]=t.useState([]),D=t.useMemo(()=>b.data.filter(e=>!e.read_at).length,[b.data]),F=t.useMemo(()=>b.data.map(e=>e.id),[b.data]),q=t.useMemo(()=>0!==b.data.length&&F.every(e=>M.includes(e)),[F,M,b.data.length]),O=j?.header?.title??"Activity center",T=j?.header?.subtitle??"All of your shared moments and space updates live here.",E=j?.actions?.mark_all_read??"Mark all as read",$=j?.actions?.filter_all??"All",I=j?.actions?.filter_unread??"Unread",J=j?.empty?.title??"No notifications yet",U=j?.empty?.body??"We will keep a running history of your activities here.",B=j?.actions?.mark_read??"Mark as read",P=j?.view?.opened_at??"Opened :date",R=t.useMemo(()=>new Intl.DateTimeFormat(w,{dateStyle:"medium",timeStyle:"short"}),[w]),V=e=>{l.get(route("spaces.notifications.index",{space:N}),{status:e},{preserveScroll:!0,preserveState:!0})},W=j?.meta?.title??"Activity notifications";return a.jsxs(r,{header:a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:O}),a.jsx("p",{className:"text-sm text-gray-500",children:T})]}),children:[a.jsx(s,{title:W}),a.jsxs("section",{className:"mx-auto flex w-full max-w-5xl flex-col gap-6 px-4 sm:px-6 lg:px-8",children:[y&&a.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-4 py-3 text-sm text-emerald-700 shadow-sm",children:y}),a.jsxs("div",{className:"flex flex-col gap-3 rounded-2xl border border-pink-100 bg-white/90 p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-full bg-pink-100",children:a.jsx(o,{className:"h-5 w-5 text-pink-500","aria-hidden":"true"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-gray-900",children:j?.summary?.recent??"Recent activity"}),a.jsx("p",{className:"text-xs text-gray-500",children:j?.summary?.unread_count?j.summary.unread_count.replace(":count",String(D)):`${D} unread`})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>V("all"),className:"rounded-full px-4 py-2 text-sm font-medium transition "+("all"===v?"bg-pink-500 text-white shadow":"bg-white text-gray-600 hover:bg-pink-50"),children:$}),a.jsx("button",{type:"button",onClick:()=>V("unread"),className:"rounded-full px-4 py-2 text-sm font-medium transition "+("unread"===v?"bg-pink-500 text-white shadow":"bg-white text-gray-600 hover:bg-pink-50"),children:I}),a.jsxs("button",{type:"button",onClick:()=>{l.post(route("spaces.notifications.readAll",{space:N}),{},{preserveScroll:!0,onStart:()=>C(!0),onFinish:()=>C(!1)})},disabled:S||0===D,className:"inline-flex items-center gap-2 rounded-full border border-pink-200 bg-white px-4 py-2 text-sm font-medium text-pink-500 shadow-sm transition hover:bg-pink-50 disabled:cursor-not-allowed disabled:opacity-60",children:[a.jsx(d,{className:"h-4 w-4","aria-hidden":"true"}),E]}),a.jsxs("button",{type:"button",onClick:()=>{A(q?[]:F)},disabled:0===b.data.length,className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-500 shadow-sm transition hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-60",children:[a.jsx("input",{type:"checkbox",checked:q,onChange:()=>{},className:"h-4 w-4 rounded border-gray-300 text-pink-600 focus:ring-pink-500"}),"Select All"]}),a.jsxs("button",{type:"button",onClick:()=>{0!==M.length&&l.post(route("spaces.notifications.destroyMultiple",{space:N}),{notifications:M},{preserveScroll:!0,onStart:()=>C(!0),onFinish:()=>{C(!1),A([])}})},disabled:S||0===M.length,className:"inline-flex items-center gap-2 rounded-full border border-red-200 bg-white px-4 py-2 text-sm font-medium text-red-500 shadow-sm transition hover:bg-red-50 disabled:cursor-not-allowed disabled:opacity-60",children:[a.jsx(c,{className:"h-4 w-4","aria-hidden":"true"}),"Delete Selected (",M.length,")"]})]})]}),0===b.data.length?a.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 rounded-2xl border border-dashed border-pink-200 bg-white/60 p-12 text-center text-gray-500",children:[a.jsx(m,{className:"h-12 w-12 text-pink-300","aria-hidden":"true"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-700",children:J}),a.jsx("p",{className:"max-w-xl text-sm text-gray-500",children:U})]}):a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx("ul",{className:"flex flex-col gap-4",children:b.data.map(e=>{const t=e.created_at?new Date(e.created_at):null,s=e.read_at?new Date(e.read_at):null,n=t?R.format(t):"",r=s?P.replace(":date",R.format(s)):null,o=k===e.id,m=e.data??{},x=m.data&&"object"==typeof(g=m.data)&&null!==g&&!Array.isArray(g)?m.data:void 0;var g;const b=("string"==typeof m.title&&m.title.trim().length>0?m.title.trim():null)??("string"==typeof m.event&&m.event.trim().length>0?u(m.event):null)??"Activity update",f=("string"==typeof m.body&&m.body.trim().length>0?m.body.trim():null)??("string"==typeof m.message&&m.message.trim().length>0?m.message.trim():null)??null,y="string"==typeof m.action_url&&m.action_url.trim().length>0&&a.jsx(i,{href:m.action_url,className:"inline-flex items-center gap-2 rounded-full border border-pink-200 bg-white px-4 py-2 text-xs font-semibold text-pink-500 shadow-sm transition hover:bg-pink-50",children:"string"==typeof m.action_label&&m.action_label.trim().length>0?m.action_label:"View Details"}),v=[];if("Countdown.Created"!==m.event){if(("timeline.created"===m.event||"timeline.updated"===m.event)&&("string"==typeof m.timeline_title&&m.timeline_title.trim().length>0&&v.push({label:"Judul Momen",value:m.timeline_title}),"string"==typeof m.timeline_date&&m.timeline_date.trim().length>0))try{const e=new Date(m.timeline_date);v.push({label:"Tanggal Momen",value:R.format(e)})}catch(j){v.push({label:"Tanggal Momen",value:m.timeline_date})}"string"==typeof m.event&&m.event.trim().length>0&&v.push({label:"Event",value:u(m.event)}),Object.entries(m).forEach(([e,t])=>{if(["title","body","message","event","space_id","daily_message_id","data","countdown_id","countdown_title","countdown_date","actor_id","actor_name","action_url","action_label","space_slug","status_message","timeline_title","timeline_date"].includes(e)||null===t||""===t||void 0===t)return;const a=h(t);a&&v.push({label:u(e),value:a})}),x&&Object.entries(x).forEach(([e,t])=>{if(null===t||""===t||void 0===t)return;const a=h(t);a&&v.push({label:u(e),value:a})})}return a.jsx("li",{className:"rounded-2xl border px-5 py-4 shadow-sm transition "+(e.read_at?"border-gray-100 bg-white":"border-pink-200 bg-pink-50/60"),children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("input",{type:"checkbox",checked:M.includes(e.id),onChange:()=>{return t=e.id,void A(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"mt-1 h-4 w-4 rounded border-gray-300 text-pink-600 focus:ring-pink-500"}),a.jsxs("div",{className:"flex flex-1 flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[a.jsxs("div",{className:"flex flex-1 flex-col gap-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(p,{className:"h-4 w-4 "+(e.read_at?"text-gray-300":"text-pink-500"),"aria-hidden":"true"}),a.jsx("h3",{className:"text-base font-semibold text-gray-900",children:b})]}),f&&a.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:f}),r&&a.jsx("p",{className:"text-xs text-gray-400",children:r})]}),a.jsxs("div",{className:"flex flex-col items-end gap-2",children:[n&&a.jsx("span",{className:"text-xs font-medium uppercase tracking-wide text-gray-400",children:n}),a.jsxs("div",{className:"flex items-center gap-2",children:[y,!e.read_at&&a.jsxs("button",{type:"button",onClick:()=>{return t=e.id,void l.post(route("spaces.notifications.read",{space:N,notification:t}),{},{preserveScroll:!0,onStart:()=>_(t),onFinish:()=>_(null)});var t},disabled:o,className:"inline-flex items-center gap-2 rounded-full border border-pink-200 bg-white px-4 py-2 text-xs font-semibold text-pink-500 shadow-sm transition hover:bg-pink-50 disabled:cursor-not-allowed disabled:opacity-60",children:[a.jsx(d,{className:"h-4 w-4","aria-hidden":"true"}),B]}),a.jsx("button",{type:"button",onClick:()=>{return t=e.id,void l.delete(route("spaces.notifications.destroy",{space:N,notification:t}),{preserveScroll:!0,onStart:()=>_(t),onFinish:()=>_(null)});var t},disabled:o,className:"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-4 py-2 text-xs font-semibold text-gray-500 shadow-sm transition hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-60",children:a.jsx(c,{className:"h-4 w-4","aria-hidden":"true"})})]})]})]})]})},e.id)})}),b.links.length>0&&a.jsx("nav",{className:"flex flex-wrap items-center justify-center gap-2 pt-2","aria-label":"Pagination",children:b.links.map((e,t)=>a.jsx("span",{children:e.url?a.jsx(i,{href:e.url,preserveScroll:!0,preserveState:!0,className:"rounded-full px-4 py-2 text-sm font-medium transition "+(e.active?"bg-pink-500 text-white shadow":"bg-white text-gray-600 hover:bg-pink-50"),children:x(e.label)}):a.jsx("span",{className:"rounded-full px-4 py-2 text-sm text-gray-400",children:x(e.label)})},`${e.label}-${t}`))})]})]})]})}export{g as default};
