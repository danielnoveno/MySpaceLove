import{R as e,r as n}from"./react-core-DkDn4djD.js";import{af as t}from"./vendor-D-GzWRLi.js";const r=e.forwardRef((r,a)=>{const o=n.useRef(null),c=n.useRef([]),l=n.useRef(),[u,i]=n.useState([]);n.useImperativeHandle(a,()=>({pageFlip:()=>l.current}));const s=n.useCallback(()=>{l.current&&l.current.clear()},[]),f=n.useCallback(()=>{const e=l.current;e&&(e.off("flip"),e.off("changeOrientation"),e.off("changeState"),e.off("init"),e.off("update"))},[]);return n.useEffect(()=>{if(c.current=[],r.children){const n=e.Children.map(r.children,n=>e.cloneElement(n,{ref:e=>{e&&c.current.push(e)}}));r.renderOnlyPageLengthChange&&u.length===n.length||(n.length<u.length&&s(),i(n))}},[r.children]),n.useEffect(()=>{u.length>0&&c.current.length>0&&(f(),o.current&&!l.current&&(l.current=new t.PageFlip(o.current,r)),l.current.getFlipController()?l.current.updateFromHtml(c.current):l.current.loadFromHTML(c.current),(()=>{const e=l.current;e&&(r.onFlip&&e.on("flip",e=>r.onFlip(e)),r.onChangeOrientation&&e.on("changeOrientation",e=>r.onChangeOrientation(e)),r.onChangeState&&e.on("changeState",e=>r.onChangeState(e)),r.onInit&&e.on("init",e=>r.onInit(e)),r.onUpdate&&e.on("update",e=>r.onUpdate(e)))})())},[u]),e.createElement("div",{ref:o,className:r.className,style:r.style},u)}),a=e.memo(r);export{a as H};
