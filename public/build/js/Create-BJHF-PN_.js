import{G as e,r as t,j as r,S as s,x as a,A as i}from"./react-core-DkDn4djD.js";import{u as o,a as l}from"./games-DpW3R6Xv.js";import{u as n}from"./useCurrentSpace-B-ijKysZ.js";import{c as d}from"./imageConverter-BDj124y7.js";import{a as c,U as m,X as p,A as x}from"./ui-libs-OX6CH3yX.js";import"./inertia-BBHw8PYu.js";import"./vendor-D-GzWRLi.js";import"./maps-CVSyMViq.js";import"./animation-Dcgp7Est.js";function u(){const u=n(),{translations:h}=o("timeline"),{t:b}=o("errors"),g=h?.create?.heading??{},f=h?.create?.form??{},j=h?.meta?.create??"Add Memory";if(!u)return null;const v=u.slug,y=u.title,{data:N,setData:w,post:k,processing:S,errors:C,clearErrors:M}=e({title:"",description:"",date:(new Date).toISOString().split("T")[0],media:[]}),[R,U]=t.useState([]),[D,_]=t.useState(null),L=t.useRef([]);t.useEffect(()=>()=>{L.current.forEach(e=>URL.revokeObjectURL(e))},[]);const O=f.actions?.cancel??"Cancel",A=f.actions?.submit??"Save memory",T=f.actions?.submitting??"Saving…",$=f.media?.helper?.replace(":count",String(5)),z=f.media?.label??"Photos",E=f.media?.button??"Choose photos",F=f.media?.empty??"No photos selected yet.",I=f.media?.preview_label??"Preview",P=t.useMemo(()=>b("timeline.image_too_large","File size too large. Maximum 10 MB for memory and special moment photos."),[b]),B=t.useMemo(()=>b("timeline.max_media_count","You can upload up to :count photos at once.").replace(":count",String(5)),[b]),Y=t.useMemo(()=>b("upload.image_not_convertible","The image could not be processed into .webp format."),[b]);return r.jsxs(l,{loveCursor:{color:"#f43f5e",heartCount:42,className:"opacity-70"},header:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(a,{href:route("timeline.index",{space:v}),className:"rounded-lg p-2 transition hover:bg-gray-100",children:r.jsx(x,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:g.title??"Add Special Moment"}),r.jsx("p",{className:"text-gray-600",children:g.subtitle?.replace(":space",y)??`Record a cherished memory for ${y}.`})]})]}),children:[r.jsx(s,{title:j}),r.jsx("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-br from-pink-50 via-white to-rose-50 py-10 px-4 sm:px-6 lg:px-8",children:r.jsx("div",{className:"relative mx-auto max-w-4xl",children:r.jsxs("form",{onSubmit:e=>{e.preventDefault(),D||(M(),k(route("timeline.store",{space:v}),{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{i.visit(route("timeline.index",{space:v}))}}))},className:"relative z-10 rounded-3xl border border-gray-100 bg-white/80 p-8 shadow-lg backdrop-blur-sm md:p-10",children:[r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{children:[r.jsx("label",{className:"mb-2 block text-base font-semibold text-gray-800",children:f.title?.label??"Moment Title"}),r.jsx("input",{type:"text",value:N.title,onChange:e=>w("title",e.target.value),className:"w-full rounded-2xl border border-gray-300 px-5 py-4 text-gray-800 transition focus:border-transparent focus:ring-2 focus:ring-pink-500",placeholder:f.title?.placeholder??"e.g. Our first anniversary dinner"}),C.title&&r.jsx("p",{className:"mt-2 text-sm text-red-500",children:C.title})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-2 block text-base font-semibold text-gray-800",children:f.date?.label??"Date"}),r.jsxs("div",{className:"relative",children:[r.jsx(c,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),r.jsx("input",{type:"date",value:N.date,onChange:e=>w("date",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full rounded-2xl border border-gray-300 pl-12 pr-5 py-4 text-gray-800 transition focus:border-transparent focus:ring-2 focus:ring-pink-500"})]}),C.date&&r.jsx("p",{className:"mt-2 text-sm text-red-500",children:C.date})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-2 block text-base font-semibold text-gray-800",children:f.description?.label??"Description"}),r.jsx("textarea",{value:N.description,onChange:e=>w("description",e.target.value),rows:6,className:"w-full rounded-2xl border border-gray-300 px-5 py-4 text-gray-800 transition focus:border-transparent focus:ring-2 focus:ring-pink-500",placeholder:f.description?.placeholder??"Tell the story behind this moment…"}),C.description&&r.jsx("p",{className:"mt-2 text-sm text-red-500",children:C.description})]}),r.jsxs("div",{children:[r.jsx("label",{className:"mb-3 block text-base font-semibold text-gray-800",children:z}),r.jsxs("div",{className:"rounded-2xl border-2 border-dashed border-gray-300 p-8 text-center transition hover:border-pink-400",children:[r.jsx(m,{className:"mx-auto mb-4 h-16 w-16 text-pink-500"}),r.jsx("p",{className:"mb-2 text-sm text-gray-600",children:$??"Upload up to 5 photos."}),r.jsx("input",{type:"file",id:"timeline-media",className:"hidden",multiple:!0,accept:"image/*",onChange:async e=>{const t=Array.from(e.target.files||[]);if(0===t.length)return;if(N.media.length+t.length>5)return void _(B);const r=[],s=[];for(const i of t)try{const e=await d(i);if(e.size>10485760)return void _(P);r.push(e);const t=URL.createObjectURL(e);L.current.push(t),s.push(t)}catch(a){return void _(Y)}_(null),w("media",[...N.media,...r]),U([...R,...s])}}),r.jsx("label",{htmlFor:"timeline-media",className:"inline-flex cursor-pointer items-center justify-center gap-2 rounded-xl bg-pink-500 px-8 py-3 font-semibold text-white transition hover:bg-pink-600",children:E}),N.media.length>0&&r.jsxs("p",{className:"mt-4 text-sm text-gray-600",children:[N.media.length," / ",5]})]}),D&&r.jsx("p",{className:"mt-2 text-sm text-red-500",children:D}),C.media&&r.jsx("p",{className:"mt-2 text-sm text-red-500",children:C.media})]}),r.jsxs("div",{className:"rounded-2xl border border-pink-100 bg-white/75 p-6 shadow-sm",children:[r.jsx("h3",{className:"mb-3 text-sm font-semibold uppercase tracking-wide text-pink-600",children:I}),R.length>0?r.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:R.map((e,t)=>r.jsxs("div",{className:"group relative overflow-hidden rounded-2xl border border-pink-100 shadow-sm",children:[r.jsx("img",{src:e,alt:`preview-${t}`,className:"h-48 w-full object-cover transition duration-300 group-hover:scale-105"}),r.jsx("button",{type:"button",onClick:()=>(e=>{const t=[...N.media],r=[...R],[s]=r.splice(e,1);s&&(URL.revokeObjectURL(s),L.current=L.current.filter(e=>e!==s)),t.splice(e,1),w("media",t),U(r)})(t),className:"absolute right-3 top-3 inline-flex items-center justify-center rounded-full bg-black/60 p-2 text-white transition hover:bg-black",children:r.jsx(p,{className:"h-4 w-4"})})]},`${e}-${t}`))}):r.jsx("p",{className:"text-sm text-gray-500",children:F})]})]}),r.jsxs("div",{className:"mt-10 flex flex-col gap-4 sm:flex-row",children:[r.jsx(a,{href:route("timeline.index",{space:v}),className:"flex-1 rounded-xl border border-gray-300 px-6 py-4 text-center font-medium text-gray-700 transition hover:bg-gray-50",children:O}),r.jsx("button",{type:"submit",disabled:S,className:"flex-1 rounded-xl bg-gradient-to-r from-pink-500 to-rose-500 px-6 py-4 font-semibold text-white shadow transition hover:shadow-lg disabled:cursor-not-allowed disabled:opacity-60",children:S?T:A})]})]})})})]})}export{u as default};
