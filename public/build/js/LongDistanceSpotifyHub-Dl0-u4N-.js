import{r as e,al as s,j as a}from"./vendor-DXr22Lef.js";import{M as t}from"./Modal-zylAUIAi.js";import{u as r,b as l}from"./games-RZpJ1ixc.js";import{X as i,S as n}from"./inertia-2axaVlnj.js";import{c as o,a4 as d,l as c,L as m,H as u,h as p,S as x,e as h,a5 as b,D as g,a6 as f}from"./ui-libs-D5k9l7B7.js";import"./animation-H0tefZHq.js";function j(e){const s=e.trim();if(!s)return null;if(s.startsWith("spotify:track:"))return s.split(":").pop()??null;try{const e=new URL(s);if(e.hostname.includes("spotify.com")){const s=e.pathname.split("/").filter(Boolean),a=s.findIndex(e=>"track"===e);if(-1!==a&&s[a+1])return s[a+1]}}catch(a){}return/^[a-zA-Z0-9]{10,}$/.test(s)?s:null}function y(e){return"number"!=typeof e||Number.isNaN(e)?"0%":`${Math.round(100*e)}%`}function N(e){return e?new Date(e).toLocaleString("id-ID",{weekday:"long",hour:"2-digit",minute:"2-digit"}):"-"}function v(e,s="en"){return e?new Date(e).toLocaleDateString(s,{day:"2-digit",month:"long",year:"numeric"}):"-"}function k({space:k}){const{props:w}=i();w.locale;const{translations:_}=r("spotify"),S=_.header??{};_.connection,_.playlist;const C=_.mood??{};_.listening;const T=_.surprise??{},D=_.capsule??{},F=_.loading??{},M=_.messages??{},[I,E]=e.useState(null),[A,B]=e.useState(!0),[L,P]=e.useState(null),[$,R]=e.useState(null),[H,J]=e.useState(null),[K,G]=e.useState(!1),[U,z]=e.useState(!1),[W,q]=e.useState({trackInput:"",scheduledFor:"",note:""}),[O,X]=e.useState({trackInput:"",moment:"",description:"",savedAt:""}),[Y,Z]=e.useState(!1),[Q,V]=e.useState(!1),[ee,se]=e.useState(null),[ae,te]=e.useState(null),[re,le]=e.useState(!1),ie={"--love-hover-color":"#8b5cf6"},ne=route("spotify.authorize",{space:k.slug,redirect:route("spotify.companion",{space:k.slug})}),oe=e.useCallback(()=>{window.location.href=ne},[ne]),de=e.useCallback(async()=>{B(!0),P(null);try{const e=await s.get(route("spotify.dashboard",{space:k.slug}));E(e.data),P(e.data.message??null);const a=e.data.moods?.[0];R(a?.id??null)}catch(e){if(s.isAxiosError(e)){const s=e.response?.data;E(s||null);const a="object"==typeof e.response?.data&&null!==e.response?.data&&"message"in e.response.data?(e.response?.data).message:void 0;P(a??e.message??M.error?.load_failed??"Failed to load Spotify data.")}else Error,E(null),P(M.error?.load_failed??"Failed to load Spotify data.")}finally{B(!1)}},[k.slug]);e.useEffect(()=>{de()},[de]);const ce=I?.playlist??null,me=I?.listening??null,ue=e.useMemo(()=>{if(!ce?.playlist_id)return null;const e=new URLSearchParams({utm_source:"myspacelove",theme:"0"});return`https://open.spotify.com/embed/playlist/${encodeURIComponent(ce.playlist_id)}?${e.toString()}`},[ce?.playlist_id]),pe=e.useMemo(()=>{if(!me?.track_id)return null;const e=new URLSearchParams({utm_source:"myspacelove"});return`https://open.spotify.com/embed/track/${encodeURIComponent(me.track_id)}?${e.toString()}`},[me?.track_id]),xe=e.useMemo(()=>ce?.sample_tracks?.length?ce.sample_tracks.slice(0,3):[],[ce?.sample_tracks]),he=I?.connections??[],be=I?.moods??[],ge=e.useMemo(()=>be.length?$?be.find(e=>e.id===$)??be[0]:be[0]:null,[be,$]),fe=I?.surpriseDrops??[],je=I?.memoryCapsules??[],ye=I?.connected??!1,Ne=e.useCallback(async()=>{if(ye)if(me?.joinable&&me.track_id){le(!0),J(null);try{await s.post(route("spotify.playback.join",{space:k.slug}),{track_id:me.track_id,position_ms:me.progress_ms??0}),J({type:"success",message:M.success?.playback_synced??"Your playback is now synced with the live session."})}catch(e){if(s.isAxiosError(e)){const s=e.response?.data?.message;J({type:"error",message:s??M.error?.join_failed??"Failed to join playback. Make sure your Spotify is active."})}else e instanceof Error?J({type:"error",message:e.message}):J({type:"error",message:M.error?.join_retry??"Failed to join playback. Try again in a moment."})}finally{le(!1)}}else J({type:"error",message:M.error?.no_playback??"No playback session available to join right now."});else oe()},[oe,ye,me,k.slug]),ve=e.useCallback(()=>{ye?(se(null),G(!0)):oe()},[oe,ye]),ke=e.useCallback(()=>{ye?(te(null),z(!0)):oe()},[oe,ye]);return a.jsxs(l,{header:a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:S.title??"Spotify Companion Kit"}),a.jsx("p",{className:"text-sm text-purple-600",children:(S.subtitle??"Space :space: sync music, moods, and moments to stay close despite the distance.").replace(":space",k.title)})]}),children:[a.jsx(n,{title:S.page_title??"Spotify Companion Kit"}),a.jsxs("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-10 px-4 sm:px-6",children:[H&&a.jsx("div",{className:"rounded-3xl border p-4 text-sm "+("success"===H.type?"border-emerald-200 bg-emerald-50 text-emerald-700":"border-rose-200 bg-rose-50 text-rose-700"),children:H.message}),he.length>0&&a.jsxs("section",{className:"rounded-3xl border border-purple-200 bg-white/90 p-6 shadow-sm",children:[a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-purple-900",children:"Status Koneksi Spotify"}),a.jsx("p",{className:"text-sm text-purple-600",children:"Setiap akun perlu tersambung supaya playlist sinkron, mood tracking, dan kejutan berjalan optimal."})]}),a.jsx("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:he.map((e,s)=>{const t=e.connected,r=t?"border-emerald-200 bg-emerald-50/80":"border-rose-200 bg-rose-50/80",l=e.is_current_user?e.name??"Kamu":e.name??"Pasangan",i=e.connected_at?`Terhubung ${N(e.connected_at)}`:t?"Terhubung":"Belum tersambung";return a.jsx("div",{className:`rounded-2xl border p-4 shadow-sm transition ${r}`,children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-purple-900",children:l}),a.jsx("p",{className:"text-xs text-purple-500",children:i})]}),t?a.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-emerald-500/10 px-3 py-1 text-xs font-semibold text-emerald-600",children:[a.jsx(o,{className:"h-4 w-4"}),"Terhubung"]}):e.is_current_user?a.jsxs("button",{type:"button",onClick:oe,"data-love-hover":!0,style:ie,className:"inline-flex items-center gap-2 rounded-full bg-purple-600 px-3 py-1 text-xs font-semibold text-white shadow-sm transition hover:bg-purple-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white",children:[a.jsx(d,{className:"h-4 w-4"}),"Sambungkan"]}):a.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-rose-500/10 px-3 py-1 text-xs font-semibold text-rose-600",children:[a.jsx(d,{className:"h-4 w-4"}),"Belum terhubung"]})]})},`${e.user_id??"guest"}-${s}`)})}),!ye&&I?.message&&a.jsx("p",{className:"mt-4 rounded-2xl bg-rose-50 px-4 py-3 text-sm text-rose-600",children:I.message})]}),!ye&&!F&&0===he.length&&a.jsx("section",{className:"rounded-3xl border border-purple-200 bg-white p-6 shadow-sm",children:a.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-purple-900",children:"Hubungkan Spotify"}),a.jsx("p",{className:"text-sm text-purple-600",children:"Sambungkan akun Spotify kalian untuk menyalakan playlist sinkron, mood check-in, dan kejutan lagu."}),L&&a.jsx("p",{className:"text-sm text-rose-500",children:L})]}),a.jsxs("button",{type:"button",onClick:oe,className:"inline-flex items-center justify-center gap-2 rounded-full bg-purple-600 px-5 py-2 text-sm font-semibold text-white shadow transition hover:bg-purple-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-purple-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white",children:[a.jsx(c,{className:"h-4 w-4"}),"Hubungkan Spotify"]})]})}),F&&a.jsx("section",{className:"flex items-center justify-center rounded-3xl border border-purple-200 bg-white p-8 shadow-sm",children:a.jsxs("div",{className:"flex items-center gap-3 text-purple-600",children:[a.jsx(m,{className:"h-5 w-5 animate-spin"}),a.jsx("span",{className:"text-sm font-medium",children:F.dashboard??"Loading Spotify data..."})]})}),L&&ye&&!F&&a.jsxs("section",{className:"rounded-3xl border border-rose-200 bg-rose-50 p-6 text-sm text-rose-700 shadow-sm",children:[L,a.jsx("button",{type:"button",onClick:()=>{de()},className:"mt-4 inline-flex items-center justify-center rounded-full bg-rose-500 px-4 py-2 text-xs font-semibold text-white hover:bg-rose-600",children:F.retry??"Try Reload"})]}),ye&&!F&&a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:"grid gap-5 rounded-3xl border border-purple-200 bg-purple-50 p-6 shadow-sm md:grid-cols-[1.2fr_1fr]",children:[a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full bg-white p-2 text-purple-500 shadow-sm",children:a.jsx(c,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-purple-800",children:"Playlist Sinkron"}),a.jsx("p",{className:"text-sm text-purple-600",children:"Playlist otomatis update tiap kalian tambah lagu favorit minggu ini."})]})]}),a.jsxs("div",{className:"rounded-2xl bg-white p-5 shadow-sm",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-purple-400",children:"Total lagu"}),a.jsx("p",{className:"text-2xl font-semibold text-purple-800",children:ce?.total_tracks??0})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-purple-400",children:"Tambahan minggu ini"}),a.jsxs("p",{className:"text-xl font-semibold text-purple-700",children:["+",ce?.new_this_week??0]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-purple-400",children:"Energi rata-rata"}),a.jsx("p",{className:"text-xl font-semibold text-purple-700",children:y(ce?.average_energy)})]})]}),ce?.last_added&&a.jsxs("div",{className:"mt-5 rounded-2xl border border-purple-100 bg-purple-50 p-4",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-purple-400",children:"Lagu terbaru"}),a.jsxs("div",{className:"mt-2 flex flex-col gap-1 text-sm text-purple-800",children:[a.jsx("span",{className:"font-semibold",children:ce.last_added.title}),a.jsx("span",{className:"text-purple-500",children:ce.last_added.artists.join(", ")}),ce.last_added.added_at&&a.jsxs("span",{className:"text-xs text-purple-400",children:["Ditambah ",N(ce.last_added.added_at)]})]})]}),ce?.external_url&&a.jsx("a",{href:ce.external_url,target:"_blank",rel:"noopener",className:"mt-5 inline-flex items-center justify-center rounded-full bg-purple-600 px-4 py-2 text-xs font-semibold text-white hover:bg-purple-700",children:"Buka di Spotify"})]}),xe.length>0&&a.jsxs("div",{className:"rounded-2xl bg-white p-5 shadow-sm",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.28em] text-purple-400",children:"Dengarkan cuplikan favorit"}),a.jsx("div",{className:"mt-4 space-y-3",children:xe.map(e=>a.jsxs("div",{className:"rounded-2xl border border-purple-100 bg-purple-50/70 p-4 shadow-inner",children:[a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-purple-800",children:e.name}),a.jsx("p",{className:"text-xs text-purple-500",children:e.artists.join(", ")})]}),e.added_at&&a.jsxs("span",{className:"rounded-full bg-white px-3 py-1 text-xs font-semibold text-purple-500 shadow-sm",children:["Ditambahkan ",v(e.added_at)]})]}),a.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.preview_url?a.jsx("audio",{className:"w-full",controls:!0,preload:"none",src:e.preview_url,children:"Browser kamu tidak mendukung audio HTML5."}):a.jsx("p",{className:"text-xs text-purple-500",children:"Preview tidak tersedia, buka di Spotify untuk memutar penuh."}),e.external_url&&a.jsx("a",{href:e.external_url,target:"_blank",rel:"noopener",className:"inline-flex items-center justify-center rounded-full border border-purple-200 px-3 py-1 text-xs font-semibold text-purple-600 transition hover:border-purple-300 hover:text-purple-700",children:"Buka di Spotify"})]})]},e.id))})]})]}),a.jsxs("div",{className:"space-y-4 rounded-2xl bg-white p-5 shadow-sm",children:[ue?a.jsx("div",{className:"overflow-hidden rounded-xl border border-purple-100 shadow-inner",children:a.jsx("iframe",{src:ue,width:"100%",height:"352",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify playlist embed"},ue)}):a.jsx("p",{className:"rounded-xl border border-dashed border-purple-200 bg-purple-50/80 p-4 text-sm text-purple-500",children:"Hubungkan Spotify untuk memutar playlist langsung tanpa meninggalkan halaman ini."}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.3em] text-purple-400",children:"Progress Weekly Mix"}),a.jsxs("span",{className:"rounded-full bg-purple-100 px-3 py-1 text-xs font-semibold text-purple-600",children:["Target ",ce?.target_weekly??6," lagu/minggu"]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"h-3 rounded-full bg-purple-100",children:a.jsx("div",{className:"h-3 rounded-full bg-purple-500 transition-all",style:{width:`${Math.min((ce?.new_this_week??0)/(ce?.target_weekly??6)*100,100)}%`}})}),a.jsxs("p",{className:"mt-2 text-xs text-purple-500",children:["Tambah ",Math.max((ce?.target_weekly??6)-(ce?.new_this_week??0),0)," lagu lagi biar challenge minggu ini penuh."]})]}),a.jsx("button",{type:"button",onClick:()=>{de()},className:"inline-flex items-center justify-center gap-2 rounded-full border border-purple-200 px-4 py-2 text-xs font-semibold text-purple-600 hover:border-purple-300",children:"Segarkan Data"})]})]}),a.jsxs("section",{className:"grid gap-5 rounded-3xl border border-blue-200 bg-blue-50 p-6 shadow-sm md:grid-cols-[1fr_1.25fr]",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full bg-white p-2 text-blue-500 shadow-sm",children:a.jsx(u,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Mood Check-In"}),a.jsx("p",{className:"text-sm text-blue-600",children:"Tebak mood pasangan dari lagu terakhir yang mereka putar."})]})]}),a.jsxs("div",{className:"grid gap-3",children:[0===be.length&&a.jsx("p",{className:"rounded-2xl border border-blue-100 bg-white p-4 text-sm text-blue-500",children:C.empty??"No mood snapshots yet. Share your first vibe!"}),be.map(e=>a.jsxs("button",{type:"button",onClick:()=>R(e.id),className:"flex w-full items-center justify-between rounded-2xl border p-4 text-left transition "+(ge?.id===e.id?"border-blue-400 bg-white shadow-sm":"border-blue-100 bg-white/70 hover:border-blue-200"),children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-blue-400",children:e.user_label}),a.jsx("p",{className:"mt-1 text-sm font-semibold text-blue-800",children:e.track}),a.jsx("p",{className:"text-xs text-blue-500",children:e.artists})]}),a.jsxs("span",{className:"text-xs font-semibold text-blue-600",children:[y(e.energy)," energi"]})]},e.id))]})]}),a.jsx("div",{className:"space-y-4 rounded-2xl bg-white p-5 shadow-sm",children:ge?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-blue-400",children:ge.user_label}),a.jsx("h4",{className:"text-lg font-semibold text-blue-900",children:ge.mood_tone}),a.jsx("p",{className:"text-sm text-blue-600",children:ge.affection})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 text-blue-600",children:[a.jsx(p,{className:"h-5 w-5"}),a.jsxs("span",{className:"text-xs",children:["Diputar ",ge.played_at?N(ge.played_at):"baru saja"]})]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-blue-400",children:"Rekomendasi aksi manis"}),a.jsx("div",{className:"mt-2 rounded-2xl border border-blue-200 bg-blue-50 p-4 text-sm text-blue-700",children:"Kirim voice note 30 detik sambil putar lagu yang sama, lalu ajak tebak lirik via call."})]}),a.jsx("button",{type:"button",onClick:()=>{de()},className:"inline-flex items-center justify-center rounded-full border border-blue-200 px-4 py-2 text-xs font-semibold text-blue-600 hover:border-blue-300",children:"Segarkan Mood"})]}):a.jsx("p",{className:"text-sm text-blue-500",children:"Pilih salah satu snapshot mood untuk lihat rekomendasi aksi."})})]}),a.jsxs("section",{className:"grid gap-5 rounded-3xl border border-rose-200 bg-rose-50 p-6 shadow-sm md:grid-cols-[1.1fr_0.9fr]",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full bg-white p-2 text-rose-500 shadow-sm",children:a.jsx(x,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-rose-900",children:"Surprise Song Drops"}),a.jsx("p",{className:"text-sm text-rose-600",children:"Jadwalkan lagu kejutan yang otomatis muncul sesuai momen."})]})]}),a.jsxs("div",{className:"space-y-3",children:[0===fe.length&&a.jsx("p",{className:"rounded-2xl border border-rose-100 bg-white p-4 text-sm text-rose-500",children:T.empty??"No surprise drops scheduled yet. Plan your first musical surprise!"}),fe.map(e=>a.jsxs("div",{className:"rounded-2xl border border-rose-100 bg-white p-4 shadow-sm",children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-rose-900",children:e.track}),a.jsx("p",{className:"text-xs text-rose-500",children:e.artists})]}),a.jsxs("span",{className:"rounded-full bg-rose-100 px-3 py-1 text-xs font-semibold text-rose-600",children:["Oleh ",e.curator??"Kamu"]})]}),a.jsxs("p",{className:"mt-2 text-xs text-rose-400",children:["Tayang ",N(e.scheduled_for)]}),e.note&&a.jsx("p",{className:"mt-2 text-sm text-rose-700",children:e.note})]},e.id))]})]}),a.jsxs("div",{className:"space-y-4 rounded-2xl bg-white p-5 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-2 text-rose-600",children:[a.jsx(h,{className:"h-5 w-5"}),a.jsx("p",{className:"text-xs uppercase tracking-[0.28em]",children:"Jadwalkan lagu"})]}),a.jsx("p",{className:"text-sm text-rose-600",children:"Gunakan tombol berikut untuk menambahkan kejutan baru setelah kamu pilih lagu di Spotify."}),a.jsxs("button",{type:"button",onClick:ve,className:"inline-flex items-center justify-center gap-2 rounded-full bg-rose-500 px-5 py-2 text-sm font-semibold text-white shadow transition hover:bg-rose-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300 focus-visible:ring-offset-2 focus-visible:ring-offset-rose-50",children:[a.jsx(x,{className:"h-4 w-4"}),"Jadwalkan lagu kejutan"]}),!ye&&a.jsx("p",{className:"text-xs text-rose-400",children:"Sambungkan Spotify dulu supaya bisa menjadwalkan lagu otomatis."})]})]}),a.jsxs("section",{className:"grid gap-5 rounded-3xl border border-emerald-200 bg-emerald-50 p-6 shadow-sm md:grid-cols-[0.95fr_1.05fr]",children:[a.jsxs("div",{className:"space-y-4 rounded-2xl bg-white p-5 shadow-sm",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full bg-emerald-100 p-2 text-emerald-600",children:a.jsx(b,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-emerald-900",children:"Listening Party Mini"}),a.jsx("p",{className:"text-sm text-emerald-600",children:"Lihat kapan kalian lagi denger lagu yang sama dan gabung sesi bareng."})]})]}),a.jsx("div",{className:"rounded-2xl border border-emerald-100 bg-emerald-50 p-4",children:me?.is_live?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-xl bg-white p-3 text-emerald-600 shadow-sm",children:a.jsx(g,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-emerald-900",children:me.track}),a.jsx("p",{className:"text-xs text-emerald-600",children:me.artists})]})]}),a.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-emerald-600",children:[a.jsxs("span",{children:["Host: ",me.host??"Pasangan"]}),a.jsx("span",{children:me.started_at??"Baru mulai"}),a.jsxs("span",{children:[me.listeners??1," pendengar"]})]}),pe?a.jsx("div",{className:"mt-4 overflow-hidden rounded-xl border border-emerald-100 shadow-inner",children:a.jsx("iframe",{src:pe,width:"100%",height:"152",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",title:"Spotify track embed"},pe)}):me?.external_url&&a.jsx("a",{href:me.external_url,target:"_blank",rel:"noopener",className:"mt-4 inline-flex items-center justify-center rounded-full border border-emerald-200 px-4 py-2 text-xs font-semibold text-emerald-600 transition hover:border-emerald-300",children:"Buka sesi di Spotify"}),a.jsxs("button",{type:"button",onClick:()=>{Ne()},disabled:re,className:"mt-4 inline-flex w-full items-center justify-center gap-2 rounded-full bg-emerald-500 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-emerald-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-emerald-300 focus-visible:ring-offset-2 focus-visible:ring-offset-emerald-50 disabled:cursor-not-allowed disabled:bg-emerald-400/70",children:[a.jsx(f,{className:"h-4 w-4"}),re?"Menyambungkan...":"Gabung playback"]})]}):a.jsx("p",{className:"text-sm text-emerald-600",children:"Tidak ada sesi live sekarang, tapi kamu bisa jadwalkan lewat Surprise Song Drops."})}),a.jsx("button",{type:"button",onClick:()=>{de()},className:"inline-flex items-center justify-center rounded-full border border-emerald-200 px-4 py-2 text-xs font-semibold text-emerald-600 hover:border-emerald-300",children:"Perbarui status playback"})]}),a.jsxs("div",{className:"space-y-4 rounded-2xl bg-white p-5 shadow-sm",children:[a.jsx("p",{className:"text-xs uppercase tracking-[0.28em] text-emerald-400",children:"Rencana listening bareng"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"rounded-2xl border border-emerald-100 bg-emerald-50 p-4 text-sm text-emerald-700",children:[a.jsx("p",{className:"font-semibold text-emerald-900",children:"Challenge akhir pekan"}),a.jsx("p",{className:"mt-1",children:"Jumat malam pukul 20.00, pilih 5 lagu mellow versi kamu, pasangan tebak siapa penyanyinya."})]}),a.jsxs("div",{className:"rounded-2xl border border-emerald-100 bg-emerald-50 p-4 text-sm text-emerald-700",children:[a.jsx("p",{className:"font-semibold text-emerald-900",children:"Mode fokus duo"}),a.jsx("p",{className:"mt-1",children:"Sinkronkan playback untuk sesi belajar 45 menit, lanjut break call 15 menit."})]})]})]})]}),a.jsxs("section",{className:"grid gap-5 rounded-3xl border border-amber-200 bg-amber-50 p-6 shadow-sm md:grid-cols-[1.05fr_0.95fr]",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"rounded-full bg-white p-2 text-amber-500 shadow-sm",children:a.jsx(x,{className:"h-5 w-5"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-amber-900",children:"Memory Capsule"}),a.jsx("p",{className:"text-sm text-amber-600",children:"Simpan highlight lagu penting dan putar preview 30 detik kapan pun."})]})]}),a.jsxs("div",{className:"space-y-4",children:[0===je.length&&a.jsx("p",{className:"rounded-2xl border border-amber-100 bg-white p-4 text-sm text-amber-600",children:D.empty??"No memory capsules yet. Start preserving your musical memories!"}),je.map(e=>a.jsxs("div",{className:"rounded-2xl border border-amber-100 bg-white p-4 shadow-sm",children:[a.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-semibold text-amber-900",children:e.track}),a.jsx("p",{className:"text-xs text-amber-600",children:e.artists})]}),e.moment&&a.jsx("span",{className:"rounded-full bg-amber-100 px-3 py-1 text-xs font-semibold text-amber-600",children:e.moment})]}),e.description&&a.jsx("p",{className:"mt-2 text-sm text-amber-700",children:e.description}),a.jsxs("p",{className:"mt-2 text-xs text-amber-500",children:["Disimpan ",v(e.saved_at)]}),e.preview_url&&a.jsx("audio",{className:"mt-3 w-full",controls:!0,src:e.preview_url,children:"Browser kamu tidak mendukung audio HTML5."})]},e.id))]})]}),a.jsxs("div",{className:"grid gap-4 rounded-2xl bg-white p-5 shadow-sm",children:[a.jsxs("div",{className:"rounded-2xl border border-amber-100 bg-amber-50 p-4 text-sm text-amber-700",children:[a.jsx("p",{className:"text-base font-semibold text-amber-900",children:"Simpan momen baru"}),a.jsx("p",{className:"mt-1",children:"Tandai highlight lagu dan tuliskan kenangannya supaya mudah diputar lagi kapan pun."}),a.jsxs("button",{type:"button",onClick:ke,className:"mt-4 inline-flex items-center justify-center gap-2 rounded-full bg-amber-500 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-amber-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-amber-300 focus-visible:ring-offset-2 focus-visible:ring-offset-amber-50",children:[a.jsx(x,{className:"h-4 w-4"}),"Simpan kapsul memori"]}),!ye&&a.jsx("p",{className:"mt-2 text-xs text-amber-500",children:"Hubungkan Spotify terlebih dahulu untuk menyimpan kapsul langsung dari lagu pilihanmu."})]}),a.jsx("div",{className:"rounded-2xl border border-dashed border-amber-200 bg-amber-50 p-4 text-xs text-amber-600",children:"Token OAuth sudah tersimpan otomatis setelah kamu menghubungkan Spotify. Gunakan endpoint di atas atau job terjadwal untuk memicu pengalaman tambahan."})]})]})]})]}),a.jsx(t,{show:K,onClose:()=>{G(!1),se(null)},maxWidth:"lg",children:a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),Y)return;se(null);const a=j(W.trackInput);if(a){Z(!0);try{const e=(await s.post(route("spotify.surprises.store",{space:k.slug}),{spotify_track_id:a,scheduled_for:W.scheduledFor,note:W.note||null})).data;E(s=>{if(!s)return s;const a=[...s.surpriseDrops??[],e].sort((e,s)=>(e.scheduled_for?new Date(e.scheduled_for).getTime():Number.MAX_SAFE_INTEGER)-(s.scheduled_for?new Date(s.scheduled_for).getTime():Number.MAX_SAFE_INTEGER));return{...s,surpriseDrops:a}}),q({trackInput:"",scheduledFor:"",note:""}),G(!1),J({type:"success",message:M.success?.surprise_scheduled??"Surprise song successfully scheduled!"})}catch(t){if(s.isAxiosError(t)){const e=t.response?.data?.message;se(e??M.error?.surprise_failed??"Failed to schedule surprise song. Try again.")}else t instanceof Error?se(t.message):se(M.error?.surprise_failed??"Failed to schedule surprise song. Try again.")}finally{Z(!1)}}else se(M.error?.invalid_track??"Enter a valid Spotify track link or ID.")},className:"space-y-5 p-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-rose-900",children:"Tambah Surprise Song Drop"}),a.jsx("p",{className:"mt-1 text-sm text-rose-600",children:"Tempel tautan lagu Spotify, pilih jadwal pemutaran, dan tambahkan pesan manis untuk pasanganmu."})]}),ee&&a.jsx("p",{className:"rounded-md bg-rose-50 p-3 text-sm text-rose-600",children:ee}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"surprise-track",className:"text-sm font-medium text-rose-900",children:"Lagu Spotify"}),a.jsx("input",{id:"surprise-track",type:"text",required:!0,value:W.trackInput,onChange:e=>q(s=>({...s,trackInput:e.target.value})),placeholder:"https://open.spotify.com/track/...",className:"w-full rounded-lg border border-rose-200 px-3 py-2 text-sm text-rose-900 focus:border-rose-400 focus:outline-none focus:ring-2 focus:ring-rose-200"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"surprise-schedule",className:"text-sm font-medium text-rose-900",children:"Jadwalkan untuk"}),a.jsx("input",{id:"surprise-schedule",type:"datetime-local",required:!0,value:W.scheduledFor,onChange:e=>q(s=>({...s,scheduledFor:e.target.value})),className:"w-full rounded-lg border border-rose-200 px-3 py-2 text-sm text-rose-900 focus:border-rose-400 focus:outline-none focus:ring-2 focus:ring-rose-200"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"surprise-note",className:"text-sm font-medium text-rose-900",children:"Catatan kejutan (opsional)"}),a.jsx("textarea",{id:"surprise-note",rows:3,value:W.note,onChange:e=>q(s=>({...s,note:e.target.value})),className:"w-full rounded-lg border border-rose-200 px-3 py-2 text-sm text-rose-900 focus:border-rose-400 focus:outline-none focus:ring-2 focus:ring-rose-200"})]}),a.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:()=>{G(!1),se(null)},className:"rounded-full border border-rose-200 px-4 py-2 text-sm font-semibold text-rose-600 hover:border-rose-300",children:"Batal"}),a.jsx("button",{type:"submit",disabled:Y,className:"inline-flex items-center justify-center gap-2 rounded-full bg-rose-500 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-rose-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white disabled:cursor-not-allowed disabled:bg-rose-400/70",children:Y?"Menyimpan...":"Jadwalkan"})]})]})}),a.jsx(t,{show:U,onClose:()=>{z(!1),te(null)},maxWidth:"lg",children:a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),Q)return;te(null);const a=j(O.trackInput);if(a){V(!0);try{const e=(await s.post(route("spotify.capsules.store",{space:k.slug}),{spotify_track_id:a,moment:O.moment||null,description:O.description||null,saved_at:O.savedAt||null})).data;E(s=>{if(!s)return s;const a=[...s.memoryCapsules??[],e].sort((e,s)=>{const a=e.saved_at?new Date(e.saved_at).getTime():0;return(s.saved_at?new Date(s.saved_at).getTime():0)-a});return{...s,memoryCapsules:a}}),X({trackInput:"",moment:"",description:"",savedAt:""}),z(!1),J({type:"success",message:M.success?.capsule_saved??"Memory capsule successfully saved!"})}catch(t){if(s.isAxiosError(t)){const e=t.response?.data?.message;te(e??M.error?.capsule_failed??"Failed to save memory capsule. Try again.")}else t instanceof Error?te(t.message):te(M.error?.capsule_failed??"Failed to save memory capsule. Try again.")}finally{V(!1)}}else te(M.error?.invalid_track??"Enter a valid Spotify track link or ID.")},className:"space-y-5 p-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-amber-900",children:"Buat Memory Capsule"}),a.jsx("p",{className:"mt-1 text-sm text-amber-600",children:"Simpan cerita singkat tentang lagu yang berarti untuk kalian. Kami ambil preview 30 detik otomatis jika tersedia."})]}),ae&&a.jsx("p",{className:"rounded-md bg-amber-50 p-3 text-sm text-amber-700",children:ae}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"capsule-track",className:"text-sm font-medium text-amber-900",children:"Lagu Spotify"}),a.jsx("input",{id:"capsule-track",type:"text",required:!0,value:O.trackInput,onChange:e=>X(s=>({...s,trackInput:e.target.value})),placeholder:"https://open.spotify.com/track/...",className:"w-full rounded-lg border border-amber-200 px-3 py-2 text-sm text-amber-900 focus:border-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-200"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"capsule-moment",className:"text-sm font-medium text-amber-900",children:"Judul momen (opsional)"}),a.jsx("input",{id:"capsule-moment",type:"text",value:O.moment,onChange:e=>X(s=>({...s,moment:e.target.value})),placeholder:"Contoh: Anniversary pertama",className:"w-full rounded-lg border border-amber-200 px-3 py-2 text-sm text-amber-900 focus:border-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-200"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"capsule-description",className:"text-sm font-medium text-amber-900",children:"Cerita singkat (opsional)"}),a.jsx("textarea",{id:"capsule-description",rows:4,value:O.description,onChange:e=>X(s=>({...s,description:e.target.value})),placeholder:"Tulis kenapa lagu ini spesial...",className:"w-full rounded-lg border border-amber-200 px-3 py-2 text-sm text-amber-900 focus:border-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-200"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"capsule-date",className:"text-sm font-medium text-amber-900",children:"Tanggal momen (opsional)"}),a.jsx("input",{id:"capsule-date",type:"date",value:O.savedAt,onChange:e=>X(s=>({...s,savedAt:e.target.value})),className:"w-full rounded-lg border border-amber-200 px-3 py-2 text-sm text-amber-900 focus:border-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-200"})]}),a.jsxs("div",{className:"flex items-center justify-end gap-3",children:[a.jsx("button",{type:"button",onClick:()=>{z(!1),te(null)},className:"rounded-full border border-amber-200 px-4 py-2 text-sm font-semibold text-amber-600 hover:border-amber-300",children:"Batal"}),a.jsx("button",{type:"submit",disabled:Q,className:"inline-flex items-center justify-center gap-2 rounded-full bg-amber-500 px-5 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-amber-600 focus:outline-none focus-visible:ring-2 focus-visible:ring-amber-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white disabled:cursor-not-allowed disabled:bg-amber-400/70",children:Q?"Menyimpan...":"Simpan"})]})]})})]})}export{k as default};
