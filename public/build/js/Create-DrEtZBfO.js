import{r as e,j as t}from"./vendor-DXr22Lef.js";import{a as r,u as s,b as a}from"./games-RZpJ1ixc.js";import{G as i,S as o,x as l,A as n}from"./inertia-2axaVlnj.js";import{u as d}from"./useCurrentSpace-CdnheA8Y.js";import{c}from"./imageConverter-BDj124y7.js";import{e as m,U as p,X as x,A as h}from"./ui-libs-D5k9l7B7.js";import"./animation-H0tefZHq.js";function u(){const u=d(),{showSuccess:b,showError:g}=r(),{translations:f}=s("timeline"),{t:j}=s("errors"),v=f?.create?.heading??{},y=f?.create?.form??{},N=f?.meta?.create??"Add Memory";if(!u)return null;const w=u.slug,k=u.title,{data:S,setData:C,post:M,processing:R,errors:U,clearErrors:D}=i({title:"",description:"",date:(new Date).toISOString().split("T")[0],media:[]}),[_,A]=e.useState([]),[L,O]=e.useState(null),E=e.useRef([]);e.useEffect(()=>()=>{E.current.forEach(e=>URL.revokeObjectURL(e))},[]);const T=y.actions?.cancel??"Cancel",$=y.actions?.submit??"Save memory",z=y.actions?.submitting??"Saving…",F=y.media?.helper?.replace(":count",String(5)),I=y.media?.label??"Photos",P=y.media?.button??"Choose photos",B=y.media?.empty??"No photos selected yet.",G=y.media?.preview_label??"Preview",Y=e.useMemo(()=>j("timeline.image_too_large","File size too large. Maximum 10 MB for memory and special moment photos."),[j]),q=e.useMemo(()=>j("timeline.max_media_count","You can upload up to :count photos at once.").replace(":count",String(5)),[j]),H=e.useMemo(()=>j("upload.image_not_convertible","The image could not be processed into .webp format."),[j]);return t.jsxs(a,{loveCursor:{color:"#f43f5e",heartCount:42,className:"opacity-70"},header:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(l,{href:route("timeline.index",{space:w}),className:"rounded-lg p-2 transition hover:bg-gray-100",children:t.jsx(h,{className:"h-5 w-5"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:v.title??"Add Special Moment"}),t.jsx("p",{className:"text-gray-600",children:v.subtitle?.replace(":space",k)??`Record a cherished memory for ${k}.`})]})]}),children:[t.jsx(o,{title:N}),t.jsx("div",{className:"relative min-h-screen overflow-hidden bg-gradient-to-br from-pink-50 via-white to-rose-50 py-10 px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"relative mx-auto max-w-4xl",children:t.jsxs("form",{onSubmit:e=>{e.preventDefault(),L||(D(),M(route("timeline.store",{space:w}),{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{b("Momen spesial berhasil ditambahkan!"),n.visit(route("timeline.index",{space:w}))},onError:e=>{g("Gagal menyimpan momen. Silakan periksa kembali input Anda.")}}))},className:"relative z-10 rounded-3xl border border-gray-100 bg-white/80 p-8 shadow-lg backdrop-blur-sm md:p-10",children:[t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-base font-semibold text-gray-800",children:y.title?.label??"Moment Title"}),t.jsx("input",{type:"text",value:S.title,onChange:e=>C("title",e.target.value),className:"w-full rounded-2xl border border-gray-300 px-5 py-4 text-gray-800 transition focus:border-transparent focus:ring-2 focus:ring-pink-500",placeholder:y.title?.placeholder??"e.g. Our first anniversary dinner"}),U.title&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:U.title})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-base font-semibold text-gray-800",children:y.date?.label??"Date"}),t.jsxs("div",{className:"relative",children:[t.jsx(m,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),t.jsx("input",{type:"date",value:S.date,onChange:e=>C("date",e.target.value),max:(new Date).toISOString().split("T")[0],className:"w-full rounded-2xl border border-gray-300 pl-12 pr-5 py-4 text-gray-800 transition focus:border-transparent focus:ring-2 focus:ring-pink-500"})]}),U.date&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:U.date})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-2 block text-base font-semibold text-gray-800",children:y.description?.label??"Description"}),t.jsx("textarea",{value:S.description,onChange:e=>C("description",e.target.value),rows:6,className:"w-full rounded-2xl border border-gray-300 px-5 py-4 text-gray-800 transition focus:border-transparent focus:ring-2 focus:ring-pink-500",placeholder:y.description?.placeholder??"Tell the story behind this moment…"}),U.description&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:U.description})]}),t.jsxs("div",{children:[t.jsx("label",{className:"mb-3 block text-base font-semibold text-gray-800",children:I}),t.jsxs("div",{className:"rounded-2xl border-2 border-dashed border-gray-300 p-8 text-center transition hover:border-pink-400",children:[t.jsx(p,{className:"mx-auto mb-4 h-16 w-16 text-pink-500"}),t.jsx("p",{className:"mb-2 text-sm text-gray-600",children:F??"Upload up to 5 photos."}),t.jsx("input",{type:"file",id:"timeline-media",className:"hidden",multiple:!0,accept:"image/*",onChange:async e=>{const t=Array.from(e.target.files||[]);if(0===t.length)return;if(S.media.length+t.length>5)return void O(q);const r=[],s=[];for(const i of t)try{const e=await c(i);if(e.size>10485760)return void O(Y);r.push(e);const t=URL.createObjectURL(e);E.current.push(t),s.push(t)}catch(a){return void O(H)}O(null),C("media",[...S.media,...r]),A([..._,...s])}}),t.jsx("label",{htmlFor:"timeline-media",className:"inline-flex cursor-pointer items-center justify-center gap-2 rounded-xl bg-pink-500 px-8 py-3 font-semibold text-white transition hover:bg-pink-600",children:P}),S.media.length>0&&t.jsxs("p",{className:"mt-4 text-sm text-gray-600",children:[S.media.length," / ",5]})]}),L&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:L}),U.media&&t.jsx("p",{className:"mt-2 text-sm text-red-500",children:U.media})]}),t.jsxs("div",{className:"rounded-2xl border border-pink-100 bg-white/75 p-6 shadow-sm",children:[t.jsx("h3",{className:"mb-3 text-sm font-semibold uppercase tracking-wide text-pink-600",children:G}),_.length>0?t.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:_.map((e,r)=>t.jsxs("div",{className:"group relative overflow-hidden rounded-2xl border border-pink-100 shadow-sm",children:[t.jsx("img",{src:e,alt:`preview-${r}`,className:"h-48 w-full object-cover transition duration-300 group-hover:scale-105"}),t.jsx("button",{type:"button",onClick:()=>(e=>{const t=[...S.media],r=[..._],[s]=r.splice(e,1);s&&(URL.revokeObjectURL(s),E.current=E.current.filter(e=>e!==s)),t.splice(e,1),C("media",t),A(r)})(r),className:"absolute right-3 top-3 inline-flex items-center justify-center rounded-full bg-black/60 p-2 text-white transition hover:bg-black",children:t.jsx(x,{className:"h-4 w-4"})})]},`${e}-${r}`))}):t.jsx("p",{className:"text-sm text-gray-500",children:B})]})]}),t.jsxs("div",{className:"mt-10 flex flex-col gap-4 sm:flex-row",children:[t.jsx(l,{href:route("timeline.index",{space:w}),className:"flex-1 rounded-xl border border-gray-300 px-6 py-4 text-center font-medium text-gray-700 transition hover:bg-gray-50",children:T}),t.jsx("button",{type:"submit",disabled:R,className:"flex-1 rounded-xl bg-gradient-to-r from-pink-500 to-rose-500 px-6 py-4 font-semibold text-white shadow transition hover:shadow-lg disabled:cursor-not-allowed disabled:opacity-60",children:R?z:$})]})]})})})]})}export{u as default};
