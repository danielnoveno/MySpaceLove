import{r as e,j as t}from"./vendor-DXr22Lef.js";import{C as s}from"./ConfirmDialog-CcaUaQi1.js";import{b as a}from"./games-RZpJ1ixc.js";import{u as l}from"./useCurrentSpace-CdnheA8Y.js";import{S as i,x as r,A as n}from"./inertia-2axaVlnj.js";import{m as o,a as d,b as c}from"./animation-H0tefZHq.js";import{P as m,y as u,z as x,d as p,f as h,X as g,e as f}from"./ui-libs-D5k9l7B7.js";import"./Modal-zylAUIAi.js";function b({children:e,onSendToBack:s,sensitivity:a,disableDrag:l=!1}){const i=d(0),r=d(0),n=c(r,[-100,100],[60,-60]),m=c(i,[-100,100],[-60,60]);return l?t.jsx(o.div,{className:"absolute inset-0 cursor-pointer",style:{x:0,y:0},children:e}):t.jsx(o.div,{className:"absolute inset-0 cursor-grab",style:{x:i,y:r,rotateX:n,rotateY:m},drag:!0,dragConstraints:{top:0,right:0,bottom:0,left:0},dragElastic:.6,whileTap:{cursor:"grabbing"},onDragEnd:function(e,t){Math.abs(t.offset.x)>a||Math.abs(t.offset.y)>a?s():(i.set(0),r.set(0))},children:e})}function j({randomRotation:s=!1,sensitivity:a=200,cards:l=[],animationConfig:i={stiffness:260,damping:20},sendToBackOnClick:r=!1,autoplay:n=!1,autoplayDelay:d=3e3,pauseOnHover:c=!1,mobileClickOnly:m=!1,mobileBreakpoint:u=768}){const[x,p]=e.useState(!1),[h,g]=e.useState(!1);e.useEffect(()=>{const e=()=>{p(window.innerWidth<u)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[u]);const f=m&&x,j=r||f,[v,w]=e.useState(()=>l.length?l.map((e,t)=>({id:t+1,content:e})):[{id:1,content:t.jsx("img",{src:"https://images.unsplash.com/photo-1480074568708-e7b720bb3f09?q=80&w=500&auto=format",alt:"card-1",className:"w-full h-full object-cover pointer-events-none"})},{id:2,content:t.jsx("img",{src:"https://images.unsplash.com/photo-1449844908441-8829872d2607?q=80&w=500&auto=format",alt:"card-2",className:"w-full h-full object-cover pointer-events-none"})},{id:3,content:t.jsx("img",{src:"https://images.unsplash.com/photo-1452626212852-811d58933cae?q=80&w=500&auto=format",alt:"card-3",className:"w-full h-full object-cover pointer-events-none"})},{id:4,content:t.jsx("img",{src:"https://images.unsplash.com/photo-1572120360610-d971b9d7767c?q=80&w=500&auto=format",alt:"card-4",className:"w-full h-full object-cover pointer-events-none"})}]);e.useEffect(()=>{l.length&&w(l.map((e,t)=>({id:t+1,content:e})))},[l]);const k=e=>{w(t=>{const s=[...t],a=s.findIndex(t=>t.id===e),[l]=s.splice(a,1);return s.unshift(l),s})};return e.useEffect(()=>{if(n&&v.length>1&&!h){const e=setInterval(()=>{const e=v[v.length-1].id;k(e)},d);return()=>clearInterval(e)}},[n,d,v,h]),t.jsx("div",{className:"relative w-full h-full",style:{perspective:600},onMouseEnter:()=>c&&g(!0),onMouseLeave:()=>c&&g(!1),children:v.map((e,l)=>{const r=s?10*Math.random()-5:0;return t.jsx(b,{onSendToBack:()=>k(e.id),sensitivity:a,disableDrag:f,children:t.jsx(o.div,{className:"rounded-2xl overflow-hidden w-full h-full",onClick:()=>j&&k(e.id),animate:{rotateZ:4*(v.length-l-1)+r,scale:1+.06*l-.06*v.length,transformOrigin:"90% 90%"},initial:!1,transition:{type:"spring",stiffness:i.stiffness,damping:i.damping},children:e.content})},e.id)})})}const v=e=>{if(!e)return"";try{return new Intl.DateTimeFormat("id-ID",{day:"numeric",month:"long",year:"numeric"}).format(new Date(e))}catch{return e}};function w({collections:o}){const d=l(),[c,b]=e.useState(null),[w,k]=e.useState(null),[y,N]=e.useState(null),[C,S]=e.useState(!1),[E,_]=e.useState(!1),T=e.useRef(null);if(!d)return null;const F=d.slug,M=d.title,P=e.useMemo(()=>o.filter(e=>e.items.length>0),[o]),D=()=>{b(null),k(null)},[H,B]=e.useState(null),[L,z]=e.useState(!1);return t.jsxs(a,{header:t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.42em] text-emerald-400",children:"Memory album"}),t.jsxs("h2",{className:"text-3xl font-semibold text-emerald-900",children:["Gallery Photos â€” ",M]})]}),children:[t.jsx(i,{title:`Gallery - ${M}`}),t.jsxs("div",{className:"relative mx-auto max-w-6xl space-y-10 px-4 pb-20 sm:px-6 lg:px-8",children:[t.jsx("section",{className:"rounded-[32px] border border-emerald-100/80 bg-white/90 p-8 shadow-sm backdrop-blur",children:t.jsxs("div",{className:"flex flex-col gap-5 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.42em] text-emerald-400",children:"Koleksi visual"}),t.jsx("h3",{className:"text-2xl font-semibold text-emerald-900",children:"Simpan cerita dalam grid minimalis"}),t.jsx("p",{className:"mt-1 text-sm text-emerald-700/80",children:"Foto yang diunggah bersamaan otomatis dikelompokkan agar tetap rapi seperti galeri iPhone kalian."})]}),t.jsxs(r,{href:route("gallery.create",{space:F}),className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-emerald-500 to-teal-500 px-6 py-2 text-sm font-semibold text-white shadow-md transition hover:shadow-lg",children:[t.jsx(m,{className:"h-4 w-4"}),"Upload Koleksi"]})]})}),0===P.length?t.jsxs("div",{className:"rounded-[32px] border border-dashed border-emerald-200 bg-white/85 py-16 text-center shadow-inner",children:[t.jsx("p",{className:"text-lg font-semibold text-emerald-800",children:"Galerinya masih kosong."}),t.jsx("p",{className:"mt-2 text-sm text-emerald-600",children:"Unggah beberapa foto sekaligus untuk membuat album favorit kalian."})]}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8",children:P.map(e=>{const s=e.items.slice(0,5).map((e,s)=>t.jsx("img",{src:e.url,alt:e.title??"Gallery Item",className:"h-full w-full object-cover rounded-xl shadow-lg border-2 border-white pointer-events-none"},s));return t.jsxs("article",{className:"group break-inside-avoid rounded-3xl bg-white/95 shadow-sm ring-1 ring-slate-100 transition duration-300 hover:-translate-y-1 hover:shadow-lg hover:ring-emerald-100 flex flex-col overflow-hidden",children:[t.jsx("div",{className:"relative w-full h-80 p-6 bg-slate-50/50",children:t.jsx("div",{className:"w-full h-full relative",children:t.jsx(j,{cards:s,sensitivity:100,sendToBackOnClick:!1,randomRotation:!0,pauseOnHover:!0})})}),t.jsx("div",{onClick:()=>(e=>{b(e),k(e.items[0]??null)})(e),className:"flex flex-col px-5 pb-5 pt-4 cursor-pointer",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-slate-800",children:e.title?.trim()||"Koleksi tanpa judul"}),t.jsx("p",{className:"text-xs text-slate-500",children:v(e.created_at)})]}),e.count>1&&t.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-emerald-50 px-3 py-1 text-xs font-medium text-emerald-700",children:[t.jsx(u,{className:"h-3.5 w-3.5"}),e.count]})]})}),t.jsxs("div",{className:"flex items-center justify-between px-3 pb-3 text-xs text-slate-500 border-t border-slate-100 pt-3 mx-4 mb-3",children:[t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full px-2 py-0.5 font-medium text-emerald-700/60 bg-emerald-50/50",children:[t.jsx(x,{className:"h-3 w-3"}),"Koleksi"]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs("button",{type:"button",onClick:t=>{t.stopPropagation(),B(e)},className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 transition hover:border-rose-200 hover:bg-rose-50 hover:text-rose-700",children:[t.jsx(p,{className:"h-3.5 w-3.5"}),"Hapus"]}),t.jsxs(r,{href:route("gallery.edit",{space:F,id:e.items[0]?.id}),onClick:e=>{e.stopPropagation()},className:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600 transition hover:border-emerald-200 hover:bg-emerald-50 hover:text-emerald-700",children:[t.jsx(h,{className:"h-3.5 w-3.5"}),"Edit"]})]})]})]},e.collection_key??`collection-${e.items[0]?.id}`)})})]}),c&&t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 px-4 py-8 sm:px-6",children:[t.jsx("div",{className:"absolute inset-0",onClick:D,"aria-hidden":"true"}),t.jsxs("div",{className:"relative z-10 flex w-full max-w-6xl flex-col gap-6 overflow-hidden rounded-[32px] border border-white/10 bg-white shadow-2xl",children:[t.jsx("button",{type:"button",onClick:D,className:"absolute right-5 top-5 z-20 rounded-full bg-black/60 p-2 text-white transition hover:bg-black","aria-label":"Tutup detail galeri",children:t.jsx(g,{className:"h-4 w-4"})}),t.jsxs("div",{className:"grid gap-6 px-6 pb-8 pt-16 sm:px-8 md:grid-cols-[minmax(0,1.4fr)_minmax(0,1fr)]",children:[t.jsx("div",{className:"flex flex-col gap-4",children:w?t.jsx("div",{className:"overflow-hidden rounded-[28px] bg-slate-100 shadow-inner",children:t.jsx("img",{src:w.url,alt:w.title??"Preview galeri",className:"max-h-[480px] w-full object-contain"})}):t.jsx("div",{className:"flex min-h-[320px] items-center justify-center rounded-[28px] border border-dashed border-slate-200 bg-slate-50 text-sm text-slate-400",children:"Pilih foto untuk melihat preview besar."})}),t.jsxs("div",{className:"flex flex-col gap-5",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs uppercase tracking-[0.36em] text-emerald-400",children:"Koleksi foto"}),t.jsx("h3",{className:"mt-2 text-2xl font-semibold text-slate-900",children:c.title?.trim()||"Koleksi tanpa judul"})]}),t.jsxs("div",{children:[t.jsxs("button",{type:"button",disabled:E,onClick:()=>T.current?.click(),className:"inline-flex shrink-0 items-center gap-2 rounded-full bg-emerald-50 px-4 py-2 text-sm font-semibold text-emerald-700 shadow-sm transition hover:bg-emerald-100 disabled:opacity-60",children:[t.jsx(x,{className:"h-4 w-4"}),E?"Mengunggah...":"Tambah Foto"]}),t.jsx("input",{type:"file",multiple:!0,ref:T,className:"hidden",onChange:e=>{if(!e.target.files||0===e.target.files.length||!c?.collection_key)return;const t=Array.from(e.target.files);_(!0),n.post(route("gallery.store",{space:F}),{files:t,collection_key:c.collection_key},{preserveScroll:!0,onSuccess:e=>{const t=e.props.collections.find(e=>e.collection_key===c.collection_key);t&&b(t)},onFinish:()=>{_(!1),e.target&&(e.target.value="")}})},accept:"image/jpeg,image/png,image/gif,video/mp4,video/quicktime"})]})]}),t.jsxs("p",{className:"mt-2 inline-flex items-center gap-2 text-sm text-slate-500",children:[t.jsx(f,{className:"h-4 w-4 text-emerald-500"}),v(c.created_at)]}),t.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:[c.count," foto tersimpan"]})]}),t.jsx("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-3",children:c.items.map(e=>t.jsxs("div",{onClick:()=>k(e),className:"group relative cursor-pointer overflow-hidden rounded-2xl border border-slate-100 bg-white shadow-sm transition hover:-translate-y-1 hover:shadow-md "+(w?.id===e.id?"ring-2 ring-emerald-400":""),children:[t.jsx("img",{src:e.url,alt:e.title??"Foto galeri",className:"h-32 w-full object-cover transition duration-300 group-hover:scale-105"}),t.jsx("div",{className:"absolute inset-0 bg-black/30 opacity-0 transition group-hover:opacity-100"}),t.jsxs("div",{className:"absolute inset-x-2 bottom-2 flex items-center justify-between gap-2 text-[11px] font-medium text-white transition",children:[t.jsxs("button",{type:"button",onClick:t=>{t.stopPropagation(),N(e)},className:"inline-flex items-center gap-1 rounded-full bg-white/20 px-2 py-1 backdrop-blur hover:bg-rose-500/90",children:[t.jsx(p,{className:"h-3 w-3"}),"Hapus"]}),t.jsxs(r,{href:route("gallery.edit",{space:F,id:e.id}),onClick:e=>e.stopPropagation(),className:"inline-flex items-center gap-1 rounded-full bg-white/20 px-2 py-1 backdrop-blur hover:bg-emerald-500/90",children:[t.jsx(h,{className:"h-3 w-3"}),"Edit"]})]})]},e.id))})]})]})]})]}),t.jsx(s,{open:null!==y,title:y?`Hapus foto galeri "${y.title??"Tanpa judul"}"?`:"Hapus foto galeri?",description:y?`Foto di koleksi galeri "${y.title??"tanpa judul"}" akan dihapus permanen.`:"Foto akan dihapus permanen dari galeri.",confirmLabel:"Ya, hapus foto galeri",cancelLabel:"Batal",tone:"danger",loading:C,onCancel:()=>{C||N(null)},onConfirm:()=>{y&&(S(!0),n.delete(route("gallery.destroy",{space:F,id:y.id}),{preserveScroll:!0,onSuccess:()=>{N(null)},onError:()=>{N(null)},onFinish:()=>{S(!1)}}))}}),t.jsx(s,{open:null!==H,title:H?`Hapus koleksi galeri "${H.title??"Tanpa judul"}"?`:"Hapus koleksi galeri?",description:H?`Semua foto dalam koleksi "${H.title??"tanpa judul"}" akan dihapus permanen dari galeri.`:"Semua foto dalam koleksi ini akan dihapus permanen dari galeri.",confirmLabel:"Ya, hapus koleksi galeri",cancelLabel:"Batal",tone:"danger",loading:L,onCancel:()=>{L||B(null)},onConfirm:()=>{H&&H.collection_key&&(z(!0),n.delete(route("gallery.destroyCollection",{space:F,collection_key:H.collection_key}),{preserveScroll:!0,onSuccess:()=>{B(null),D()},onError:e=>{B(null)},onFinish:()=>{z(!1)}}))}})]})}export{w as default};
