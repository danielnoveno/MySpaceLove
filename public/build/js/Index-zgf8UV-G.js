import{r as e,ak as t,j as s}from"./vendor-DtplsvIg.js";import{a}from"./games-C9PD58Ia.js";import{u as i}from"./useCurrentSpace--m3qXMVy.js";import{A as l,S as n,x as r}from"./inertia-BRtPwdNN.js";import{C as o}from"./ConfirmDialog-BmvPSwZQ.js";import{P as d,t as c,a as m,L as x,b as p,T as u,H as h,X as b}from"./ui-libs-CxG7ASKr.js";import"./animation-BDJwZp_N.js";import"./Modal-DXoGrJ2Y.js";function f({timelines:f}){const g=i();if(!g)return null;const[j,k]=e.useState(f),[v,w]=e.useState(null),[N,y]=e.useState(null),[C,S]=e.useState(null),[$,_]=e.useState(null),[M,P]=e.useState(!1),B=g.slug,D=g.title,L=e.useCallback(e=>{if(!e)return"";try{return new Date(e).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}catch{return e}},[]),H=e.useCallback(async(e,s)=>{S(e);try{await t.post(route("timeline.thumbnail",{space:B,timeline:e}),{path:s}),k(t=>t.map(t=>t.uuid===e?{...t,thumbnail_path:s,thumbnail_url:s?t.media_urls[t.media_paths.findIndex(e=>e===s)]??`/storage/${s}`:t.media_urls[0]??null}:t))}catch(a){}finally{S(null)}},[B]),T=e.useCallback(e=>{_(e)},[]),U=e.useCallback(()=>{$&&(P(!0),l.delete(route("timeline.destroy",{space:B,timeline:$.uuid}),{preserveScroll:!0,onSuccess:()=>{_(null),l.visit(route("timeline.index",{space:B}),{preserveScroll:!0,replace:!0})},onError:()=>{_(null)},onFinish:()=>P(!1)}))},[$,B]),z=e.useMemo(()=>j.map(e=>{const t=(e=>{const t=e.media_paths??[],s=e.media_urls??[];return t.map((e,t)=>({path:e,url:s[t]??`/storage/${e}`}))})(e),s=t[0]?.url??null;return{...e,media:t,coverUrl:e.thumbnail_url??s,coverPath:e.thumbnail_path??t[0]?.path??null}}),[j]);return s.jsxs(a,{loveCursor:{color:"#f43f5e",heartCount:48,className:"opacity-70"},header:s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-pink-400",children:"Moment collection"}),s.jsxs("h2",{className:"text-3xl font-semibold text-pink-900",children:["Love Timeline – ",D]})]}),children:[s.jsx(n,{title:`Timeline - ${D}`}),s.jsxs("div",{className:"relative mx-auto max-w-6xl space-y-10 px-6 pb-16",children:[s.jsx("section",{className:"rounded-[28px] border border-pink-100/80 bg-white/90 p-8 shadow-sm backdrop-blur",children:s.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase tracking-[0.4em] text-pink-400",children:"Galeri kisah"}),s.jsx("h3",{className:"text-2xl font-semibold text-pink-900",children:"Susun momen indah kalian"}),s.jsx("p",{className:"text-sm text-pink-700/80",children:"Pilih foto yang paling mewakili cerita sebagai cover setiap momen."})]}),s.jsxs(r,{href:route("timeline.create",{space:B}),className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-pink-500 to-rose-500 px-6 py-2 text-sm font-semibold text-white shadow-md transition hover:shadow-lg",children:[s.jsx(d,{className:"h-4 w-4"}),"Tambah Momen"]})]})}),0===z.length?s.jsxs("div",{className:"rounded-[28px] border border-dashed border-pink-200 bg-white/85 py-16 text-center shadow-inner",children:[s.jsx("p",{className:"text-lg font-semibold text-pink-800",children:"Belum ada kenangan tersimpan."}),s.jsx("p",{className:"mt-2 text-sm text-pink-600",children:"Mulai tambahkan cerita pertamamu hari ini. ✨"})]}):s.jsx("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2",children:z.map(e=>{const t=e.media;return s.jsxs("article",{className:"group relative overflow-hidden rounded-[26px] border border-pink-100/80 bg-white/85 shadow-sm transition duration-300 hover:-translate-y-1 hover:shadow-xl",children:[s.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-br from-pink-50/70 via-transparent to-white"}),s.jsx("div",{className:"pointer-events-none absolute -left-6 top-8 h-24 w-24 rounded-full bg-pink-200/20 blur-3xl"}),s.jsxs("div",{className:"relative grid gap-6 px-8 pb-10 pt-10",children:[s.jsxs("div",{className:"relative mx-auto w-full max-w-sm",children:[s.jsx("div",{className:"absolute inset-2 rounded-[24px] border border-pink-100/70 bg-white shadow-md transition group-hover:shadow-lg"}),s.jsxs("div",{className:"relative overflow-hidden rounded-[24px] border border-pink-100/80 bg-white shadow-lg transition group-hover:shadow-2xl",children:[e.coverUrl?s.jsx("img",{src:e.coverUrl,alt:e.title,className:"h-64 w-full object-cover",onClick:()=>w(e)}):s.jsxs("div",{className:"flex h-64 w-full flex-col items-center justify-center gap-3 bg-pink-50 text-pink-400",children:[s.jsx(c,{className:"h-10 w-10"}),s.jsx("span",{className:"text-sm font-medium",children:"Belum ada foto"})]}),s.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 via-black/0 to-transparent px-4 py-3 text-white",children:[s.jsxs("div",{className:"flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.32em] text-white/70",children:[s.jsx(m,{className:"h-3 w-3 text-white/80"}),L(e.date)]}),s.jsx("h4",{className:"mt-1 text-lg font-semibold",children:e.title})]})]})]}),s.jsxs("div",{className:"rounded-[20px] border border-pink-100/80 bg-pink-50/60 p-5",children:[s.jsx("p",{className:"line-clamp-3 text-sm text-pink-800/90",children:e.description??"Belum ada cerita tertulis."}),t.length>0&&s.jsxs("div",{className:"mt-5 space-y-3",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.32em] text-pink-400",children:"Pilih Cover Foto"}),s.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.map(t=>{const a=t.path===e.coverPath,i=C===e.uuid;return s.jsxs("button",{type:"button",disabled:i,onClick:()=>H(e.uuid,t.path),className:`relative h-16 w-16 overflow-hidden rounded-xl border bg-white shadow transition focus:outline-none focus:ring-2 focus:ring-pink-400 ${a?"border-pink-500 ring-2 ring-pink-300":"border-transparent hover:-translate-y-1"} ${i?"cursor-not-allowed opacity-60":""}`,"aria-label":"Pilih thumbnail",children:[s.jsx("img",{src:t.url,alt:"thumbnail option",className:"h-full w-full object-cover"}),a&&s.jsx("span",{className:"absolute bottom-1 left-1 rounded-full bg-pink-500 px-2 text-[10px] font-semibold uppercase tracking-[0.18em] text-white",children:"aktif"})]},t.path)}),t.length>1&&e.coverPath&&s.jsx("button",{type:"button",disabled:C===e.uuid,onClick:()=>H(e.uuid,null),className:"inline-flex items-center justify-center rounded-xl border border-pink-200 bg-white px-3 text-xs font-semibold uppercase tracking-[0.24em] text-pink-500 transition hover:bg-pink-100 disabled:opacity-60",children:"Reset"}),C===e.uuid&&s.jsxs("div",{className:"inline-flex items-center gap-2 rounded-xl border border-pink-200 bg-white px-3 py-2 text-xs font-medium text-pink-500",children:[s.jsx(x,{className:"h-3.5 w-3.5 animate-spin"}),"Menyimpan..."]})]})]}),s.jsxs("div",{className:"mt-6 flex flex-wrap items-center justify-between gap-3 text-sm font-medium text-pink-700",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsxs(r,{href:route("timeline.edit",{space:B,timeline:e.uuid}),className:"inline-flex items-center gap-2 rounded-full border border-pink-200 px-4 py-1 transition hover:bg-pink-500 hover:text-white",children:[s.jsx(p,{className:"h-4 w-4"}),"Sunting"]}),s.jsxs("button",{type:"button",onClick:()=>T(e),className:"inline-flex items-center gap-2 rounded-full border border-rose-200 px-4 py-1 text-rose-500 transition hover:bg-rose-500 hover:text-white",children:[s.jsx(u,{className:"h-4 w-4"}),"Hapus"]})]}),t.length>0&&s.jsxs("button",{onClick:()=>w(e),className:"inline-flex items-center gap-2 rounded-full border border-pink-200 px-4 py-1 transition hover:bg-pink-500 hover:text-white",children:[s.jsx(h,{className:"h-4 w-4"}),"Detail"]})]})]})]})]},e.uuid)})})]}),v&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:()=>w(null),children:s.jsxs("div",{className:"relative max-h-[90vh] w-full max-w-3xl overflow-y-auto rounded-3xl bg-white p-8 shadow-2xl",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{type:"button",onClick:()=>w(null),className:"absolute right-4 top-4 rounded-full bg-black/50 p-1 text-white transition hover:bg-black",children:s.jsx(b,{className:"h-4 w-4"})}),s.jsxs("div",{className:"flex flex-col gap-8 md:flex-row",children:[s.jsxs("div",{className:"flex-1 space-y-4",children:[s.jsx("h3",{className:"text-2xl font-semibold text-pink-900",children:v.title}),s.jsxs("p",{className:"flex items-center gap-2 text-sm uppercase tracking-[0.32em] text-pink-400",children:[s.jsx(m,{className:"h-4 w-4"}),L(v.date)]}),s.jsx("p",{className:"whitespace-pre-line text-sm leading-relaxed text-pink-800/90",children:v.description??"Belum ada cerita tertulis."})]}),s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"grid grid-cols-2 gap-4",children:v.media_urls.map((e,t)=>s.jsx("button",{type:"button",onClick:()=>y(e),className:"overflow-hidden rounded-2xl border border-pink-100 shadow-sm transition hover:-translate-y-1 hover:shadow-lg",children:s.jsx("img",{src:e,alt:`media-${t}`,className:"h-32 w-full object-cover"})},`${v.uuid}-${t}`))})})]})]})}),N&&s.jsx("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/80 p-4",onClick:()=>y(null),children:s.jsx("img",{src:N,alt:"preview",className:"max-h-[90vh] max-w-[90vw] rounded-3xl object-contain shadow-2xl"})}),s.jsx(o,{open:null!==$,description:$?`Momen timeline "${$.title}" akan dihapus dan tidak bisa dikembalikan.`:"Momen akan dihapus dan tidak bisa dikembalikan.",confirmLabel:"Ya, hapus momen",cancelLabel:"Batal",tone:"danger",loading:M,title:$?`Hapus momen timeline "${$.title}"?`:"Hapus momen timeline?",onCancel:()=>{M||_(null)},onConfirm:U})]})}export{f as default};
