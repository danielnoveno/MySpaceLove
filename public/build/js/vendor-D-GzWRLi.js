var t,e,i,n,s,r,a,o,l,h,c,d,u,p,f,g,m,y,w,v,b,A,x,_,S,k,E,M,C,P,T,R,D,I,O,L,F,N,B,W,j,$,U,H,z,V,G,q,X,K,Y,Q,J,Z,tt,et,it,nt,st,rt,at,ot,lt,ht,ct,dt,ut,pt,ft,gt,mt,yt,wt,vt,bt,At,xt,_t,St,kt,Et,Mt,Ct,Pt,Tt,Rt,Dt,It,Ot,Lt,Ft,Nt,Bt,Wt,jt,$t,Ut,Ht,zt,Vt,Gt,qt,Xt,Kt,Yt,Qt,Jt,Zt,te,ee,ie,ne,se,re,ae,oe,le,he,ce,de,ue,pe,fe,ge,me,ye,we,ve,be,Ae,xe,_e,Se,ke,Ee,Me,Ce,Pe,Te,Re,De,Ie,Oe,Le,Fe,Ne,Be,We,je,$e,Ue,He,ze,Ve,Ge,qe,Xe,Ke,Ye,Qe,Je,Ze,ti,ei,ii,ni,si,ri,ai,oi,li,hi,ci,di,ui,pi,fi,gi,mi,yi,wi,vi,bi,Ai,xi,_i,Si,ki,Ei,Mi,Ci,Pi,Ti,Ri,Di,Ii,Oi,Li,Fi,Ni,Bi,Wi,ji,$i,Ui,Hi,zi,Vi,Gi,qi,Xi,Ki,Yi,Qi,Ji,Zi,tn,en,nn,sn,rn,an,on,ln,hn,cn,dn,un,pn,fn,gn,mn,yn,wn,vn,bn,An,xn,_n,Sn,kn,En,Mn,Cn,Pn,Tn,Rn,Dn,In,On,Ln,Fn,Nn,Bn,Wn,jn,$n,Un,Hn,zn,Vn,Gn,qn,Xn,Kn,Yn,Qn,Jn,Zn,ts,es,is,ns,ss,rs,as,os,ls,hs,cs,ds,us,ps,fs,gs,ms,ys,ws,vs,bs,As,xs,_s,Ss,ks,Es,Ms,Cs,Ps,Ts,Rs,Ds,Is,Os,Ls,Fs,Ns,Bs,Ws,js,$s,Us,Hs,zs,Vs,Gs,qs,Xs,Ks,Ys,Qs,Js,Zs,tr,er,ir,nr,sr,rr,ar,or,lr,hr,cr,dr,ur,pr,fr,gr,mr,yr,wr,vr,br,Ar,xr,_r,Sr,kr,Er,Mr,Cr,Pr,Tr,Rr,Dr,Ir,Or,Lr,Fr,Nr,Br,Wr,jr,$r,Ur,Hr,zr,Vr,Gr,qr,Xr,Kr,Yr,Qr,Jr,Zr,ta,ea,ia,na,sa,ra,aa,oa,la,ha,ca,da,ua,pa,fa,ga,ma,ya,wa,va,ba,Aa,xa,_a,Sa,ka,Ea,Ma,Ca,Pa,Ta,Ra,Da,Ia,Oa,La,Fa,Na,Ba,Wa,ja,$a,Ua,Ha,za,Va,Ga,qa,Xa,Ka,Ya,Qa,Ja,Za,to,eo,io,no,so,ro,ao,oo,lo,ho,co,uo,po,fo,go,mo,yo,wo,vo,bo,Ao,xo,_o,So,ko,Eo,Mo,Co,Po,To,Ro,Do,Io,Oo,Lo,Fo,No,Bo,Wo,jo,$o,Uo,Ho,zo,Vo,Go,qo,Xo,Ko,Yo,Qo,Jo,Zo,tl,el,il,nl,sl,rl,al,ol,ll,hl,cl,dl,ul,pl,fl,gl,ml,yl,wl,vl,bl,Al,xl,_l,Sl,kl,El,Ml,Cl,Pl,Tl,Rl,Dl,Il,Ol,Ll,Fl,Nl,Bl,Wl,jl,$l,Ul,Hl,zl,Vl,Gl,ql,Xl,Kl,Yl,Ql,Jl,Zl,th,eh,ih,nh,sh,rh,ah,oh,lh,hh,ch,dh,uh,ph,fh,gh,mh,yh,wh,vh,bh,Ah,xh,_h,Sh,kh,Eh,Mh,Ch,Ph,Th,Rh,Dh,Ih,Oh,Lh,Fh,Nh,Bh,Wh,jh,$h,Uh,Hh,zh,Vh,Gh,qh,Xh,Kh,Yh,Qh,Jh,Zh,tc,ec,ic,nc,sc,rc,ac,oc,lc,hc,cc,dc,uc,pc,fc,gc,mc,yc,wc,vc,bc,Ac,xc,_c,Sc,kc,Ec,Mc,Cc,Pc,Tc,Rc,Dc,Ic,Oc,Lc,Fc,Nc,Bc,Wc,jc,$c,Uc,Hc,zc,Vc,Gc,qc,Xc,Kc,Yc,Qc,Jc,Zc,td,ed,id,nd,sd,rd,ad,od,ld,hd,cd,dd,ud,pd,fd,gd,md,yd,wd,vd,bd,Ad,xd,_d,Sd,kd,Ed,Md,Cd,Pd,Td,Rd,Dd,Id,Od,Ld,Fd,Nd=Object.defineProperty,Bd=t=>{throw TypeError(t)},Wd=(t,e,i)=>((t,e,i)=>e in t?Nd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i)(t,"symbol"!=typeof e?e+"":e,i),jd=(t,e,i)=>e.has(t)||Bd("Cannot "+i),$d=(t,e,i)=>(jd(t,e,"read from private field"),i?i.call(t):e.get(t)),Ud=(t,e,i)=>e.has(t)?Bd("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,i),Hd=(t,e,i,n)=>(jd(t,e,"write to private field"),n?n.call(t,i):e.set(t,i),i),zd=(t,e,i)=>(jd(t,e,"access private method"),i),Vd=(t,e,i,n)=>({set _(n){Hd(t,e,n,i)},get _(){return $d(t,e,n)}});import{g as Gd,a as qd,c as Xd}from"./maps-CVSyMViq.js";import{r as Kd,b as Yd,R as Qd}from"./react-core-DkDn4djD.js";function Jd(t,e){return function(){return t.apply(e,arguments)}}const{toString:Zd}=Object.prototype,{getPrototypeOf:tu}=Object,{iterator:eu,toStringTag:iu}=Symbol,nu=(t=>e=>{const i=Zd.call(e);return t[i]||(t[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),su=t=>(t=t.toLowerCase(),e=>nu(e)===t),ru=t=>e=>typeof e===t,{isArray:au}=Array,ou=ru("undefined");function lu(t){return null!==t&&!ou(t)&&null!==t.constructor&&!ou(t.constructor)&&du(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const hu=su("ArrayBuffer"),cu=ru("string"),du=ru("function"),uu=ru("number"),pu=t=>null!==t&&"object"==typeof t,fu=t=>{if("object"!==nu(t))return!1;const e=tu(t);return!(null!==e&&e!==Object.prototype&&null!==Object.getPrototypeOf(e)||iu in t||eu in t)},gu=su("Date"),mu=su("File"),yu=su("Blob"),wu=su("FileList"),vu=su("URLSearchParams"),[bu,Au,xu,_u]=["ReadableStream","Request","Response","Headers"].map(su);function Su(t,e,{allOwnKeys:i=!1}={}){if(null==t)return;let n,s;if("object"!=typeof t&&(t=[t]),au(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{if(lu(t))return;const s=i?Object.getOwnPropertyNames(t):Object.keys(t),r=s.length;let a;for(n=0;n<r;n++)a=s[n],e.call(null,t[a],a,t)}}function ku(t,e){if(lu(t))return null;e=e.toLowerCase();const i=Object.keys(t);let n,s=i.length;for(;s-- >0;)if(n=i[s],e===n.toLowerCase())return n;return null}const Eu="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Mu=t=>!ou(t)&&t!==Eu,Cu=(t=>e=>t&&e instanceof t)("undefined"!=typeof Uint8Array&&tu(Uint8Array)),Pu=su("HTMLFormElement"),Tu=(({hasOwnProperty:t})=>(e,i)=>t.call(e,i))(Object.prototype),Ru=su("RegExp"),Du=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t),n={};Su(i,(i,s)=>{let r;!1!==(r=e(i,s,t))&&(n[s]=r||i)}),Object.defineProperties(t,n)},Iu=su("AsyncFunction"),Ou=(Lu="function"==typeof setImmediate,Fu=du(Eu.postMessage),Lu?setImmediate:Fu?(Nu=`axios@${Math.random()}`,Bu=[],Eu.addEventListener("message",({source:t,data:e})=>{t===Eu&&e===Nu&&Bu.length&&Bu.shift()()},!1),t=>{Bu.push(t),Eu.postMessage(Nu,"*")}):t=>setTimeout(t));var Lu,Fu,Nu,Bu;const Wu="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Eu):"undefined"!=typeof process&&process.nextTick||Ou,ju={isArray:au,isArrayBuffer:hu,isBuffer:lu,isFormData:t=>{let e;return t&&("function"==typeof FormData&&t instanceof FormData||du(t.append)&&("formdata"===(e=nu(t))||"object"===e&&du(t.toString)&&"[object FormData]"===t.toString()))},isArrayBufferView:function(t){let e;return e="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&hu(t.buffer),e},isString:cu,isNumber:uu,isBoolean:t=>!0===t||!1===t,isObject:pu,isPlainObject:fu,isEmptyObject:t=>{if(!pu(t)||lu(t))return!1;try{return 0===Object.keys(t).length&&Object.getPrototypeOf(t)===Object.prototype}catch(e){return!1}},isReadableStream:bu,isRequest:Au,isResponse:xu,isHeaders:_u,isUndefined:ou,isDate:gu,isFile:mu,isBlob:yu,isRegExp:Ru,isFunction:du,isStream:t=>pu(t)&&du(t.pipe),isURLSearchParams:vu,isTypedArray:Cu,isFileList:wu,forEach:Su,merge:function t(){const{caseless:e,skipUndefined:i}=Mu(this)&&this||{},n={},s=(s,r)=>{const a=e&&ku(n,r)||r;fu(n[a])&&fu(s)?n[a]=t(n[a],s):fu(s)?n[a]=t({},s):au(s)?n[a]=s.slice():i&&ou(s)||(n[a]=s)};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&Su(arguments[r],s);return n},extend:(t,e,i,{allOwnKeys:n}={})=>(Su(e,(e,n)=>{i&&du(e)?t[n]=Jd(e,i):t[n]=e},{allOwnKeys:n}),t),trim:t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:t=>(65279===t.charCodeAt(0)&&(t=t.slice(1)),t),inherits:(t,e,i,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),i&&Object.assign(t.prototype,i)},toFlatObject:(t,e,i,n)=>{let s,r,a;const o={};if(e=e||{},null==t)return e;do{for(s=Object.getOwnPropertyNames(t),r=s.length;r-- >0;)a=s[r],n&&!n(a,t,e)||o[a]||(e[a]=t[a],o[a]=!0);t=!1!==i&&tu(t)}while(t&&(!i||i(t,e))&&t!==Object.prototype);return e},kindOf:nu,kindOfTest:su,endsWith:(t,e,i)=>{t=String(t),(void 0===i||i>t.length)&&(i=t.length),i-=e.length;const n=t.indexOf(e,i);return-1!==n&&n===i},toArray:t=>{if(!t)return null;if(au(t))return t;let e=t.length;if(!uu(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=t[e];return i},forEachEntry:(t,e)=>{const i=(t&&t[eu]).call(t);let n;for(;(n=i.next())&&!n.done;){const i=n.value;e.call(t,i[0],i[1])}},matchAll:(t,e)=>{let i;const n=[];for(;null!==(i=t.exec(e));)n.push(i);return n},isHTMLForm:Pu,hasOwnProperty:Tu,hasOwnProp:Tu,reduceDescriptors:Du,freezeMethods:t=>{Du(t,(e,i)=>{if(du(t)&&-1!==["arguments","caller","callee"].indexOf(i))return!1;const n=t[i];du(n)&&(e.enumerable=!1,"writable"in e?e.writable=!1:e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")}))})},toObjectSet:(t,e)=>{const i={},n=t=>{t.forEach(t=>{i[t]=!0})};return au(t)?n(t):n(String(t).split(e)),i},toCamelCase:t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,e,i){return e.toUpperCase()+i}),noop:()=>{},toFiniteNumber:(t,e)=>null!=t&&Number.isFinite(t=+t)?t:e,findKey:ku,global:Eu,isContextDefined:Mu,isSpecCompliantForm:function(t){return!!(t&&du(t.append)&&"FormData"===t[iu]&&t[eu])},toJSONObject:t=>{const e=new Array(10),i=(t,n)=>{if(pu(t)){if(e.indexOf(t)>=0)return;if(lu(t))return t;if(!("toJSON"in t)){e[n]=t;const s=au(t)?[]:{};return Su(t,(t,e)=>{const r=i(t,n+1);!ou(r)&&(s[e]=r)}),e[n]=void 0,s}}return t};return i(t,0)},isAsyncFn:Iu,isThenable:t=>t&&(pu(t)||du(t))&&du(t.then)&&du(t.catch),setImmediate:Ou,asap:Wu,isIterable:t=>null!=t&&du(t[eu])};function $u(t,e,i,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=t,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}ju.inherits($u,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ju.toJSONObject(this.config),code:this.code,status:this.status}}});const Uu=$u.prototype,Hu={};function zu(t){return ju.isPlainObject(t)||ju.isArray(t)}function Vu(t){return ju.endsWith(t,"[]")?t.slice(0,-2):t}function Gu(t,e,i){return t?t.concat(e).map(function(t,e){return t=Vu(t),!i&&e?"["+t+"]":t}).join(i?".":""):e}["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Hu[t]={value:t}}),Object.defineProperties($u,Hu),Object.defineProperty(Uu,"isAxiosError",{value:!0}),$u.from=(t,e,i,n,s,r)=>{const a=Object.create(Uu);ju.toFlatObject(t,a,function(t){return t!==Error.prototype},t=>"isAxiosError"!==t);const o=t&&t.message?t.message:"Error",l=null==e&&t?t.code:e;return $u.call(a,o,l,i,n,s),t&&null==a.cause&&Object.defineProperty(a,"cause",{value:t,configurable:!0}),a.name=t&&t.name||"Error",r&&Object.assign(a,r),a};const qu=ju.toFlatObject(ju,{},null,function(t){return/^is[A-Z]/.test(t)});function Xu(t,e,i){if(!ju.isObject(t))throw new TypeError("target must be an object");e=e||new FormData;const n=(i=ju.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(t,e){return!ju.isUndefined(e[t])})).metaTokens,s=i.visitor||h,r=i.dots,a=i.indexes,o=(i.Blob||"undefined"!=typeof Blob&&Blob)&&ju.isSpecCompliantForm(e);if(!ju.isFunction(s))throw new TypeError("visitor must be a function");function l(t){if(null===t)return"";if(ju.isDate(t))return t.toISOString();if(ju.isBoolean(t))return t.toString();if(!o&&ju.isBlob(t))throw new $u("Blob is not supported. Use a Buffer instead.");return ju.isArrayBuffer(t)||ju.isTypedArray(t)?o&&"function"==typeof Blob?new Blob([t]):Buffer.from(t):t}function h(t,i,s){let o=t;if(t&&!s&&"object"==typeof t)if(ju.endsWith(i,"{}"))i=n?i:i.slice(0,-2),t=JSON.stringify(t);else if(ju.isArray(t)&&function(t){return ju.isArray(t)&&!t.some(zu)}(t)||(ju.isFileList(t)||ju.endsWith(i,"[]"))&&(o=ju.toArray(t)))return i=Vu(i),o.forEach(function(t,n){!ju.isUndefined(t)&&null!==t&&e.append(!0===a?Gu([i],n,r):null===a?i:i+"[]",l(t))}),!1;return!!zu(t)||(e.append(Gu(s,i,r),l(t)),!1)}const c=[],d=Object.assign(qu,{defaultVisitor:h,convertValue:l,isVisitable:zu});if(!ju.isObject(t))throw new TypeError("data must be an object");return function t(i,n){if(!ju.isUndefined(i)){if(-1!==c.indexOf(i))throw Error("Circular reference detected in "+n.join("."));c.push(i),ju.forEach(i,function(i,r){!0===(!(ju.isUndefined(i)||null===i)&&s.call(e,i,ju.isString(r)?r.trim():r,n,d))&&t(i,n?n.concat(r):[r])}),c.pop()}}(t),e}function Ku(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(t){return e[t]})}function Yu(t,e){this._pairs=[],t&&Xu(t,this,e)}const Qu=Yu.prototype;function Ju(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Zu(t,e,i){if(!e)return t;const n=i&&i.encode||Ju;ju.isFunction(i)&&(i={serialize:i});const s=i&&i.serialize;let r;if(r=s?s(e,i):ju.isURLSearchParams(e)?e.toString():new Yu(e,i).toString(n),r){const e=t.indexOf("#");-1!==e&&(t=t.slice(0,e)),t+=(-1===t.indexOf("?")?"?":"&")+r}return t}Qu.append=function(t,e){this._pairs.push([t,e])},Qu.toString=function(t){const e=t?function(e){return t.call(this,e,Ku)}:Ku;return this._pairs.map(function(t){return e(t[0])+"="+e(t[1])},"").join("&")};class tp{constructor(){this.handlers=[]}use(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ju.forEach(this.handlers,function(e){null!==e&&t(e)})}}const ep={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ip={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:Yu,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},np="undefined"!=typeof window&&"undefined"!=typeof document,sp="object"==typeof navigator&&navigator||void 0,rp=np&&(!sp||["ReactNative","NativeScript","NS"].indexOf(sp.product)<0),ap="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,op=np&&window.location.href||"http://localhost",lp={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:np,hasStandardBrowserEnv:rp,hasStandardBrowserWebWorkerEnv:ap,navigator:sp,origin:op},Symbol.toStringTag,{value:"Module"})),...ip};function hp(t){function e(t,i,n,s){let r=t[s++];if("__proto__"===r)return!0;const a=Number.isFinite(+r),o=s>=t.length;return r=!r&&ju.isArray(n)?n.length:r,o?(ju.hasOwnProp(n,r)?n[r]=[n[r],i]:n[r]=i,!a):(n[r]&&ju.isObject(n[r])||(n[r]=[]),e(t,i,n[r],s)&&ju.isArray(n[r])&&(n[r]=function(t){const e={},i=Object.keys(t);let n;const s=i.length;let r;for(n=0;n<s;n++)r=i[n],e[r]=t[r];return e}(n[r])),!a)}if(ju.isFormData(t)&&ju.isFunction(t.entries)){const i={};return ju.forEachEntry(t,(t,n)=>{e(function(t){return ju.matchAll(/\w+|\[(\w*)]/g,t).map(t=>"[]"===t[0]?"":t[1]||t[0])}(t),n,i,0)}),i}return null}const cp={transitional:ep,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const i=e.getContentType()||"",n=i.indexOf("application/json")>-1,s=ju.isObject(t);if(s&&ju.isHTMLForm(t)&&(t=new FormData(t)),ju.isFormData(t))return n?JSON.stringify(hp(t)):t;if(ju.isArrayBuffer(t)||ju.isBuffer(t)||ju.isStream(t)||ju.isFile(t)||ju.isBlob(t)||ju.isReadableStream(t))return t;if(ju.isArrayBufferView(t))return t.buffer;if(ju.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let r;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return function(t,e){return Xu(t,new lp.classes.URLSearchParams,{visitor:function(t,e,i,n){return lp.isNode&&ju.isBuffer(t)?(this.append(e,t.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)},...e})}(t,this.formSerializer).toString();if((r=ju.isFileList(t))||i.indexOf("multipart/form-data")>-1){const e=this.env&&this.env.FormData;return Xu(r?{"files[]":t}:t,e&&new e,this.formSerializer)}}return s||n?(e.setContentType("application/json",!1),function(t){if(ju.isString(t))try{return(0,JSON.parse)(t),ju.trim(t)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(t)}(t)):t}],transformResponse:[function(t){const e=this.transitional||cp.transitional,i=e&&e.forcedJSONParsing,n="json"===this.responseType;if(ju.isResponse(t)||ju.isReadableStream(t))return t;if(t&&ju.isString(t)&&(i&&!this.responseType||n)){const i=!(e&&e.silentJSONParsing)&&n;try{return JSON.parse(t,this.parseReviver)}catch(s){if(i){if("SyntaxError"===s.name)throw $u.from(s,$u.ERR_BAD_RESPONSE,this,null,this.response);throw s}}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:lp.classes.FormData,Blob:lp.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ju.forEach(["delete","get","head","post","put","patch"],t=>{cp.headers[t]={}});const dp=ju.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),up=Symbol("internals");function pp(t){return t&&String(t).trim().toLowerCase()}function fp(t){return!1===t||null==t?t:ju.isArray(t)?t.map(fp):String(t)}function gp(t,e,i,n,s){return ju.isFunction(n)?n.call(this,e,i):(s&&(e=i),ju.isString(e)?ju.isString(n)?-1!==e.indexOf(n):ju.isRegExp(n)?n.test(e):void 0:void 0)}let mp=class{constructor(t){t&&this.set(t)}set(t,e,i){const n=this;function s(t,e,i){const s=pp(e);if(!s)throw new Error("header name must be a non-empty string");const r=ju.findKey(n,s);(!r||void 0===n[r]||!0===i||void 0===i&&!1!==n[r])&&(n[r||e]=fp(t))}const r=(t,e)=>ju.forEach(t,(t,i)=>s(t,i,e));if(ju.isPlainObject(t)||t instanceof this.constructor)r(t,e);else if(ju.isString(t)&&(t=t.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim()))r((t=>{const e={};let i,n,s;return t&&t.split("\n").forEach(function(t){s=t.indexOf(":"),i=t.substring(0,s).trim().toLowerCase(),n=t.substring(s+1).trim(),!i||e[i]&&dp[i]||("set-cookie"===i?e[i]?e[i].push(n):e[i]=[n]:e[i]=e[i]?e[i]+", "+n:n)}),e})(t),e);else if(ju.isObject(t)&&ju.isIterable(t)){let i,n,s={};for(const e of t){if(!ju.isArray(e))throw TypeError("Object iterator must return a key-value pair");s[n=e[0]]=(i=s[n])?ju.isArray(i)?[...i,e[1]]:[i,e[1]]:e[1]}r(s,e)}else null!=t&&s(e,t,i);return this}get(t,e){if(t=pp(t)){const i=ju.findKey(this,t);if(i){const t=this[i];if(!e)return t;if(!0===e)return function(t){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=i.exec(t);)e[n[1]]=n[2];return e}(t);if(ju.isFunction(e))return e.call(this,t,i);if(ju.isRegExp(e))return e.exec(t);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=pp(t)){const i=ju.findKey(this,t);return!(!i||void 0===this[i]||e&&!gp(0,this[i],i,e))}return!1}delete(t,e){const i=this;let n=!1;function s(t){if(t=pp(t)){const s=ju.findKey(i,t);!s||e&&!gp(0,i[s],s,e)||(delete i[s],n=!0)}}return ju.isArray(t)?t.forEach(s):s(t),n}clear(t){const e=Object.keys(this);let i=e.length,n=!1;for(;i--;){const s=e[i];t&&!gp(0,this[s],s,t,!0)||(delete this[s],n=!0)}return n}normalize(t){const e=this,i={};return ju.forEach(this,(n,s)=>{const r=ju.findKey(i,s);if(r)return e[r]=fp(n),void delete e[s];const a=t?function(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,i)=>e.toUpperCase()+i)}(s):String(s).trim();a!==s&&delete e[s],e[a]=fp(n),i[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return ju.forEach(this,(i,n)=>{null!=i&&!1!==i&&(e[n]=t&&ju.isArray(i)?i.join(", "):i)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const i=new this(t);return e.forEach(t=>i.set(t)),i}static accessor(t){const e=(this[up]=this[up]={accessors:{}}).accessors,i=this.prototype;function n(t){const n=pp(t);e[n]||(function(t,e){const i=ju.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+i,{value:function(t,i,s){return this[n].call(this,e,t,i,s)},configurable:!0})})}(i,t),e[n]=!0)}return ju.isArray(t)?t.forEach(n):n(t),this}};function yp(t,e){const i=this||cp,n=e||i,s=mp.from(n.headers);let r=n.data;return ju.forEach(t,function(t){r=t.call(i,r,s.normalize(),e?e.status:void 0)}),s.normalize(),r}function wp(t){return!(!t||!t.__CANCEL__)}function vp(t,e,i){$u.call(this,null==t?"canceled":t,$u.ERR_CANCELED,e,i),this.name="CanceledError"}function bp(t,e,i){const n=i.config.validateStatus;i.status&&n&&!n(i.status)?e(new $u("Request failed with status code "+i.status,[$u.ERR_BAD_REQUEST,$u.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i)):t(i)}mp.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ju.reduceDescriptors(mp.prototype,({value:t},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(t){this[i]=t}}}),ju.freezeMethods(mp),ju.inherits(vp,$u,{__CANCEL__:!0});const Ap=(t,e,i=3)=>{let n=0;const s=function(t,e){t=t||10;const i=new Array(t),n=new Array(t);let s,r=0,a=0;return e=void 0!==e?e:1e3,function(o){const l=Date.now(),h=n[a];s||(s=l),i[r]=o,n[r]=l;let c=a,d=0;for(;c!==r;)d+=i[c++],c%=t;if(r=(r+1)%t,r===a&&(a=(a+1)%t),l-s<e)return;const u=h&&l-h;return u?Math.round(1e3*d/u):void 0}}(50,250);return function(i,r){let a,o,l=0,h=1e3/r;const c=(i,r=Date.now())=>{l=r,a=null,o&&(clearTimeout(o),o=null),(i=>{const r=i.loaded,a=i.lengthComputable?i.total:void 0,o=r-n,l=s(o);n=r,t({loaded:r,total:a,progress:a?r/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&r<=a?(a-r)/l:void 0,event:i,lengthComputable:null!=a,[e?"download":"upload"]:!0})})(...i)};return[(...t)=>{const e=Date.now(),i=e-l;i>=h?c(t,e):(a=t,o||(o=setTimeout(()=>{o=null,c(a)},h-i)))},()=>a&&c(a)]}(0,i)},xp=(t,e)=>{const i=null!=t;return[n=>e[0]({lengthComputable:i,total:t,loaded:n}),e[1]]},_p=t=>(...e)=>ju.asap(()=>t(...e)),Sp=lp.hasStandardBrowserEnv?((t,e)=>i=>(i=new URL(i,lp.origin),t.protocol===i.protocol&&t.host===i.host&&(e||t.port===i.port)))(new URL(lp.origin),lp.navigator&&/(msie|trident)/i.test(lp.navigator.userAgent)):()=>!0,kp=lp.hasStandardBrowserEnv?{write(t,e,i,n,s,r,a){if("undefined"==typeof document)return;const o=[`${t}=${encodeURIComponent(e)}`];ju.isNumber(i)&&o.push(`expires=${new Date(i).toUTCString()}`),ju.isString(n)&&o.push(`path=${n}`),ju.isString(s)&&o.push(`domain=${s}`),!0===r&&o.push("secure"),ju.isString(a)&&o.push(`SameSite=${a}`),document.cookie=o.join("; ")},read(t){if("undefined"==typeof document)return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function Ep(t,e,i){let n=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e);return t&&(n||0==i)?function(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}(t,e):e}const Mp=t=>t instanceof mp?{...t}:t;function Cp(t,e){e=e||{};const i={};function n(t,e,i,n){return ju.isPlainObject(t)&&ju.isPlainObject(e)?ju.merge.call({caseless:n},t,e):ju.isPlainObject(e)?ju.merge({},e):ju.isArray(e)?e.slice():e}function s(t,e,i,s){return ju.isUndefined(e)?ju.isUndefined(t)?void 0:n(void 0,t,0,s):n(t,e,0,s)}function r(t,e){if(!ju.isUndefined(e))return n(void 0,e)}function a(t,e){return ju.isUndefined(e)?ju.isUndefined(t)?void 0:n(void 0,t):n(void 0,e)}function o(i,s,r){return r in e?n(i,s):r in t?n(void 0,i):void 0}const l={url:r,method:r,data:r,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(t,e,i)=>s(Mp(t),Mp(e),0,!0)};return ju.forEach(Object.keys({...t,...e}),function(n){const r=l[n]||s,a=r(t[n],e[n],n);ju.isUndefined(a)&&r!==o||(i[n]=a)}),i}const Pp=t=>{const e=Cp({},t);let{data:i,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:r,headers:a,auth:o}=e;if(e.headers=a=mp.from(a),e.url=Zu(Ep(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),ju.isFormData(i))if(lp.hasStandardBrowserEnv||lp.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(ju.isFunction(i.getHeaders)){const t=i.getHeaders(),e=["content-type","content-length"];Object.entries(t).forEach(([t,i])=>{e.includes(t.toLowerCase())&&a.set(t,i)})}if(lp.hasStandardBrowserEnv&&(n&&ju.isFunction(n)&&(n=n(e)),n||!1!==n&&Sp(e.url))){const t=s&&r&&kp.read(r);t&&a.set(s,t)}return e},Tp="undefined"!=typeof XMLHttpRequest&&function(t){return new Promise(function(e,i){const n=Pp(t);let s=n.data;const r=mp.from(n.headers).normalize();let a,o,l,h,c,{responseType:d,onUploadProgress:u,onDownloadProgress:p}=n;function f(){h&&h(),c&&c(),n.cancelToken&&n.cancelToken.unsubscribe(a),n.signal&&n.signal.removeEventListener("abort",a)}let g=new XMLHttpRequest;function m(){if(!g)return;const n=mp.from("getAllResponseHeaders"in g&&g.getAllResponseHeaders());bp(function(t){e(t),f()},function(t){i(t),f()},{data:d&&"text"!==d&&"json"!==d?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:n,config:t,request:g}),g=null}g.open(n.method.toUpperCase(),n.url,!0),g.timeout=n.timeout,"onloadend"in g?g.onloadend=m:g.onreadystatechange=function(){g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))&&setTimeout(m)},g.onabort=function(){g&&(i(new $u("Request aborted",$u.ECONNABORTED,t,g)),g=null)},g.onerror=function(e){const n=new $u(e&&e.message?e.message:"Network Error",$u.ERR_NETWORK,t,g);n.event=e||null,i(n),g=null},g.ontimeout=function(){let e=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const s=n.transitional||ep;n.timeoutErrorMessage&&(e=n.timeoutErrorMessage),i(new $u(e,s.clarifyTimeoutError?$u.ETIMEDOUT:$u.ECONNABORTED,t,g)),g=null},void 0===s&&r.setContentType(null),"setRequestHeader"in g&&ju.forEach(r.toJSON(),function(t,e){g.setRequestHeader(e,t)}),ju.isUndefined(n.withCredentials)||(g.withCredentials=!!n.withCredentials),d&&"json"!==d&&(g.responseType=n.responseType),p&&([l,c]=Ap(p,!0),g.addEventListener("progress",l)),u&&g.upload&&([o,h]=Ap(u),g.upload.addEventListener("progress",o),g.upload.addEventListener("loadend",h)),(n.cancelToken||n.signal)&&(a=e=>{g&&(i(!e||e.type?new vp(null,t,g):e),g.abort(),g=null)},n.cancelToken&&n.cancelToken.subscribe(a),n.signal&&(n.signal.aborted?a():n.signal.addEventListener("abort",a)));const y=function(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}(n.url);y&&-1===lp.protocols.indexOf(y)?i(new $u("Unsupported protocol "+y+":",$u.ERR_BAD_REQUEST,t)):g.send(s||null)})},Rp=(t,e)=>{const{length:i}=t=t?t.filter(Boolean):[];if(e||i){let i,n=new AbortController;const s=function(t){if(!i){i=!0,a();const e=t instanceof Error?t:this.reason;n.abort(e instanceof $u?e:new vp(e instanceof Error?e.message:e))}};let r=e&&setTimeout(()=>{r=null,s(new $u(`timeout ${e} of ms exceeded`,$u.ETIMEDOUT))},e);const a=()=>{t&&(r&&clearTimeout(r),r=null,t.forEach(t=>{t.unsubscribe?t.unsubscribe(s):t.removeEventListener("abort",s)}),t=null)};t.forEach(t=>t.addEventListener("abort",s));const{signal:o}=n;return o.unsubscribe=()=>ju.asap(a),o}},Dp=function*(t,e){let i=t.byteLength;if(i<e)return void(yield t);let n,s=0;for(;s<i;)n=s+e,yield t.slice(s,n),s=n},Ip=(t,e,i,n)=>{const s=async function*(t,e){for await(const i of async function*(t){if(t[Symbol.asyncIterator])return void(yield*t);const e=t.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}}(t))yield*Dp(i,e)}(t,e);let r,a=0,o=t=>{r||(r=!0,n&&n(t))};return new ReadableStream({async pull(t){try{const{done:e,value:n}=await s.next();if(e)return o(),void t.close();let r=n.byteLength;if(i){let t=a+=r;i(t)}t.enqueue(new Uint8Array(n))}catch(e){throw o(e),e}},cancel:t=>(o(t),s.return())},{highWaterMark:2})},{isFunction:Op}=ju,Lp=(({Request:t,Response:e})=>({Request:t,Response:e}))(ju.global),{ReadableStream:Fp,TextEncoder:Np}=ju.global,Bp=(t,...e)=>{try{return!!t(...e)}catch(i){return!1}},Wp=t=>{t=ju.merge.call({skipUndefined:!0},Lp,t);const{fetch:e,Request:i,Response:n}=t,s=e?Op(e):"function"==typeof fetch,r=Op(i),a=Op(n);if(!s)return!1;const o=s&&Op(Fp),l=s&&("function"==typeof Np?(t=>e=>t.encode(e))(new Np):async t=>new Uint8Array(await new i(t).arrayBuffer())),h=r&&o&&Bp(()=>{let t=!1;const e=new i(lp.origin,{body:new Fp,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),c=a&&o&&Bp(()=>ju.isReadableStream(new n("").body)),d={stream:c&&(t=>t.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!d[t]&&(d[t]=(e,i)=>{let n=e&&e[t];if(n)return n.call(e);throw new $u(`Response type '${t}' is not supported`,$u.ERR_NOT_SUPPORT,i)})});return async t=>{let{url:s,method:a,data:o,signal:u,cancelToken:p,timeout:f,onDownloadProgress:g,onUploadProgress:m,responseType:y,headers:w,withCredentials:v="same-origin",fetchOptions:b}=Pp(t),A=e||fetch;y=y?(y+"").toLowerCase():"text";let x=Rp([u,p&&p.toAbortSignal()],f),_=null;const S=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let k;try{if(m&&h&&"get"!==a&&"head"!==a&&0!==(k=await(async(t,e)=>{const n=ju.toFiniteNumber(t.getContentLength());return null==n?(async t=>{if(null==t)return 0;if(ju.isBlob(t))return t.size;if(ju.isSpecCompliantForm(t)){const e=new i(lp.origin,{method:"POST",body:t});return(await e.arrayBuffer()).byteLength}return ju.isArrayBufferView(t)||ju.isArrayBuffer(t)?t.byteLength:(ju.isURLSearchParams(t)&&(t+=""),ju.isString(t)?(await l(t)).byteLength:void 0)})(e):n})(w,o))){let t,e=new i(s,{method:"POST",body:o,duplex:"half"});if(ju.isFormData(o)&&(t=e.headers.get("content-type"))&&w.setContentType(t),e.body){const[t,i]=xp(k,Ap(_p(m)));o=Ip(e.body,65536,t,i)}}ju.isString(v)||(v=v?"include":"omit");const e=r&&"credentials"in i.prototype,u={...b,signal:x,method:a.toUpperCase(),headers:w.normalize().toJSON(),body:o,duplex:"half",credentials:e?v:void 0};_=r&&new i(s,u);let p=await(r?A(_,b):A(s,u));const f=c&&("stream"===y||"response"===y);if(c&&(g||f&&S)){const t={};["status","statusText","headers"].forEach(e=>{t[e]=p[e]});const e=ju.toFiniteNumber(p.headers.get("content-length")),[i,s]=g&&xp(e,Ap(_p(g),!0))||[];p=new n(Ip(p.body,65536,i,()=>{s&&s(),S&&S()}),t)}y=y||"text";let E=await d[ju.findKey(d,y)||"text"](p,t);return!f&&S&&S(),await new Promise((e,i)=>{bp(e,i,{data:E,headers:mp.from(p.headers),status:p.status,statusText:p.statusText,config:t,request:_})})}catch(E){if(S&&S(),E&&"TypeError"===E.name&&/Load failed|fetch/i.test(E.message))throw Object.assign(new $u("Network Error",$u.ERR_NETWORK,t,_),{cause:E.cause||E});throw $u.from(E,E&&E.code,t,_)}}},jp=new Map,$p=t=>{let e=t&&t.env||{};const{fetch:i,Request:n,Response:s}=e,r=[n,s,i];let a,o,l=r.length,h=jp;for(;l--;)a=r[l],o=h.get(a),void 0===o&&h.set(a,o=l?new Map:Wp(e)),h=o;return o};$p();const Up={http:null,xhr:Tp,fetch:{get:$p}};ju.forEach(Up,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch(i){}Object.defineProperty(t,"adapterName",{value:e})}});const Hp=t=>`- ${t}`,zp=t=>ju.isFunction(t)||null===t||!1===t,Vp=function(t,e){t=ju.isArray(t)?t:[t];const{length:i}=t;let n,s;const r={};for(let a=0;a<i;a++){let i;if(n=t[a],s=n,!zp(n)&&(s=Up[(i=String(n)).toLowerCase()],void 0===s))throw new $u(`Unknown adapter '${i}'`);if(s&&(ju.isFunction(s)||(s=s.get(e))))break;r[i||"#"+a]=s}if(!s){const t=Object.entries(r).map(([t,e])=>`adapter ${t} `+(!1===e?"is not supported by the environment":"is not available in the build"));throw new $u("There is no suitable adapter to dispatch the request "+(i?t.length>1?"since :\n"+t.map(Hp).join("\n"):" "+Hp(t[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return s};function Gp(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new vp(null,t)}function qp(t){return Gp(t),t.headers=mp.from(t.headers),t.data=yp.call(t,t.transformRequest),-1!==["post","put","patch"].indexOf(t.method)&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Vp(t.adapter||cp.adapter,t)(t).then(function(e){return Gp(t),e.data=yp.call(t,t.transformResponse,e),e.headers=mp.from(e.headers),e},function(e){return wp(e)||(Gp(t),e&&e.response&&(e.response.data=yp.call(t,t.transformResponse,e.response),e.response.headers=mp.from(e.response.headers))),Promise.reject(e)})}const Xp="1.13.2",Kp={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Kp[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});const Yp={};Kp.transitional=function(t,e,i){return(n,s,r)=>{if(!1===t)throw new $u(function(t,e){return"[Axios v"+Xp+"] Transitional option '"+t+"'"+e+(i?". "+i:"")}(s," has been removed"+(e?" in "+e:"")),$u.ERR_DEPRECATED);return e&&!Yp[s]&&(Yp[s]=!0),!t||t(n,s,r)}},Kp.spelling=function(t){return(t,e)=>!0};const Qp={assertOptions:function(t,e,i){if("object"!=typeof t)throw new $u("options must be an object",$u.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const r=n[s],a=e[r];if(a){const e=t[r],i=void 0===e||a(e,r,t);if(!0!==i)throw new $u("option "+r+" must be "+i,$u.ERR_BAD_OPTION_VALUE);continue}if(!0!==i)throw new $u("Unknown option "+r,$u.ERR_BAD_OPTION)}},validators:Kp},Jp=Qp.validators;let Zp=class{constructor(t){this.defaults=t||{},this.interceptors={request:new tp,response:new tp}}async request(t,e){try{return await this._request(t,e)}catch(i){if(i instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const e=t.stack?t.stack.replace(/^.+\n/,""):"";try{i.stack?e&&!String(i.stack).endsWith(e.replace(/^.+\n.+\n/,""))&&(i.stack+="\n"+e):i.stack=e}catch(n){}}throw i}}_request(t,e){"string"==typeof t?(e=e||{}).url=t:e=t||{},e=Cp(this.defaults,e);const{transitional:i,paramsSerializer:n,headers:s}=e;void 0!==i&&Qp.assertOptions(i,{silentJSONParsing:Jp.transitional(Jp.boolean),forcedJSONParsing:Jp.transitional(Jp.boolean),clarifyTimeoutError:Jp.transitional(Jp.boolean)},!1),null!=n&&(ju.isFunction(n)?e.paramsSerializer={serialize:n}:Qp.assertOptions(n,{encode:Jp.function,serialize:Jp.function},!0)),void 0!==e.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Qp.assertOptions(e,{baseUrl:Jp.spelling("baseURL"),withXsrfToken:Jp.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let r=s&&ju.merge(s.common,s[e.method]);s&&ju.forEach(["delete","get","head","post","put","patch","common"],t=>{delete s[t]}),e.headers=mp.concat(r,s);const a=[];let o=!0;this.interceptors.request.forEach(function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,a.unshift(t.fulfilled,t.rejected))});const l=[];let h;this.interceptors.response.forEach(function(t){l.push(t.fulfilled,t.rejected)});let c,d=0;if(!o){const t=[qp.bind(this),void 0];for(t.unshift(...a),t.push(...l),c=t.length,h=Promise.resolve(e);d<c;)h=h.then(t[d++],t[d++]);return h}c=a.length;let u=e;for(;d<c;){const t=a[d++],e=a[d++];try{u=t(u)}catch(p){e.call(this,p);break}}try{h=qp.call(this,u)}catch(p){return Promise.reject(p)}for(d=0,c=l.length;d<c;)h=h.then(l[d++],l[d++]);return h}getUri(t){return Zu(Ep((t=Cp(this.defaults,t)).baseURL,t.url,t.allowAbsoluteUrls),t.params,t.paramsSerializer)}};ju.forEach(["delete","get","head","options"],function(t){Zp.prototype[t]=function(e,i){return this.request(Cp(i||{},{method:t,url:e,data:(i||{}).data}))}}),ju.forEach(["post","put","patch"],function(t){function e(e){return function(i,n,s){return this.request(Cp(s||{},{method:t,headers:e?{"Content-Type":"multipart/form-data"}:{},url:i,data:n}))}}Zp.prototype[t]=e(),Zp.prototype[t+"Form"]=e(!0)});const tf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(tf).forEach(([t,e])=>{tf[e]=t});const ef=function t(e){const i=new Zp(e),n=Jd(Zp.prototype.request,i);return ju.extend(n,Zp.prototype,i,{allOwnKeys:!0}),ju.extend(n,i,null,{allOwnKeys:!0}),n.create=function(i){return t(Cp(e,i))},n}(cp);ef.Axios=Zp,ef.CanceledError=vp,ef.CancelToken=class t{constructor(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(t){e=t});const i=this;this.promise.then(t=>{if(!i._listeners)return;let e=i._listeners.length;for(;e-- >0;)i._listeners[e](t);i._listeners=null}),this.promise.then=t=>{let e;const n=new Promise(t=>{i.subscribe(t),e=t}).then(t);return n.cancel=function(){i.unsubscribe(e)},n},t(function(t,n,s){i.reason||(i.reason=new vp(t,n,s),e(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){this.reason?t(this.reason):this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);-1!==e&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=e=>{t.abort(e)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let e;return{token:new t(function(t){e=t}),cancel:e}}},ef.isCancel=wp,ef.VERSION=Xp,ef.toFormData=Xu,ef.AxiosError=$u,ef.Cancel=ef.CanceledError,ef.all=function(t){return Promise.all(t)},ef.spread=function(t){return function(e){return t.apply(null,e)}},ef.isAxiosError=function(t){return ju.isObject(t)&&!0===t.isAxiosError},ef.mergeConfig=Cp,ef.AxiosHeaders=mp,ef.formToJSON=t=>hp(ju.isHTMLForm(t)?new FormData(t):t),ef.getAdapter=Vp,ef.HttpStatusCode=tf,ef.default=ef;const{Axios:nf,AxiosError:sf,CanceledError:rf,isCancel:af,CancelToken:of,VERSION:lf,all:hf,Cancel:cf,isAxiosError:df,spread:uf,toFormData:pf,AxiosHeaders:ff,HttpStatusCode:gf,formToJSON:mf,getAdapter:yf,mergeConfig:wf}=ef;var vf=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===bf}(t)}(t)},bf="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function Af(t,e){return!1!==e.clone&&e.isMergeableObject(t)?kf((i=t,Array.isArray(i)?[]:{}),t,e):t;var i}function xf(t,e,i){return t.concat(e).map(function(t){return Af(t,i)})}function _f(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}(t))}function Sf(t,e){try{return e in t}catch(i){return!1}}function kf(t,e,i){(i=i||{}).arrayMerge=i.arrayMerge||xf,i.isMergeableObject=i.isMergeableObject||vf,i.cloneUnlessOtherwiseSpecified=Af;var n=Array.isArray(e);return n===Array.isArray(t)?n?i.arrayMerge(t,e,i):function(t,e,i){var n={};return i.isMergeableObject(t)&&_f(t).forEach(function(e){n[e]=Af(t[e],i)}),_f(e).forEach(function(s){(function(t,e){return Sf(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,s)||(Sf(t,s)&&i.isMergeableObject(e[s])?n[s]=function(t,e){if(!e.customMerge)return kf;var i=e.customMerge(t);return"function"==typeof i?i:kf}(s,i)(t[s],e[s],i):n[s]=Af(e[s],i))}),n}(t,e,i):Af(e,i)}kf.all=function(t,e){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(t,i){return kf(t,i,e)},{})};const Ef=Gd(kf);var Mf=TypeError;const Cf=qd(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var Pf="function"==typeof Map&&Map.prototype,Tf=Object.getOwnPropertyDescriptor&&Pf?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Rf=Pf&&Tf&&"function"==typeof Tf.get?Tf.get:null,Df=Pf&&Map.prototype.forEach,If="function"==typeof Set&&Set.prototype,Of=Object.getOwnPropertyDescriptor&&If?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Lf=If&&Of&&"function"==typeof Of.get?Of.get:null,Ff=If&&Set.prototype.forEach,Nf="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,Bf="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,Wf="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,jf=Boolean.prototype.valueOf,$f=Object.prototype.toString,Uf=Function.prototype.toString,Hf=String.prototype.match,zf=String.prototype.slice,Vf=String.prototype.replace,Gf=String.prototype.toUpperCase,qf=String.prototype.toLowerCase,Xf=RegExp.prototype.test,Kf=Array.prototype.concat,Yf=Array.prototype.join,Qf=Array.prototype.slice,Jf=Math.floor,Zf="function"==typeof BigInt?BigInt.prototype.valueOf:null,tg=Object.getOwnPropertySymbols,eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,ig="function"==typeof Symbol&&"object"==typeof Symbol.iterator,ng="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,sg=Object.prototype.propertyIsEnumerable,rg=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function ag(t,e){if(t===1/0||t===-1/0||t!=t||t&&t>-1e3&&t<1e3||Xf.call(/e/,e))return e;var i=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof t){var n=t<0?-Jf(-t):Jf(t);if(n!==t){var s=String(n),r=zf.call(e,s.length+1);return Vf.call(s,i,"$&_")+"."+Vf.call(Vf.call(r,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Vf.call(e,i,"$&_")}var og=Cf,lg=og.custom,hg=wg(lg)?lg:null,cg={__proto__:null,double:'"',single:"'"},dg={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},ug=function t(e,i,n,s){var r=i||{};if(bg(r,"quoteStyle")&&!bg(cg,r.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(bg(r,"maxStringLength")&&("number"==typeof r.maxStringLength?r.maxStringLength<0&&r.maxStringLength!==1/0:null!==r.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=!bg(r,"customInspect")||r.customInspect;if("boolean"!=typeof a&&"symbol"!==a)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(bg(r,"indent")&&null!==r.indent&&"\t"!==r.indent&&!(parseInt(r.indent,10)===r.indent&&r.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(bg(r,"numericSeparator")&&"boolean"!=typeof r.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=r.numericSeparator;if(void 0===e)return"undefined";if(null===e)return"null";if("boolean"==typeof e)return e?"true":"false";if("string"==typeof e)return _g(e,r);if("number"==typeof e){if(0===e)return 1/0/e>0?"0":"-0";var l=String(e);return o?ag(e,l):l}if("bigint"==typeof e){var h=String(e)+"n";return o?ag(e,h):h}var c=void 0===r.depth?5:r.depth;if(void 0===n&&(n=0),n>=c&&c>0&&"object"==typeof e)return mg(e)?"[Array]":"[Object]";var d=function(t,e){var i;if("\t"===t.indent)i="\t";else{if(!("number"==typeof t.indent&&t.indent>0))return null;i=Yf.call(Array(t.indent+1)," ")}return{base:i,prev:Yf.call(Array(e+1),i)}}(r,n);if(void 0===s)s=[];else if(xg(s,e)>=0)return"[Circular]";function u(e,i,a){if(i&&(s=Qf.call(s)).push(i),a){var o={depth:r.depth};return bg(r,"quoteStyle")&&(o.quoteStyle=r.quoteStyle),t(e,o,n+1,s)}return t(e,r,n+1,s)}if("function"==typeof e&&!yg(e)){var p=function(t){if(t.name)return t.name;var e=Hf.call(Uf.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}(e),f=Pg(e,u);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(f.length>0?" { "+Yf.call(f,", ")+" }":"")}if(wg(e)){var g=ig?Vf.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):eg.call(e);return"object"!=typeof e||ig?g:kg(g)}if(function(t){return!(!t||"object"!=typeof t)&&("undefined"!=typeof HTMLElement&&t instanceof HTMLElement||"string"==typeof t.nodeName&&"function"==typeof t.getAttribute)}(e)){for(var m="<"+qf.call(String(e.nodeName)),y=e.attributes||[],w=0;w<y.length;w++)m+=" "+y[w].name+"="+pg(fg(y[w].value),"double",r);return m+=">",e.childNodes&&e.childNodes.length&&(m+="..."),m+"</"+qf.call(String(e.nodeName))+">"}if(mg(e)){if(0===e.length)return"[]";var v=Pg(e,u);return d&&!function(t){for(var e=0;e<t.length;e++)if(xg(t[e],"\n")>=0)return!1;return!0}(v)?"["+Cg(v,d)+"]":"[ "+Yf.call(v,", ")+" ]"}if(function(t){return"[object Error]"===Ag(t)&&gg(t)}(e)){var b=Pg(e,u);return"cause"in Error.prototype||!("cause"in e)||sg.call(e,"cause")?0===b.length?"["+String(e)+"]":"{ ["+String(e)+"] "+Yf.call(b,", ")+" }":"{ ["+String(e)+"] "+Yf.call(Kf.call("[cause]: "+u(e.cause),b),", ")+" }"}if("object"==typeof e&&a){if(hg&&"function"==typeof e[hg]&&og)return og(e,{depth:c-n});if("symbol"!==a&&"function"==typeof e.inspect)return e.inspect()}if(function(t){if(!Rf||!t||"object"!=typeof t)return!1;try{Rf.call(t);try{Lf.call(t)}catch(m){return!0}return t instanceof Map}catch(e){}return!1}(e)){var A=[];return Df&&Df.call(e,function(t,i){A.push(u(i,e,!0)+" => "+u(t,e))}),Mg("Map",Rf.call(e),A,d)}if(function(t){if(!Lf||!t||"object"!=typeof t)return!1;try{Lf.call(t);try{Rf.call(t)}catch(e){return!0}return t instanceof Set}catch(i){}return!1}(e)){var x=[];return Ff&&Ff.call(e,function(t){x.push(u(t,e))}),Mg("Set",Lf.call(e),x,d)}if(function(t){if(!Nf||!t||"object"!=typeof t)return!1;try{Nf.call(t,Nf);try{Bf.call(t,Bf)}catch(m){return!0}return t instanceof WeakMap}catch(e){}return!1}(e))return Eg("WeakMap");if(function(t){if(!Bf||!t||"object"!=typeof t)return!1;try{Bf.call(t,Bf);try{Nf.call(t,Nf)}catch(m){return!0}return t instanceof WeakSet}catch(e){}return!1}(e))return Eg("WeakSet");if(function(t){if(!Wf||!t||"object"!=typeof t)return!1;try{return Wf.call(t),!0}catch(e){}return!1}(e))return Eg("WeakRef");if(function(t){return"[object Number]"===Ag(t)&&gg(t)}(e))return kg(u(Number(e)));if(function(t){if(!t||"object"!=typeof t||!Zf)return!1;try{return Zf.call(t),!0}catch(e){}return!1}(e))return kg(u(Zf.call(e)));if(function(t){return"[object Boolean]"===Ag(t)&&gg(t)}(e))return kg(jf.call(e));if(function(t){return"[object String]"===Ag(t)&&gg(t)}(e))return kg(u(String(e)));if("undefined"!=typeof window&&e===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&e===globalThis||void 0!==Xd&&e===Xd)return"{ [object globalThis] }";if(!function(t){return"[object Date]"===Ag(t)&&gg(t)}(e)&&!yg(e)){var _=Pg(e,u),S=rg?rg(e)===Object.prototype:e instanceof Object||e.constructor===Object,k=e instanceof Object?"":"null prototype",E=!S&&ng&&Object(e)===e&&ng in e?zf.call(Ag(e),8,-1):k?"Object":"",M=(S||"function"!=typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(E||k?"["+Yf.call(Kf.call([],E||[],k||[]),": ")+"] ":"");return 0===_.length?M+"{}":d?M+"{"+Cg(_,d)+"}":M+"{ "+Yf.call(_,", ")+" }"}return String(e)};function pg(t,e,i){var n=i.quoteStyle||e,s=cg[n];return s+t+s}function fg(t){return Vf.call(String(t),/"/g,"&quot;")}function gg(t){return!ng||!("object"==typeof t&&(ng in t||void 0!==t[ng]))}function mg(t){return"[object Array]"===Ag(t)&&gg(t)}function yg(t){return"[object RegExp]"===Ag(t)&&gg(t)}function wg(t){if(ig)return t&&"object"==typeof t&&t instanceof Symbol;if("symbol"==typeof t)return!0;if(!t||"object"!=typeof t||!eg)return!1;try{return eg.call(t),!0}catch(e){}return!1}var vg=Object.prototype.hasOwnProperty||function(t){return t in this};function bg(t,e){return vg.call(t,e)}function Ag(t){return $f.call(t)}function xg(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}function _g(t,e){if(t.length>e.maxStringLength){var i=t.length-e.maxStringLength,n="... "+i+" more character"+(i>1?"s":"");return _g(zf.call(t,0,e.maxStringLength),e)+n}var s=dg[e.quoteStyle||"single"];return s.lastIndex=0,pg(Vf.call(Vf.call(t,s,"\\$1"),/[\x00-\x1f]/g,Sg),"single",e)}function Sg(t){var e=t.charCodeAt(0),i={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return i?"\\"+i:"\\x"+(e<16?"0":"")+Gf.call(e.toString(16))}function kg(t){return"Object("+t+")"}function Eg(t){return t+" { ? }"}function Mg(t,e,i,n){return t+" ("+e+") {"+(n?Cg(i,n):Yf.call(i,", "))+"}"}function Cg(t,e){if(0===t.length)return"";var i="\n"+e.prev+e.base;return i+Yf.call(t,","+i)+"\n"+e.prev}function Pg(t,e){var i=mg(t),n=[];if(i){n.length=t.length;for(var s=0;s<t.length;s++)n[s]=bg(t,s)?e(t[s],t):""}var r,a="function"==typeof tg?tg(t):[];if(ig){r={};for(var o=0;o<a.length;o++)r["$"+a[o]]=a[o]}for(var l in t)bg(t,l)&&(i&&String(Number(l))===l&&l<t.length||ig&&r["$"+l]instanceof Symbol||(Xf.call(/[^\w$]/,l)?n.push(e(l,t)+": "+e(t[l],t)):n.push(l+": "+e(t[l],t))));if("function"==typeof tg)for(var h=0;h<a.length;h++)sg.call(t,a[h])&&n.push("["+e(a[h])+"]: "+e(t[a[h]],t));return n}var Tg=ug,Rg=Mf,Dg=function(t,e,i){for(var n,s=t;null!=(n=s.next);s=n)if(n.key===e)return s.next=n.next,i||(n.next=t.next,t.next=n),n},Ig=Object,Og=Error,Lg=EvalError,Fg=RangeError,Ng=ReferenceError,Bg=SyntaxError,Wg=URIError,jg=Math.abs,$g=Math.floor,Ug=Math.max,Hg=Math.min,zg=Math.pow,Vg=Math.round,Gg=Number.isNaN||function(t){return t!=t},qg=Object.getOwnPropertyDescriptor;if(qg)try{qg([],"length")}catch(XO){qg=null}var Xg=qg,Kg=Object.defineProperty||!1;if(Kg)try{Kg({},"a",{value:1})}catch(XO){Kg=!1}var Yg,Qg,Jg,Zg,tm,em,im,nm,sm=Kg;function rm(){return em?tm:(em=1,tm="undefined"!=typeof Reflect&&Reflect.getPrototypeOf||null)}function am(){return nm?im:(nm=1,im=Ig.getPrototypeOf||null)}var om,lm,hm=Object.prototype.toString,cm=Math.max,dm=function(t,e){for(var i=[],n=0;n<t.length;n+=1)i[n]=t[n];for(var s=0;s<e.length;s+=1)i[s+t.length]=e[s];return i},um=Function.prototype.bind||function(t){var e=this;if("function"!=typeof e||"[object Function]"!==hm.apply(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var i,n=function(t){for(var e=[],i=1,n=0;i<t.length;i+=1,n+=1)e[n]=t[i];return e}(arguments),s=cm(0,e.length-n.length),r=[],a=0;a<s;a++)r[a]="$"+a;if(i=Function("binder","return function ("+function(t){for(var e="",i=0;i<t.length;i+=1)e+=t[i],i+1<t.length&&(e+=",");return e}(r)+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof i){var s=e.apply(this,dm(n,arguments));return Object(s)===s?s:this}return e.apply(t,dm(n,arguments))}),e.prototype){var o=function(){};o.prototype=e.prototype,i.prototype=new o,o.prototype=null}return i},pm=Function.prototype.call;function fm(){return lm?om:(lm=1,om=Function.prototype.apply)}var gm,mm,ym,wm,vm,bm,Am,xm="undefined"!=typeof Reflect&&Reflect&&Reflect.apply,_m=um,Sm=fm(),km=pm,Em=xm||_m.call(km,Sm),Mm=um,Cm=Mf,Pm=pm,Tm=Em,Rm=function(t){if(t.length<1||"function"!=typeof t[0])throw new Cm("a function is required");return Tm(Mm,Pm,t)},Dm=Ig,Im=Og,Om=Lg,Lm=Fg,Fm=Ng,Nm=Bg,Bm=Mf,Wm=Wg,jm=jg,$m=$g,Um=Ug,Hm=Hg,zm=zg,Vm=Vg,Gm=Function,qm=function(t){try{return Gm('"use strict"; return ('+t+").constructor;")()}catch(XO){}},Xm=Xg,Km=sm,Ym=function(){throw new Bm},Qm=Xm?function(){try{return Ym}catch(t){try{return Xm(arguments,"callee").get}catch(e){return Ym}}}():Ym,Jm=function(){if(Zg)return Jg;Zg=1;var t="undefined"!=typeof Symbol&&Symbol,e=Qg?Yg:(Qg=1,Yg=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),i=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(i))return!1;for(var n in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var s=Object.getOwnPropertySymbols(t);if(1!==s.length||s[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0});return Jg=function(){return"function"==typeof t&&"function"==typeof Symbol&&"symbol"==typeof t("foo")&&"symbol"==typeof Symbol("bar")&&e()}}()(),Zm=function(){if(wm)return ym;wm=1;var t=rm(),e=am(),i=function(){if(mm)return gm;mm=1;var t,e=Rm,i=Xg;try{t=[].__proto__===Array.prototype}catch(XO){if(!XO||"object"!=typeof XO||!("code"in XO)||"ERR_PROTO_ACCESS"!==XO.code)throw XO}var n=!!t&&i&&i(Object.prototype,"__proto__"),s=Object,r=s.getPrototypeOf;return gm=n&&"function"==typeof n.get?e([n.get]):"function"==typeof r&&function(t){return r(null==t?t:s(t))}}();return ym=t?function(e){return t(e)}:e?function(t){if(!t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("getProto: not an object");return e(t)}:i?function(t){return i(t)}:null}(),ty=am(),ey=rm(),iy=fm(),ny=pm,sy={},ry="undefined"!=typeof Uint8Array&&Zm?Zm(Uint8Array):Am,ay={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?Am:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?Am:ArrayBuffer,"%ArrayIteratorPrototype%":Jm&&Zm?Zm([][Symbol.iterator]()):Am,"%AsyncFromSyncIteratorPrototype%":Am,"%AsyncFunction%":sy,"%AsyncGenerator%":sy,"%AsyncGeneratorFunction%":sy,"%AsyncIteratorPrototype%":sy,"%Atomics%":"undefined"==typeof Atomics?Am:Atomics,"%BigInt%":"undefined"==typeof BigInt?Am:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?Am:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?Am:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?Am:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Im,"%eval%":eval,"%EvalError%":Om,"%Float16Array%":"undefined"==typeof Float16Array?Am:Float16Array,"%Float32Array%":"undefined"==typeof Float32Array?Am:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?Am:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?Am:FinalizationRegistry,"%Function%":Gm,"%GeneratorFunction%":sy,"%Int8Array%":"undefined"==typeof Int8Array?Am:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?Am:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?Am:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Jm&&Zm?Zm(Zm([][Symbol.iterator]())):Am,"%JSON%":"object"==typeof JSON?JSON:Am,"%Map%":"undefined"==typeof Map?Am:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&Jm&&Zm?Zm((new Map)[Symbol.iterator]()):Am,"%Math%":Math,"%Number%":Number,"%Object%":Dm,"%Object.getOwnPropertyDescriptor%":Xm,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?Am:Promise,"%Proxy%":"undefined"==typeof Proxy?Am:Proxy,"%RangeError%":Lm,"%ReferenceError%":Fm,"%Reflect%":"undefined"==typeof Reflect?Am:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?Am:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&Jm&&Zm?Zm((new Set)[Symbol.iterator]()):Am,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?Am:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Jm&&Zm?Zm(""[Symbol.iterator]()):Am,"%Symbol%":Jm?Symbol:Am,"%SyntaxError%":Nm,"%ThrowTypeError%":Qm,"%TypedArray%":ry,"%TypeError%":Bm,"%Uint8Array%":"undefined"==typeof Uint8Array?Am:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?Am:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?Am:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?Am:Uint32Array,"%URIError%":Wm,"%WeakMap%":"undefined"==typeof WeakMap?Am:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?Am:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?Am:WeakSet,"%Function.prototype.call%":ny,"%Function.prototype.apply%":iy,"%Object.defineProperty%":Km,"%Object.getPrototypeOf%":ty,"%Math.abs%":jm,"%Math.floor%":$m,"%Math.max%":Um,"%Math.min%":Hm,"%Math.pow%":zm,"%Math.round%":Vm,"%Math.sign%":function(t){return Gg(t)||0===t?t:t<0?-1:1},"%Reflect.getPrototypeOf%":ey};if(Zm)try{null.error}catch(XO){var oy=Zm(Zm(XO));ay["%Error.prototype%"]=oy}var ly=function t(e){var i;if("%AsyncFunction%"===e)i=qm("async function () {}");else if("%GeneratorFunction%"===e)i=qm("function* () {}");else if("%AsyncGeneratorFunction%"===e)i=qm("async function* () {}");else if("%AsyncGenerator%"===e){var n=t("%AsyncGeneratorFunction%");n&&(i=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var s=t("%AsyncGenerator%");s&&Zm&&(i=Zm(s.prototype))}return ay[e]=i,i},hy={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},cy=um,dy=function(){if(bm)return vm;bm=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty;return vm=um.call(t,e)}(),uy=cy.call(ny,Array.prototype.concat),py=cy.call(iy,Array.prototype.splice),fy=cy.call(ny,String.prototype.replace),gy=cy.call(ny,String.prototype.slice),my=cy.call(ny,RegExp.prototype.exec),yy=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,wy=/\\(\\)?/g,vy=function(t,e){var i,n=t;if(dy(hy,n)&&(n="%"+(i=hy[n])[0]+"%"),dy(ay,n)){var s=ay[n];if(s===sy&&(s=ly(n)),void 0===s&&!e)throw new Bm("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:s}}throw new Nm("intrinsic "+t+" does not exist!")},by=function(t,e){if("string"!=typeof t||0===t.length)throw new Bm("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new Bm('"allowMissing" argument must be a boolean');if(null===my(/^%?[^%]*%?$/,t))throw new Nm("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=function(t){var e=gy(t,0,1),i=gy(t,-1);if("%"===e&&"%"!==i)throw new Nm("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==e)throw new Nm("invalid intrinsic syntax, expected opening `%`");var n=[];return fy(t,yy,function(t,e,i,s){n[n.length]=i?fy(s,wy,"$1"):e||t}),n}(t),n=i.length>0?i[0]:"",s=vy("%"+n+"%",e),r=s.name,a=s.value,o=!1,l=s.alias;l&&(n=l[0],py(i,uy([0,1],l)));for(var h=1,c=!0;h<i.length;h+=1){var d=i[h],u=gy(d,0,1),p=gy(d,-1);if(('"'===u||"'"===u||"`"===u||'"'===p||"'"===p||"`"===p)&&u!==p)throw new Nm("property names with quotes must have matching quotes");if("constructor"!==d&&c||(o=!0),dy(ay,r="%"+(n+="."+d)+"%"))a=ay[r];else if(null!=a){if(!(d in a)){if(!e)throw new Bm("base intrinsic for "+t+" exists, but the property is not available.");return}if(Xm&&h+1>=i.length){var f=Xm(a,d);a=(c=!!f)&&"get"in f&&!("originalValue"in f.get)?f.get:a[d]}else c=dy(a,d),a=a[d];c&&!o&&(ay[r]=a)}}return a},Ay=by,xy=Rm,_y=xy([Ay("%String.prototype.indexOf%")]),Sy=function(t,e){var i=Ay(t,!!e);return"function"==typeof i&&_y(t,".prototype.")>-1?xy([i]):i},ky=Sy,Ey=ug,My=Mf,Cy=by("%Map%",!0),Py=ky("Map.prototype.get",!0),Ty=ky("Map.prototype.set",!0),Ry=ky("Map.prototype.has",!0),Dy=ky("Map.prototype.delete",!0),Iy=ky("Map.prototype.size",!0),Oy=!!Cy&&function(){var t,e={assert:function(t){if(!e.has(t))throw new My("Side channel does not contain "+Ey(t))},delete:function(e){if(t){var i=Dy(t,e);return 0===Iy(t)&&(t=void 0),i}return!1},get:function(e){if(t)return Py(t,e)},has:function(e){return!!t&&Ry(t,e)},set:function(e,i){t||(t=new Cy),Ty(t,e,i)}};return e},Ly=Sy,Fy=ug,Ny=Oy,By=Mf,Wy=by("%WeakMap%",!0),jy=Ly("WeakMap.prototype.get",!0),$y=Ly("WeakMap.prototype.set",!0),Uy=Ly("WeakMap.prototype.has",!0),Hy=Ly("WeakMap.prototype.delete",!0),zy=Mf,Vy=ug,Gy=(Wy?function(){var t,e,i={assert:function(t){if(!i.has(t))throw new By("Side channel does not contain "+Fy(t))},delete:function(i){if(Wy&&i&&("object"==typeof i||"function"==typeof i)){if(t)return Hy(t,i)}else if(Ny&&e)return e.delete(i);return!1},get:function(i){return Wy&&i&&("object"==typeof i||"function"==typeof i)&&t?jy(t,i):e&&e.get(i)},has:function(i){return Wy&&i&&("object"==typeof i||"function"==typeof i)&&t?Uy(t,i):!!e&&e.has(i)},set:function(i,n){Wy&&i&&("object"==typeof i||"function"==typeof i)?(t||(t=new Wy),$y(t,i,n)):Ny&&(e||(e=Ny()),e.set(i,n))}};return i}:Ny)||Oy||function(){var t,e={assert:function(t){if(!e.has(t))throw new Rg("Side channel does not contain "+Tg(t))},delete:function(e){var i=t&&t.next,n=function(t,e){if(t)return Dg(t,e,!0)}(t,e);return n&&i&&i===n&&(t=void 0),!!n},get:function(e){return function(t,e){if(t){var i=Dg(t,e);return i&&i.value}}(t,e)},has:function(e){return function(t,e){return!!t&&!!Dg(t,e)}(t,e)},set:function(e,i){t||(t={next:void 0}),function(t,e,i){var n=Dg(t,e);n?n.value=i:t.next={key:e,next:t.next,value:i}}(t,e,i)}};return e},qy=String.prototype.replace,Xy=/%20/g,Ky="RFC3986",Yy={default:Ky,formatters:{RFC1738:function(t){return qy.call(t,Xy,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:Ky},Qy=Yy,Jy=Object.prototype.hasOwnProperty,Zy=Array.isArray,tw=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),ew=function(t,e){for(var i=e&&e.plainObjects?{__proto__:null}:{},n=0;n<t.length;++n)void 0!==t[n]&&(i[n]=t[n]);return i},iw=1024,nw={arrayToObject:ew,assign:function(t,e){return Object.keys(e).reduce(function(t,i){return t[i]=e[i],t},t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],i=[],n=0;n<e.length;++n)for(var s=e[n],r=s.obj[s.prop],a=Object.keys(r),o=0;o<a.length;++o){var l=a[o],h=r[l];"object"==typeof h&&null!==h&&-1===i.indexOf(h)&&(e.push({obj:r,prop:l}),i.push(h))}return function(t){for(;t.length>1;){var e=t.pop(),i=e.obj[e.prop];if(Zy(i)){for(var n=[],s=0;s<i.length;++s)void 0!==i[s]&&n.push(i[s]);e.obj[e.prop]=n}}}(e),t},decode:function(t,e,i){var n=t.replace(/\+/g," ");if("iso-8859-1"===i)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(XO){return n}},encode:function(t,e,i,n,s){if(0===t.length)return t;var r=t;if("symbol"==typeof t?r=Symbol.prototype.toString.call(t):"string"!=typeof t&&(r=String(t)),"iso-8859-1"===i)return escape(r).replace(/%u[0-9a-f]{4}/gi,function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"});for(var a="",o=0;o<r.length;o+=iw){for(var l=r.length>=iw?r.slice(o,o+iw):r,h=[],c=0;c<l.length;++c){var d=l.charCodeAt(c);45===d||46===d||95===d||126===d||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===Qy.RFC1738&&(40===d||41===d)?h[h.length]=l.charAt(c):d<128?h[h.length]=tw[d]:d<2048?h[h.length]=tw[192|d>>6]+tw[128|63&d]:d<55296||d>=57344?h[h.length]=tw[224|d>>12]+tw[128|d>>6&63]+tw[128|63&d]:(c+=1,d=65536+((1023&d)<<10|1023&l.charCodeAt(c)),h[h.length]=tw[240|d>>18]+tw[128|d>>12&63]+tw[128|d>>6&63]+tw[128|63&d])}a+=h.join("")}return a},isBuffer:function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(Zy(t)){for(var i=[],n=0;n<t.length;n+=1)i.push(e(t[n]));return i}return e(t)},merge:function t(e,i,n){if(!i)return e;if("object"!=typeof i&&"function"!=typeof i){if(Zy(e))e.push(i);else{if(!e||"object"!=typeof e)return[e,i];(n&&(n.plainObjects||n.allowPrototypes)||!Jy.call(Object.prototype,i))&&(e[i]=!0)}return e}if(!e||"object"!=typeof e)return[e].concat(i);var s=e;return Zy(e)&&!Zy(i)&&(s=ew(e,n)),Zy(e)&&Zy(i)?(i.forEach(function(i,s){if(Jy.call(e,s)){var r=e[s];r&&"object"==typeof r&&i&&"object"==typeof i?e[s]=t(r,i,n):e.push(i)}else e[s]=i}),e):Object.keys(i).reduce(function(e,s){var r=i[s];return Jy.call(e,s)?e[s]=t(e[s],r,n):e[s]=r,e},s)}},sw=function(){var t,e={assert:function(t){if(!e.has(t))throw new zy("Side channel does not contain "+Vy(t))},delete:function(e){return!!t&&t.delete(e)},get:function(e){return t&&t.get(e)},has:function(e){return!!t&&t.has(e)},set:function(e,i){t||(t=Gy()),t.set(e,i)}};return e},rw=nw,aw=Yy,ow=Object.prototype.hasOwnProperty,lw={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},hw=Array.isArray,cw=Array.prototype.push,dw=function(t,e){cw.apply(t,hw(e)?e:[e])},uw=Date.prototype.toISOString,pw=aw.default,fw={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:rw.encode,encodeValuesOnly:!1,filter:void 0,format:pw,formatter:aw.formatters[pw],indices:!1,serializeDate:function(t){return uw.call(t)},skipNulls:!1,strictNullHandling:!1},gw={},mw=function t(e,i,n,s,r,a,o,l,h,c,d,u,p,f,g,m,y,w){for(var v,b=e,A=w,x=0,_=!1;void 0!==(A=A.get(gw))&&!_;){var S=A.get(e);if(x+=1,void 0!==S){if(S===x)throw new RangeError("Cyclic object value");_=!0}void 0===A.get(gw)&&(x=0)}if("function"==typeof c?b=c(i,b):b instanceof Date?b=p(b):"comma"===n&&hw(b)&&(b=rw.maybeMap(b,function(t){return t instanceof Date?p(t):t})),null===b){if(a)return h&&!m?h(i,fw.encoder,y,"key",f):i;b=""}if("string"==typeof(v=b)||"number"==typeof v||"boolean"==typeof v||"symbol"==typeof v||"bigint"==typeof v||rw.isBuffer(b))return h?[g(m?i:h(i,fw.encoder,y,"key",f))+"="+g(h(b,fw.encoder,y,"value",f))]:[g(i)+"="+g(String(b))];var k,E=[];if(void 0===b)return E;if("comma"===n&&hw(b))m&&h&&(b=rw.maybeMap(b,h)),k=[{value:b.length>0?b.join(",")||null:void 0}];else if(hw(c))k=c;else{var M=Object.keys(b);k=d?M.sort(d):M}var C=l?String(i).replace(/\./g,"%2E"):String(i),P=s&&hw(b)&&1===b.length?C+"[]":C;if(r&&hw(b)&&0===b.length)return P+"[]";for(var T=0;T<k.length;++T){var R=k[T],D="object"==typeof R&&R&&void 0!==R.value?R.value:b[R];if(!o||null!==D){var I=u&&l?String(R).replace(/\./g,"%2E"):String(R),O=hw(b)?"function"==typeof n?n(P,I):P:P+(u?"."+I:"["+I+"]");w.set(e,x);var L=sw();L.set(gw,w),dw(E,t(D,O,n,s,r,a,o,l,"comma"===n&&m&&hw(b)?null:h,c,d,u,p,f,g,m,y,L))}}return E},yw=nw,ww=Object.prototype.hasOwnProperty,vw=Array.isArray,bw={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:yw.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},Aw=function(t){return t.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},xw=function(t,e,i){if(t&&"string"==typeof t&&e.comma&&t.indexOf(",")>-1)return t.split(",");if(e.throwOnLimitExceeded&&i>=e.arrayLimit)throw new RangeError("Array limit exceeded. Only "+e.arrayLimit+" element"+(1===e.arrayLimit?"":"s")+" allowed in an array.");return t},_w=function(t,e,i,n){if(t){var s=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,r=/(\[[^[\]]*])/g,a=i.depth>0&&/(\[[^[\]]*])/.exec(s),o=a?s.slice(0,a.index):s,l=[];if(o){if(!i.plainObjects&&ww.call(Object.prototype,o)&&!i.allowPrototypes)return;l.push(o)}for(var h=0;i.depth>0&&null!==(a=r.exec(s))&&h<i.depth;){if(h+=1,!i.plainObjects&&ww.call(Object.prototype,a[1].slice(1,-1))&&!i.allowPrototypes)return;l.push(a[1])}if(a){if(!0===i.strictDepth)throw new RangeError("Input depth exceeded depth option of "+i.depth+" and strictDepth is true");l.push("["+s.slice(a.index)+"]")}return function(t,e,i,n){var s=0;if(t.length>0&&"[]"===t[t.length-1]){var r=t.slice(0,-1).join("");s=Array.isArray(e)&&e[r]?e[r].length:0}for(var a=n?e:xw(e,i,s),o=t.length-1;o>=0;--o){var l,h=t[o];if("[]"===h&&i.parseArrays)l=i.allowEmptyArrays&&(""===a||i.strictNullHandling&&null===a)?[]:yw.combine([],a);else{l=i.plainObjects?{__proto__:null}:{};var c="["===h.charAt(0)&&"]"===h.charAt(h.length-1)?h.slice(1,-1):h,d=i.decodeDotInKeys?c.replace(/%2E/g,"."):c,u=parseInt(d,10);i.parseArrays||""!==d?!isNaN(u)&&h!==d&&String(u)===d&&u>=0&&i.parseArrays&&u<=i.arrayLimit?(l=[])[u]=a:"__proto__"!==d&&(l[d]=a):l={0:a}}a=l}return a}(l,e,i,n)}},Sw={formats:Yy,parse:function(t,e){var i=function(t){if(!t)return bw;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.decodeDotInKeys&&"boolean"!=typeof t.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.decoder&&void 0!==t.decoder&&"function"!=typeof t.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(void 0!==t.throwOnLimitExceeded&&"boolean"!=typeof t.throwOnLimitExceeded)throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var e=void 0===t.charset?bw.charset:t.charset,i=void 0===t.duplicates?bw.duplicates:t.duplicates;if("combine"!==i&&"first"!==i&&"last"!==i)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===t.allowDots?!0===t.decodeDotInKeys||bw.allowDots:!!t.allowDots,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:bw.allowEmptyArrays,allowPrototypes:"boolean"==typeof t.allowPrototypes?t.allowPrototypes:bw.allowPrototypes,allowSparse:"boolean"==typeof t.allowSparse?t.allowSparse:bw.allowSparse,arrayLimit:"number"==typeof t.arrayLimit?t.arrayLimit:bw.arrayLimit,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:bw.charsetSentinel,comma:"boolean"==typeof t.comma?t.comma:bw.comma,decodeDotInKeys:"boolean"==typeof t.decodeDotInKeys?t.decodeDotInKeys:bw.decodeDotInKeys,decoder:"function"==typeof t.decoder?t.decoder:bw.decoder,delimiter:"string"==typeof t.delimiter||yw.isRegExp(t.delimiter)?t.delimiter:bw.delimiter,depth:"number"==typeof t.depth||!1===t.depth?+t.depth:bw.depth,duplicates:i,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof t.interpretNumericEntities?t.interpretNumericEntities:bw.interpretNumericEntities,parameterLimit:"number"==typeof t.parameterLimit?t.parameterLimit:bw.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"==typeof t.plainObjects?t.plainObjects:bw.plainObjects,strictDepth:"boolean"==typeof t.strictDepth?!!t.strictDepth:bw.strictDepth,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:bw.strictNullHandling,throwOnLimitExceeded:"boolean"==typeof t.throwOnLimitExceeded&&t.throwOnLimitExceeded}}(e);if(""===t||null==t)return i.plainObjects?{__proto__:null}:{};for(var n="string"==typeof t?function(t,e){var i={__proto__:null},n=e.ignoreQueryPrefix?t.replace(/^\?/,""):t;n=n.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var s=e.parameterLimit===1/0?void 0:e.parameterLimit,r=n.split(e.delimiter,e.throwOnLimitExceeded?s+1:s);if(e.throwOnLimitExceeded&&r.length>s)throw new RangeError("Parameter limit exceeded. Only "+s+" parameter"+(1===s?"":"s")+" allowed.");var a,o=-1,l=e.charset;if(e.charsetSentinel)for(a=0;a<r.length;++a)0===r[a].indexOf("utf8=")&&("utf8=%E2%9C%93"===r[a]?l="utf-8":"utf8=%26%2310003%3B"===r[a]&&(l="iso-8859-1"),o=a,a=r.length);for(a=0;a<r.length;++a)if(a!==o){var h,c,d=r[a],u=d.indexOf("]="),p=-1===u?d.indexOf("="):u+1;-1===p?(h=e.decoder(d,bw.decoder,l,"key"),c=e.strictNullHandling?null:""):(h=e.decoder(d.slice(0,p),bw.decoder,l,"key"),c=yw.maybeMap(xw(d.slice(p+1),e,vw(i[h])?i[h].length:0),function(t){return e.decoder(t,bw.decoder,l,"value")})),c&&e.interpretNumericEntities&&"iso-8859-1"===l&&(c=Aw(String(c))),d.indexOf("[]=")>-1&&(c=vw(c)?[c]:c);var f=ww.call(i,h);f&&"combine"===e.duplicates?i[h]=yw.combine(i[h],c):f&&"last"!==e.duplicates||(i[h]=c)}return i}(t,i):t,s=i.plainObjects?{__proto__:null}:{},r=Object.keys(n),a=0;a<r.length;++a){var o=r[a],l=_w(o,n[o],i,"string"==typeof t);s=yw.merge(s,l,i)}return!0===i.allowSparse?s:yw.compact(s)},stringify:function(t,e){var i,n=t,s=function(t){if(!t)return fw;if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||fw.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=aw.default;if(void 0!==t.format){if(!ow.call(aw.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var n,s=aw.formatters[i],r=fw.filter;if(("function"==typeof t.filter||hw(t.filter))&&(r=t.filter),n=t.arrayFormat in lw?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":fw.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var a=void 0===t.allowDots?!0===t.encodeDotInKeys||fw.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:fw.addQueryPrefix,allowDots:a,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:fw.allowEmptyArrays,arrayFormat:n,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:fw.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:void 0===t.delimiter?fw.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:fw.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:fw.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:fw.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:fw.encodeValuesOnly,filter:r,format:i,formatter:s,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:fw.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:fw.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:fw.strictNullHandling}}(e);"function"==typeof s.filter?n=(0,s.filter)("",n):hw(s.filter)&&(i=s.filter);var r=[];if("object"!=typeof n||null===n)return"";var a=lw[s.arrayFormat],o="comma"===a&&s.commaRoundTrip;i||(i=Object.keys(n)),s.sort&&i.sort(s.sort);for(var l=sw(),h=0;h<i.length;++h){var c=i[h],d=n[c];s.skipNulls&&null===d||dw(r,mw(d,c,a,o,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}var u=r.join(s.delimiter),p=!0===s.addQueryPrefix?"?":"";return s.charsetSentinel&&("iso-8859-1"===s.charset?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),u.length>0?p+u:""}};const kw=Gd({exports:{}}.exports=function(){var t,e,i={version:"0.2.0"},n=i.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function s(t,e,i){return t<e?e:t>i?i:t}function r(t){return 100*(-1+t)}i.configure=function(t){var e,i;for(e in t)void 0!==(i=t[e])&&t.hasOwnProperty(e)&&(n[e]=i);return this},i.status=null,i.set=function(t){var e=i.isStarted();t=s(t,n.minimum,1),i.status=1===t?null:t;var l=i.render(!e),h=l.querySelector(n.barSelector),c=n.speed,d=n.easing;return l.offsetWidth,a(function(e){""===n.positionUsing&&(n.positionUsing=i.getPositioningCSS()),o(h,function(t,e,i){var s;return(s="translate3d"===n.positionUsing?{transform:"translate3d("+r(t)+"%,0,0)"}:"translate"===n.positionUsing?{transform:"translate("+r(t)+"%,0)"}:{"margin-left":r(t)+"%"}).transition="all "+e+"ms "+i,s}(t,c,d)),1===t?(o(l,{transition:"none",opacity:1}),l.offsetWidth,setTimeout(function(){o(l,{transition:"all "+c+"ms linear",opacity:0}),setTimeout(function(){i.remove(),e()},c)},c)):setTimeout(e,c)}),this},i.isStarted=function(){return"number"==typeof i.status},i.start=function(){i.status||i.set(0);var t=function(){setTimeout(function(){i.status&&(i.trickle(),t())},n.trickleSpeed)};return n.trickle&&t(),this},i.done=function(t){return t||i.status?i.inc(.3+.5*Math.random()).set(1):this},i.inc=function(t){var e=i.status;return e?("number"!=typeof t&&(t=(1-e)*s(Math.random()*e,.1,.95)),e=s(e+t,0,.994),i.set(e)):i.start()},i.trickle=function(){return i.inc(Math.random()*n.trickleRate)},t=0,e=0,i.promise=function(n){return n&&"resolved"!==n.state()?(0===e&&i.start(),t++,e++,n.always(function(){0===--e?(t=0,i.done()):i.set((t-e)/t)}),this):this},i.render=function(t){if(i.isRendered())return document.getElementById("nprogress");h(document.documentElement,"nprogress-busy");var e=document.createElement("div");e.id="nprogress",e.innerHTML=n.template;var s,a=e.querySelector(n.barSelector),l=t?"-100":r(i.status||0),c=document.querySelector(n.parent);return o(a,{transition:"all 0 linear",transform:"translate3d("+l+"%,0,0)"}),n.showSpinner||(s=e.querySelector(n.spinnerSelector))&&u(s),c!=document.body&&h(c,"nprogress-custom-parent"),c.appendChild(e),e},i.remove=function(){c(document.documentElement,"nprogress-busy"),c(document.querySelector(n.parent),"nprogress-custom-parent");var t=document.getElementById("nprogress");t&&u(t)},i.isRendered=function(){return!!document.getElementById("nprogress")},i.getPositioningCSS=function(){var t=document.body.style,e="WebkitTransform"in t?"Webkit":"MozTransform"in t?"Moz":"msTransform"in t?"ms":"OTransform"in t?"O":"";return e+"Perspective"in t?"translate3d":e+"Transform"in t?"translate":"margin"};var a=function(){var t=[];function e(){var i=t.shift();i&&i(e)}return function(i){t.push(i),1==t.length&&e()}}(),o=function(){var t=["Webkit","O","Moz","ms"],e={};function i(i){return i=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()}),e[i]||(e[i]=function(e){var i=document.body.style;if(e in i)return e;for(var n,s=t.length,r=e.charAt(0).toUpperCase()+e.slice(1);s--;)if((n=t[s]+r)in i)return n;return e}(i))}function n(t,e,n){e=i(e),t.style[e]=n}return function(t,e){var i,s,r=arguments;if(2==r.length)for(i in e)void 0!==(s=e[i])&&e.hasOwnProperty(i)&&n(t,i,s);else n(t,r[1],r[2])}}();function l(t,e){return("string"==typeof t?t:d(t)).indexOf(" "+e+" ")>=0}function h(t,e){var i=d(t),n=i+e;l(i,e)||(t.className=n.substring(1))}function c(t,e){var i,n=d(t);l(t,e)&&(i=n.replace(" "+e+" "," "),t.className=i.substring(1,i.length-1))}function d(t){return(" "+(t.className||"")+" ").replace(/\s+/gi," ")}function u(t){t&&t.parentNode&&t.parentNode.removeChild(t)}return i}());var Ew={exports:{}};!function(t,e){var i="__lodash_hash_undefined__",n=9007199254740991,s="[object Arguments]",r="[object Array]",a="[object Boolean]",o="[object Date]",l="[object Error]",h="[object Function]",c="[object Map]",d="[object Number]",u="[object Object]",p="[object Promise]",f="[object RegExp]",g="[object Set]",m="[object String]",y="[object WeakMap]",w="[object ArrayBuffer]",v="[object DataView]",b=/^\[object .+?Constructor\]$/,A=/^(?:0|[1-9]\d*)$/,x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x[s]=x[r]=x[w]=x[a]=x[v]=x[o]=x[l]=x[h]=x[c]=x[d]=x[u]=x[f]=x[g]=x[m]=x[y]=!1;var _="object"==typeof Xd&&Xd&&Xd.Object===Object&&Xd,S="object"==typeof self&&self&&self.Object===Object&&self,k=_||S||Function("return this")(),E=e&&!e.nodeType&&e,M=E&&t&&!t.nodeType&&t,C=M&&M.exports===E,P=C&&_.process,T=function(){try{return P&&P.binding&&P.binding("util")}catch(XO){}}(),R=T&&T.isTypedArray;function D(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}function I(t){var e=-1,i=Array(t.size);return t.forEach(function(t,n){i[++e]=[n,t]}),i}function O(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}var L,F,N,B=Array.prototype,W=Function.prototype,j=Object.prototype,$=k["__core-js_shared__"],U=W.toString,H=j.hasOwnProperty,z=(L=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+L:"",V=j.toString,G=RegExp("^"+U.call(H).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),q=C?k.Buffer:void 0,X=k.Symbol,K=k.Uint8Array,Y=j.propertyIsEnumerable,Q=B.splice,J=X?X.toStringTag:void 0,Z=Object.getOwnPropertySymbols,tt=q?q.isBuffer:void 0,et=(F=Object.keys,N=Object,function(t){return F(N(t))}),it=Mt(k,"DataView"),nt=Mt(k,"Map"),st=Mt(k,"Promise"),rt=Mt(k,"Set"),at=Mt(k,"WeakMap"),ot=Mt(Object,"create"),lt=Rt(it),ht=Rt(nt),ct=Rt(st),dt=Rt(rt),ut=Rt(at),pt=X?X.prototype:void 0,ft=pt?pt.valueOf:void 0;function gt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function mt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function yt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}function wt(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new yt;++e<i;)this.add(t[e])}function vt(t){var e=this.__data__=new mt(t);this.size=e.size}function bt(t,e){for(var i=t.length;i--;)if(Dt(t[i][0],e))return i;return-1}function At(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":J&&J in Object(t)?function(t){var e=H.call(t,J),i=t[J];try{t[J]=void 0;var n=!0}catch(XO){}var s=V.call(t);return n&&(e?t[J]=i:delete t[J]),s}(t):function(t){return V.call(t)}(t)}function xt(t){return Wt(t)&&At(t)==s}function _t(t,e,i,n,h){return t===e||(null==t||null==e||!Wt(t)&&!Wt(e)?t!=t&&e!=e:function(t,e,i,n,h,p){var y=Ot(t),b=Ot(e),A=y?r:Pt(t),x=b?r:Pt(e),_=(A=A==s?u:A)==u,S=(x=x==s?u:x)==u,k=A==x;if(k&&Lt(t)){if(!Lt(e))return!1;y=!0,_=!1}if(k&&!_)return p||(p=new vt),y||jt(t)?St(t,e,i,n,h,p):function(t,e,i,n,s,r,h){switch(i){case v:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case w:return!(t.byteLength!=e.byteLength||!r(new K(t),new K(e)));case a:case o:case d:return Dt(+t,+e);case l:return t.name==e.name&&t.message==e.message;case f:case m:return t==e+"";case c:var u=I;case g:var p=1&n;if(u||(u=O),t.size!=e.size&&!p)return!1;var y=h.get(t);if(y)return y==e;n|=2,h.set(t,e);var b=St(u(t),u(e),n,s,r,h);return h.delete(t),b;case"[object Symbol]":if(ft)return ft.call(t)==ft.call(e)}return!1}(t,e,A,i,n,h,p);if(!(1&i)){var E=_&&H.call(t,"__wrapped__"),M=S&&H.call(e,"__wrapped__");if(E||M){var C=E?t.value():t,P=M?e.value():e;return p||(p=new vt),h(C,P,i,n,p)}}return!!k&&(p||(p=new vt),function(t,e,i,n,s,r){var a=1&i,o=kt(t),l=o.length;if(l!=kt(e).length&&!a)return!1;for(var h=l;h--;){var c=o[h];if(!(a?c in e:H.call(e,c)))return!1}var d=r.get(t);if(d&&r.get(e))return d==e;var u=!0;r.set(t,e),r.set(e,t);for(var p=a;++h<l;){var f=t[c=o[h]],g=e[c];if(n)var m=a?n(g,f,c,e,t,r):n(f,g,c,t,e,r);if(!(void 0===m?f===g||s(f,g,i,n,r):m)){u=!1;break}p||(p="constructor"==c)}if(u&&!p){var y=t.constructor,w=e.constructor;y==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof w&&w instanceof w||(u=!1)}return r.delete(t),r.delete(e),u}(t,e,i,n,h,p))}(t,e,i,n,_t,h))}function St(t,e,i,n,s,r){var a=1&i,o=t.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var h=r.get(t);if(h&&r.get(e))return h==e;var c=-1,d=!0,u=2&i?new wt:void 0;for(r.set(t,e),r.set(e,t);++c<o;){var p=t[c],f=e[c];if(n)var g=a?n(f,p,c,e,t,r):n(p,f,c,t,e,r);if(void 0!==g){if(g)continue;d=!1;break}if(u){if(!D(e,function(t,e){if(a=e,!u.has(a)&&(p===t||s(p,t,i,n,r)))return u.push(e);var a})){d=!1;break}}else if(p!==f&&!s(p,f,i,n,r)){d=!1;break}}return r.delete(t),r.delete(e),d}function kt(t){return function(t,e,i){var n=e(t);return Ot(t)?n:function(t,e){for(var i=-1,n=e.length,s=t.length;++i<n;)t[s+i]=e[i];return t}(n,i(t))}(t,$t,Ct)}function Et(t,e){var i,n,s=t.__data__;return("string"==(n=typeof(i=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?s["string"==typeof e?"string":"hash"]:s.map}function Mt(t,e){var i=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!Bt(t)||function(t){return!!z&&z in t}(t))&&(Ft(t)?G:b).test(Rt(t))}(i)?i:void 0}gt.prototype.clear=function(){this.__data__=ot?ot(null):{},this.size=0},gt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},gt.prototype.get=function(t){var e=this.__data__;if(ot){var n=e[t];return n===i?void 0:n}return H.call(e,t)?e[t]:void 0},gt.prototype.has=function(t){var e=this.__data__;return ot?void 0!==e[t]:H.call(e,t)},gt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ot&&void 0===e?i:e,this},mt.prototype.clear=function(){this.__data__=[],this.size=0},mt.prototype.delete=function(t){var e=this.__data__,i=bt(e,t);return!(i<0||(i==e.length-1?e.pop():Q.call(e,i,1),--this.size,0))},mt.prototype.get=function(t){var e=this.__data__,i=bt(e,t);return i<0?void 0:e[i][1]},mt.prototype.has=function(t){return bt(this.__data__,t)>-1},mt.prototype.set=function(t,e){var i=this.__data__,n=bt(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this},yt.prototype.clear=function(){this.size=0,this.__data__={hash:new gt,map:new(nt||mt),string:new gt}},yt.prototype.delete=function(t){var e=Et(this,t).delete(t);return this.size-=e?1:0,e},yt.prototype.get=function(t){return Et(this,t).get(t)},yt.prototype.has=function(t){return Et(this,t).has(t)},yt.prototype.set=function(t,e){var i=Et(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this},wt.prototype.add=wt.prototype.push=function(t){return this.__data__.set(t,i),this},wt.prototype.has=function(t){return this.__data__.has(t)},vt.prototype.clear=function(){this.__data__=new mt,this.size=0},vt.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},vt.prototype.get=function(t){return this.__data__.get(t)},vt.prototype.has=function(t){return this.__data__.has(t)},vt.prototype.set=function(t,e){var i=this.__data__;if(i instanceof mt){var n=i.__data__;if(!nt||n.length<199)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new yt(n)}return i.set(t,e),this.size=i.size,this};var Ct=Z?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var i=-1,n=null==t?0:t.length,s=0,r=[];++i<n;){var a=t[i];e(a)&&(r[s++]=a)}return r}(Z(t),function(e){return Y.call(t,e)}))}:function(){return[]},Pt=At;function Tt(t,e){return!!(e=null==e?n:e)&&("number"==typeof t||A.test(t))&&t>-1&&t%1==0&&t<e}function Rt(t){if(null!=t){try{return U.call(t)}catch(XO){}try{return t+""}catch(XO){}}return""}function Dt(t,e){return t===e||t!=t&&e!=e}(it&&Pt(new it(new ArrayBuffer(1)))!=v||nt&&Pt(new nt)!=c||st&&Pt(st.resolve())!=p||rt&&Pt(new rt)!=g||at&&Pt(new at)!=y)&&(Pt=function(t){var e=At(t),i=e==u?t.constructor:void 0,n=i?Rt(i):"";if(n)switch(n){case lt:return v;case ht:return c;case ct:return p;case dt:return g;case ut:return y}return e});var It=xt(function(){return arguments}())?xt:function(t){return Wt(t)&&H.call(t,"callee")&&!Y.call(t,"callee")},Ot=Array.isArray,Lt=tt||function(){return!1};function Ft(t){if(!Bt(t))return!1;var e=At(t);return e==h||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Nt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}function Bt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Wt(t){return null!=t&&"object"==typeof t}var jt=R?function(t){return function(e){return t(e)}}(R):function(t){return Wt(t)&&Nt(t.length)&&!!x[At(t)]};function $t(t){return null!=(e=t)&&Nt(e.length)&&!Ft(e)?function(t){var e=Ot(t),i=!e&&It(t),n=!e&&!i&&Lt(t),s=!e&&!i&&!n&&jt(t),r=e||i||n||s,a=r?function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}(t.length,String):[],o=a.length;for(var l in t)!H.call(t,l)||r&&("length"==l||n&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Tt(l,o))||a.push(l);return a}(t):function(t){if(i=(e=t)&&e.constructor,e!==("function"==typeof i&&i.prototype||j))return et(t);var e,i,n=[];for(var s in Object(t))H.call(t,s)&&"constructor"!=s&&n.push(s);return n}(t);var e}t.exports=function(t,e){return _t(t,e)}}(Ew,Ew.exports);const Mw=Gd(Ew.exports);async function Cw(t,e){for(const i of Array.isArray(t)?t:[t]){const t=e[i];if(void 0!==t)return"function"==typeof t?t():t}throw new Error(`Page not found: ${t}`)}var Pw=Vw(),Tw=t=>$w(t,Pw),Rw=Vw();Tw.write=t=>$w(t,Rw);var Dw=Vw();Tw.onStart=t=>$w(t,Dw);var Iw=Vw();Tw.onFrame=t=>$w(t,Iw);var Ow=Vw();Tw.onFinish=t=>$w(t,Ow);var Lw=[];Tw.setTimeout=(t,e)=>{const i=Tw.now()+e,n=()=>{const t=Lw.findIndex(t=>t.cancel==n);~t&&Lw.splice(t,1),Ww-=~t?1:0},s={time:i,handler:t,cancel:n};return Lw.splice(Fw(i),0,s),Ww+=1,Uw(),s};var Fw=t=>~(~Lw.findIndex(e=>e.time>t)||~Lw.length);Tw.cancel=t=>{Dw.delete(t),Iw.delete(t),Ow.delete(t),Pw.delete(t),Rw.delete(t)},Tw.sync=t=>{jw=!0,Tw.batchedUpdates(t),jw=!1},Tw.throttle=t=>{let e;function i(){try{t(...e)}finally{e=null}}function n(...t){e=t,Tw.onStart(i)}return n.handler=t,n.cancel=()=>{Dw.delete(i),e=null},n};var Nw="undefined"!=typeof window?window.requestAnimationFrame:()=>{};Tw.use=t=>Nw=t,Tw.now="undefined"!=typeof performance?()=>performance.now():Date.now,Tw.batchedUpdates=t=>t(),Tw.catch=console.error,Tw.frameLoop="always",Tw.advance=()=>{"demand"!==Tw.frameLoop||zw()};var Bw=-1,Ww=0,jw=!1;function $w(t,e){jw?(e.delete(t),t(0)):(e.add(t),Uw())}function Uw(){Bw<0&&(Bw=0,"demand"!==Tw.frameLoop&&Nw(Hw))}function Hw(){~Bw&&(Nw(Hw),Tw.batchedUpdates(zw))}function zw(){const t=Bw;Bw=Tw.now();const e=Fw(Bw);e&&(Gw(Lw.splice(0,e),t=>t.handler()),Ww-=e),Ww?(Dw.flush(),Pw.flush(t?Math.min(64,Bw-t):16.667),Iw.flush(),Rw.flush(),Ow.flush()):Bw=-1}function Vw(){let t=new Set,e=t;return{add(i){Ww+=e!=t||t.has(i)?0:1,t.add(i)},delete:i=>(Ww-=e==t&&t.has(i)?1:0,t.delete(i)),flush(i){e.size&&(t=new Set,Ww-=e.size,Gw(e,e=>e(i)&&t.add(e)),Ww+=t.size,e=t)}}}function Gw(t,e){t.forEach(t=>{try{e(t)}catch(XO){Tw.catch(XO)}})}var qw=Object.defineProperty,Xw={};function Kw(){}((t,e)=>{for(var i in e)qw(t,i,{get:e[i],enumerable:!0})})(Xw,{assign:()=>hv,colors:()=>av,createStringInterpolator:()=>iv,skipAnimation:()=>ov,to:()=>nv,willAdvance:()=>lv});var Yw={arr:Array.isArray,obj:t=>!!t&&"Object"===t.constructor.name,fun:t=>"function"==typeof t,str:t=>"string"==typeof t,num:t=>"number"==typeof t,und:t=>void 0===t};function Qw(t,e){if(Yw.arr(t)){if(!Yw.arr(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}return t===e}var Jw=(t,e)=>t.forEach(e);function Zw(t,e,i){if(Yw.arr(t))for(let n=0;n<t.length;n++)e.call(i,t[n],`${n}`);else for(const n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n)}var tv=t=>Yw.und(t)?[]:Yw.arr(t)?t:[t];function ev(t,e){if(t.size){const i=Array.from(t);t.clear(),Jw(i,e)}}var iv,nv,sv=(t,...e)=>ev(t,t=>t(...e)),rv=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),av=null,ov=!1,lv=Kw,hv=t=>{t.to&&(nv=t.to),t.now&&(Tw.now=t.now),void 0!==t.colors&&(av=t.colors),null!=t.skipAnimation&&(ov=t.skipAnimation),t.createStringInterpolator&&(iv=t.createStringInterpolator),t.requestAnimationFrame&&Tw.use(t.requestAnimationFrame),t.batchedUpdates&&(Tw.batchedUpdates=t.batchedUpdates),t.willAdvance&&(lv=t.willAdvance),t.frameLoop&&(Tw.frameLoop=t.frameLoop)},cv=new Set,dv=[],uv=[],pv=0,fv={get idle(){return!cv.size&&!dv.length},start(t){pv>t.priority?(cv.add(t),Tw.onStart(gv)):(mv(t),Tw(wv))},advance:wv,sort(t){if(pv)Tw.onFrame(()=>fv.sort(t));else{const e=dv.indexOf(t);~e&&(dv.splice(e,1),yv(t))}},clear(){dv=[],cv.clear()}};function gv(){cv.forEach(mv),cv.clear(),Tw(wv)}function mv(t){dv.includes(t)||yv(t)}function yv(t){dv.splice(function(e){const i=e.findIndex(e=>e.priority>t.priority);return i<0?e.length:i}(dv),0,t)}function wv(t){const e=uv;for(let i=0;i<dv.length;i++){const n=dv[i];pv=n.priority,n.idle||(lv(n),n.advance(t),n.idle||e.push(n))}return pv=0,(uv=dv).length=0,(dv=e).length>0}var vv="[-+]?\\d*\\.?\\d+",bv=vv+"%";function Av(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var xv=new RegExp("rgb"+Av(vv,vv,vv)),_v=new RegExp("rgba"+Av(vv,vv,vv,vv)),Sv=new RegExp("hsl"+Av(vv,bv,bv)),kv=new RegExp("hsla"+Av(vv,bv,bv,vv)),Ev=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Mv=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Cv=/^#([0-9a-fA-F]{6})$/,Pv=/^#([0-9a-fA-F]{8})$/;function Tv(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function Rv(t,e,i){const n=i<.5?i*(1+e):i+e-i*e,s=2*i-n,r=Tv(s,n,t+1/3),a=Tv(s,n,t),o=Tv(s,n,t-1/3);return Math.round(255*r)<<24|Math.round(255*a)<<16|Math.round(255*o)<<8}function Dv(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function Iv(t){return(parseFloat(t)%360+360)%360/360}function Ov(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(255*e)}function Lv(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function Fv(t){let e=function(t){let e;return"number"==typeof t?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=Cv.exec(t))?parseInt(e[1]+"ff",16)>>>0:av&&void 0!==av[t]?av[t]:(e=xv.exec(t))?(Dv(e[1])<<24|Dv(e[2])<<16|Dv(e[3])<<8|255)>>>0:(e=_v.exec(t))?(Dv(e[1])<<24|Dv(e[2])<<16|Dv(e[3])<<8|Ov(e[4]))>>>0:(e=Ev.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=Pv.exec(t))?parseInt(e[1],16)>>>0:(e=Mv.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Sv.exec(t))?(255|Rv(Iv(e[1]),Lv(e[2]),Lv(e[3])))>>>0:(e=kv.exec(t))?(Rv(Iv(e[1]),Lv(e[2]),Lv(e[3]))|Ov(e[4]))>>>0:null}(t);return null===e?t:(e=e||0,`rgba(${(4278190080&e)>>>24}, ${(16711680&e)>>>16}, ${(65280&e)>>>8}, ${(255&e)/255})`)}var Nv=(t,e,i)=>{if(Yw.fun(t))return t;if(Yw.arr(t))return Nv({range:t,output:e,extrapolate:i});if(Yw.str(t.output[0]))return iv(t);const n=t,s=n.output,r=n.range||[0,1],a=n.extrapolateLeft||n.extrapolate||"extend",o=n.extrapolateRight||n.extrapolate||"extend",l=n.easing||(t=>t);return t=>{const e=function(t,e){for(var i=1;i<e.length-1&&!(e[i]>=t);++i);return i-1}(t,r);return function(t,e,i,n,s,r,a,o,l){let h=l?l(t):t;if(h<e){if("identity"===a)return h;"clamp"===a&&(h=e)}if(h>i){if("identity"===o)return h;"clamp"===o&&(h=i)}return n===s?n:e===i?t<=e?n:s:(e===-1/0?h=-h:i===1/0?h-=e:h=(h-e)/(i-e),h=r(h),n===-1/0?h=-h:s===1/0?h+=n:h=h*(s-n)+n,h)}(t,r[e],r[e+1],s[e],s[e+1],l,a,o,n.map)}},Bv=Symbol.for("FluidValue.get"),Wv=Symbol.for("FluidValue.observers"),jv=t=>Boolean(t&&t[Bv]),$v=t=>t&&t[Bv]?t[Bv]():t,Uv=t=>t[Wv]||null;function Hv(t,e){const i=t[Wv];i&&i.forEach(t=>{!function(t,e){t.eventObserved?t.eventObserved(e):t(e)}(t,e)})}var zv=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Vv(this,t)}},Vv=(t,e)=>Kv(t,Bv,e);function Gv(t,e){if(t[Bv]){let i=t[Wv];i||Kv(t,Wv,i=new Set),i.has(e)||(i.add(e),t.observerAdded&&t.observerAdded(i.size,e))}return e}function qv(t,e){const i=t[Wv];if(i&&i.has(e)){const n=i.size-1;n?i.delete(e):t[Wv]=null,t.observerRemoved&&t.observerRemoved(n,e)}}var Xv,Kv=(t,e,i)=>Object.defineProperty(t,e,{value:i,writable:!0,configurable:!0}),Yv=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Qv=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,Jv=new RegExp(`(${Yv.source})(%|[a-z]+)`,"i"),Zv=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,tb=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,eb=t=>{const[e,i]=ib(t);if(!e||rv())return t;const n=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(n)return n.trim();if(i&&i.startsWith("--")){return window.getComputedStyle(document.documentElement).getPropertyValue(i)||t}return i&&tb.test(i)?eb(i):i||t},ib=t=>{const e=tb.exec(t);if(!e)return[,];const[,i,n]=e;return[i,n]},nb=(t,e,i,n,s)=>`rgba(${Math.round(e)}, ${Math.round(i)}, ${Math.round(n)}, ${s})`,sb=t=>{Xv||(Xv=av?new RegExp(`(${Object.keys(av).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(t=>$v(t).replace(tb,eb).replace(Qv,Fv).replace(Xv,Fv)),i=e.map(t=>t.match(Yv).map(Number)),n=i[0].map((t,e)=>i.map(t=>{if(!(e in t))throw Error('The arity of each "output" value must be equal');return t[e]})).map(e=>Nv({...t,output:e}));return t=>{const i=!Jv.test(e[0])&&e.find(t=>Jv.test(t))?.replace(Yv,"");let s=0;return e[0].replace(Yv,()=>`${n[s++](t)}${i||""}`).replace(Zv,nb)}},rb="react-spring: ",ab=t=>{const e=t;let i=!1;if("function"!=typeof e)throw new TypeError(`${rb}once requires a function parameter`);return(...t)=>{i||(e(...t),i=!0)}},ob=ab(console.warn),lb=ab(console.warn);function hb(t){return Yw.str(t)&&("#"==t[0]||/\d/.test(t)||!rv()&&tb.test(t)||t in(av||{}))}var cb=rv()?Kd.useEffect:Kd.useLayoutEffect;function db(){const t=Kd.useState()[1],e=(()=>{const t=Kd.useRef(!1);return cb(()=>(t.current=!0,()=>{t.current=!1}),[]),t})();return()=>{e.current&&t(Math.random())}}var ub=t=>Kd.useEffect(t,pb),pb=[];function fb(t){const e=Kd.useRef();return Kd.useEffect(()=>{e.current=t}),e.current}var gb=Symbol.for("Animated:node"),mb=t=>t&&t[gb],yb=(t,e)=>{return i=t,n=gb,s=e,Object.defineProperty(i,n,{value:s,writable:!0,configurable:!0});var i,n,s},wb=t=>t&&t[gb]&&t[gb].getPayload(),vb=class{constructor(){yb(this,this)}getPayload(){return this.payload||[]}},bb=class extends vb{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,Yw.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new bb(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return Yw.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value!==t&&(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,Yw.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},Ab=class extends bb{constructor(t){super(0),this._string=null,this._toString=Nv({output:[t,t]})}static create(t){return new Ab(t)}getValue(){const t=this._string;return null==t?this._string=this._toString(this._value):t}setValue(t){if(Yw.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else{if(!super.setValue(t))return!1;this._string=null}return!0}reset(t){t&&(this._toString=Nv({output:[this.getValue(),t]})),this._value=0,super.reset()}},xb={dependencies:null},_b=class extends vb{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return Zw(this.source,(i,n)=>{var s;(s=i)&&s[gb]===s?e[n]=i.getValue(t):jv(i)?e[n]=$v(i):t||(e[n]=i)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&Jw(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return Zw(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){xb.dependencies&&jv(t)&&xb.dependencies.add(t);const e=wb(t);e&&Jw(e,t=>this.add(t))}},Sb=class extends _b{constructor(t){super(t)}static create(t){return new Sb(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const e=this.getPayload();return t.length==e.length?e.map((e,i)=>e.setValue(t[i])).some(Boolean):(super.setValue(t.map(kb)),!0)}};function kb(t){return(hb(t)?Ab:bb).create(t)}function Eb(t){const e=mb(t);return e?e.constructor:Yw.arr(t)?Sb:hb(t)?Ab:bb}var Mb=(t,e)=>{const i=!Yw.fun(t)||t.prototype&&t.prototype.isReactComponent;return Kd.forwardRef((n,s)=>{const r=Kd.useRef(null),a=i&&Kd.useCallback(t=>{r.current=function(t,e){return t&&(Yw.fun(t)?t(e):t.current=e),e}(s,t)},[s]),[o,l]=function(t,e){const i=new Set;return xb.dependencies=i,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new _b(t),xb.dependencies=null,[t,i]}(n,e),h=db(),c=()=>{const t=r.current;i&&!t||!1===(!!t&&e.applyAnimatedValues(t,o.getValue(!0)))&&h()},d=new Cb(c,l),u=Kd.useRef();cb(()=>(u.current=d,Jw(l,t=>Gv(t,d)),()=>{u.current&&(Jw(u.current.deps,t=>qv(t,u.current)),Tw.cancel(u.current.update))})),Kd.useEffect(c,[]),ub(()=>()=>{const t=u.current;Jw(t.deps,e=>qv(e,t))});const p=e.getComponentProps(o.getValue());return Kd.createElement(t,{...p,ref:a})})},Cb=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){"change"==t.type&&Tw.write(this.update)}},Pb=Symbol.for("AnimatedComponent"),Tb=t=>Yw.str(t)?t:t&&Yw.str(t.displayName)?t.displayName:Yw.fun(t)&&t.name||null;function Rb(t,...e){return Yw.fun(t)?t(...e):t}var Db=(t,e)=>!0===t||!!(e&&t&&(Yw.fun(t)?t(e):tv(t).includes(e))),Ib=(t,e)=>Yw.obj(t)?e&&t[e]:t,Ob=(t,e)=>!0===t.default?t[e]:t.default?t.default[e]:void 0,Lb=t=>t,Fb=(t,e=Lb)=>{let i=Nb;t.default&&!0!==t.default&&(t=t.default,i=Object.keys(t));const n={};for(const s of i){const i=e(t[s],s);Yw.und(i)||(n[s]=i)}return n},Nb=["config","onProps","onStart","onChange","onPause","onResume","onRest"],Bb={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function Wb(t){const e=function(t){const e={};let i=0;if(Zw(t,(t,n)=>{Bb[n]||(e[n]=t,i++)}),i)return e}(t);if(e){const i={to:e};return Zw(t,(t,n)=>n in e||(i[n]=t)),i}return{...t}}function jb(t){return t=$v(t),Yw.arr(t)?t.map(jb):hb(t)?Xw.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function $b(t){return Yw.fun(t)||Yw.arr(t)&&Yw.obj(t[0])}var Ub={tension:170,friction:26,mass:1,damping:1,easing:t=>t,clamp:!1},Hb=class{constructor(){this.velocity=0,Object.assign(this,Ub)}};function zb(t,e){if(Yw.und(e.decay)){const i=!Yw.und(e.tension)||!Yw.und(e.friction);!i&&Yw.und(e.frequency)&&Yw.und(e.damping)&&Yw.und(e.mass)||(t.duration=void 0,t.decay=void 0),i&&(t.frequency=void 0)}else t.duration=void 0}var Vb=[],Gb=class{constructor(){this.changed=!1,this.values=Vb,this.toValues=null,this.fromValues=Vb,this.config=new Hb,this.immediate=!1}};function qb(t,{key:e,props:i,defaultProps:n,state:s,actions:r}){return new Promise((a,o)=>{let l,h,c=Db(i.cancel??n?.cancel,e);if(c)p();else{Yw.und(i.pause)||(s.paused=Db(i.pause,e));let t=n?.pause;!0!==t&&(t=s.paused||Db(t,e)),l=Rb(i.delay||0,e),t?(s.resumeQueue.add(u),r.pause()):(r.resume(),u())}function d(){s.resumeQueue.add(u),s.timeouts.delete(h),h.cancel(),l=h.time-Tw.now()}function u(){l>0&&!Xw.skipAnimation?(s.delayed=!0,h=Tw.setTimeout(p,l),s.pauseQueue.add(d),s.timeouts.add(h)):p()}function p(){s.delayed&&(s.delayed=!1),s.pauseQueue.delete(d),s.timeouts.delete(h),t<=(s.cancelId||0)&&(c=!0);try{r.start({...i,callId:t,cancel:c},a)}catch(e){o(e)}}})}var Xb=(t,e)=>1==e.length?e[0]:e.some(t=>t.cancelled)?Qb(t.get()):e.every(t=>t.noop)?Kb(t.get()):Yb(t.get(),e.every(t=>t.finished)),Kb=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),Yb=(t,e,i=!1)=>({value:t,finished:e,cancelled:i}),Qb=t=>({value:t,cancelled:!0,finished:!1});function Jb(t,e,i,n){const{callId:s,parentId:r,onRest:a}=e,{asyncTo:o,promise:l}=i;return r||t!==o||e.reset?i.promise=(async()=>{i.asyncId=s,i.asyncTo=t;const h=Fb(e,(t,e)=>"onRest"===e?void 0:t);let c,d;const u=new Promise((t,e)=>(c=t,d=e)),p=t=>{const e=s<=(i.cancelId||0)&&Qb(n)||s!==i.asyncId&&Yb(n,!1);if(e)throw t.result=e,d(t),t},f=(t,e)=>{const r=new tA,a=new eA;return(async()=>{if(Xw.skipAnimation)throw Zb(i),a.result=Yb(n,!1),d(a),a;p(r);const o=Yw.obj(t)?{...t}:{...e,to:t};o.parentId=s,Zw(h,(t,e)=>{Yw.und(o[e])&&(o[e]=t)});const l=await n.start(o);return p(r),i.paused&&await new Promise(t=>{i.resumeQueue.add(t)}),l})()};let g;if(Xw.skipAnimation)return Zb(i),Yb(n,!1);try{let e;e=Yw.arr(t)?(async t=>{for(const e of t)await f(e)})(t):Promise.resolve(t(f,n.stop.bind(n))),await Promise.all([e.then(c),u]),g=Yb(n.get(),!0,!1)}catch(m){if(m instanceof tA)g=m.result;else{if(!(m instanceof eA))throw m;g=m.result}}finally{s==i.asyncId&&(i.asyncId=r,i.asyncTo=r?o:void 0,i.promise=r?l:void 0)}return Yw.fun(a)&&Tw.batchedUpdates(()=>{a(g,n,n.item)}),g})():l}function Zb(t,e){ev(t.timeouts,t=>t.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var tA=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},eA=class extends Error{constructor(){super("SkipAnimationSignal")}},iA=t=>t instanceof sA,nA=1,sA=class extends zv{constructor(){super(...arguments),this.id=nA++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=mb(this);return t&&t.getValue()}to(...t){return Xw.to(this,t)}interpolate(...t){return ob(`${rb}The "interpolate" function is deprecated in v9 (use "to" instead)`),Xw.to(this,t)}toJSON(){return this.get()}observerAdded(t){1==t&&this._attach()}observerRemoved(t){0==t&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){Hv(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||fv.sort(this),Hv(this,{type:"priority",parent:this,priority:t})}},rA=Symbol.for("SpringPhase"),aA=t=>(1&t[rA])>0,oA=t=>(2&t[rA])>0,lA=t=>(4&t[rA])>0,hA=(t,e)=>e?t[rA]|=3:t[rA]&=-3,cA=(t,e)=>e?t[rA]|=4:t[rA]&=-5,dA=class extends sA{constructor(t,e){if(super(),this.animation=new Gb,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!Yw.und(t)||!Yw.und(e)){const i=Yw.obj(t)?{...t}:{...e,from:t};Yw.und(i.default)&&(i.default=!0),this.start(i)}}get idle(){return!(oA(this)||this._state.asyncTo)||lA(this)}get goal(){return $v(this.animation.to)}get velocity(){const t=mb(this);return t instanceof bb?t.lastVelocity||0:t.getPayload().map(t=>t.lastVelocity||0)}get hasAnimated(){return aA(this)}get isAnimating(){return oA(this)}get isPaused(){return lA(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,i=!1;const n=this.animation;let{toValues:s}=n;const{config:r}=n,a=wb(n.to);!a&&jv(n.to)&&(s=tv($v(n.to))),n.values.forEach((o,l)=>{if(o.done)return;const h=o.constructor==Ab?1:a?a[l].lastPosition:s[l];let c=n.immediate,d=h;if(!c){if(d=o.lastPosition,r.tension<=0)return void(o.done=!0);let e=o.elapsedTime+=t;const i=n.fromValues[l],s=null!=o.v0?o.v0:o.v0=Yw.arr(r.velocity)?r.velocity[l]:r.velocity;let a;const u=r.precision||(i==h?.005:Math.min(1,.001*Math.abs(h-i)));if(Yw.und(r.duration))if(r.decay){const t=!0===r.decay?.998:r.decay,n=Math.exp(-(1-t)*e);d=i+s/(1-t)*(1-n),c=Math.abs(o.lastPosition-d)<=u,a=s*n}else{a=null==o.lastVelocity?s:o.lastVelocity;const e=r.restVelocity||u/10,n=r.clamp?0:r.bounce,l=!Yw.und(n),p=i==h?o.v0>0:i<h;let f,g=!1;const m=1,y=Math.ceil(t/m);for(let t=0;t<y&&(f=Math.abs(a)>e,f||(c=Math.abs(h-d)<=u,!c));++t)l&&(g=d==h||d>h==p,g&&(a=-a*n,d=h)),a+=(1e-6*-r.tension*(d-h)+.001*-r.friction*a)/r.mass*m,d+=a*m}else{let n=1;r.duration>0&&(this._memoizedDuration!==r.duration&&(this._memoizedDuration=r.duration,o.durationProgress>0&&(o.elapsedTime=r.duration*o.durationProgress,e=o.elapsedTime+=t)),n=(r.progress||0)+e/this._memoizedDuration,n=n>1?1:n<0?0:n,o.durationProgress=n),d=i+r.easing(n)*(h-i),a=(d-o.lastPosition)/t,c=1==n}o.lastVelocity=a,Number.isNaN(d)&&(c=!0)}a&&!a[l].done&&(c=!1),c?o.done=!0:e=!1,o.setValue(d,r.round)&&(i=!0)});const o=mb(this),l=o.getValue();if(e){const t=$v(n.to);l===t&&!i||r.decay?i&&r.decay&&this._onChange(l):(o.setValue(t),this._onChange(t)),this._stop()}else i&&this._onChange(l)}set(t){return Tw.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(oA(this)){const{to:t,config:e}=this.animation;Tw.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let i;return Yw.und(t)?(i=this.queue||[],this.queue=[]):i=[Yw.obj(t)?t:{...e,to:t}],Promise.all(i.map(t=>this._update(t))).then(t=>Xb(this,t))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),Zb(this._state,t&&this._lastCallId),Tw.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){"change"==t.type?this._start():"priority"==t.type&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:i,from:n}=t;i=Yw.obj(i)?i[e]:i,(null==i||$b(i))&&(i=void 0),n=Yw.obj(n)?n[e]:n,null==n&&(n=void 0);const s={to:i,from:n};return aA(this)||(t.reverse&&([i,n]=[n,i]),n=$v(n),Yw.und(n)?mb(this)||this._set(i):this._set(n)),s}_update({...t},e){const{key:i,defaultProps:n}=this;t.default&&Object.assign(n,Fb(t,(t,e)=>/^on/.test(e)?Ib(t,i):t)),wA(this,t,"onProps"),vA(this,"onProps",t,this);const s=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const r=this._state;return qb(++this._lastCallId,{key:i,props:t,defaultProps:n,state:r,actions:{pause:()=>{lA(this)||(cA(this,!0),sv(r.pauseQueue),vA(this,"onPause",Yb(this,uA(this,this.animation.to)),this))},resume:()=>{lA(this)&&(cA(this,!1),oA(this)&&this._resume(),sv(r.resumeQueue),vA(this,"onResume",Yb(this,uA(this,this.animation.to)),this))},start:this._merge.bind(this,s)}}).then(i=>{if(t.loop&&i.finished&&(!e||!i.noop)){const e=pA(t);if(e)return this._update(e,!0)}return i})}_merge(t,e,i){if(e.cancel)return this.stop(!0),i(Qb(this));const n=!Yw.und(t.to),s=!Yw.und(t.from);if(n||s){if(!(e.callId>this._lastToId))return i(Qb(this));this._lastToId=e.callId}const{key:r,defaultProps:a,animation:o}=this,{to:l,from:h}=o;let{to:c=l,from:d=h}=t;!s||n||e.default&&!Yw.und(c)||(c=d),e.reverse&&([c,d]=[d,c]);const u=!Qw(d,h);u&&(o.from=d),d=$v(d);const p=!Qw(c,l);p&&this._focus(c);const f=$b(e.to),{config:g}=o,{decay:m,velocity:y}=g;(n||s)&&(g.velocity=0),e.config&&!f&&function(t,e,i){i&&(zb(i={...i},e),e={...i,...e}),zb(t,e),Object.assign(t,e);for(const a in Ub)null==t[a]&&(t[a]=Ub[a]);let{frequency:n,damping:s}=t;const{mass:r}=t;Yw.und(n)||(n<.01&&(n=.01),s<0&&(s=0),t.tension=Math.pow(2*Math.PI/n,2)*r,t.friction=4*Math.PI*s*r/n)}(g,Rb(e.config,r),e.config!==a.config?Rb(a.config,r):void 0);let w=mb(this);if(!w||Yw.und(c))return i(Yb(this,!0));const v=Yw.und(e.reset)?s&&!e.default:!Yw.und(d)&&Db(e.reset,r),b=v?d:this.get(),A=jb(c),x=Yw.num(A)||Yw.arr(A)||hb(A),_=!f&&(!x||Db(a.immediate||e.immediate,r));if(p){const t=Eb(c);if(t!==w.constructor){if(!_)throw Error(`Cannot animate between ${w.constructor.name} and ${t.name}, as the "to" prop suggests`);w=this._set(A)}}const S=w.constructor;let k=jv(c),E=!1;if(!k){const t=v||!aA(this)&&u;(p||t)&&(E=Qw(jb(b),A),k=!E),(Qw(o.immediate,_)||_)&&Qw(g.decay,m)&&Qw(g.velocity,y)||(k=!0)}if(E&&oA(this)&&(o.changed&&!v?k=!0:k||this._stop(l)),!f&&((k||jv(l))&&(o.values=w.getPayload(),o.toValues=jv(c)?null:S==Ab?[1]:tv(A)),o.immediate!=_&&(o.immediate=_,_||v||this._set(l)),k)){const{onRest:t}=o;Jw(yA,t=>wA(this,e,t));const n=Yb(this,uA(this,l));sv(this._pendingCalls,n),this._pendingCalls.add(i),o.changed&&Tw.batchedUpdates(()=>{o.changed=!v,t?.(n,this),v?Rb(a.onRest,n):o.onStart?.(n,this)})}v&&this._set(b),f?i(Jb(e.to,e,this._state,this)):k?this._start():oA(this)&&!p?this._pendingCalls.add(i):i(Kb(b))}_focus(t){const e=this.animation;t!==e.to&&(Uv(this)&&this._detach(),e.to=t,Uv(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;jv(e)&&(Gv(e,this),iA(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;jv(t)&&qv(t,this)}_set(t,e=!0){const i=$v(t);if(!Yw.und(i)){const t=mb(this);if(!t||!Qw(i,t.getValue())){const n=Eb(i);t&&t.constructor==n?t.setValue(i):yb(this,n.create(i)),t&&Tw.batchedUpdates(()=>{this._onChange(i,e)})}}return mb(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,vA(this,"onStart",Yb(this,uA(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),Rb(this.animation.onChange,t,this)),Rb(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;mb(this).reset($v(t.to)),t.immediate||(t.fromValues=t.values.map(t=>t.lastPosition)),oA(this)||(hA(this,!0),lA(this)||this._resume())}_resume(){Xw.skipAnimation?this.finish():fv.start(this)}_stop(t,e){if(oA(this)){hA(this,!1);const i=this.animation;Jw(i.values,t=>{t.done=!0}),i.toValues&&(i.onChange=i.onPause=i.onResume=void 0),Hv(this,{type:"idle",parent:this});const n=e?Qb(this.get()):Yb(this.get(),uA(this,t??i.to));sv(this._pendingCalls,n),i.changed&&(i.changed=!1,vA(this,"onRest",n,this))}}};function uA(t,e){const i=jb(e);return Qw(jb(t.get()),i)}function pA(t,e=t.loop,i=t.to){const n=Rb(e);if(n){const s=!0!==n&&Wb(n),r=(s||t).reverse,a=!s||s.reset;return fA({...t,loop:e,default:!1,pause:void 0,to:!r||$b(i)?i:void 0,from:a?t.from:void 0,reset:a,...s})}}function fA(t){const{to:e,from:i}=t=Wb(t),n=new Set;return Yw.obj(e)&&mA(e,n),Yw.obj(i)&&mA(i,n),t.keys=n.size?Array.from(n):null,t}function gA(t){const e=fA(t);return Yw.und(e.default)&&(e.default=Fb(e)),e}function mA(t,e){Zw(t,(t,i)=>null!=t&&e.add(i))}var yA=["onStart","onRest","onChange","onPause","onResume"];function wA(t,e,i){t.animation[i]=e[i]!==Ob(e,i)?Ib(e[i],t.key):void 0}function vA(t,e,...i){t.animation[e]?.(...i),t.defaultProps[e]?.(...i)}var bA=["onStart","onChange","onRest"],AA=1,xA=class{constructor(t,e){this.id=AA++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),e&&(this._flush=e),t&&this.start({default:!0,...t})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(t=>t.idle&&!t.isDelayed&&!t.isPaused)}get item(){return this._item}set item(t){this._item=t}get(){const t={};return this.each((e,i)=>t[i]=e.get()),t}set(t){for(const e in t){const i=t[e];Yw.und(i)||this.springs[e].set(i)}}update(t){return t&&this.queue.push(fA(t)),this}start(t){let{queue:e}=this;return t?e=tv(t).map(fA):this.queue=[],this._flush?this._flush(this,e):(PA(this,e),_A(this,e))}stop(t,e){if(t!==!!t&&(e=t),e){const i=this.springs;Jw(tv(e),e=>i[e].stop(!!t))}else Zb(this._state,this._lastAsyncId),this.each(e=>e.stop(!!t));return this}pause(t){if(Yw.und(t))this.start({pause:!0});else{const e=this.springs;Jw(tv(t),t=>e[t].pause())}return this}resume(t){if(Yw.und(t))this.start({pause:!1});else{const e=this.springs;Jw(tv(t),t=>e[t].resume())}return this}each(t){Zw(this.springs,t)}_onFrame(){const{onStart:t,onChange:e,onRest:i}=this._events,n=this._active.size>0,s=this._changed.size>0;(n&&!this._started||s&&!this._started)&&(this._started=!0,ev(t,([t,e])=>{e.value=this.get(),t(e,this,this._item)}));const r=!n&&this._started,a=s||r&&i.size?this.get():null;s&&e.size&&ev(e,([t,e])=>{e.value=a,t(e,this,this._item)}),r&&(this._started=!1,ev(i,([t,e])=>{e.value=a,t(e,this,this._item)}))}eventObserved(t){if("change"==t.type)this._changed.add(t.parent),t.idle||this._active.add(t.parent);else{if("idle"!=t.type)return;this._active.delete(t.parent)}Tw.onFrame(this._onFrame)}};function _A(t,e){return Promise.all(e.map(e=>SA(t,e))).then(e=>Xb(t,e))}async function SA(t,e,i){const{keys:n,to:s,from:r,loop:a,onRest:o,onResolve:l}=e,h=Yw.obj(e.default)&&e.default;a&&(e.loop=!1),!1===s&&(e.to=null),!1===r&&(e.from=null);const c=Yw.arr(s)||Yw.fun(s)?s:void 0;c?(e.to=void 0,e.onRest=void 0,h&&(h.onRest=void 0)):Jw(bA,i=>{const n=e[i];if(Yw.fun(n)){const s=t._events[i];e[i]=({finished:t,cancelled:e})=>{const i=s.get(n);i?(t||(i.finished=!1),e&&(i.cancelled=!0)):s.set(n,{value:null,finished:t||!1,cancelled:e||!1})},h&&(h[i]=e[i])}});const d=t._state;e.pause===!d.paused?(d.paused=e.pause,sv(e.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(e.pause=!0);const u=(n||Object.keys(t.springs)).map(i=>t.springs[i].start(e)),p=!0===e.cancel||!0===Ob(e,"cancel");(c||p&&d.asyncId)&&u.push(qb(++t._lastAsyncId,{props:e,state:d,actions:{pause:Kw,resume:Kw,start(e,i){p?(Zb(d,t._lastAsyncId),i(Qb(t))):(e.onRest=o,i(Jb(c,e,d,t)))}}})),d.paused&&await new Promise(t=>{d.resumeQueue.add(t)});const f=Xb(t,await Promise.all(u));if(a&&f.finished&&(!i||!f.noop)){const i=pA(e,a,s);if(i)return PA(t,[i]),SA(t,i,!0)}return l&&Tw.batchedUpdates(()=>l(f,t,t.item)),f}function kA(t,e){const i={...t.springs};return e&&Jw(tv(e),t=>{Yw.und(t.keys)&&(t=fA(t)),Yw.obj(t.to)||(t={...t,to:void 0}),CA(i,t,t=>MA(t))}),EA(t,i),i}function EA(t,e){Zw(e,(e,i)=>{t.springs[i]||(t.springs[i]=e,Gv(e,t))})}function MA(t,e){const i=new dA;return i.key=t,e&&Gv(i,e),i}function CA(t,e,i){e.keys&&Jw(e.keys,n=>{(t[n]||(t[n]=i(n)))._prepareNode(e)})}function PA(t,e){Jw(e,e=>{CA(t.springs,e,e=>MA(e,t))})}var TA,RA,DA=({children:t,...e})=>{const i=Kd.useContext(IA),n=e.pause||!!i.pause,s=e.immediate||!!i.immediate;e=function(t,e){const[i]=Kd.useState(()=>({inputs:e,result:t()})),n=Kd.useRef(),s=n.current;let r=s;return r?Boolean(e&&r.inputs&&function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(e,r.inputs))||(r={inputs:e,result:t()}):r=i,Kd.useEffect(()=>{n.current=r,s==i&&(i.inputs=i.result=void 0)},[r]),r.result}(()=>({pause:n,immediate:s}),[n,s]);const{Provider:r}=IA;return Kd.createElement(r,{value:e},t)},IA=(TA=DA,RA={},Object.assign(TA,Kd.createContext(RA)),TA.Provider._context=TA,TA.Consumer._context=TA,TA);DA.Provider=IA.Provider,DA.Consumer=IA.Consumer;var OA=()=>{const t=[],e=function(e){lb(`${rb}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`);const n=[];return Jw(t,(t,s)=>{if(Yw.und(e))n.push(t.start());else{const r=i(e,t,s);r&&n.push(t.start(r))}}),n};e.current=t,e.add=function(e){t.includes(e)||t.push(e)},e.delete=function(e){const i=t.indexOf(e);~i&&t.splice(i,1)},e.pause=function(){return Jw(t,t=>t.pause(...arguments)),this},e.resume=function(){return Jw(t,t=>t.resume(...arguments)),this},e.set=function(e){Jw(t,(t,i)=>{const n=Yw.fun(e)?e(i,t):e;n&&t.set(n)})},e.start=function(e){const i=[];return Jw(t,(t,n)=>{if(Yw.und(e))i.push(t.start());else{const s=this._getProps(e,t,n);s&&i.push(t.start(s))}}),i},e.stop=function(){return Jw(t,t=>t.stop(...arguments)),this},e.update=function(e){return Jw(t,(t,i)=>t.update(this._getProps(e,t,i))),this};const i=function(t,e,i){return Yw.fun(t)?t(i,e):t};return e._getProps=i,e};function LA(t,e,i){const n=Yw.fun(e)&&e;n&&!i&&(i=[]);const s=Kd.useMemo(()=>n||3==arguments.length?OA():void 0,[]),r=Kd.useRef(0),a=db(),o=Kd.useMemo(()=>({ctrls:[],queue:[],flush(t,e){const i=kA(t,e);return r.current>0&&!o.queue.length&&!Object.keys(i).some(e=>!t.springs[e])?_A(t,e):new Promise(n=>{EA(t,i),o.queue.push(()=>{n(_A(t,e))}),a()})}}),[]),l=Kd.useRef([...o.ctrls]),h=[],c=fb(t)||0;function d(t,i){for(let s=t;s<i;s++){const t=l.current[s]||(l.current[s]=new xA(null,o.flush)),i=n?n(s,t):e[s];i&&(h[s]=gA(i))}}Kd.useMemo(()=>{Jw(l.current.slice(t,c),t=>{!function(t,e){t.ref?.delete(t),e?.delete(t)}(t,s),t.stop(!0)}),l.current.length=t,d(c,t)},[t]),Kd.useMemo(()=>{d(0,Math.min(c,t))},i);const u=l.current.map((t,e)=>kA(t,h[e])),p=Kd.useContext(DA),f=fb(p),g=p!==f&&function(t){for(const e in t)return!0;return!1}(p);cb(()=>{r.current++,o.ctrls=l.current;const{queue:t}=o;t.length&&(o.queue=[],Jw(t,t=>t())),Jw(l.current,(t,e)=>{s?.add(t),g&&t.start({default:p});const i=h[e];i&&(function(t,e){e&&t.ref!==e&&(t.ref?.delete(t),e.add(t),t.ref=e)}(t,i.ref),t.ref?t.queue.push(i):t.start(i))})}),ub(()=>()=>{Jw(o.ctrls,t=>t.stop(!0))});const m=u.map(t=>({...t}));return s?[m,s]:m}var FA=class extends sA{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=Nv(...e);const i=this._get(),n=Eb(i);yb(this,n.create(i))}advance(t){const e=this._get();Qw(e,this.get())||(mb(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&BA(this._active)&&WA(this)}_get(){const t=Yw.arr(this.source)?this.source.map($v):tv($v(this.source));return this.calc(...t)}_start(){this.idle&&!BA(this._active)&&(this.idle=!1,Jw(wb(this),t=>{t.done=!1}),Xw.skipAnimation?(Tw.batchedUpdates(()=>this.advance()),WA(this)):fv.start(this))}_attach(){let t=1;Jw(tv(this.source),e=>{jv(e)&&Gv(e,this),iA(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){Jw(tv(this.source),t=>{jv(t)&&qv(t,this)}),this._active.clear(),WA(this)}eventObserved(t){"change"==t.type?t.idle?this.advance():(this._active.add(t.parent),this._start()):"idle"==t.type?this._active.delete(t.parent):"priority"==t.type&&(this.priority=tv(this.source).reduce((t,e)=>Math.max(t,(iA(e)?e.priority:0)+1),0))}};function NA(t){return!1!==t.idle}function BA(t){return!t.size||Array.from(t).every(NA)}function WA(t){t.idle||(t.idle=!0,Jw(wb(t),t=>{t.done=!0}),Hv(t,{type:"idle",parent:t}))}Xw.assign({createStringInterpolator:sb,to:(t,e)=>new FA(t,e)});var jA=/^--/;function $A(t,e){return null==e||"boolean"==typeof e||""===e?"":"number"!=typeof e||0===e||jA.test(t)||HA.hasOwnProperty(t)&&HA[t]?(""+e).trim():e+"px"}var UA={},HA={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zA=["Webkit","Ms","Moz","O"];HA=Object.keys(HA).reduce((t,e)=>(zA.forEach(i=>t[((t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1))(i,e)]=t[e]),t),HA);var VA=/^(matrix|translate|scale|rotate|skew)/,GA=/^(translate)/,qA=/^(rotate|skew)/,XA=(t,e)=>Yw.num(t)&&0!==t?t+e:t,KA=(t,e)=>Yw.arr(t)?t.every(t=>KA(t,e)):Yw.num(t)?t===e:parseFloat(t)===e,YA=class extends _b{constructor({x:t,y:e,z:i,...n}){const s=[],r=[];(t||e||i)&&(s.push([t||0,e||0,i||0]),r.push(t=>[`translate3d(${t.map(t=>XA(t,"px")).join(",")})`,KA(t,0)])),Zw(n,(t,e)=>{if("transform"===e)s.push([t||""]),r.push(t=>[t,""===t]);else if(VA.test(e)){if(delete n[e],Yw.und(t))return;const i=GA.test(e)?"px":qA.test(e)?"deg":"";s.push(tv(t)),r.push("rotate3d"===e?([t,e,n,s])=>[`rotate3d(${t},${e},${n},${XA(s,i)})`,KA(s,0)]:t=>[`${e}(${t.map(t=>XA(t,i)).join(",")})`,KA(t,e.startsWith("scale")?1:0)])}}),s.length&&(n.transform=new QA(s,r)),super(n)}},QA=class extends zv{constructor(t,e){super(),this.inputs=t,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let t="",e=!0;return Jw(this.inputs,(i,n)=>{const s=$v(i[0]),[r,a]=this.transforms[n](Yw.arr(s)?s:i.map($v));t+=" "+r,e=e&&a}),e?"none":t}observerAdded(t){1==t&&Jw(this.inputs,t=>Jw(t,t=>jv(t)&&Gv(t,this)))}observerRemoved(t){0==t&&Jw(this.inputs,t=>Jw(t,t=>jv(t)&&qv(t,this)))}eventObserved(t){"change"==t.type&&(this._value=null),Hv(this,t)}};Xw.assign({batchedUpdates:Yd.unstable_batchedUpdates,createStringInterpolator:sb,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199}});var JA=((t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:i=t=>new _b(t),getComponentProps:n=t=>t}={})=>{const s={applyAnimatedValues:e,createAnimatedStyle:i,getComponentProps:n},r=t=>{const e=Tb(t)||"Anonymous";return(t=Yw.str(t)?r[t]||(r[t]=Mb(t,s)):t[Pb]||(t[Pb]=Mb(t,s))).displayName=`Animated(${e})`,t};return Zw(t,(e,i)=>{Yw.arr(t)&&(i=Tb(e)),r[i]=r(e)}),{animated:r}})(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],{applyAnimatedValues:function(t,e){if(!t.nodeType||!t.setAttribute)return!1;const i="filter"===t.nodeName||t.parentNode&&"filter"===t.parentNode.nodeName,{className:n,style:s,children:r,scrollTop:a,scrollLeft:o,viewBox:l,...h}=e,c=Object.values(h),d=Object.keys(h).map(e=>i||t.hasAttribute(e)?e:UA[e]||(UA[e]=e.replace(/([A-Z])/g,t=>"-"+t.toLowerCase())));void 0!==r&&(t.textContent=r);for(const u in s)if(s.hasOwnProperty(u)){const e=$A(u,s[u]);jA.test(u)?t.style.setProperty(u,e):t.style[u]=e}d.forEach((e,i)=>{t.setAttribute(e,c[i])}),void 0!==n&&(t.className=n),void 0!==a&&(t.scrollTop=a),void 0!==o&&(t.scrollLeft=o),void 0!==l&&t.setAttribute("viewBox",l)},createAnimatedStyle:t=>new YA(t),getComponentProps:({scrollTop:t,scrollLeft:e,...i})=>i}).animated;let ZA,tx={};function ex(t={}){tx={animate:!0,allowClose:!0,overlayClickBehavior:"close",overlayOpacity:.7,smoothScroll:!1,disableActiveInteraction:!1,showProgress:!1,stagePadding:10,stageRadius:5,popoverOffset:10,showButtons:["next","previous","close"],disableButtons:[],overlayColor:"#000",...t}}function ix(t){return t?tx[t]:tx}function nx(){return ZA}let sx={};function rx(t,e){sx[t]=e}function ax(t){var e;null==(e=sx[t])||e.call(sx)}function ox(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e}function lx(t){const e='a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])';return t.flatMap(t=>{const i=t.matches(e),n=Array.from(t.querySelectorAll(e));return[...i?[t]:[],...n]}).filter(t=>"none"!==getComputedStyle(t).pointerEvents&&function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}(t))}function hx(t){if(!t||function(t){const e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}(t))return;const e=ix("smoothScroll"),i=t.offsetHeight>window.innerHeight;t.scrollIntoView({behavior:!e||cx(t)?"auto":"smooth",inline:"center",block:i?"start":"center"})}function cx(t){if(!t||!t.parentElement)return;const e=t.parentElement;return e.scrollHeight>e.clientHeight}let dx={};function ux(t,e){dx[t]=e}function px(t){return t?dx[t]:dx}function fx(){dx={}}function gx(t){if(!t)return;const e=t.getBoundingClientRect(),i={x:e.x,y:e.y,width:e.width,height:e.height};ux("__activeStagePosition",i),mx(i)}function mx(t){const e=px("__overlaySvg");if(!e)return void function(t){const e=function(t){const e=window.innerWidth,i=window.innerHeight,n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.classList.add("driver-overlay","driver-overlay-animated"),n.setAttribute("viewBox",`0 0 ${e} ${i}`),n.setAttribute("xmlSpace","preserve"),n.setAttribute("xmlnsXlink","http://www.w3.org/1999/xlink"),n.setAttribute("version","1.1"),n.setAttribute("preserveAspectRatio","xMinYMin slice"),n.style.fillRule="evenodd",n.style.clipRule="evenodd",n.style.strokeLinejoin="round",n.style.strokeMiterlimit="2",n.style.zIndex="10000",n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="100%",n.style.height="100%";const s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",yx(t)),s.style.fill=ix("overlayColor")||"rgb(0,0,0)",s.style.opacity=`${ix("overlayOpacity")}`,s.style.pointerEvents="auto",s.style.cursor="auto",n.appendChild(s),n}(t);document.body.appendChild(e),_x(e,t=>{"path"===t.target.tagName&&ax("overlayClick")}),ux("__overlaySvg",e)}(t);const i=e.firstElementChild;if("path"!==(null==i?void 0:i.tagName))throw new Error("no path element found in stage svg");i.setAttribute("d",yx(t))}function yx(t){const e=window.innerWidth,i=window.innerHeight,n=ix("stagePadding")||0,s=ix("stageRadius")||0,r=t.width+2*n,a=t.height+2*n,o=Math.min(s,r/2,a/2),l=Math.floor(Math.max(o,0)),h=r-2*l,c=a-2*l;return`M${e},0L0,0L0,${i}L${e},${i}L${e},0Z\n    M${t.x-n+l},${t.y-n} h${h} a${l},${l} 0 0 1 ${l},${l} v${c} a${l},${l} 0 0 1 -${l},${l} h-${h} a${l},${l} 0 0 1 -${l},-${l} v-${c} a${l},${l} 0 0 1 ${l},-${l} z`}function wx(t){const{element:e}=t;let i="function"==typeof e?e():"string"==typeof e?document.querySelector(e):e;i||(i=function(){const t=document.getElementById("driver-dummy-element");if(t)return t;let e=document.createElement("div");return e.id="driver-dummy-element",e.style.width="0",e.style.height="0",e.style.pointerEvents="none",e.style.opacity="0",e.style.position="fixed",e.style.top="50%",e.style.left="50%",document.body.appendChild(e),e}()),function(t,e){var i;const n=Date.now(),s=px("__activeStep"),r=px("__activeElement")||t,a=!r||r===t,o="driver-dummy-element"===t.id,l="driver-dummy-element"===r.id,h=ix("animate"),c=e.onHighlightStarted||ix("onHighlightStarted"),d=(null==e?void 0:e.onHighlighted)||ix("onHighlighted"),u=(null==s?void 0:s.onDeselected)||ix("onDeselected"),p=ix(),f=px();!a&&u&&u(l?void 0:r,s,{config:p,state:f,driver:nx()}),c&&c(o?void 0:t,e,{config:p,state:f,driver:nx()});const g=!a&&h;let m=!1;(function(){const t=px("popover");t&&(t.wrapper.style.display="none")})(),ux("previousStep",s),ux("previousElement",r),ux("activeStep",e),ux("activeElement",t);const y=()=>{if(px("__transitionCallback")!==y)return;const i=Date.now()-n,a=400-i<=200;e.popover&&a&&!m&&g&&(Sx(t,e),m=!0),ix("animate")&&i<400?function(t,e,i,n){let s=px("__activeStagePosition");const r=s||i.getBoundingClientRect(),a=n.getBoundingClientRect();s={x:ox(t,r.x,a.x-r.x,e),y:ox(t,r.y,a.y-r.y,e),width:ox(t,r.width,a.width-r.width,e),height:ox(t,r.height,a.height-r.height,e)},mx(s),ux("__activeStagePosition",s)}(i,400,r,t):(gx(t),d&&d(o?void 0:t,e,{config:ix(),state:px(),driver:nx()}),ux("__transitionCallback",void 0),ux("__previousStep",s),ux("__previousElement",r),ux("__activeStep",e),ux("__activeElement",t)),window.requestAnimationFrame(y)};ux("__transitionCallback",y),window.requestAnimationFrame(y),hx(t),!g&&e.popover&&Sx(t,e),r.classList.remove("driver-active-element","driver-no-interaction"),r.removeAttribute("aria-haspopup"),r.removeAttribute("aria-expanded"),r.removeAttribute("aria-controls"),(null!=(i=e.disableActiveInteraction)?i:ix("disableActiveInteraction"))&&t.classList.add("driver-no-interaction"),t.classList.add("driver-active-element"),t.setAttribute("aria-haspopup","dialog"),t.setAttribute("aria-expanded","true"),t.setAttribute("aria-controls","driver-popover-content")}(i,t)}function vx(){const t=px("__activeElement"),e=px("__activeStep");t&&(gx(t),function(){const t=px("__activeStagePosition"),e=px("__overlaySvg");if(!t)return;if(!e)return;const i=window.innerWidth,n=window.innerHeight;e.setAttribute("viewBox",`0 0 ${i} ${n}`)}(),Cx(t,e))}function bx(){const t=px("__resizeTimeout");t&&window.cancelAnimationFrame(t),ux("__resizeTimeout",window.requestAnimationFrame(vx))}function Ax(t){var e;if(!px("isInitialized")||"Tab"!==t.key&&9!==t.keyCode)return;const i=px("__activeElement"),n=null==(e=px("popover"))?void 0:e.wrapper,s=lx([...n?[n]:[],...i?[i]:[]]),r=s[0],a=s[s.length-1];if(t.preventDefault(),t.shiftKey){const t=s[s.indexOf(document.activeElement)-1]||a;null==t||t.focus()}else{const t=s[s.indexOf(document.activeElement)+1]||r;null==t||t.focus()}}function xx(t){var e;(null==(e=ix("allowKeyboardControl"))||e)&&("Escape"===t.key?ax("escapePress"):"ArrowRight"===t.key?ax("arrowRightPress"):"ArrowLeft"===t.key&&ax("arrowLeftPress"))}function _x(t,e,i){const n=(e,n)=>{const s=e.target;t.contains(s)&&((!i||i(s))&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()),null==n||n(e))};document.addEventListener("pointerdown",n,!0),document.addEventListener("mousedown",n,!0),document.addEventListener("pointerup",n,!0),document.addEventListener("mouseup",n,!0),document.addEventListener("click",t=>{n(t,e)},!0)}function Sx(t,e){var i,n;let s=px("popover");s&&document.body.removeChild(s.wrapper),s=function(){const t=document.createElement("div");t.classList.add("driver-popover");const e=document.createElement("div");e.classList.add("driver-popover-arrow");const i=document.createElement("header");i.id="driver-popover-title",i.classList.add("driver-popover-title"),i.style.display="none",i.innerText="Popover Title";const n=document.createElement("div");n.id="driver-popover-description",n.classList.add("driver-popover-description"),n.style.display="none",n.innerText="Popover description is here";const s=document.createElement("button");s.type="button",s.classList.add("driver-popover-close-btn"),s.setAttribute("aria-label","Close"),s.innerHTML="&times;";const r=document.createElement("footer");r.classList.add("driver-popover-footer");const a=document.createElement("span");a.classList.add("driver-popover-progress-text"),a.innerText="";const o=document.createElement("span");o.classList.add("driver-popover-navigation-btns");const l=document.createElement("button");l.type="button",l.classList.add("driver-popover-prev-btn"),l.innerHTML="&larr; Previous";const h=document.createElement("button");return h.type="button",h.classList.add("driver-popover-next-btn"),h.innerHTML="Next &rarr;",o.appendChild(l),o.appendChild(h),r.appendChild(a),r.appendChild(o),t.appendChild(s),t.appendChild(e),t.appendChild(i),t.appendChild(n),t.appendChild(r),{wrapper:t,arrow:e,title:i,description:n,footer:r,previousButton:l,nextButton:h,closeButton:s,footerButtons:o,progress:a}}(),document.body.appendChild(s.wrapper);const{title:r,description:a,showButtons:o,disableButtons:l,showProgress:h,nextBtnText:c=ix("nextBtnText")||"Next &rarr;",prevBtnText:d=ix("prevBtnText")||"&larr; Previous",progressText:u=ix("progressText")||"{current} of {total}"}=e.popover||{};s.nextButton.innerHTML=c,s.previousButton.innerHTML=d,s.progress.innerHTML=u,r?(s.title.innerHTML=r,s.title.style.display="block"):s.title.style.display="none",a?(s.description.innerHTML=a,s.description.style.display="block"):s.description.style.display="none";const p=o||ix("showButtons"),f=h||ix("showProgress")||!1,g=(null==p?void 0:p.includes("next"))||(null==p?void 0:p.includes("previous"))||f;s.closeButton.style.display=p.includes("close")?"block":"none",g?(s.footer.style.display="flex",s.progress.style.display=f?"block":"none",s.nextButton.style.display=p.includes("next")?"block":"none",s.previousButton.style.display=p.includes("previous")?"block":"none"):s.footer.style.display="none";const m=l||ix("disableButtons")||[];null!=m&&m.includes("next")&&(s.nextButton.disabled=!0,s.nextButton.classList.add("driver-popover-btn-disabled")),null!=m&&m.includes("previous")&&(s.previousButton.disabled=!0,s.previousButton.classList.add("driver-popover-btn-disabled")),null!=m&&m.includes("close")&&(s.closeButton.disabled=!0,s.closeButton.classList.add("driver-popover-btn-disabled"));const y=s.wrapper;y.style.display="block",y.style.left="",y.style.top="",y.style.bottom="",y.style.right="",y.id="driver-popover-content",y.setAttribute("role","dialog"),y.setAttribute("aria-labelledby","driver-popover-title"),y.setAttribute("aria-describedby","driver-popover-description"),s.arrow.className="driver-popover-arrow";const w=(null==(i=e.popover)?void 0:i.popoverClass)||ix("popoverClass")||"";y.className=`driver-popover ${w}`.trim(),_x(s.wrapper,i=>{var n,s,r;const a=i.target,o=(null==(n=e.popover)?void 0:n.onNextClick)||ix("onNextClick"),l=(null==(s=e.popover)?void 0:s.onPrevClick)||ix("onPrevClick"),h=(null==(r=e.popover)?void 0:r.onCloseClick)||ix("onCloseClick");return a.closest(".driver-popover-next-btn")?o?o(t,e,{config:ix(),state:px(),driver:nx()}):ax("nextClick"):a.closest(".driver-popover-prev-btn")?l?l(t,e,{config:ix(),state:px(),driver:nx()}):ax("prevClick"):a.closest(".driver-popover-close-btn")?h?h(t,e,{config:ix(),state:px(),driver:nx()}):ax("closeClick"):void 0},t=>!(null!=s&&s.description.contains(t))&&!(null!=s&&s.title.contains(t))&&"string"==typeof t.className&&t.className.includes("driver-popover")),ux("popover",s);const v=(null==(n=e.popover)?void 0:n.onPopoverRender)||ix("onPopoverRender");v&&v(s,{config:ix(),state:px(),driver:nx()}),Cx(t,e),hx(y);const b=lx([y,...t.classList.contains("driver-dummy-element")?[]:[t]]);b.length>0&&b[0].focus()}function kx(){const t=px("popover");if(null==t||!t.wrapper)return;const e=t.wrapper.getBoundingClientRect(),i=ix("stagePadding")||0,n=ix("popoverOffset")||0;return{width:e.width+i+n,height:e.height+i+n,realWidth:e.width,realHeight:e.height}}function Ex(t,e){const{elementDimensions:i,popoverDimensions:n,popoverPadding:s,popoverArrowDimensions:r}=e;return"start"===t?Math.max(Math.min(i.top-s,window.innerHeight-n.realHeight-r.width),r.width):"end"===t?Math.max(Math.min(i.top-(null==n?void 0:n.realHeight)+i.height+s,window.innerHeight-(null==n?void 0:n.realHeight)-r.width),r.width):"center"===t?Math.max(Math.min(i.top+i.height/2-(null==n?void 0:n.realHeight)/2,window.innerHeight-(null==n?void 0:n.realHeight)-r.width),r.width):0}function Mx(t,e){const{elementDimensions:i,popoverDimensions:n,popoverPadding:s,popoverArrowDimensions:r}=e;return"start"===t?Math.max(Math.min(i.left-s,window.innerWidth-n.realWidth-r.width),r.width):"end"===t?Math.max(Math.min(i.left-(null==n?void 0:n.realWidth)+i.width+s,window.innerWidth-(null==n?void 0:n.realWidth)-r.width),r.width):"center"===t?Math.max(Math.min(i.left+i.width/2-(null==n?void 0:n.realWidth)/2,window.innerWidth-(null==n?void 0:n.realWidth)-r.width),r.width):0}function Cx(t,e){const i=px("popover");if(!i)return;const{align:n="start",side:s="left"}=(null==e?void 0:e.popover)||{},r=n,a="driver-dummy-element"===t.id?"over":s,o=ix("stagePadding")||0,l=kx(),h=i.arrow.getBoundingClientRect(),c=t.getBoundingClientRect(),d=c.top-l.height;let u=d>=0;const p=window.innerHeight-(c.bottom+l.height);let f=p>=0;const g=c.left-l.width;let m=g>=0;const y=window.innerWidth-(c.right+l.width);let w=y>=0;const v=!(u||f||m||w);let b=a;if("top"===a&&u?w=m=f=!1:"bottom"===a&&f?w=m=u=!1:"left"===a&&m?w=u=f=!1:"right"===a&&w&&(m=u=f=!1),"over"===a){const t=window.innerWidth/2-l.realWidth/2,e=window.innerHeight/2-l.realHeight/2;i.wrapper.style.left=`${t}px`,i.wrapper.style.right="auto",i.wrapper.style.top=`${e}px`,i.wrapper.style.bottom="auto"}else if(v){const t=window.innerWidth/2-(null==l?void 0:l.realWidth)/2,e=10;i.wrapper.style.left=`${t}px`,i.wrapper.style.right="auto",i.wrapper.style.bottom=`${e}px`,i.wrapper.style.top="auto"}else if(m){const t=Math.min(g,window.innerWidth-(null==l?void 0:l.realWidth)-h.width),e=Ex(r,{elementDimensions:c,popoverDimensions:l,popoverPadding:o,popoverArrowDimensions:h});i.wrapper.style.left=`${t}px`,i.wrapper.style.top=`${e}px`,i.wrapper.style.bottom="auto",i.wrapper.style.right="auto",b="left"}else if(w){const t=Math.min(y,window.innerWidth-(null==l?void 0:l.realWidth)-h.width),e=Ex(r,{elementDimensions:c,popoverDimensions:l,popoverPadding:o,popoverArrowDimensions:h});i.wrapper.style.right=`${t}px`,i.wrapper.style.top=`${e}px`,i.wrapper.style.bottom="auto",i.wrapper.style.left="auto",b="right"}else if(u){const t=Math.min(d,window.innerHeight-l.realHeight-h.width);let e=Mx(r,{elementDimensions:c,popoverDimensions:l,popoverPadding:o,popoverArrowDimensions:h});i.wrapper.style.top=`${t}px`,i.wrapper.style.left=`${e}px`,i.wrapper.style.bottom="auto",i.wrapper.style.right="auto",b="top"}else if(f){const t=Math.min(p,window.innerHeight-(null==l?void 0:l.realHeight)-h.width);let e=Mx(r,{elementDimensions:c,popoverDimensions:l,popoverPadding:o,popoverArrowDimensions:h});i.wrapper.style.left=`${e}px`,i.wrapper.style.bottom=`${t}px`,i.wrapper.style.top="auto",i.wrapper.style.right="auto",b="bottom"}v?i.arrow.classList.add("driver-popover-arrow-none"):function(t,e,i){const n=px("popover");if(!n)return;const s=i.getBoundingClientRect(),r=kx(),a=n.arrow,o=r.width,l=window.innerWidth,h=s.width,c=s.left,d=r.height,u=window.innerHeight,p=s.top,f=s.height;a.className="driver-popover-arrow";let g=e,m=t;if("top"===e?(c+h<=0?(g="right",m="end"):c+h-o<=0&&(g="top",m="start"),c>=l?(g="left",m="end"):c+o>=l&&(g="top",m="end")):"bottom"===e?(c+h<=0?(g="right",m="start"):c+h-o<=0&&(g="bottom",m="start"),c>=l?(g="left",m="start"):c+o>=l&&(g="bottom",m="end")):"left"===e?(p+f<=0?(g="bottom",m="end"):p+f-d<=0&&(g="left",m="start"),p>=u?(g="top",m="end"):p+d>=u&&(g="left",m="end")):"right"===e&&(p+f<=0?(g="bottom",m="start"):p+f-d<=0&&(g="right",m="start"),p>=u?(g="top",m="start"):p+d>=u&&(g="right",m="end")),g){a.classList.add(`driver-popover-arrow-side-${g}`),a.classList.add(`driver-popover-arrow-align-${m}`);const t=i.getBoundingClientRect(),s=a.getBoundingClientRect(),r=ix("stagePadding")||0,o=t.left-r<window.innerWidth&&t.right+r>0&&t.top-r<window.innerHeight&&t.bottom+r>0;"bottom"===e&&o&&(s.x>t.x&&s.x+s.width<t.x+t.width?n.wrapper.style.transform="translateY(0)":(a.classList.remove(`driver-popover-arrow-align-${m}`),a.classList.add("driver-popover-arrow-none"),n.wrapper.style.transform=`translateY(-${r/2}px)`))}else a.classList.add("driver-popover-arrow-none")}(r,b,t)}function Px(t={}){function e(){ix("allowClose")&&h()}function i(){const t=ix("overlayClickBehavior");if(ix("allowClose")&&"close"===t)h();else{if("function"==typeof t){const e=px("__activeStep");return void t(px("__activeElement"),e,{config:ix(),state:px(),driver:nx()})}"nextStep"===t&&n()}}function n(){const t=px("activeIndex"),e=ix("steps")||[];if(void 0===t)return;const i=t+1;e[i]?l(i):h()}function s(){const t=px("activeIndex"),e=ix("steps")||[];if(void 0===t)return;const i=t-1;e[i]?l(i):h()}function r(){var t;if(px("__transitionCallback"))return;const e=px("activeIndex"),i=px("__activeStep"),n=px("__activeElement");if(void 0===e||void 0===i||void 0===px("activeIndex"))return;const r=(null==(t=i.popover)?void 0:t.onPrevClick)||ix("onPrevClick");if(r)return r(n,i,{config:ix(),state:px(),driver:nx()});s()}function a(){var t;if(px("__transitionCallback"))return;const e=px("activeIndex"),i=px("__activeStep"),s=px("__activeElement");if(void 0===e||void 0===i)return;const r=(null==(t=i.popover)?void 0:t.onNextClick)||ix("onNextClick");if(r)return r(s,i,{config:ix(),state:px(),driver:nx()});n()}function o(){px("isInitialized")||(ux("isInitialized",!0),document.body.classList.add("driver-active",ix("animate")?"driver-fade":"driver-simple"),window.addEventListener("keyup",xx,!1),window.addEventListener("keydown",Ax,!1),window.addEventListener("resize",bx),window.addEventListener("scroll",bx),rx("overlayClick",i),rx("escapePress",e),rx("arrowLeftPress",r),rx("arrowRightPress",a))}function l(t=0){var e,i,n,s,r,a,o,c;const d=ix("steps");if(!d)return void h();if(!d[t])return void h();ux("__activeOnDestroyed",document.activeElement),ux("activeIndex",t);const u=d[t],p=d[t+1],f=d[t-1],g=(null==(e=u.popover)?void 0:e.doneBtnText)||ix("doneBtnText")||"Done",m=ix("allowClose"),y=void 0!==(null==(i=u.popover)?void 0:i.showProgress)?null==(n=u.popover)?void 0:n.showProgress:ix("showProgress"),w=((null==(s=u.popover)?void 0:s.progressText)||ix("progressText")||"{{current}} of {{total}}").replace("{{current}}",`${t+1}`).replace("{{total}}",`${d.length}`),v=(null==(r=u.popover)?void 0:r.showButtons)||ix("showButtons"),b=["next","previous",...m?["close"]:[]].filter(t=>!(null!=v&&v.length)||v.includes(t)),A=(null==(a=u.popover)?void 0:a.onNextClick)||ix("onNextClick"),x=(null==(o=u.popover)?void 0:o.onPrevClick)||ix("onPrevClick"),_=(null==(c=u.popover)?void 0:c.onCloseClick)||ix("onCloseClick");wx({...u,popover:{showButtons:b,nextBtnText:p?void 0:g,disableButtons:[...f?[]:["previous"]],showProgress:y,progressText:w,onNextClick:A||(()=>{p?l(t+1):h()}),onPrevClick:x||(()=>{l(t-1)}),onCloseClick:_||(()=>{h()}),...(null==u?void 0:u.popover)||{}}})}function h(t=!0){const e=px("__activeElement"),i=px("__activeStep"),n=px("__activeOnDestroyed"),s=ix("onDestroyStarted");if(t&&s)return void s(e&&"driver-dummy-element"!==(null==e?void 0:e.id)?e:void 0,i,{config:ix(),state:px(),driver:nx()});const r=(null==i?void 0:i.onDeselected)||ix("onDeselected"),a=ix("onDestroyed");if(document.body.classList.remove("driver-active","driver-fade","driver-simple"),window.removeEventListener("keyup",xx),window.removeEventListener("resize",bx),window.removeEventListener("scroll",bx),function(){var t;const e=px("popover");e&&(null==(t=e.wrapper.parentElement)||t.removeChild(e.wrapper))}(),function(){var t;null==(t=document.getElementById("driver-dummy-element"))||t.remove(),document.querySelectorAll(".driver-active-element").forEach(t=>{t.classList.remove("driver-active-element","driver-no-interaction"),t.removeAttribute("aria-haspopup"),t.removeAttribute("aria-expanded"),t.removeAttribute("aria-controls")})}(),function(){const t=px("__overlaySvg");t&&t.remove()}(),sx={},fx(),e&&i){const t="driver-dummy-element"===e.id;r&&r(t?void 0:e,i,{config:ix(),state:px(),driver:nx()}),a&&a(t?void 0:e,i,{config:ix(),state:px(),driver:nx()})}n&&n.focus()}ex(t);const c={isActive:()=>px("isInitialized")||!1,refresh:bx,drive:(t=0)=>{o(),l(t)},setConfig:ex,setSteps:t=>{fx(),ex({...ix(),steps:t})},getConfig:ix,getState:px,getActiveIndex:()=>px("activeIndex"),isFirstStep:()=>0===px("activeIndex"),isLastStep:()=>{const t=ix("steps")||[],e=px("activeIndex");return void 0!==e&&e===t.length-1},getActiveStep:()=>px("activeStep"),getActiveElement:()=>px("activeElement"),getPreviousElement:()=>px("previousElement"),getPreviousStep:()=>px("previousStep"),moveNext:n,movePrevious:s,moveTo:function(t){(ix("steps")||[])[t]?l(t):h()},hasNextStep:()=>{const t=ix("steps")||[],e=px("activeIndex");return void 0!==e&&!!t[e+1]},hasPreviousStep:()=>{const t=ix("steps")||[],e=px("activeIndex");return void 0!==e&&!!t[e-1]},highlight:t=>{o(),wx({...t,popover:t.popover?{showButtons:[],showProgress:!1,progressText:"",...t.popover}:void 0})},destroy:()=>{h(!1)}};return function(t){ZA=t}(c),c}const Tx=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type),Rx=[.001,0,0,.001,0,0],Dx=1.35,Ix={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ox="pdfjs_internal_editor_",Lx={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Fx={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Nx={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Bx={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Wx={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},jx={ERRORS:0,WARNINGS:1,INFOS:5},$x={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ux={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Hx=jx.WARNINGS;function zx(){return Hx}function Vx(t){}function Gx(t){throw new Error(t)}function qx(t,e){t||Gx(e)}function Xx(t,e=null,i=null){if(!t)return null;if(i&&"string"==typeof t){if(i.addDefaultProtocol&&t.startsWith("www.")){const e=t.match(/\./g);e?.length>=2&&(t=`http://${t}`)}if(i.tryConvertEncoding)try{t=decodeURIComponent(escape(t))}catch{}}const n=e?URL.parse(t,e):URL.parse(t);return function(t){switch(t?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n)?n:null}function Kx(t,e,i=!1){const n=URL.parse(t);return n?(n.hash=e,n.href):i&&Xx(t,"http://example.com")?t.split("#",1)[0]+""+(e?`#${e}`:""):""}function Yx(t,e,i,n=!1){return Object.defineProperty(t,e,{value:i,enumerable:!n,configurable:!0,writable:!1}),i}const Qx=function(){function t(t,e){this.message=t,this.name=e}return t.prototype=new Error,t.constructor=t,t}();class Jx extends Qx{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Zx extends Qx{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class t_ extends Qx{constructor(t){super(t,"InvalidPDFException")}}class e_ extends Qx{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class i_ extends Qx{constructor(t){super(t,"FormatError")}}class n_ extends Qx{constructor(t){super(t,"AbortException")}}function s_(t){"object"==typeof t&&void 0!==t?.length||Gx("Invalid argument for bytesToString");const e=t.length,i=8192;if(e<i)return String.fromCharCode.apply(null,t);const n=[];for(let s=0;s<e;s+=i){const r=Math.min(s+i,e),a=t.subarray(s,r);n.push(String.fromCharCode.apply(null,a))}return n.join("")}function r_(t){"string"!=typeof t&&Gx("Invalid argument for stringToBytes");const e=t.length,i=new Uint8Array(e);for(let n=0;n<e;++n)i[n]=255&t.charCodeAt(n);return i}class a_{static get isLittleEndian(){return Yx(this,"isLittleEndian",function(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return Yx(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return Yx(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get isImageDecoderSupported(){return Yx(this,"isImageDecoderSupported","undefined"!=typeof ImageDecoder)}static get platform(){const{platform:t,userAgent:e}=navigator;return Yx(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Yx(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const o_=Array.from(Array(256).keys(),t=>t.toString(16).padStart(2,"0"));class l_{static makeHexColor(t,e,i){return`#${o_[t]}${o_[e]}${o_[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const n=t[i],s=t[i+1];t[i]=n*e[0]+s*e[2]+e[4],t[i+1]=n*e[1]+s*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],l=e[5];for(let h=0;h<6;h+=2){const e=t[i+h],c=t[i+h+1];t[i+h]=e*n+c*r+o,t[i+h+1]=e*s+c*a+l}}static applyInverseTransform(t,e){const i=t[0],n=t[1],s=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-n*e[2]+e[2]*e[5]-e[4]*e[3])/s,t[1]=(-i*e[1]+n*e[0]+e[4]*e[1]-e[5]*e[0])/s}static axialAlignedBoundingBox(t,e,i){const n=e[0],s=e[1],r=e[2],a=e[3],o=e[4],l=e[5],h=t[0],c=t[1],d=t[2],u=t[3];let p=n*h+o,f=p,g=n*d+o,m=g,y=a*c+l,w=y,v=a*u+l,b=v;if(0!==s||0!==r){const t=s*h,e=s*d,i=r*c,n=r*u;p+=i,m+=i,g+=n,f+=n,y+=t,b+=t,v+=e,w+=e}i[0]=Math.min(i[0],p,g,f,m),i[1]=Math.min(i[1],y,v,w,b),i[2]=Math.max(i[2],p,g,f,m),i[3]=Math.max(i[3],y,v,w,b)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],n=t[1],s=t[2],r=t[3],a=i**2+n**2,o=i*s+n*r,l=s**2+r**2,h=(a+l)/2,c=Math.sqrt(h**2-(a*l-o**2));e[0]=Math.sqrt(h+c||1),e[1]=Math.sqrt(h-c||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),n=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>n)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),r=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>r?null:[i,s,n,r]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,n,s){s[0]=Math.min(s[0],t,i),s[1]=Math.min(s[1],e,n),s[2]=Math.max(s[2],t,i),s[3]=Math.max(s[3],e,n)}static bezierBoundingBox(e,n,s,r,a,o,l,h,c){c[0]=Math.min(c[0],e,l),c[1]=Math.min(c[1],n,h),c[2]=Math.max(c[2],e,l),c[3]=Math.max(c[3],n,h),zd(this,t,i).call(this,e,s,a,l,n,r,o,h,3*(3*(s-a)-e+l),6*(e-2*s+a),3*(s-e),c),zd(this,t,i).call(this,e,s,a,l,n,r,o,h,3*(3*(r-o)-n+h),6*(n-2*r+o),3*(r-n),c)}}t=new WeakSet,e=function(t,e,i,n,s,r,a,o,l,h){if(l<=0||l>=1)return;const c=1-l,d=l*l,u=d*l,p=c*(c*(c*t+3*l*e)+3*d*i)+u*n,f=c*(c*(c*s+3*l*r)+3*d*a)+u*o;h[0]=Math.min(h[0],p),h[1]=Math.min(h[1],f),h[2]=Math.max(h[2],p),h[3]=Math.max(h[3],f)},i=function(i,n,s,r,a,o,l,h,c,d,u,p){if(Math.abs(c)<1e-12)return void(Math.abs(d)>=1e-12&&zd(this,t,e).call(this,i,n,s,r,a,o,l,h,-u/d,p));const f=d**2-4*u*c;if(f<0)return;const g=Math.sqrt(f),m=2*c;zd(this,t,e).call(this,i,n,s,r,a,o,l,h,(-d+g)/m,p),zd(this,t,e).call(this,i,n,s,r,a,o,l,h,(-d-g)/m,p)},Ud(l_,t);let h_=null,c_=null;function d_(t){return h_||(h_=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,c_=new Map([["","t"]])),t.replaceAll(h_,(t,e,i)=>e?e.normalize("NFKC"):c_.get(i))}function u_(){if("function"==typeof crypto.randomUUID)return crypto.randomUUID();const t=new Uint8Array(32);return crypto.getRandomValues(t),s_(t)}const p_="pdfjs_internal_id_";function f_(t,e,i){return Math.min(Math.max(t,e),i)}function g_(t){return Uint8Array.prototype.toBase64?t.toBase64():btoa(s_(t))}"function"!=typeof Promise.try&&(Promise.try=function(t,...e){return new Promise(i=>{i(t(...e))})}),"function"!=typeof Math.sumPrecise&&(Math.sumPrecise=function(t){return t.reduce((t,e)=>t+e,0)});class m_{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};return function t(i){if(!i)return;let n=null;const s=i.name;if("#text"===s)n=i.value;else{if(!m_.shouldBuildText(s))return;i?.attributes?.textContent?n=i.attributes.textContent:i.value&&(n=i.value)}if(null!==n&&e.push({str:n}),i.children)for(const e of i.children)t(e)}(t),i}static shouldBuildText(t){return!("textarea"===t||"input"===t||"option"===t||"select"===t)}}class y_{static setupStorage(t,e,i,n,s){const r=n.getValue(e,{value:null});switch(i.name){case"textarea":if(null!==r.value&&(t.textContent=r.value),"print"===s)break;t.addEventListener("input",t=>{n.setValue(e,{value:t.target.value})});break;case"input":if("radio"===i.attributes.type||"checkbox"===i.attributes.type){if(r.value===i.attributes.xfaOn?t.setAttribute("checked",!0):r.value===i.attributes.xfaOff&&t.removeAttribute("checked"),"print"===s)break;t.addEventListener("change",t=>{n.setValue(e,{value:t.target.checked?t.target.getAttribute("xfaOn"):t.target.getAttribute("xfaOff")})})}else{if(null!==r.value&&t.setAttribute("value",r.value),"print"===s)break;t.addEventListener("input",t=>{n.setValue(e,{value:t.target.value})})}break;case"select":if(null!==r.value){t.setAttribute("value",r.value);for(const t of i.children)t.attributes.value===r.value?t.attributes.selected=!0:t.attributes.hasOwnProperty("selected")&&delete t.attributes.selected}t.addEventListener("input",t=>{const i=t.target.options,s=-1===i.selectedIndex?"":i[i.selectedIndex].value;n.setValue(e,{value:s})})}}static setAttributes({html:t,element:e,storage:i=null,intent:n,linkService:s}){const{attributes:r}=e,a=t instanceof HTMLAnchorElement;"radio"===r.type&&(r.name=`${r.name}-${n}`);for(const[o,l]of Object.entries(r))if(null!=l)switch(o){case"class":l.length&&t.setAttribute(o,l.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",l);break;case"style":Object.assign(t.style,l);break;case"textContent":t.textContent=l;break;default:(!a||"href"!==o&&"newWindow"!==o)&&t.setAttribute(o,l)}a&&s.addLinkAttributes(t,r.href,r.newWindow),i&&r.dataId&&this.setupStorage(t,r.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,n=t.xfaHtml,s=t.intent||"display",r=document.createElement(n.name);n.attributes&&this.setAttributes({html:r,element:n,intent:s,linkService:i});const a="richText"!==s,o=t.div;if(o.append(r),t.viewport){const e=`matrix(${t.viewport.transform.join(",")})`;o.style.transform=e}a&&o.setAttribute("class","xfaLayer xfaFont");const l=[];if(0===n.children.length){if(n.value){const t=document.createTextNode(n.value);r.append(t),a&&m_.shouldBuildText(n.name)&&l.push(t)}return{textDivs:l}}const h=[[n,-1,r]];for(;h.length>0;){const[t,n,r]=h.at(-1);if(n+1===t.children.length){h.pop();continue}const o=t.children[++h.at(-1)[1]];if(null===o)continue;const{name:c}=o;if("#text"===c){const t=document.createTextNode(o.value);l.push(t),r.append(t);continue}const d=o?.attributes?.xmlns?document.createElementNS(o.attributes.xmlns,c):document.createElement(c);if(r.append(d),o.attributes&&this.setAttributes({html:d,element:o,storage:e,intent:s,linkService:i}),o.children?.length>0)h.push([o,-1,d]);else if(o.value){const t=document.createTextNode(o.value);a&&m_.shouldBuildText(c)&&l.push(t),d.append(t)}}for(const c of o.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))c.setAttribute("readOnly",!0);return{textDivs:l}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const w_="http://www.w3.org/2000/svg",v_=class{};Wd(v_,"CSS",96),Wd(v_,"PDF",72),Wd(v_,"PDF_TO_CSS_UNITS",v_.CSS/v_.PDF);let b_=v_;async function A_(t,e="text"){if(P_(t,document.baseURI)){const i=await fetch(t);if(!i.ok)throw new Error(i.statusText);switch(e){case"arraybuffer":return i.arrayBuffer();case"blob":return i.blob();case"json":return i.json()}return i.text()}return new Promise((i,n)=>{const s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE)if(200!==s.status&&0!==s.status)n(new Error(s.statusText));else{switch(e){case"arraybuffer":case"blob":case"json":return void i(s.response)}i(s.responseText)}},s.send(null)})}class x_{constructor({viewBox:t,userUnit:e,scale:i,rotation:n,offsetX:s=0,offsetY:r=0,dontFlip:a=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=n,this.offsetX=s,this.offsetY=r,i*=e;const o=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let h,c,d,u,p,f,g,m;switch((n%=360)<0&&(n+=360),n){case 180:h=-1,c=0,d=0,u=1;break;case 90:h=0,c=1,d=1,u=0;break;case 270:h=0,c=-1,d=-1,u=0;break;case 0:h=1,c=0,d=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(d=-d,u=-u),0===h?(p=Math.abs(l-t[1])*i+s,f=Math.abs(o-t[0])*i+r,g=(t[3]-t[1])*i,m=(t[2]-t[0])*i):(p=Math.abs(o-t[0])*i+s,f=Math.abs(l-t[1])*i+r,g=(t[2]-t[0])*i,m=(t[3]-t[1])*i),this.transform=[h*i,c*i,d*i,u*i,p-h*i*o-d*i*l,f-c*i*o-u*i*l],this.width=g,this.height=m}get rawDims(){const t=this.viewBox;return Yx(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:n=this.offsetY,dontFlip:s=!1}={}){return new x_({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}convertToViewportPoint(t,e){const i=[t,e];return l_.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];l_.applyTransform(e,this.transform);const i=[t[2],t[3]];return l_.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return l_.applyInverseTransform(i,this.transform),i}}class __ extends Qx{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function S_(t){const e=t.length;let i=0;for(;i<e&&""===t[i].trim();)i++;return"data:"===t.substring(i,i+5).toLowerCase()}function k_(t){return"string"==typeof t&&/\.pdf$/i.test(t)}function E_(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)}function M_(t,e="document.pdf"){if("string"!=typeof t)return e;if(S_(t))return e;const i=(t=>{try{return new URL(t)}catch{try{return new URL(decodeURIComponent(t))}catch{try{return new URL(t,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(t),"https://foo.bar")}catch{return null}}}}})(t);if(!i)return e;const n=t=>{try{let e=decodeURIComponent(t);return e.includes("/")?(e=e.split("/").at(-1),e.test(/^\.pdf$/i)?e:t):e}catch{return t}},s=/\.pdf$/i,r=i.pathname.split("/").at(-1);if(s.test(r))return n(r);if(i.searchParams.size>0){const t=Array.from(i.searchParams.values()).reverse();for(const i of t)if(s.test(i))return n(i);const e=Array.from(i.searchParams.keys()).reverse();for(const i of e)if(s.test(i))return n(i)}if(i.hash){const t=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(t)return n(t[0])}return e}class C_{constructor(){Wd(this,"started",Object.create(null)),Wd(this,"times",[])}time(t){this.started,this.started[t]=Date.now()}timeEnd(t){this.started,this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:n,end:s}of this.times)t.push(`${i.padEnd(e)} ${s-n}ms\n`);return t.join("")}}function P_(t,e){const i=e?URL.parse(t,e):URL.parse(t);return"http:"===i?.protocol||"https:"===i?.protocol}function T_(t){t.preventDefault()}function R_(t){t.preventDefault(),t.stopPropagation()}class D_{static toDateObject(t){if(t instanceof Date)return t;if(!t||"string"!=typeof t)return null;$d(this,n)||Hd(this,n,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=$d(this,n).exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(e[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(e[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(e[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(e[6],10);l=l>=0&&l<=59?l:0;const h=e[7]||"Z";let c=parseInt(e[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(e[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===h?(a+=c,o+=d):"+"===h&&(a-=c,o-=d),new Date(Date.UTC(i,s,r,a,o,l))}}function I_(t,{scale:e=1,rotation:i=0}){const{width:n,height:s}=t.attributes.style,r=[0,0,parseInt(n),parseInt(s)];return new x_({viewBox:r,userUnit:1,scale:e,rotation:i})}function O_(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(16711680&e)>>16,(65280&e)>>8,255&e]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map(t=>parseInt(t)):t.startsWith("rgba(")?t.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):[0,0,0]}function L_(t){const{a:e,b:i,c:n,d:s,e:r,f:a}=t.getTransform();return[e,i,n,s,r,a]}function F_(t){const{a:e,b:i,c:n,d:s,e:r,f:a}=t.getTransform().invertSelf();return[e,i,n,s,r,a]}function N_(t,e,i=!1,n=!0){if(e instanceof x_){const{pageWidth:n,pageHeight:s}=e.rawDims,{style:r}=t,a=a_.isCSSRoundSupported,o=`var(--total-scale-factor) * ${n}px`,l=`var(--total-scale-factor) * ${s}px`,h=a?`round(down, ${o}, var(--scale-round-x))`:`calc(${o})`,c=a?`round(down, ${l}, var(--scale-round-y))`:`calc(${l})`;i&&e.rotation%180!=0?(r.width=c,r.height=h):(r.width=h,r.height=c)}n&&t.setAttribute("data-main-rotation",e.rotation)}n=new WeakMap,Ud(D_,n);class B_{constructor(){const{pixelRatio:t}=B_;this.sx=t,this.sy=t}get scaled(){return 1!==this.sx||1!==this.sy}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,n,s=-1){let r=1/0,a=1/0,o=1/0;(i=B_.capPixels(i,s))>0&&(r=Math.sqrt(i/(t*e))),-1!==n&&(a=n/t,o=n/e);const l=Math.min(r,a,o);return(this.sx>l||this.sy>l)&&(this.sx=l,this.sy=l,!0)}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const W_=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class j_{static get isDarkMode(){return Yx(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class $_{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),Yx(this,"commentForegroundColor",O_(i))}}function U_(t,e,i,n){const s=255*(1-(n=Math.min(Math.max(n??1,0),1)));return[t=Math.round(t*n+s),e=Math.round(e*n+s),i=Math.round(i*n+s)]}function H_(t,e){const i=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.max(i,n,s),a=Math.min(i,n,s),o=(r+a)/2;if(r===a)e[0]=e[1]=0;else{const t=r-a;switch(e[1]=o<.5?t/(r+a):t/(2-r-a),r){case i:e[0]=60*((n-s)/t+(n<s?6:0));break;case n:e[0]=60*((s-i)/t+2);break;case s:e[0]=60*((i-n)/t+4)}}e[2]=o}function z_(t,e){const i=t[0],n=t[1],s=t[2],r=(1-Math.abs(2*s-1))*n,a=r*(1-Math.abs(i/60%2-1)),o=s-r/2;switch(Math.floor(i/60)){case 0:e[0]=r+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=r+o,e[2]=o;break;case 2:e[0]=o,e[1]=r+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=r+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=r+o;break;case 5:case 6:e[0]=r+o,e[1]=o,e[2]=a+o}}function V_(t){return t<=.03928?t/12.92:((t+.055)/1.055)**2.4}function G_(t,e,i){z_(t,i),i.map(V_);const n=.2126*i[0]+.7152*i[1]+.0722*i[2];z_(e,i),i.map(V_);const s=.2126*i[0]+.7152*i[1]+.0722*i[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const q_=new Map;function X_(t,e){const i=t[0]+256*t[1]+65536*t[2]+16777216*e[0]+4294967296*e[1]+1099511627776*e[2];let n=q_.get(i);if(n)return n;const s=new Float32Array(9),r=s.subarray(0,3),a=s.subarray(3,6);H_(t,a);const o=s.subarray(6,9);H_(e,o);const l=o[2]<.5,h=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),G_(a,o,r)<h){let t,e;l?(t=a[2],e=1):(t=0,e=a[2]);const i=.005;for(;e-t>i;){const i=a[2]=(t+e)/2;l===G_(a,o,r)<h?t=i:e=i}a[2]=l?e:t}return z_(a,r),n=l_.makeHexColor(Math.round(255*r[0]),Math.round(255*r[1]),Math.round(255*r[2])),q_.set(i,n),n}function K_({html:t,dir:e,className:i},n){const s=document.createDocumentFragment();if("string"==typeof t){const i=document.createElement("p");i.dir=e||"auto";const n=t.split(/(?:\r\n?|\n)/);for(let t=0,e=n.length;t<e;++t){const s=n[t];i.append(document.createTextNode(s)),t<e-1&&i.append(document.createElement("br"))}s.append(i)}else y_.render({xfaHtml:t,div:s,intent:"richText"});s.firstChild.classList.add("richText",i),n.append(s)}const Y_=class t{constructor(e){Ud(this,g),Ud(this,s,null),Ud(this,r,null),Ud(this,a),Ud(this,o,null),Ud(this,l,null),Ud(this,h,null),Ud(this,c,null),Ud(this,d,null),Hd(this,a,e),$d(t,u)||Hd(t,u,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=Hd(this,s,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const i=$d(this,a)._uiManager._signal;i instanceof AbortSignal&&!i.aborted&&(e.addEventListener("contextmenu",T_,{signal:i}),e.addEventListener("pointerdown",zd(t,p,f),{signal:i}));const n=Hd(this,o,document.createElement("div"));n.className="buttons",e.append(n);const r=$d(this,a).toolbarPosition;if(r){const{style:t}=e,i="ltr"===$d(this,a)._uiManager.direction?1-r[0]:r[0];t.insetInlineEnd=100*i+"%",t.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return $d(this,s)}hide(){$d(this,s).classList.add("hidden"),$d(this,r)?.hideDropdown()}show(){$d(this,s).classList.remove("hidden"),$d(this,l)?.shown(),$d(this,h)?.shown()}addDeleteButton(){const{editorType:e,_uiManager:i}=$d(this,a),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",$d(t,u)[e]),zd(this,g,w).call(this,n)&&n.addEventListener("click",t=>{i.delete()},{signal:i._signal}),$d(this,o).append(n)}async addAltText(t){const e=await t.render();zd(this,g,w).call(this,e),$d(this,o).append(e,$d(this,g,v)),Hd(this,l,t)}addComment(t,e=null){if($d(this,h))return;const i=t.renderForToolbar();if(!i)return;zd(this,g,w).call(this,i);const n=Hd(this,c,$d(this,g,v));e?($d(this,o).insertBefore(i,e),$d(this,o).insertBefore(n,e)):$d(this,o).append(i,n),Hd(this,h,t),t.toolbar=this}addColorPicker(t){if($d(this,r))return;Hd(this,r,t);const e=t.renderButton();zd(this,g,w).call(this,e),$d(this,o).append(e,$d(this,g,v))}async addEditSignatureButton(t){const e=Hd(this,d,await t.renderEditButton($d(this,a)));zd(this,g,w).call(this,e),$d(this,o).append(e,$d(this,g,v))}removeButton(t){"comment"===t&&($d(this,h)?.removeToolbarCommentButton(),Hd(this,h,null),$d(this,c)?.remove(),Hd(this,c,null))}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e)}}async addButtonBefore(t,e,i){const n=$d(this,o).querySelector(i);n&&"comment"===t&&this.addComment(e,n)}updateEditSignatureButton(t){$d(this,d)&&($d(this,d).title=t)}remove(){$d(this,s).remove(),$d(this,r)?.destroy(),Hd(this,r,null)}};s=new WeakMap,r=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakMap,h=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap,p=new WeakSet,f=function(t){t.stopPropagation()},g=new WeakSet,m=function(t){$d(this,a)._focusEventsAllowed=!1,R_(t)},y=function(t){$d(this,a)._focusEventsAllowed=!0,R_(t)},w=function(t){const e=$d(this,a)._uiManager._signal;return e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("focusin",zd(this,g,m).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",zd(this,g,y).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",T_,{signal:e}),!0)},v=function(){const t=document.createElement("div");return t.className="divider",t},Ud(Y_,p),Ud(Y_,u,null);let Q_=Y_;class J_{constructor(t){Ud(this,_),Ud(this,b,null),Ud(this,A,null),Ud(this,x),Hd(this,x,t)}show(t,e,i){const[n,s]=zd(this,_,k).call(this,e,i),{style:r}=$d(this,A)||Hd(this,A,zd(this,_,S).call(this));t.append($d(this,A)),r.insetInlineEnd=100*n+"%",r.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){$d(this,A).remove()}}function Z_(t,e,i){for(const n of i)e.addEventListener(n,t[n].bind(t))}b=new WeakMap,A=new WeakMap,x=new WeakMap,_=new WeakSet,S=function(){const t=Hd(this,A,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar");const e=$d(this,x)._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",T_,{signal:e});const i=Hd(this,b,document.createElement("div"));return i.className="buttons",t.append(i),$d(this,x).hasCommentManager()&&zd(this,_,E).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{$d(this,x).commentSelection("floating_button")}),zd(this,_,E).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{$d(this,x).highlightSelection("floating_button")}),t},k=function(t,e){let i=0,n=0;for(const s of t){const t=s.y+s.height;if(t<i)continue;const r=s.x+(e?s.width:0);t>i?(n=r,i=t):e?r>n&&(n=r):r<n&&(n=r)}return[e?1-n:n,i]},E=function(t,e,i,n){const s=document.createElement("button");s.classList.add("basic",t),s.tabIndex=0,s.setAttribute("data-l10n-id",e);const r=document.createElement("span");s.append(r),r.className="visuallyHidden",r.setAttribute("data-l10n-id",i);const a=$d(this,x)._signal;a instanceof AbortSignal&&!a.aborted&&(s.addEventListener("contextmenu",T_,{signal:a}),s.addEventListener("click",n,{signal:a})),$d(this,b).append(s)};class tS{constructor(){Ud(this,M,0)}get id(){return`${Ox}${Vd(this,M)._++}`}}M=new WeakMap;const eS=class{constructor(){Ud(this,R),Ud(this,C,u_()),Ud(this,P,0),Ud(this,T,null)}static get _isSVGFittingCanvas(){const t=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Yx(this,"_isSVGFittingCanvas",e.decode().then(()=>(t.drawImage(e,0,0,1,1,0,0,1,3),0===new Uint32Array(t.getImageData(0,0,1,1).data.buffer)[0])))}async getFromFile(t){const{lastModified:e,name:i,size:n,type:s}=t;return zd(this,R,D).call(this,`${e}_${i}_${n}_${s}`,t)}async getFromUrl(t){return zd(this,R,D).call(this,t,t)}async getFromBlob(t,e){const i=await e;return zd(this,R,D).call(this,t,i)}async getFromId(t){$d(this,T)||Hd(this,T,new Map);const e=$d(this,T).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:t}=e;return delete e.blobPromise,this.getFromBlob(e.id,t)}return this.getFromUrl(e.url)}getFromCanvas(t,e){$d(this,T)||Hd(this,T,new Map);let i=$d(this,T).get(t);if(i?.bitmap)return i.refCounter+=1,i;const n=new OffscreenCanvas(e.width,e.height);return n.getContext("2d").drawImage(e,0,0),i={bitmap:n.transferToImageBitmap(),id:`image_${$d(this,C)}_${Vd(this,P)._++}`,refCounter:1,isSvg:!1},$d(this,T).set(t,i),$d(this,T).set(i.id,i),i}getSvgUrl(t){const e=$d(this,T).get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){$d(this,T)||Hd(this,T,new Map);const e=$d(this,T).get(t);if(!e)return;if(e.refCounter-=1,0!==e.refCounter)return;const{bitmap:i}=e;if(!e.url&&!e.file){const t=new OffscreenCanvas(i.width,i.height);t.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=t.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${$d(this,C)}_`)}};C=new WeakMap,P=new WeakMap,T=new WeakMap,R=new WeakSet,D=async function(t,e){$d(this,T)||Hd(this,T,new Map);let i=$d(this,T).get(t);if(null===i)return null;if(i?.bitmap)return i.refCounter+=1,i;try{let t;if(i||(i={bitmap:null,id:`image_${$d(this,C)}_${Vd(this,P)._++}`,refCounter:0,isSvg:!1}),"string"==typeof e?(i.url=e,t=await A_(e,"blob")):e instanceof File?t=i.file=e:e instanceof Blob&&(t=e),"image/svg+xml"===t.type){const e=eS._isSVGFittingCanvas,n=new FileReader,s=new Image,r=new Promise((t,r)=>{s.onload=()=>{i.bitmap=s,i.isSvg=!0,t()},n.onload=async()=>{const t=i.svgUrl=n.result;s.src=await e?`${t}#svgView(preserveAspectRatio(none))`:t},s.onerror=n.onerror=r});n.readAsDataURL(t),await r}else i.bitmap=await createImageBitmap(t);i.refCounter=1}catch(XO){i=null}return $d(this,T).set(t,i),i&&$d(this,T).set(i.id,i),i};let iS=eS;class nS{constructor(t=128){Ud(this,I,[]),Ud(this,O,!1),Ud(this,L),Ud(this,F,-1),Hd(this,L,t)}add({cmd:t,undo:e,post:i,mustExec:n,type:s=NaN,overwriteIfSameType:r=!1,keepUndo:a=!1}){if(n&&t(),$d(this,O))return;const o={cmd:t,undo:e,post:i,type:s};if(-1===$d(this,F))return $d(this,I).length>0&&($d(this,I).length=0),Hd(this,F,0),void $d(this,I).push(o);if(r&&$d(this,I)[$d(this,F)].type===s)return a&&(o.undo=$d(this,I)[$d(this,F)].undo),void($d(this,I)[$d(this,F)]=o);const l=$d(this,F)+1;l===$d(this,L)?$d(this,I).splice(0,1):(Hd(this,F,l),l<$d(this,I).length&&$d(this,I).splice(l)),$d(this,I).push(o)}undo(){if(-1===$d(this,F))return;Hd(this,O,!0);const{undo:t,post:e}=$d(this,I)[$d(this,F)];t(),e?.(),Hd(this,O,!1),Hd(this,F,$d(this,F)-1)}redo(){if($d(this,F)<$d(this,I).length-1){Hd(this,F,$d(this,F)+1),Hd(this,O,!0);const{cmd:t,post:e}=$d(this,I)[$d(this,F)];t(),e?.(),Hd(this,O,!1)}}hasSomethingToUndo(){return-1!==$d(this,F)}hasSomethingToRedo(){return $d(this,F)<$d(this,I).length-1}cleanType(t){if(-1!==$d(this,F)){for(let e=$d(this,F);e>=0;e--)if($d(this,I)[e].type!==t)return $d(this,I).splice(e+1,$d(this,F)-e),void Hd(this,F,e);$d(this,I).length=0,Hd(this,F,-1)}}destroy(){Hd(this,I,null)}}I=new WeakMap,O=new WeakMap,L=new WeakMap,F=new WeakMap;class sS{constructor(t){Ud(this,N),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=a_.platform;for(const[i,n,s={}]of t)for(const t of i){const i=t.startsWith("mac+");e&&i?(this.callbacks.set(t.slice(4),{callback:n,options:s}),this.allKeys.add(t.split("+").at(-1))):e||i||(this.callbacks.set(t,{callback:n,options:s}),this.allKeys.add(t.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(zd(this,N,B).call(this,e));if(!i)return;const{callback:n,options:{bubbles:s=!1,args:r=[],checker:a=null}}=i;a&&!a(t,e)||(n.bind(t,...r,e)(),s||R_(e))}}N=new WeakSet,B=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const rS=class t{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return function(t){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const i of t.keys()){e.style.color=i;const n=window.getComputedStyle(e).color;t.set(i,O_(n))}e.remove()}(t),Yx(this,"_colors",t)}convert(e){const i=O_(e);if(!window.matchMedia("(forced-colors: active)").matches)return i;for(const[n,s]of this._colors)if(s.every((t,e)=>t===i[e]))return t._colorsMapping.get(n);return i}getHexCode(t){const e=this._colors.get(t);return e?l_.makeHexColor(...e):t}};Wd(rS,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let aS=rS;const oS=class t{constructor(t,e,i,n,s,r,a,o,l,h,c,d,u,p,f,g){Ud(this,Ot),Ud(this,W,new AbortController),Ud(this,j,null),Ud(this,$,null),Ud(this,U,new Map),Ud(this,H,new Map),Ud(this,z,null),Ud(this,V,null),Ud(this,G,null),Ud(this,q,new nS),Ud(this,X,null),Ud(this,K,null),Ud(this,Y,null),Ud(this,Q,0),Ud(this,J,new Set),Ud(this,Z,null),Ud(this,tt,null),Ud(this,et,new Set),Wd(this,"_editorUndoBar",null),Ud(this,it,!1),Ud(this,nt,!1),Ud(this,st,!1),Ud(this,rt,null),Ud(this,at,null),Ud(this,ot,null),Ud(this,lt,null),Ud(this,ht,!1),Ud(this,ct,null),Ud(this,dt,new tS),Ud(this,ut,!1),Ud(this,pt,!1),Ud(this,ft,!1),Ud(this,gt,null),Ud(this,mt,null),Ud(this,yt,null),Ud(this,wt,null),Ud(this,vt,null),Ud(this,bt,Lx.NONE),Ud(this,At,new Set),Ud(this,xt,null),Ud(this,_t,null),Ud(this,St,null),Ud(this,kt,null),Ud(this,Et,null),Ud(this,Mt,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),Ud(this,Ct,[0,0]),Ud(this,Pt,null),Ud(this,Tt,null),Ud(this,Rt,null),Ud(this,Dt,null),Ud(this,It,null);const m=this._signal=$d(this,W).signal;Hd(this,Tt,t),Hd(this,Rt,e),Hd(this,Dt,i),Hd(this,z,n),Hd(this,X,s),Hd(this,_t,r),Hd(this,Et,o),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:m}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),a._on("setpreference",this.onSetPreference.bind(this),{signal:m}),a._on("switchannotationeditorparams",t=>this.updateParams(t.type,t.value),{signal:m}),window.addEventListener("pointerdown",()=>{Hd(this,pt,!0)},{capture:!0,signal:m}),window.addEventListener("pointerup",()=>{Hd(this,pt,!1)},{capture:!0,signal:m}),zd(this,Ot,jt).call(this),zd(this,Ot,qt).call(this),zd(this,Ot,Ht).call(this),Hd(this,V,o.annotationStorage),Hd(this,rt,o.filterFactory),Hd(this,St,l),Hd(this,lt,h||null),Hd(this,it,c),Hd(this,nt,d),Hd(this,st,u),Hd(this,vt,p||null),this.viewParameters={realScale:b_.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=!1!==g,s?.setSidebarUiManager(this)}static get _keyboardManager(){const e=t.prototype,i=t=>$d(t,Tt).contains(document.activeElement)&&"BUTTON"!==document.activeElement.tagName&&t.hasSomethingToControl(),n=(t,{target:e})=>{if(e instanceof HTMLInputElement){const{type:t}=e;return"text"!==t&&"number"!==t}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return Yx(this,"_keyboardManager",new sS([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&$d(t,Tt).contains(e)&&!t.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(t,{target:e})=>!(e instanceof HTMLButtonElement)&&$d(t,Tt).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:i}]]))}destroy(){$d(this,It)?.resolve(),Hd(this,It,null),$d(this,W)?.abort(),Hd(this,W,null),this._signal=null;for(const t of $d(this,H).values())t.destroy();$d(this,H).clear(),$d(this,U).clear(),$d(this,et).clear(),$d(this,wt)?.clear(),Hd(this,j,null),$d(this,At).clear(),$d(this,q).destroy(),$d(this,z)?.destroy(),$d(this,X)?.destroy(),$d(this,_t)?.destroy(),$d(this,ct)?.hide(),Hd(this,ct,null),$d(this,yt)?.destroy(),Hd(this,yt,null),Hd(this,$,null),$d(this,at)&&(clearTimeout($d(this,at)),Hd(this,at,null)),$d(this,Pt)&&(clearTimeout($d(this,Pt)),Hd(this,Pt,null)),this._editorUndoBar?.destroy(),Hd(this,Et,null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return $d(this,vt)}get useNewAltTextFlow(){return $d(this,nt)}get useNewAltTextWhenAddingImage(){return $d(this,st)}get hcmFilter(){return Yx(this,"hcmFilter",$d(this,St)?$d(this,rt).addHCMFilter($d(this,St).foreground,$d(this,St).background):"none")}get direction(){return Yx(this,"direction",getComputedStyle($d(this,Tt)).direction)}get _highlightColors(){return Yx(this,"_highlightColors",$d(this,lt)?new Map($d(this,lt).split(",").map(t=>(t=t.split("=").map(t=>t.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Yx(this,"highlightColors",null);const e=new Map,i=!!$d(this,St);for(const[n,s]of t){const t=n.endsWith("_HCM");i&&t?e.set(n.replace("_HCM",""),s):i||t||e.set(n,s)}return Yx(this,"highlightColors",e)}get highlightColorNames(){return Yx(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),Hd(this,Y,t)}setMainHighlightColorPicker(t){Hd(this,yt,t)}editAltText(t,e=!1){$d(this,z)?.editAltText(this,t,e)}hasCommentManager(){return!!$d(this,X)}editComment(t,e,i,n){$d(this,X)?.showDialog(this,t,e,i,n)}selectComment(t,e){const i=$d(this,H).get(t),n=i?.getEditorByUID(e);n?.toggleComment(!0,!0)}updateComment(t){$d(this,X)?.updateComment(t.getData())}updatePopupColor(t){$d(this,X)?.updatePopupColor(t)}removeComment(t){$d(this,X)?.removeComments([t.uid])}toggleComment(t,e,i=void 0){$d(this,X)?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&$d(this,X)?.makeCommentColor(t,e)||null}getCommentDialogElement(){return $d(this,X)?.dialogElement||null}async waitForEditorsRendered(t){if($d(this,H).has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),n=i=>{i.pageNumber===t&&(this._eventBus._off("editorsrendered",n),e())};this._eventBus.on("editorsrendered",n),await i}getSignature(t){$d(this,_t)?.getSignature({uiManager:this,editor:t})}get signatureManager(){return $d(this,_t)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){"enableNewAltTextWhenAddingImage"===t&&Hd(this,st,e)}onPageChanging({pageNumber:t}){Hd(this,Q,t-1)}focusMainContainer(){$d(this,Tt).focus()}findParent(t,e){for(const i of $d(this,H).values()){const{x:n,y:s,width:r,height:a}=i.div.getBoundingClientRect();if(t>=n&&t<=n+r&&e>=s&&e<=s+a)return i}return null}disableUserSelect(t=!1){$d(this,Rt).classList.toggle("noUserSelect",t)}addShouldRescale(t){$d(this,et).add(t)}removeShouldRescale(t){$d(this,et).delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*b_.PDF_TO_CSS_UNITS;for(const e of $d(this,et))e.onScaleChanging();$d(this,Y)?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:n,anchorOffset:s,focusNode:r,focusOffset:a}=i,o=i.toString(),l=zd(this,Ot,Lt).call(this,i).closest(".textLayer"),h=this.getSelectionBoxes(l);if(!h)return;i.empty();const c=zd(this,Ot,Ft).call(this,l),d=$d(this,bt)===Lx.NONE,u=()=>{const i=c?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:h,anchorNode:n,anchorOffset:s,focusNode:r,focusOffset:a,text:o});d&&this.showAllEditors("highlight",!0,!0),e&&i?.editComment()};d?this.switchToMode(Lx.HIGHLIGHT,u):u()}commentSelection(t=""){this.highlightSelection(t,!0)}getAndRemoveDataFromAnnotationStorage(t){if(!$d(this,V))return null;const e=`${Ox}${t}`,i=$d(this,V).getRawValue(e);return i&&$d(this,V).remove(e),i}addToAnnotationStorage(t){t.isEmpty()||!$d(this,V)||$d(this,V).has(t.id)||$d(this,V).setValue(t.id,t)}a11yAlert(t,e=null){const i=$d(this,Dt);i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,$d(this,ht)&&(Hd(this,ht,!1),zd(this,Ot,Wt).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of $d(this,At))if(e.div.contains(t)){Hd(this,mt,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!$d(this,mt))return;const[t,e]=$d(this,mt);Hd(this,mt,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){zd(this,Ot,Ht).call(this),zd(this,Ot,Vt).call(this)}removeEditListeners(){zd(this,Ot,zt).call(this),zd(this,Ot,Gt).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of $d(this,tt))if(i.isHandlingMimeForPasting(e))return t.dataTransfer.dropEffect="copy",void t.preventDefault()}drop(t){for(const e of t.dataTransfer.items)for(const i of $d(this,tt))if(i.isHandlingMimeForPasting(e.type))return i.paste(e,this.currentLayer),void t.preventDefault()}copy(t){if(t.preventDefault(),$d(this,j)?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of $d(this,At)){const t=i.serialize(!0);t&&e.push(t)}0!==e.length&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const r of e.items)for(const t of $d(this,tt))if(t.isHandlingMimeForPasting(r.type))return void t.paste(r,this.currentLayer);let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(s){return void s.message}if(!Array.isArray(i))return;this.unselectAll();const n=this.currentLayer;try{const t=[];for(const r of i){const e=await n.deserialize(r);if(!e)return;t.push(e)}const e=()=>{for(const e of t)zd(this,Ot,Jt).call(this,e);zd(this,Ot,ee).call(this,t)},s=()=>{for(const e of t)e.remove()};this.addCommands({cmd:e,undo:s,mustExec:!0})}catch(s){s.message}}keydown(e){this.isShiftKeyDown||"Shift"!==e.key||(this.isShiftKeyDown=!0),$d(this,bt)===Lx.NONE||this.isEditorHandlingKeyboard||t._keyboardManager.exec(this,e)}keyup(t){this.isShiftKeyDown&&"Shift"===t.key&&(this.isShiftKeyDown=!1,$d(this,ht)&&(Hd(this,ht,!1),zd(this,Ot,Wt).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu")}}setEditingState(t){t?(zd(this,Ot,$t).call(this),zd(this,Ot,Vt).call(this),zd(this,Ot,Xt).call(this,{isEditing:$d(this,bt)!==Lx.NONE,isEmpty:zd(this,Ot,te).call(this),hasSomethingToUndo:$d(this,q).hasSomethingToUndo(),hasSomethingToRedo:$d(this,q).hasSomethingToRedo(),hasSelectedEditor:!1})):(zd(this,Ot,Ut).call(this),zd(this,Ot,Gt).call(this),zd(this,Ot,Xt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!$d(this,tt)){Hd(this,tt,t);for(const t of $d(this,tt))zd(this,Ot,Kt).call(this,t.defaultPropertiesToUpdate)}}getId(){return $d(this,dt).id}get currentLayer(){return $d(this,H).get($d(this,Q))}getLayer(t){return $d(this,H).get(t)}get currentPageIndex(){return $d(this,Q)}addLayer(t){$d(this,H).set(t.pageIndex,t),$d(this,ut)?t.enable():t.disable()}removeLayer(t){$d(this,H).delete(t.pageIndex)}async updateMode(t,e=null,i=!1,n=!1,s=!1){if($d(this,bt)!==t&&(!$d(this,It)||(await $d(this,It).promise,$d(this,It)))){if(Hd(this,It,Promise.withResolvers()),$d(this,Y)?.commitOrRemove(),$d(this,bt)===Lx.POPUP&&$d(this,X)?.hideSidebar(),$d(this,X)?.destroyPopup(),Hd(this,bt,t),t===Lx.NONE){this.setEditingState(!1),zd(this,Ot,Qt).call(this);for(const t of $d(this,U).values())t.hideStandaloneCommentButton();return this._editorUndoBar?.hide(),this.toggleComment(null),void $d(this,It).resolve()}for(const t of $d(this,U).values())t.addStandaloneCommentButton();t===Lx.SIGNATURE&&await($d(this,_t)?.loadSignatures()),this.setEditingState(!0),await zd(this,Ot,Yt).call(this),this.unselectAll();for(const e of $d(this,H).values())e.updateMode(t);if(t===Lx.POPUP){$d(this,$)||Hd(this,$,await $d(this,Et).getAnnotationsByType(new Set($d(this,tt).map(t=>t._editorType))));const t=new Set,e=[];for(const i of $d(this,U).values()){const{annotationElementId:n,hasComment:s,deleted:r}=i;n&&t.add(n),s&&!r&&e.push(i.getData())}for(const i of $d(this,$)){const{id:n,popupRef:s,contentsObj:r}=i;s&&r?.str&&!t.has(n)&&!$d(this,J).has(n)&&e.push(i)}$d(this,X)?.showSidebar(e)}if(!e)return i&&this.addNewEditorFromKeyboard(),void $d(this,It).resolve();for(const t of $d(this,U).values())t.uid===e?(this.setSelected(t),s?t.editComment():n?t.enterInEditMode():t.focus()):t.unselect();$d(this,It).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==$d(this,bt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if($d(this,tt)){switch(t){case Fx.CREATE:return void this.currentLayer.addNewEditor(e);case Fx.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),($d(this,kt)||Hd(this,kt,new Map)).set(t,e),this.showAllEditors("highlight",e)}if(this.hasSelection)for(const i of $d(this,At))i.updateParams(t,e);else for(const i of $d(this,tt))i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const n of $d(this,U).values())n.editorType===t&&n.show(e);($d(this,kt)?.get(Fx.HIGHLIGHT_SHOW_ALL)??!0)!==e&&zd(this,Ot,Kt).call(this,[[Fx.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if($d(this,ft)!==t){Hd(this,ft,t);for(const e of $d(this,H).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}*getEditors(t){for(const e of $d(this,U).values())e.pageIndex===t&&(yield e)}getEditor(t){return $d(this,U).get(t)}addEditor(t){$d(this,U).set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&($d(this,at)&&clearTimeout($d(this,at)),Hd(this,at,setTimeout(()=>{this.focusMainContainer(),Hd(this,at,null)},0))),$d(this,U).delete(t.id),t.annotationElementId&&$d(this,wt)?.delete(t.annotationElementId),this.unselect(t),t.annotationElementId&&$d(this,J).has(t.annotationElementId)||$d(this,V)?.remove(t.id)}addDeletedAnnotationElement(t){$d(this,J).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return $d(this,J).has(t)}removeDeletedAnnotationElement(t){$d(this,J).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){$d(this,j)!==t&&(Hd(this,j,t),t&&zd(this,Ot,Kt).call(this,t.propertiesToUpdate))}updateUI(t){$d(this,Ot,Zt)===t&&zd(this,Ot,Kt).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){zd(this,Ot,Kt).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if($d(this,At).has(t))return $d(this,At).delete(t),t.unselect(),void zd(this,Ot,Xt).call(this,{hasSelectedEditor:this.hasSelection});$d(this,At).add(t),t.select(),zd(this,Ot,Kt).call(this,t.propertiesToUpdate),zd(this,Ot,Xt).call(this,{hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),$d(this,Y)?.commitOrRemove();for(const e of $d(this,At))e!==t&&e.unselect();$d(this,At).clear(),$d(this,At).add(t),t.select(),zd(this,Ot,Kt).call(this,t.propertiesToUpdate),zd(this,Ot,Xt).call(this,{hasSelectedEditor:!0})}isSelected(t){return $d(this,At).has(t)}get firstSelectedEditor(){return $d(this,At).values().next().value}unselect(t){t.unselect(),$d(this,At).delete(t),zd(this,Ot,Xt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==$d(this,At).size}get isEnterHandled(){return 1===$d(this,At).size&&this.firstSelectedEditor.isEnterHandled}undo(){$d(this,q).undo(),zd(this,Ot,Xt).call(this,{hasSomethingToUndo:$d(this,q).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:zd(this,Ot,te).call(this)}),this._editorUndoBar?.hide()}redo(){$d(this,q).redo(),zd(this,Ot,Xt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:$d(this,q).hasSomethingToRedo(),isEmpty:zd(this,Ot,te).call(this)})}addCommands(t){$d(this,q).add(t),zd(this,Ot,Xt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:zd(this,Ot,te).call(this)})}cleanUndoStack(t){$d(this,q).cleanType(t)}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...$d(this,At)],i=()=>{for(const t of e)zd(this,Ot,Jt).call(this,t)};this.addCommands({cmd:()=>{this._editorUndoBar?.show(i,1===e.length?e[0].editorType:e.length);for(const t of e)t.remove()},undo:i,mustExec:!0})}commitOrRemove(){$d(this,j)?.commitOrRemove()}hasSomethingToControl(){return $d(this,j)||this.hasSelection}selectAll(){for(const t of $d(this,At))t.commit();zd(this,Ot,ee).call(this,$d(this,U).values())}unselectAll(){if((!$d(this,j)||($d(this,j).commitOrRemove(),$d(this,bt)===Lx.NONE))&&!$d(this,Y)?.commitOrRemove()&&this.hasSelection){for(const t of $d(this,At))t.unselect();$d(this,At).clear(),zd(this,Ot,Xt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;$d(this,Ct)[0]+=t,$d(this,Ct)[1]+=e;const[n,s]=$d(this,Ct),r=[...$d(this,At)];$d(this,Pt)&&clearTimeout($d(this,Pt)),Hd(this,Pt,setTimeout(()=>{Hd(this,Pt,null),$d(this,Ct)[0]=$d(this,Ct)[1]=0,this.addCommands({cmd:()=>{for(const t of r)$d(this,U).has(t.id)&&(t.translateInPage(n,s),t.translationDone())},undo:()=>{for(const t of r)$d(this,U).has(t.id)&&(t.translateInPage(-n,-s),t.translationDone())},mustExec:!1})},1e3));for(const a of r)a.translateInPage(t,e),a.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Hd(this,Z,new Map);for(const t of $d(this,At))$d(this,Z).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!$d(this,Z))return!1;this.disableUserSelect(!1);const t=$d(this,Z);Hd(this,Z,null);let e=!1;for(const[{x:n,y:s,pageIndex:r},a]of t)a.newX=n,a.newY=s,a.newPageIndex=r,e||(e=n!==a.savedX||s!==a.savedY||r!==a.savedPageIndex);if(!e)return!1;const i=(t,e,i,n)=>{if($d(this,U).has(t.id)){const s=$d(this,H).get(n);s?t._setParentAndPosition(s,e,i):(t.pageIndex=n,t.x=e,t.y=i)}};return this.addCommands({cmd:()=>{for(const[e,{newX:n,newY:s,newPageIndex:r}]of t)i(e,n,s,r)},undo:()=>{for(const[e,{savedX:n,savedY:s,savedPageIndex:r}]of t)i(e,n,s,r)},mustExec:!0}),!0}dragSelectedEditors(t,e){if($d(this,Z))for(const i of $d(this,Z).keys())i.drag(t,e)}rebuild(t){if(null===t.parent){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||1===$d(this,At).size&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return $d(this,j)===t}getActive(){return $d(this,j)}getMode(){return $d(this,bt)}isEditingMode(){return $d(this,bt)!==Lx.NONE}get imageManager(){return Yx(this,"imageManager",new iS)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let l=0,h=e.rangeCount;l<h;l++)if(!t.contains(e.getRangeAt(l).commonAncestorContainer))return null;const{x:i,y:n,width:s,height:r}=t.getBoundingClientRect();let a;switch(t.getAttribute("data-main-rotation")){case"90":a=(t,e,a,o)=>({x:(e-n)/r,y:1-(t+a-i)/s,width:o/r,height:a/s});break;case"180":a=(t,e,a,o)=>({x:1-(t+a-i)/s,y:1-(e+o-n)/r,width:a/s,height:o/r});break;case"270":a=(t,e,a,o)=>({x:1-(e+o-n)/r,y:(t-i)/s,width:o/r,height:a/s});break;default:a=(t,e,a,o)=>({x:(t-i)/s,y:(e-n)/r,width:a/s,height:o/r})}const o=[];for(let l=0,h=e.rangeCount;l<h;l++){const t=e.getRangeAt(l);if(!t.collapsed)for(const{x:e,y:i,width:n,height:s}of t.getClientRects())0!==n&&0!==s&&o.push(a(e,i,n,s))}return 0===o.length?null:o}addChangedExistingAnnotation({annotationElementId:t,id:e}){($d(this,G)||Hd(this,G,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){$d(this,G)?.delete(t)}renderAnnotationElement(t){const e=$d(this,G)?.get(t.data.id);if(!e)return;const i=$d(this,V).getRawValue(e);i&&($d(this,bt)!==Lx.NONE||i.hasBeenModified)&&i.renderAnnotationElement(t)}setMissingCanvas(t,e,i){const n=$d(this,wt)?.get(t);n&&(n.setCanvas(e,i),$d(this,wt).delete(t))}addMissingCanvas(t,e){($d(this,wt)||Hd(this,wt,new Map)).set(t,e)}};W=new WeakMap,j=new WeakMap,$=new WeakMap,U=new WeakMap,H=new WeakMap,z=new WeakMap,V=new WeakMap,G=new WeakMap,q=new WeakMap,X=new WeakMap,K=new WeakMap,Y=new WeakMap,Q=new WeakMap,J=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,it=new WeakMap,nt=new WeakMap,st=new WeakMap,rt=new WeakMap,at=new WeakMap,ot=new WeakMap,lt=new WeakMap,ht=new WeakMap,ct=new WeakMap,dt=new WeakMap,ut=new WeakMap,pt=new WeakMap,ft=new WeakMap,gt=new WeakMap,mt=new WeakMap,yt=new WeakMap,wt=new WeakMap,vt=new WeakMap,bt=new WeakMap,At=new WeakMap,xt=new WeakMap,_t=new WeakMap,St=new WeakMap,kt=new WeakMap,Et=new WeakMap,Mt=new WeakMap,Ct=new WeakMap,Pt=new WeakMap,Tt=new WeakMap,Rt=new WeakMap,Dt=new WeakMap,It=new WeakMap,Ot=new WeakSet,Lt=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Ft=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of $d(this,H).values())if(i.hasTextLayer(t))return i;return null},Nt=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const e=zd(this,Ot,Lt).call(this,t).closest(".textLayer"),i=this.getSelectionBoxes(e);i&&($d(this,ct)||Hd(this,ct,new J_(this)),$d(this,ct).show(e,i,"ltr"===this.direction))},Bt=function(){const t=document.getSelection();if(!t||t.isCollapsed)return void($d(this,xt)&&($d(this,ct)?.hide(),Hd(this,xt,null),zd(this,Ot,Xt).call(this,{hasSelectedText:!1})));const{anchorNode:e}=t;if(e===$d(this,xt))return;const i=zd(this,Ot,Lt).call(this,t).closest(".textLayer");if(i){if($d(this,ct)?.hide(),Hd(this,xt,e),zd(this,Ot,Xt).call(this,{hasSelectedText:!0}),($d(this,bt)===Lx.HIGHLIGHT||$d(this,bt)===Lx.NONE)&&($d(this,bt)===Lx.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),Hd(this,ht,this.isShiftKeyDown),!this.isShiftKeyDown)){const t=$d(this,bt)===Lx.HIGHLIGHT?zd(this,Ot,Ft).call(this,i):null;if(t?.toggleDrawing(),$d(this,pt)){const e=new AbortController,i=this.combinedSignal(e),n=i=>{"pointerup"===i.type&&0!==i.button||(e.abort(),t?.toggleDrawing(!0),"pointerup"===i.type&&zd(this,Ot,Wt).call(this,"main_toolbar"))};window.addEventListener("pointerup",n,{signal:i}),window.addEventListener("blur",n,{signal:i})}else t?.toggleDrawing(!0),zd(this,Ot,Wt).call(this,"main_toolbar")}}else $d(this,xt)&&($d(this,ct)?.hide(),Hd(this,xt,null),zd(this,Ot,Xt).call(this,{hasSelectedText:!1}))},Wt=function(t=""){$d(this,bt)===Lx.HIGHLIGHT?this.highlightSelection(t):$d(this,it)&&zd(this,Ot,Nt).call(this)},jt=function(){document.addEventListener("selectionchange",zd(this,Ot,Bt).bind(this),{signal:this._signal})},$t=function(){if($d(this,ot))return;Hd(this,ot,new AbortController);const t=this.combinedSignal($d(this,ot));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Ut=function(){$d(this,ot)?.abort(),Hd(this,ot,null)},Ht=function(){if($d(this,gt))return;Hd(this,gt,new AbortController);const t=this.combinedSignal($d(this,gt));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},zt=function(){$d(this,gt)?.abort(),Hd(this,gt,null)},Vt=function(){if($d(this,K))return;Hd(this,K,new AbortController);const t=this.combinedSignal($d(this,K));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},Gt=function(){$d(this,K)?.abort(),Hd(this,K,null)},qt=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Xt=function(t){Object.entries(t).some(([t,e])=>$d(this,Mt)[t]!==e)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign($d(this,Mt),t)}),$d(this,bt)===Lx.HIGHLIGHT&&!1===t.hasSelectedEditor&&zd(this,Ot,Kt).call(this,[[Fx.HIGHLIGHT_FREE,!0]]))},Kt=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Yt=async function(){if(!$d(this,ut)){Hd(this,ut,!0);const t=[];for(const e of $d(this,H).values())t.push(e.enable());await Promise.all(t);for(const e of $d(this,U).values())e.enable()}},Qt=function(){if(this.unselectAll(),$d(this,ut)){Hd(this,ut,!1);for(const t of $d(this,H).values())t.disable();for(const t of $d(this,U).values())t.disable()}},Jt=function(t){const e=$d(this,H).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},Zt=function(){let t=null;for(t of $d(this,At));return t},te=function(){if(0===$d(this,U).size)return!0;if(1===$d(this,U).size)for(const t of $d(this,U).values())return t.isEmpty();return!1},ee=function(t){for(const e of $d(this,At))e.unselect();$d(this,At).clear();for(const e of t)e.isEmpty()||($d(this,At).add(e),e.select());zd(this,Ot,Xt).call(this,{hasSelectedEditor:this.hasSelection})},Wd(oS,"TRANSLATE_SMALL",1),Wd(oS,"TRANSLATE_BIG",10);let lS=oS;const hS=class t{constructor(e){Ud(this,ge),Ud(this,ie,null),Ud(this,ne,!1),Ud(this,se,null),Ud(this,re,null),Ud(this,ae,null),Ud(this,oe,null),Ud(this,le,!1),Ud(this,he,null),Ud(this,ce,null),Ud(this,de,null),Ud(this,ue,null),Ud(this,pe,!1),Hd(this,ce,e),Hd(this,pe,e._uiManager.useNewAltTextFlow),$d(t,fe)||Hd(t,fe,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){t._l10n??(t._l10n=e)}async render(){const e=Hd(this,se,document.createElement("button"));e.className="altText",e.tabIndex="0";const i=Hd(this,re,document.createElement("span"));e.append(i),$d(this,pe)?(e.classList.add("new"),e.setAttribute("data-l10n-id",$d(t,fe).missing),i.setAttribute("data-l10n-id",$d(t,fe)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=$d(this,ce)._uiManager._signal;e.addEventListener("contextmenu",T_,{signal:n}),e.addEventListener("pointerdown",t=>t.stopPropagation(),{signal:n});const s=t=>{t.preventDefault(),$d(this,ce)._uiManager.editAltText($d(this,ce)),$d(this,pe)&&$d(this,ce)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:$d(this,ge,me)}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",t=>{t.target===e&&"Enter"===t.key&&(Hd(this,le,!0),s(t))},{signal:n}),await zd(this,ge,ye).call(this),e}finish(){$d(this,se)&&($d(this,se).focus({focusVisible:$d(this,le)}),Hd(this,le,!1))}isEmpty(){return $d(this,pe)?null===$d(this,ie):!$d(this,ie)&&!$d(this,ne)}hasData(){return $d(this,pe)?null!==$d(this,ie)||!!$d(this,de):this.isEmpty()}get guessedText(){return $d(this,de)}async setGuessedText(e){null===$d(this,ie)&&(Hd(this,de,e),Hd(this,ue,await t._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),zd(this,ge,ye).call(this))}toggleAltTextBadge(t=!1){if(!$d(this,pe)||$d(this,ie))return $d(this,he)?.remove(),void Hd(this,he,null);if(!$d(this,he)){const t=Hd(this,he,document.createElement("div"));t.className="noAltTextBadge",$d(this,ce).div.append(t)}$d(this,he).classList.toggle("hidden",!t)}serialize(t){let e=$d(this,ie);return t||$d(this,de)!==e||(e=$d(this,ue)),{altText:e,decorative:$d(this,ne),guessedText:$d(this,de),textWithDisclaimer:$d(this,ue)}}get data(){return{altText:$d(this,ie),decorative:$d(this,ne)}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:n,cancel:s=!1}){i&&(Hd(this,de,i),Hd(this,ue,n)),$d(this,ie)===t&&$d(this,ne)===e||(s||(Hd(this,ie,t),Hd(this,ne,e)),zd(this,ge,ye).call(this))}toggle(t=!1){$d(this,se)&&(!t&&$d(this,oe)&&(clearTimeout($d(this,oe)),Hd(this,oe,null)),$d(this,se).disabled=!t)}shown(){$d(this,ce)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:$d(this,ge,me)}})}destroy(){$d(this,se)?.remove(),Hd(this,se,null),Hd(this,re,null),Hd(this,ae,null),$d(this,he)?.remove(),Hd(this,he,null)}};ie=new WeakMap,ne=new WeakMap,se=new WeakMap,re=new WeakMap,ae=new WeakMap,oe=new WeakMap,le=new WeakMap,he=new WeakMap,ce=new WeakMap,de=new WeakMap,ue=new WeakMap,pe=new WeakMap,fe=new WeakMap,ge=new WeakSet,me=function(){return($d(this,ie)?"added":null===$d(this,ie)&&this.guessedText&&"review")||"missing"},ye=async function(){const t=$d(this,se);if(!t)return;if($d(this,pe)){if(t.classList.toggle("done",!!$d(this,ie)),t.setAttribute("data-l10n-id",$d(hS,fe)[$d(this,ge,me)]),$d(this,re)?.setAttribute("data-l10n-id",$d(hS,fe)[`${$d(this,ge,me)}-label`]),!$d(this,ie))return void $d(this,ae)?.remove()}else{if(!$d(this,ie)&&!$d(this,ne))return t.classList.remove("done"),void $d(this,ae)?.remove();t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=$d(this,ae);if(!e){Hd(this,ae,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${$d(this,ce).id}`;const i=100,n=$d(this,ce)._uiManager._signal;n.addEventListener("abort",()=>{clearTimeout($d(this,oe)),Hd(this,oe,null)},{once:!0}),t.addEventListener("mouseenter",()=>{Hd(this,oe,setTimeout(()=>{Hd(this,oe,null),$d(this,ae).classList.add("show"),$d(this,ce)._reportTelemetry({action:"alt_text_tooltip"})},i))},{signal:n}),t.addEventListener("mouseleave",()=>{$d(this,oe)&&(clearTimeout($d(this,oe)),Hd(this,oe,null)),$d(this,ae)?.classList.remove("show")},{signal:n})}$d(this,ne)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=$d(this,ie)),e.parentNode||t.append(e);const i=$d(this,ce).getElementForAltText();i?.setAttribute("aria-describedby",e.id)},Ud(hS,fe,null),Wd(hS,"_l10n",null);let cS=hS;class dS{constructor(t){Ud(this,Ce),Ud(this,we,null),Ud(this,ve,null),Ud(this,be,!1),Ud(this,Ae,null),Ud(this,xe,null),Ud(this,_e,null),Ud(this,Se,null),Ud(this,ke,null),Ud(this,Ee,!1),Ud(this,Me,null),Hd(this,Ae,t)}renderForToolbar(){const t=Hd(this,ve,document.createElement("button"));return t.className="comment",zd(this,Ce,Pe).call(this,t,!1)}renderForStandalone(){const t=Hd(this,we,document.createElement("button"));t.className="annotationCommentButton";const e=$d(this,Ae).commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*("ltr"===$d(this,Ae)._uiManager.direction?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const n=$d(this,Ae).commentButtonColor;n&&(i.backgroundColor=n)}return zd(this,Ce,Pe).call(this,t,!0)}focusButton(){setTimeout(()=>{($d(this,we)??$d(this,ve))?.focus()},0)}onUpdatedColor(){if(!$d(this,we))return;const t=$d(this,Ae).commentButtonColor;t&&($d(this,we).style.backgroundColor=t),$d(this,Ae)._uiManager.updatePopupColor($d(this,Ae))}get commentButtonWidth(){return($d(this,we)?.getBoundingClientRect().width??0)/$d(this,Ae).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if($d(this,Me))return $d(this,Me);if(!$d(this,we))return null;const{x:t,y:e,height:i}=$d(this,we).getBoundingClientRect(),{x:n,y:s,width:r,height:a}=$d(this,Ae).parent.boundingClientRect;return[(t-n)/r,(e+i-s)/a]}set commentPopupPositionInLayer(t){Hd(this,Me,t)}hasDefaultPopupPosition(){return null===$d(this,Me)}removeStandaloneCommentButton(){$d(this,we)?.remove(),Hd(this,we,null)}removeToolbarCommentButton(){$d(this,ve)?.remove(),Hd(this,ve,null)}setCommentButtonStates({selected:t,hasPopup:e}){$d(this,we)&&($d(this,we).classList.toggle("selected",t),$d(this,we).ariaExpanded=e)}edit(t){const e=this.commentPopupPositionInLayer;let i,n;if(e)[i,n]=e;else{[i,n]=$d(this,Ae).commentButtonPosition;const{width:t,height:e,x:s,y:r}=$d(this,Ae);i=s+i*t,n=r+n*e}const s=$d(this,Ae).parent.boundingClientRect,{x:r,y:a,width:o,height:l}=s;$d(this,Ae)._uiManager.editComment($d(this,Ae),r+i*o,a+n*l,{...t,parentDimensions:s})}finish(){$d(this,ve)&&($d(this,ve).focus({focusVisible:$d(this,be)}),Hd(this,be,!1))}isDeleted(){return $d(this,Ee)||""===$d(this,Se)}isEmpty(){return null===$d(this,Se)}hasBeenEdited(){return this.isDeleted()||$d(this,Se)!==$d(this,xe)}serialize(){return this.data}get data(){return{text:$d(this,Se),richText:$d(this,_e),date:$d(this,ke),deleted:this.isDeleted()}}set data(t){if(t!==$d(this,Se)&&Hd(this,_e,null),null===t)return Hd(this,Se,""),void Hd(this,Ee,!0);Hd(this,Se,t),Hd(this,ke,new Date),Hd(this,Ee,!1)}setInitialText(t,e=null){Hd(this,xe,t),this.data=t,Hd(this,ke,null),Hd(this,_e,e)}shown(){}destroy(){$d(this,ve)?.remove(),Hd(this,ve,null),$d(this,we)?.remove(),Hd(this,we,null),Hd(this,Se,""),Hd(this,_e,null),Hd(this,ke,null),Hd(this,Ae,null),Hd(this,be,!1),Hd(this,Ee,!1)}}we=new WeakMap,ve=new WeakMap,be=new WeakMap,Ae=new WeakMap,xe=new WeakMap,_e=new WeakMap,Se=new WeakMap,ke=new WeakMap,Ee=new WeakMap,Me=new WeakMap,Ce=new WeakSet,Pe=function(t,e){if(!$d(this,Ae)._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[$d(this,Ae)._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const i=$d(this,Ae)._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",T_,{signal:i}),e&&(t.addEventListener("focusin",t=>{$d(this,Ae)._focusEventsAllowed=!1,R_(t)},{capture:!0,signal:i}),t.addEventListener("focusout",t=>{$d(this,Ae)._focusEventsAllowed=!0,R_(t)},{capture:!0,signal:i})),t.addEventListener("pointerdown",t=>t.stopPropagation(),{signal:i});const n=e=>{e.preventDefault(),t===$d(this,ve)?this.edit():$d(this,Ae).toggleComment(!0)};return t.addEventListener("click",n,{capture:!0,signal:i}),t.addEventListener("keydown",e=>{e.target===t&&"Enter"===e.key&&(Hd(this,be,!0),n(e))},{signal:i}),t.addEventListener("pointerenter",()=>{$d(this,Ae).toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{$d(this,Ae).toggleComment(!1,!1)},{signal:i}),t};const uS=class{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:n=null,onPinching:s=null,onPinchEnd:r=null,signal:a}){Ud(this,Ue),Ud(this,Te),Ud(this,Re,!1),Ud(this,De,null),Ud(this,Ie),Ud(this,Oe),Ud(this,Le),Ud(this,Fe),Ud(this,Ne,null),Ud(this,Be),Ud(this,We,null),Ud(this,je),Ud(this,$e,null),Hd(this,Te,t),Hd(this,De,i),Hd(this,Ie,e),Hd(this,Oe,n),Hd(this,Le,s),Hd(this,Fe,r),Hd(this,je,new AbortController),Hd(this,Be,AbortSignal.any([a,$d(this,je).signal])),t.addEventListener("touchstart",zd(this,Ue,He).bind(this),{passive:!1,signal:$d(this,Be)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/B_.pixelRatio}destroy(){$d(this,je)?.abort(),Hd(this,je,null),$d(this,Ne)?.abort(),Hd(this,Ne,null)}};Te=new WeakMap,Re=new WeakMap,De=new WeakMap,Ie=new WeakMap,Oe=new WeakMap,Le=new WeakMap,Fe=new WeakMap,Ne=new WeakMap,Be=new WeakMap,We=new WeakMap,je=new WeakMap,$e=new WeakMap,Ue=new WeakSet,He=function(t){var e,i,n;if(null==(e=$d(this,Ie))?void 0:e.call(this))return;if(1===t.touches.length){if($d(this,Ne))return;const t=Hd(this,Ne,new AbortController),e=AbortSignal.any([$d(this,Be),t.signal]),i=$d(this,Te),n={capture:!0,signal:e,passive:!1},s=t=>{"touch"===t.pointerType&&($d(this,Ne)?.abort(),Hd(this,Ne,null))};return i.addEventListener("pointerdown",t=>{"touch"===t.pointerType&&(R_(t),s(t))},n),i.addEventListener("pointerup",s,n),void i.addEventListener("pointercancel",s,n)}if(!$d(this,$e)){Hd(this,$e,new AbortController);const t=AbortSignal.any([$d(this,Be),$d(this,$e).signal]),e=$d(this,Te),n={signal:t,capture:!1,passive:!1};e.addEventListener("touchmove",zd(this,Ue,ze).bind(this),n);const s=zd(this,Ue,Ve).bind(this);e.addEventListener("touchend",s,n),e.addEventListener("touchcancel",s,n),n.capture=!0,e.addEventListener("pointerdown",R_,n),e.addEventListener("pointermove",R_,n),e.addEventListener("pointercancel",R_,n),e.addEventListener("pointerup",R_,n),null==(i=$d(this,Oe))||i.call(this)}if(R_(t),2!==t.touches.length||(null==(n=$d(this,De))?void 0:n.call(this)))return void Hd(this,We,null);let[s,r]=t.touches;s.identifier>r.identifier&&([s,r]=[r,s]),Hd(this,We,{touch0X:s.screenX,touch0Y:s.screenY,touch1X:r.screenX,touch1Y:r.screenY})},ze=function(t){var e;if(!$d(this,We)||2!==t.touches.length)return;R_(t);let[i,n]=t.touches;i.identifier>n.identifier&&([i,n]=[n,i]);const{screenX:s,screenY:r}=i,{screenX:a,screenY:o}=n,l=$d(this,We),{touch0X:h,touch0Y:c,touch1X:d,touch1Y:u}=l,p=d-h,f=u-c,g=a-s,m=o-r,y=Math.hypot(g,m)||1,w=Math.hypot(p,f)||1;if(!$d(this,Re)&&Math.abs(w-y)<=uS.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,!$d(this,Re))return void Hd(this,Re,!0);const v=[(s+a)/2,(r+o)/2];null==(e=$d(this,Le))||e.call(this,v,w,y)},Ve=function(t){var e;t.touches.length>=2||($d(this,$e)&&($d(this,$e).abort(),Hd(this,$e,null),null==(e=$d(this,Fe))||e.call(this)),$d(this,We)&&(R_(t),Hd(this,We,null),Hd(this,Re,!1)))};let pS=uS;const fS=class t{constructor(e){Ud(this,wi),Ud(this,Ge,null),Ud(this,qe,null),Ud(this,Xe,null),Ud(this,Ke,null),Ud(this,Ye,null),Ud(this,Qe,!1),Ud(this,Je,null),Ud(this,Ze,""),Ud(this,ti,null),Ud(this,ei,null),Ud(this,ii,null),Ud(this,ni,null),Ud(this,si,null),Ud(this,ri,""),Ud(this,ai,!1),Ud(this,oi,null),Ud(this,li,!1),Ud(this,hi,!1),Ud(this,ci,!1),Ud(this,di,null),Ud(this,ui,0),Ud(this,pi,0),Ud(this,fi,null),Ud(this,gi,null),Wd(this,"isSelected",!1),Wd(this,"_isCopy",!1),Wd(this,"_editToolbar",null),Wd(this,"_initialOptions",Object.create(null)),Wd(this,"_initialData",null),Wd(this,"_isVisible",!0),Wd(this,"_uiManager",null),Wd(this,"_focusEventsAllowed",!0),Ud(this,mi,!1),Ud(this,yi,t._zIndex++),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:i,rawDims:{pageWidth:n,pageHeight:s,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=i,this.pageRotation=(360+i-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=t.prototype._resizeWithKeyboard,i=lS.TRANSLATE_SMALL,n=lS.TRANSLATE_BIG;return Yx(this,"_resizerKeyboardManager",new sS([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-i,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[i,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-i]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,i]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],t.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Yx(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new mS({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(e,i){if(t._l10n??(t._l10n=e),t._l10nResizer||(t._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),-1!==t._borderLineWidth)return;const n=getComputedStyle(document.documentElement);t._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Gx("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return $d(this,mi)}set _isDraggable(t){Hd(this,mi,t),this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(2*t),this.y+=this.width*t/(2*e);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(2*t),this.y-=this.width*t/(2*e);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=$d(this,yi)}setParent(t){null!==t?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(zd(this,wi,Bi).call(this),$d(this,ni)?.remove(),Hd(this,ni,null)),this.parent=t}focusin(t){this._focusEventsAllowed&&($d(this,ai)?Hd(this,ai,!1):this.parent.setSelected(this))}focusout(t){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const e=t.relatedTarget;e?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,n){const[s,r]=this.parentDimensions;[i,n]=this.screenToPageTranslation(i,n),this.x=(t+i)/s,this.y=(e+n)/r,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,n]=this.parentDimensions;this.setAt(t*i,e*n,this.width*i,this.height*n),this._onTranslated()}translate(t,e){zd(this,wi,vi).call(this,this.parentDimensions,t,e)}translateInPage(t,e){$d(this,oi)||Hd(this,oi,[this.x,this.y,this.width,this.height]),zd(this,wi,vi).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){$d(this,oi)||Hd(this,oi,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[n,s]}=this;if(this.x+=t/n,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:t,y:e}=this.div.getBoundingClientRect();this.parent.findNewParent(this,t,e)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:a}=this;const[o,l]=this.getBaseTranslation();r+=o,a+=l;const{style:h}=i;h.left=`${(100*r).toFixed(2)}%`,h.top=`${(100*a).toFixed(2)}%`,this._onTranslating(r,a),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!$d(this,oi)&&($d(this,oi)[0]!==this.x||$d(this,oi)[1]!==this.y)}get _hasBeenResized(){return!!$d(this,oi)&&($d(this,oi)[2]!==this.width||$d(this,oi)[3]!==this.height)}getBaseTranslation(){const[e,i]=this.parentDimensions,{_borderLineWidth:n}=t,s=n/e,r=n/i;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,n]}=this;let{x:s,y:r,width:a,height:o}=this;if(a*=i,o*=n,s*=i,r*=n,this._mustFixPosition)switch(t){case 0:s=f_(s,0,i-a),r=f_(r,0,n-o);break;case 90:s=f_(s,0,i-o),r=f_(r,a,n);break;case 180:s=f_(s,a,i),r=f_(r,o,n);break;case 270:s=f_(s,o,i),r=f_(r,0,n-a)}this.x=s/=i,this.y=r/=n;const[l,h]=this.getBaseTranslation();s+=l,r+=h,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,i){var n;return zd(n=t,bi,Ai).call(n,e,i,this.parentRotation)}pageTranslationToScreen(e,i){var n;return zd(n=t,bi,Ai).call(n,e,i,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(1e4*t)/1e4}_onResizing(){}altTextFinish(){$d(this,Xe)?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||$d(this,hi))return this._editToolbar;this._editToolbar=new Q_(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,$d(this,Xe)?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return $d(this,Xe)||(cS.initialize(t._l10n),Hd(this,Xe,new cS(this)),$d(this,Ge)&&($d(this,Xe).data=$d(this,Ge),Hd(this,Ge,null))),$d(this,Xe)}get altTextData(){return $d(this,Xe)?.data}set altTextData(t){$d(this,Xe)&&($d(this,Xe).data=t)}get guessedAltText(){return $d(this,Xe)?.guessedText}async setGuessedAltText(t){await($d(this,Xe)?.setGuessedText(t))}serializeAltText(t){return $d(this,Xe)?.serialize(t)}hasAltText(){return!!$d(this,Xe)&&!$d(this,Xe).isEmpty()}hasAltTextData(){return $d(this,Xe)?.hasData()??!1}focusCommentButton(){$d(this,Ke)?.focusButton()}addCommentButton(){return $d(this,Ke)||Hd(this,Ke,new dS(this))}addStandaloneCommentButton(){$d(this,Ye)?this._uiManager.isEditingMode()&&$d(this,Ye).classList.remove("hidden"):this.hasComment&&(Hd(this,Ye,$d(this,Ke).renderForStandalone()),this.div.append($d(this,Ye)))}removeStandaloneCommentButton(){$d(this,Ke).removeStandaloneCommentButton(),Hd(this,Ye,null)}hideStandaloneCommentButton(){$d(this,Ye)?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:n}}=$d(this,Ke);return{text:e,richText:t,date:i,deleted:n,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){$d(this,Ke)||Hd(this,Ke,new dS(this)),$d(this,Ke).data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e)return;if($d(this,Ke)||Hd(this,Ke,new dS(this)),$d(this,Ke).setInitialText(t,i),!this.annotationElementId)return;const n=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);n&&this.updateFromAnnotationLayer(n)}get hasEditedComment(){return $d(this,Ke)?.hasBeenEdited()}get hasDeletedComment(){return $d(this,Ke)?.isDeleted()}get hasComment(){return!!$d(this,Ke)&&!$d(this,Ke).isEmpty()&&!$d(this,Ke).isDeleted()}async editComment(t){$d(this,Ke)||Hd(this,Ke,new dS(this)),$d(this,Ke).edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){$d(this,Ke).setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const e=180,i=100,[,,,n]=t.rect,[s]=this.pageDimensions,[r]=this.pageTranslation,a=r+s+1,o=n-i,l=a+e;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[a,o,l,n]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){$d(this,Ke).data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=$d(this,Qe)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),zd(this,wi,Ii).call(this);const[e,i]=this.parentDimensions;this.parentRotation%180!=0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[n,s]=this.getInitialTranslation();return this.translate(n,s),Z_(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&($d(this,gi)||Hd(this,gi,new pS({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:zd(this,wi,Ci).bind(this),onPinching:zd(this,wi,Pi).bind(this),onPinchEnd:zd(this,wi,Ti).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}pointerdown(t){const{isMac:e}=a_.platform;0!==t.button||t.ctrlKey&&e?t.preventDefault():(Hd(this,ai,!0),this._isDraggable?zd(this,wi,Di).call(this,t):zd(this,wi,Ri).call(this,t))}_onStartDragging(){}_onStopDragging(){}moveInDOM(){$d(this,di)&&clearTimeout($d(this,di)),Hd(this,di,setTimeout(()=>{Hd(this,di,null),this.parent?.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const n=this.parentScale,[s,r]=this.pageDimensions,[a,o]=this.pageTranslation,l=t/n,h=e/n,c=this.x*s,d=this.y*r,u=this.width*s,p=this.height*r;switch(i){case 0:return[c+l+a,r-d-h-p+o,c+l+u+a,r-d-h+o];case 90:return[c+h+a,r-d+l+o,c+h+p+a,r-d+l+u+o];case 180:return[c-l-u+a,r-d+h+o,c-l+a,r-d+h+p+o];case 270:return[c-h-p+a,r-d-l-u+o,c-h+a,r-d-l+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,n,s,r]=t,a=s-i,o=r-n;switch(this.rotation){case 0:return[i,e-r,a,o];case 90:return[i,e-n,o,a];case 180:return[s,e-n,a,o];case 270:return[s,e-r,o,a];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&t._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){$d(this,Ke)?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:n,deleted:s,richText:r},uid:a,pageIndex:o,creationDate:l,modificationDate:h}=this;return{id:a,pageIndex:o,rect:this.getPDFRect(),richText:r,contentsObj:{str:t},creationDate:l,modificationDate:i||h,popupRef:!s,color:e,opacity:n}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return!this.isInEditMode()&&(this.parent.setEditingState(!1),Hd(this,hi,!0),!0)}disableEditMode(){return!!this.isInEditMode()&&(this.parent.setEditingState(!0),Hd(this,hi,!1),!0)}isInEditMode(){return $d(this,hi)}shouldGetKeyboardEvents(){return $d(this,ci)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:n}=this.getClientDimensions(),{innerHeight:s,innerWidth:r}=window;return e<r&&n>0&&t<s&&i>0}rebuild(){zd(this,wi,Ii).call(this)}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const n=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});n.rotation=t.rotation,Hd(n,Ge,t.accessibilityData),n._isCopy=t.isCopy||!1;const[s,r]=n.pageDimensions,[a,o,l,h]=n.getRectInCurrentCoords(t.rect,r);return n.x=a/s,n.y=o/r,n.width=l/s,n.height=h/r,n}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||null!==this.serialize())}remove(){if($d(this,si)?.abort(),Hd(this,si,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),$d(this,di)&&(clearTimeout($d(this,di)),Hd(this,di,null)),zd(this,wi,Bi).call(this),this.removeEditToolbar(),$d(this,fi)){for(const t of $d(this,fi).values())clearTimeout(t);Hd(this,fi,null)}this.parent=null,$d(this,gi)?.destroy(),Hd(this,gi,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(zd(this,wi,_i).call(this),$d(this,ti).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return"ltr"===this._uiManager.direction?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,i]}=this,[n,s,r,a]=this.getPDFRect();return[t._round(n+(r-n)*e),t._round(s+(a-s)*(1-i))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return $d(this,Ke).commentPopupPositionInLayer}set commentPopupPosition(t){$d(this,Ke).commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return $d(this,Ke).hasDefaultPopupPosition()}get commentButtonWidth(){return $d(this,Ke).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){$d(this,Ke).setCommentButtonStates(t)}keydown(e){if(!this.isResizable||e.target!==this.div||"Enter"!==e.key)return;this._uiManager.setSelected(this),Hd(this,ii,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const i=$d(this,ti).children;if(!$d(this,qe)){Hd(this,qe,Array.from(i));const e=zd(this,wi,Oi).bind(this),n=zd(this,wi,Li).bind(this),s=this._uiManager._signal;for(const i of $d(this,qe)){const r=i.getAttribute("data-resizer-name");i.setAttribute("role","spinbutton"),i.addEventListener("keydown",e,{signal:s}),i.addEventListener("blur",n,{signal:s}),i.addEventListener("focus",zd(this,wi,Fi).bind(this,r),{signal:s}),i.setAttribute("data-l10n-id",t._l10nResizer[r])}}const n=$d(this,qe)[0];let s=0;for(const t of i){if(t===n)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*($d(this,qe).length/4);if(r!==s){if(r<s)for(let t=0;t<s-r;t++)$d(this,ti).append($d(this,ti).firstChild);else if(r>s)for(let t=0;t<r-s;t++)$d(this,ti).firstChild.before($d(this,ti).lastChild);let e=0;for(const n of i){const i=$d(this,qe)[e++].getAttribute("data-resizer-name");n.setAttribute("data-l10n-id",t._l10nResizer[i])}}zd(this,wi,Ni).call(this,0),Hd(this,ci,!0),$d(this,ti).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(t,e){$d(this,ci)&&zd(this,wi,Mi).call(this,$d(this,ri),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){zd(this,wi,Bi).call(this),this.div.focus()}select(){this.isSelected&&this._editToolbar?this._editToolbar.show():(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),this._editToolbar?(this._editToolbar?.show(),$d(this,Xe)?.toggleAltTextBadge(!1)):this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()}))}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,$d(this,ti)?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),$d(this,Xe)?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){"BUTTON"!==t.target.nodeName&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return $d(this,li)}set isEditing(t){Hd(this,li,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,i=!1){if(i){$d(this,fi)||Hd(this,fi,new Map);const{action:i}=e;let n=$d(this,fi).get(i);return n&&clearTimeout(n),n=setTimeout(()=>{this._reportTelemetry(e),$d(this,fi).delete(i),0===$d(this,fi).size&&Hd(this,fi,null)},t._telemetryTimeout),void $d(this,fi).set(i,n)}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),Hd(this,Qe,!1)}disable(){this.div&&(this.div.tabIndex=-1),Hd(this,Qe,!0)}updateFakeAnnotationElement(t){if($d(this,ni)||this.deleted)return this.deleted?($d(this,ni).remove(),void Hd(this,ni,null)):void((this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&$d(this,ni).updateEdited({rect:this.getPDFRect(),popup:this.comment}));Hd(this,ni,t.addFakeAnnotation(this))}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(e){if("CANVAS"===e.nodeName){const t=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.before(e)}}else e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);return e}resetAnnotationElement(t){const{firstChild:e}=t.container;"DIV"===e?.nodeName&&e.classList.contains("annotationContent")&&e.remove()}};Ge=new WeakMap,qe=new WeakMap,Xe=new WeakMap,Ke=new WeakMap,Ye=new WeakMap,Qe=new WeakMap,Je=new WeakMap,Ze=new WeakMap,ti=new WeakMap,ei=new WeakMap,ii=new WeakMap,ni=new WeakMap,si=new WeakMap,ri=new WeakMap,ai=new WeakMap,oi=new WeakMap,li=new WeakMap,hi=new WeakMap,ci=new WeakMap,di=new WeakMap,ui=new WeakMap,pi=new WeakMap,fi=new WeakMap,gi=new WeakMap,mi=new WeakMap,yi=new WeakMap,wi=new WeakSet,vi=function([t,e],i,n){[i,n]=this.screenToPageTranslation(i,n),this.x+=i/t,this.y+=n/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},bi=new WeakSet,Ai=function(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},xi=function(t){switch(t){case 90:{const[t,e]=this.pageDimensions;return[0,-t/e,e/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,e]=this.pageDimensions;return[0,t/e,-e/t,0]}default:return[1,0,0,1]}},_i=function(){if($d(this,ti))return;Hd(this,ti,document.createElement("div")),$d(this,ti).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const t=document.createElement("div");$d(this,ti).append(t),t.classList.add("resizer",i),t.setAttribute("data-resizer-name",i),t.addEventListener("pointerdown",zd(this,wi,Si).bind(this,i),{signal:e}),t.addEventListener("contextmenu",T_,{signal:e}),t.tabIndex=-1}this.div.prepend($d(this,ti))},Si=function(t,e){e.preventDefault();const{isMac:i}=a_.platform;if(0!==e.button||e.ctrlKey&&i)return;$d(this,Xe)?.toggle(!1);const n=this._isDraggable;this._isDraggable=!1,Hd(this,ei,[e.screenX,e.screenY]);const s=new AbortController,r=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",zd(this,wi,Mi).bind(this,t),{passive:!0,capture:!0,signal:r}),window.addEventListener("touchmove",R_,{passive:!1,signal:r}),window.addEventListener("contextmenu",T_,{signal:r}),Hd(this,ii,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,o=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const l=()=>{s.abort(),this.parent.togglePointerEvents(!0),$d(this,Xe)?.toggle(!0),this._isDraggable=n,this.parent.div.style.cursor=a,this.div.style.cursor=o,zd(this,wi,Ei).call(this)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},ki=function(t,e,i,n){this.width=i,this.height=n,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()},Ei=function(){if(!$d(this,ii))return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:n}=$d(this,ii);Hd(this,ii,null);const s=this.x,r=this.y,a=this.width,o=this.height;s===t&&r===e&&a===i&&o===n||this.addCommands({cmd:zd(this,wi,ki).bind(this,s,r,a,o),undo:zd(this,wi,ki).bind(this,t,e,i,n),mustExec:!0})},Mi=function(t,e){const[i,n]=this.parentDimensions,s=this.x,r=this.y,a=this.width,o=this.height,l=fS.MIN_SIZE/i,h=fS.MIN_SIZE/n,c=zd(this,wi,xi).call(this,this.rotation),d=(t,e)=>[c[0]*t+c[2]*e,c[1]*t+c[3]*e],u=zd(this,wi,xi).call(this,360-this.rotation);let p,f,g=!1,m=!1;switch(t){case"topLeft":g=!0,p=(t,e)=>[0,0],f=(t,e)=>[t,e];break;case"topMiddle":p=(t,e)=>[t/2,0],f=(t,e)=>[t/2,e];break;case"topRight":g=!0,p=(t,e)=>[t,0],f=(t,e)=>[0,e];break;case"middleRight":m=!0,p=(t,e)=>[t,e/2],f=(t,e)=>[0,e/2];break;case"bottomRight":g=!0,p=(t,e)=>[t,e],f=(t,e)=>[0,0];break;case"bottomMiddle":p=(t,e)=>[t/2,e],f=(t,e)=>[t/2,0];break;case"bottomLeft":g=!0,p=(t,e)=>[0,e],f=(t,e)=>[t,0];break;case"middleLeft":m=!0,p=(t,e)=>[0,e/2],f=(t,e)=>[t,e/2]}const y=p(a,o),w=f(a,o);let v=d(...w);const b=fS._round(s+v[0]),A=fS._round(r+v[1]);let x,_,S=1,k=1;if(e.fromKeyboard)({deltaX:x,deltaY:_}=e);else{const{screenX:t,screenY:i}=e,[n,s]=$d(this,ei);[x,_]=this.screenToPageTranslation(t-n,i-s),$d(this,ei)[0]=t,$d(this,ei)[1]=i}if([x,_]=((t,e)=>[u[0]*t+u[2]*e,u[1]*t+u[3]*e])(x/i,_/n),g){const t=Math.hypot(a,o);S=k=Math.max(Math.min(Math.hypot(w[0]-y[0]-x,w[1]-y[1]-_)/t,1/a,1/o),l/a,h/o)}else m?S=f_(Math.abs(w[0]-y[0]-x),l,1)/a:k=f_(Math.abs(w[1]-y[1]-_),h,1)/o;const E=fS._round(a*S),M=fS._round(o*k);v=d(...f(E,M));const C=b-v[0],P=A-v[1];$d(this,oi)||Hd(this,oi,[this.x,this.y,this.width,this.height]),this.width=E,this.height=M,this.x=C,this.y=P,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Ci=function(){Hd(this,ii,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),$d(this,Xe)?.toggle(!1),this.parent.togglePointerEvents(!1)},Pi=function(t,e,i){let n=i/e*.7+1-.7;if(1===n)return;const s=zd(this,wi,xi).call(this,this.rotation),r=(t,e)=>[s[0]*t+s[2]*e,s[1]*t+s[3]*e],[a,o]=this.parentDimensions,l=this.x,h=this.y,c=this.width,d=this.height,u=fS.MIN_SIZE/a,p=fS.MIN_SIZE/o;n=Math.max(Math.min(n,1/c,1/d),u/c,p/d);const f=fS._round(c*n),g=fS._round(d*n);if(f===c&&g===d)return;$d(this,oi)||Hd(this,oi,[l,h,c,d]);const m=r(c/2,d/2),y=fS._round(l+m[0]),w=fS._round(h+m[1]),v=r(f/2,g/2);this.x=y-v[0],this.y=w-v[1],this.width=f,this.height=g,this.setDims(),this.fixAndSetPosition(),this._onResizing()},Ti=function(){$d(this,Xe)?.toggle(!0),this.parent.togglePointerEvents(!0),zd(this,wi,Ei).call(this)},Ri=function(t){const{isMac:e}=a_.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Di=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const n=new AbortController,s=this._uiManager.combinedSignal(n),r={capture:!0,passive:!1,signal:s},a=t=>{n.abort(),Hd(this,Je,null),Hd(this,ai,!1),this._uiManager.endDragSession()||zd(this,wi,Ri).call(this,t),i&&this._onStopDragging()};e&&(Hd(this,ui,t.clientX),Hd(this,pi,t.clientY),Hd(this,Je,t.pointerId),Hd(this,Ze,t.pointerType),window.addEventListener("pointermove",t=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:e,clientY:n,pointerId:s}=t;if(s!==$d(this,Je))return void R_(t);const[r,a]=this.screenToPageTranslation(e-$d(this,ui),n-$d(this,pi));Hd(this,ui,e),Hd(this,pi,n),this._uiManager.dragSelectedEditors(r,a)},r),window.addEventListener("touchmove",R_,r),window.addEventListener("pointerdown",t=>{t.pointerType===$d(this,Ze)&&($d(this,gi)||t.isPrimary)&&a(t),R_(t)},r));const o=t=>{$d(this,Je)&&$d(this,Je)!==t.pointerId?R_(t):a(t)};window.addEventListener("pointerup",o,{signal:s}),window.addEventListener("blur",o,{signal:s})},Ii=function(){if($d(this,si)||!this.div)return;Hd(this,si,new AbortController);const t=this._uiManager.combinedSignal($d(this,si));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Oi=function(t){fS._resizerKeyboardManager.exec(this,t)},Li=function(t){$d(this,ci)&&t.relatedTarget?.parentNode!==$d(this,ti)&&zd(this,wi,Bi).call(this)},Fi=function(t){Hd(this,ri,$d(this,ci)?t:"")},Ni=function(t){if($d(this,qe))for(const e of $d(this,qe))e.tabIndex=t},Bi=function(){Hd(this,ci,!1),zd(this,wi,Ni).call(this,-1),zd(this,wi,Ei).call(this)},Ud(fS,bi),Wd(fS,"_l10n",null),Wd(fS,"_l10nResizer",null),Wd(fS,"_borderLineWidth",-1),Wd(fS,"_colorManager",new aS),Wd(fS,"_zIndex",1),Wd(fS,"_telemetryTimeout",1e3);let gS=fS;class mS extends gS{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const yS=3285377520,wS=4294901760,vS=65535;class bS{constructor(t){this.h1=t?4294967295&t:yS,this.h2=t?4294967295&t:yS}update(t){let e,i;if("string"==typeof t){e=new Uint8Array(2*t.length),i=0;for(let n=0,s=t.length;n<s;n++){const s=t.charCodeAt(n);s<=255?e[i++]=s:(e[i++]=s>>>8,e[i++]=255&s)}}else{if(!ArrayBuffer.isView(t))throw new Error("Invalid data format, must be a string or TypedArray.");e=t.slice(),i=e.byteLength}const n=i>>2,s=i-4*n,r=new Uint32Array(e.buffer,0,n);let a=0,o=0,l=this.h1,h=this.h2;const c=3432918353,d=461845907,u=11601,p=13715;for(let f=0;f<n;f++)1&f?(a=r[f],a=a*c&wS|a*u&vS,a=a<<15|a>>>17,a=a*d&wS|a*p&vS,l^=a,l=l<<13|l>>>19,l=5*l+3864292196):(o=r[f],o=o*c&wS|o*u&vS,o=o<<15|o>>>17,o=o*d&wS|o*p&vS,h^=o,h=h<<13|h>>>19,h=5*h+3864292196);switch(a=0,s){case 3:a^=e[4*n+2]<<16;case 2:a^=e[4*n+1]<<8;case 1:a^=e[4*n],a=a*c&wS|a*u&vS,a=a<<15|a>>>17,a=a*d&wS|a*p&vS,1&n?l^=a:h^=a}this.h1=l,this.h2=h}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=3981806797*t&wS|36045*t&vS,e=4283543511*e&wS|(2950163797*(e<<16|t>>>16)&wS)>>>16,t^=e>>>1,t=444984403*t&wS|60499*t&vS,e=3301882366*e&wS|(3120437893*(e<<16|t>>>16)&wS)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const AS=Object.freeze({map:null,hash:"",transfer:void 0});class xS{constructor(){Ud(this,Hi),Ud(this,Wi,!1),Ud(this,ji,null),Ud(this,$i,null),Ud(this,Ui,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=$d(this,Ui).get(t);return void 0===i?e:Object.assign(e,i)}getRawValue(t){return $d(this,Ui).get(t)}remove(t){const e=$d(this,Ui).get(t);if(void 0!==e&&(e instanceof gS&&$d(this,$i).delete(e.annotationElementId),$d(this,Ui).delete(t),0===$d(this,Ui).size&&this.resetModified(),"function"==typeof this.onAnnotationEditor)){for(const t of $d(this,Ui).values())if(t instanceof gS)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=$d(this,Ui).get(t);let n=!1;if(void 0!==i)for(const[s,r]of Object.entries(e))i[s]!==r&&(n=!0,i[s]=r);else n=!0,$d(this,Ui).set(t,e);n&&zd(this,Hi,zi).call(this),e instanceof gS&&(($d(this,$i)||Hd(this,$i,new Map)).set(e.annotationElementId,e),"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(e.constructor._type))}has(t){return $d(this,Ui).has(t)}get size(){return $d(this,Ui).size}resetModified(){$d(this,Wi)&&(Hd(this,Wi,!1),"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new _S(this)}get serializable(){if(0===$d(this,Ui).size)return AS;const t=new Map,e=new bS,i=[],n=Object.create(null);let s=!1;for(const[r,a]of $d(this,Ui)){const i=a instanceof gS?a.serialize(!1,n):a;i&&(t.set(r,i),e.update(`${r}:${JSON.stringify(i)}`),s||(s=!!i.bitmap))}if(s)for(const r of t.values())r.bitmap&&i.push(r.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:AS}get editorStats(){let t=null;const e=new Map;let i=0,n=0;for(const s of $d(this,Ui).values()){if(!(s instanceof gS)){s.popup&&(s.popup.deleted?n+=1:i+=1);continue}s.isCommentDeleted?n+=1:s.hasEditedComment&&(i+=1);const r=s.telemetryFinalData;if(!r)continue;const{type:a}=r;e.has(a)||e.set(a,Object.getPrototypeOf(s).constructor),t||(t=Object.create(null));const o=t[a]||(t[a]=new Map);for(const[t,e]of Object.entries(r)){if("type"===t)continue;let i=o.get(t);i||(i=new Map,o.set(t,i));const n=i.get(e)??0;i.set(e,n+1)}}if((n>0||i>0)&&(t||(t=Object.create(null)),t.comments={deleted:n,edited:i}),!t)return null;for(const[s,r]of e)t[s]=r.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){Hd(this,ji,null)}updateEditor(t,e){const i=$d(this,$i)?.get(t);return!!i&&(i.updateFromAnnotationLayer(e),!0)}getEditor(t){return $d(this,$i)?.get(t)||null}get modifiedIds(){if($d(this,ji))return $d(this,ji);const t=[];if($d(this,$i))for(const e of $d(this,$i).values())e.serialize()&&t.push(e.annotationElementId);return Hd(this,ji,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return $d(this,Ui).entries()}}Wi=new WeakMap,ji=new WeakMap,$i=new WeakMap,Ui=new WeakMap,Hi=new WeakSet,zi=function(){$d(this,Wi)||(Hd(this,Wi,!0),"function"==typeof this.onSetModified&&this.onSetModified())};class _S extends xS{constructor(t){super(),Ud(this,Vi);const{map:e,hash:i,transfer:n}=t.serializable,s=structuredClone(e,n?{transfer:n}:null);Hd(this,Vi,{map:s,hash:i,transfer:n})}get print(){Gx("Should not call PrintAnnotationStorage.print")}get serializable(){return $d(this,Vi)}get modifiedIds(){return Yx(this,"modifiedIds",{ids:new Set,hash:""})}}Vi=new WeakMap;class SS{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){Ud(this,Gi,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),$d(this,Gi).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(t&&!$d(this,Gi).has(t.loadedName)){if(qx(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:e,src:n,style:s}=t,r=new FontFace(e,n,s);this.addNativeFontFace(r);try{await r.load(),$d(this,Gi).add(e),i?.(t)}catch{t.baseFontName,this.removeNativeFontFace(r)}return}Gx("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo)return void(await this.loadSystemFont(t));if(this.isFontLoadingAPISupported){const e=t.createNativeFontFace();if(e){this.addNativeFontFace(e);try{await e.loaded}catch(i){throw e.family,t.disableFontFace=!0,i}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(e=>{const i=this._queueLoadingCallback(e);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){return Yx(this,"isFontLoadingAPISupported",!!this._document?.fonts)}get isSyncFontLoadingSupported(){return Yx(this,"isSyncFontLoadingSupported",Tx||a_.platform.isFirefox)}_queueLoadingCallback(t){const{loadingRequests:e}=this,i={done:!1,complete:function(){for(qx(!i.done,"completeRequest() cannot be called twice."),i.done=!0;e.length>0&&e[0].done;){const t=e.shift();setTimeout(t.callback,0)}},callback:t};return e.push(i),i}get _loadTestFont(){return Yx(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(t,e){function i(t,e){return t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|255&t.charCodeAt(e+3)}function n(t,e,i,n){return t.substring(0,e)+n+t.substring(e+i)}let s,r;const a=this._document.createElement("canvas");a.width=1,a.height=1;const o=a.getContext("2d");let l=0;const h=`lt${Date.now()}${this.loadTestFontId++}`;let c=this._loadTestFont;c=n(c,976,h.length,h);const d=1482184792;let u=i(c,16);for(s=0,r=h.length-3;s<r;s+=4)u=u-d+i(h,s)|0;var p;s<h.length&&(u=u-d+i(h+"XXX",s)|0),c=n(c,16,4,(p=u,String.fromCharCode(p>>24&255,p>>16&255,p>>8&255,255&p)));const f=`@font-face {font-family:"${h}";src:url(data:font/opentype;base64,${btoa(c)});}`;this.insertRule(f);const g=this._document.createElement("div");g.style.visibility="hidden",g.style.width=g.style.height="10px",g.style.position="absolute",g.style.top=g.style.left="0px";for(const m of[t.loadedName,h]){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=m,g.append(t)}this._document.body.append(g),function t(e,i){++l>30?i():(o.font="30px "+e,o.fillText(".",0,20),o.getImageData(0,0,1,1).data[3]>0?i():setTimeout(t.bind(null,e,i)))}(h,()=>{g.remove(),e.complete()})}}Gi=new WeakMap;class kS{constructor(t,e=null,i,n){Ud(this,qi),this.compiledGlyphs=Object.create(null),Hd(this,qi,t),this._inspectFont=e,i&&Object.assign(this,i),n&&(this.charProcOperatorList=n)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(this.cssFontInfo){const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}else t=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${g_(this.data)});`;let e;if(this.cssFontInfo){let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}else e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(void 0!==this.compiledGlyphs[e])return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let n;try{n=t.get(i)}catch(r){}const s=new Path2D(n||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=s}get black(){return $d(this,qi).black}get bold(){return $d(this,qi).bold}get disableFontFace(){return $d(this,qi).disableFontFace??!1}get fontExtraProperties(){return $d(this,qi).fontExtraProperties??!1}get isInvalidPDFjsFont(){return $d(this,qi).isInvalidPDFjsFont}get isType3Font(){return $d(this,qi).isType3Font}get italic(){return $d(this,qi).italic}get missingFile(){return $d(this,qi).missingFile}get remeasure(){return $d(this,qi).remeasure}get vertical(){return $d(this,qi).vertical}get ascent(){return $d(this,qi).ascent}get defaultWidth(){return $d(this,qi).defaultWidth}get descent(){return $d(this,qi).descent}get bbox(){return $d(this,qi).bbox}get fontMatrix(){return $d(this,qi).fontMatrix}get fallbackName(){return $d(this,qi).fallbackName}get loadedName(){return $d(this,qi).loadedName}get mimetype(){return $d(this,qi).mimetype}get name(){return $d(this,qi).name}get data(){return $d(this,qi).data}clearData(){$d(this,qi).clearData()}get cssFontInfo(){return $d(this,qi).cssFontInfo}get systemFontInfo(){return $d(this,qi).systemFontInfo}get defaultVMetrics(){return $d(this,qi).defaultVMetrics}}function ES(t){if("string"!=typeof t)return null;if(t.endsWith("/"))return t;throw new Error(`Invalid factory url: "${t}" must include trailing slash.`)}qi=new WeakMap;const MS=t=>"object"==typeof t&&Number.isInteger(t?.num)&&t.num>=0&&Number.isInteger(t?.gen)&&t.gen>=0,CS=function(t,e,i){if(!Array.isArray(i)||i.length<2)return!1;const[n,s,...r]=i;if(!t(n)&&!Number.isInteger(n))return!1;if(!e(s))return!1;const a=r.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return 0===a;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(4!==a)return!1;o=!1;break;default:return!1}for(const l of r)if(!("number"==typeof l||o&&null===l))return!1;return!0}.bind(null,MS,t=>"object"==typeof t&&"string"==typeof t?.name);class PS{constructor(){Ud(this,Xi,new Map),Ud(this,Ki,Promise.resolve())}postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};$d(this,Ki).then(()=>{for(const[t]of $d(this,Xi))t.call(this,i)})}addEventListener(t,e,i=null){let n=null;if(i?.signal instanceof AbortSignal){const{signal:s}=i;if(s.aborted)return;const r=()=>this.removeEventListener(t,e);n=()=>s.removeEventListener("abort",r),s.addEventListener("abort",r)}$d(this,Xi).set(e,n)}removeEventListener(t,e){const i=$d(this,Xi).get(e);i?.(),$d(this,Xi).delete(e)}terminate(){for(const[,t]of $d(this,Xi))t?.();$d(this,Xi).clear()}}Xi=new WeakMap,Ki=new WeakMap;function TS(){}function RS(t){if(t instanceof n_||t instanceof t_||t instanceof Jx||t instanceof e_||t instanceof Zx)return t;switch(t instanceof Error||"object"==typeof t&&null!==t||Gx('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new n_(t.message);case"InvalidPDFException":return new t_(t.message);case"PasswordException":return new Jx(t.message,t.code);case"ResponseException":return new e_(t.message,t.status,t.missing);case"UnknownErrorException":return new Zx(t.message,t.details)}return new Zx(t.message,t.toString())}class DS{constructor(t,e,i){Ud(this,Qi),Ud(this,Yi,new AbortController),this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",zd(this,Qi,Ji).bind(this),{signal:$d(this,Yi).signal})}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const n=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[n]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:n,data:e},i)}catch(r){s.reject(r)}return s.promise}sendWithStream(t,e,i,n){const s=this.streamId++,r=this.sourceName,a=this.targetName,o=this.comObj;return new ReadableStream({start:i=>{const l=Promise.withResolvers();return this.streamControllers[s]={controller:i,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},o.postMessage({sourceName:r,targetName:a,action:t,streamId:s,data:e,desiredSize:i.desiredSize},n),l.promise},pull:t=>{const e=Promise.withResolvers();return this.streamControllers[s].pullCall=e,o.postMessage({sourceName:r,targetName:a,stream:6,streamId:s,desiredSize:t.desiredSize}),e.promise},cancel:t=>{qx(t instanceof Error,"cancel must have a valid reason");const e=Promise.withResolvers();return this.streamControllers[s].cancelCall=e,this.streamControllers[s].isClosed=!0,o.postMessage({sourceName:r,targetName:a,stream:1,streamId:s,reason:RS(t)}),e.promise}},i)}destroy(){$d(this,Yi)?.abort(),Hd(this,Yi,null)}}Yi=new WeakMap,Qi=new WeakSet,Ji=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream)return void zd(this,Qi,tn).call(this,t);if(t.callback){const e=t.callbackId,i=this.callbackCapabilities[e];if(!i)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],1===t.callback)i.resolve(t.data);else{if(2!==t.callback)throw new Error("Unexpected callback case");i.reject(RS(t.reason))}return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,n=t.sourceName,s=this.comObj;return void Promise.try(e,t.data).then(function(e){s.postMessage({sourceName:i,targetName:n,callback:1,callbackId:t.callbackId,data:e})},function(e){s.postMessage({sourceName:i,targetName:n,callback:2,callbackId:t.callbackId,reason:RS(e)})})}t.streamId?zd(this,Qi,Zi).call(this,t):e(t.data)},Zi=function(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,r=this,a=this.actionHandler[t.action],o={enqueue(t,r=1,a){if(this.isCancelled)return;const o=this.desiredSize;this.desiredSize-=r,o>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:i,targetName:n,stream:4,streamId:e,chunk:t},a)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:3,streamId:e}),delete r.streamSinks[e])},error(t){qx(t instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:i,targetName:n,stream:5,streamId:e,reason:RS(t)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};o.sinkCapability.resolve(),o.ready=o.sinkCapability.promise,this.streamSinks[e]=o,Promise.try(a,t.data,o).then(function(){s.postMessage({sourceName:i,targetName:n,stream:8,streamId:e,success:!0})},function(t){s.postMessage({sourceName:i,targetName:n,stream:8,streamId:e,reason:RS(t)})})},tn=function(t){const e=t.streamId,i=this.sourceName,n=t.sourceName,s=this.comObj,r=this.streamControllers[e],a=this.streamSinks[e];switch(t.stream){case 8:t.success?r.startCall.resolve():r.startCall.reject(RS(t.reason));break;case 7:t.success?r.pullCall.resolve():r.pullCall.reject(RS(t.reason));break;case 6:if(!a){s.postMessage({sourceName:i,targetName:n,stream:7,streamId:e,success:!0});break}a.desiredSize<=0&&t.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=t.desiredSize,Promise.try(a.onPull||TS).then(function(){s.postMessage({sourceName:i,targetName:n,stream:7,streamId:e,success:!0})},function(t){s.postMessage({sourceName:i,targetName:n,stream:7,streamId:e,reason:RS(t)})});break;case 4:if(qx(r,"enqueue should have stream controller"),r.isClosed)break;r.controller.enqueue(t.chunk);break;case 3:if(qx(r,"close should have stream controller"),r.isClosed)break;r.isClosed=!0,r.controller.close(),zd(this,Qi,en).call(this,r,e);break;case 5:qx(r,"error should have stream controller"),r.controller.error(RS(t.reason)),zd(this,Qi,en).call(this,r,e);break;case 2:t.success?r.cancelCall.resolve():r.cancelCall.reject(RS(t.reason)),zd(this,Qi,en).call(this,r,e);break;case 1:if(!a)break;const o=RS(t.reason);Promise.try(a.onCancel||TS,o).then(function(){s.postMessage({sourceName:i,targetName:n,stream:2,streamId:e,success:!0})},function(t){s.postMessage({sourceName:i,targetName:n,stream:2,streamId:e,reason:RS(t)})}),a.sinkCapability.reject(o),a.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},en=async function(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]};class IS{constructor({enableHWA:t=!1}){Ud(this,nn,!1),Hd(this,nn,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!$d(this,nn)})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Gx("Abstract method `_createCanvas` called.")}}nn=new WeakMap;class OS extends IS{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class LS{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(t=>({cMapData:t,isCompressed:this.isCompressed})).catch(t=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Gx("Abstract method `_fetch` called.")}}class FS extends LS{async _fetch(t){const e=await A_(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):r_(e)}}class NS{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,n,s){return"none"}destroy(t=!1){}}class BS extends NS{constructor({docId:t,ownerDocument:e=globalThis.document}){super(),Ud(this,dn),Ud(this,sn),Ud(this,rn),Ud(this,an),Ud(this,on),Ud(this,ln),Ud(this,hn),Ud(this,cn,0),Hd(this,on,t),Hd(this,ln,e)}addFilter(t){if(!t)return"none";let e=$d(this,dn,un).get(t);if(e)return e;const[i,n,s]=zd(this,dn,gn).call(this,t),r=1===t.length?i:`${i}${n}${s}`;if(e=$d(this,dn,un).get(r),e)return $d(this,dn,un).set(t,e),e;const a=`g_${$d(this,on)}_transfer_map_${Vd(this,cn)._++}`,o=zd(this,dn,mn).call(this,a);$d(this,dn,un).set(t,o),$d(this,dn,un).set(r,o);const l=zd(this,dn,vn).call(this,a);return zd(this,dn,An).call(this,i,n,s,l),o}addHCMFilter(t,e){const i=`${t}-${e}`,n="base";let s=$d(this,dn,pn).get(n);if(s?.key===i)return s.url;if(s?(s.filter?.remove(),s.key=i,s.url="none",s.filter=null):(s={key:i,url:"none",filter:null},$d(this,dn,pn).set(n,s)),!t||!e)return s.url;const r=zd(this,dn,_n).call(this,t);t=l_.makeHexColor(...r);const a=zd(this,dn,_n).call(this,e);if(e=l_.makeHexColor(...a),$d(this,dn,fn).style.color="","#000000"===t&&"#ffffff"===e||t===e)return s.url;const o=new Array(256);for(let u=0;u<=255;u++){const t=u/255;o[u]=t<=.03928?t/12.92:((t+.055)/1.055)**2.4}const l=o.join(","),h=`g_${$d(this,on)}_hcm_filter`,c=s.filter=zd(this,dn,vn).call(this,h);zd(this,dn,An).call(this,l,l,l,c),zd(this,dn,wn).call(this,c);const d=(t,e)=>{const i=r[t]/255,n=a[t]/255,s=new Array(e+1);for(let r=0;r<=e;r++)s[r]=i+r/e*(n-i);return s.join(",")};return zd(this,dn,An).call(this,d(0,5),d(1,5),d(2,5),c),s.url=zd(this,dn,mn).call(this,h),s.url}addAlphaFilter(t){let e=$d(this,dn,un).get(t);if(e)return e;const[i]=zd(this,dn,gn).call(this,[t]),n=`alpha_${i}`;if(e=$d(this,dn,un).get(n),e)return $d(this,dn,un).set(t,e),e;const s=`g_${$d(this,on)}_alpha_map_${Vd(this,cn)._++}`,r=zd(this,dn,mn).call(this,s);$d(this,dn,un).set(t,r),$d(this,dn,un).set(n,r);const a=zd(this,dn,vn).call(this,s);return zd(this,dn,xn).call(this,i,a),r}addLuminosityFilter(t){let e,i,n=$d(this,dn,un).get(t||"luminosity");if(n)return n;if(t?([e]=zd(this,dn,gn).call(this,[t]),i=`luminosity_${e}`):i="luminosity",n=$d(this,dn,un).get(i),n)return $d(this,dn,un).set(t,n),n;const s=`g_${$d(this,on)}_luminosity_map_${Vd(this,cn)._++}`,r=zd(this,dn,mn).call(this,s);$d(this,dn,un).set(t,r),$d(this,dn,un).set(i,r);const a=zd(this,dn,vn).call(this,s);return zd(this,dn,yn).call(this,a),t&&zd(this,dn,xn).call(this,e,a),r}addHighlightHCMFilter(t,e,i,n,s){const r=`${e}-${i}-${n}-${s}`;let a=$d(this,dn,pn).get(t);if(a?.key===r)return a.url;if(a?(a.filter?.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},$d(this,dn,pn).set(t,a)),!e||!i)return a.url;const[o,l]=[e,i].map(zd(this,dn,_n).bind(this));let h=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),c=Math.round(.2126*l[0]+.7152*l[1]+.0722*l[2]),[d,u]=[n,s].map(zd(this,dn,_n).bind(this));c<h&&([h,c,d,u]=[c,h,u,d]),$d(this,dn,fn).style.color="";const p=(t,e,i)=>{const n=new Array(256),s=(c-h)/i,r=t/255,a=(e-t)/(255*i);let o=0;for(let l=0;l<=i;l++){const t=Math.round(h+l*s),e=r+l*a;for(let i=o;i<=t;i++)n[i]=e;o=t+1}for(let l=o;l<256;l++)n[l]=n[o-1];return n.join(",")},f=`g_${$d(this,on)}_hcm_${t}_filter`,g=a.filter=zd(this,dn,vn).call(this,f);return zd(this,dn,wn).call(this,g),zd(this,dn,An).call(this,p(d[0],u[0],5),p(d[1],u[1],5),p(d[2],u[2],5),g),a.url=zd(this,dn,mn).call(this,f),a.url}destroy(t=!1){t&&$d(this,hn)?.size||($d(this,an)?.parentNode.parentNode.remove(),Hd(this,an,null),$d(this,rn)?.clear(),Hd(this,rn,null),$d(this,hn)?.clear(),Hd(this,hn,null),Hd(this,cn,0))}}sn=new WeakMap,rn=new WeakMap,an=new WeakMap,on=new WeakMap,ln=new WeakMap,hn=new WeakMap,cn=new WeakMap,dn=new WeakSet,un=function(){return $d(this,rn)||Hd(this,rn,new Map)},pn=function(){return $d(this,hn)||Hd(this,hn,new Map)},fn=function(){if(!$d(this,an)){const t=$d(this,ln).createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=$d(this,ln).createElementNS(w_,"svg");i.setAttribute("width",0),i.setAttribute("height",0),Hd(this,an,$d(this,ln).createElementNS(w_,"defs")),t.append(i),i.append($d(this,an)),$d(this,ln).body.append(t)}return $d(this,an)},gn=function(t){if(1===t.length){const e=t[0],i=new Array(256);for(let t=0;t<256;t++)i[t]=e[t]/255;const n=i.join(",");return[n,n,n]}const[e,i,n]=t,s=new Array(256),r=new Array(256),a=new Array(256);for(let o=0;o<256;o++)s[o]=e[o]/255,r[o]=i[o]/255,a[o]=n[o]/255;return[s.join(","),r.join(","),a.join(",")]},mn=function(t){if(void 0===$d(this,sn)){Hd(this,sn,"");const t=$d(this,ln).URL;t!==$d(this,ln).baseURI&&(S_(t)||Hd(this,sn,Kx(t,"")))}return`url(${$d(this,sn)}#${t})`},yn=function(t){const e=$d(this,ln).createElementNS(w_,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)},wn=function(t){const e=$d(this,ln).createElementNS(w_,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)},vn=function(t){const e=$d(this,ln).createElementNS(w_,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),$d(this,dn,fn).append(e),e},bn=function(t,e,i){const n=$d(this,ln).createElementNS(w_,e);n.setAttribute("type","discrete"),n.setAttribute("tableValues",i),t.append(n)},An=function(t,e,i,n){const s=$d(this,ln).createElementNS(w_,"feComponentTransfer");n.append(s),zd(this,dn,bn).call(this,s,"feFuncR",t),zd(this,dn,bn).call(this,s,"feFuncG",e),zd(this,dn,bn).call(this,s,"feFuncB",i)},xn=function(t,e){const i=$d(this,ln).createElementNS(w_,"feComponentTransfer");e.append(i),zd(this,dn,bn).call(this,i,"feFuncA",t)},_n=function(t){return $d(this,dn,fn).style.color=t,O_(getComputedStyle($d(this,dn,fn)).getPropertyValue("color"))};class WS{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(t=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Gx("Abstract method `_fetch` called.")}}class jS extends WS{async _fetch(t){const e=await A_(t,"arraybuffer");return new Uint8Array(e)}}class $S{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(t=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Gx("Abstract method `_fetch` called.")}}class US extends $S{async _fetch(t){const e=await A_(t,"arraybuffer");return new Uint8Array(e)}}async function HS(t){const e=process.getBuiltinModule("fs"),i=await e.promises.readFile(t);return new Uint8Array(i)}class zS extends NS{}class VS extends IS{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class GS extends LS{async _fetch(t){return HS(t)}}class qS extends WS{async _fetch(t){return HS(t)}}class XS extends $S{async _fetch(t){return HS(t)}}const KS="__forcedDependency",{floor:YS,ceil:QS}=Math;function JS(t,e,i,n,s,r){t[4*e+0]=Math.min(t[4*e+0],i),t[4*e+1]=Math.min(t[4*e+1],n),t[4*e+2]=Math.max(t[4*e+2],s),t[4*e+3]=Math.max(t[4*e+3],r)}const ZS=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class tk{constructor(t,e){Ud(this,Sn),Ud(this,kn),Hd(this,Sn,t),Hd(this,kn,e)}get length(){return $d(this,Sn).length}isEmpty(t){return $d(this,Sn)[t]===ZS}minX(t){return $d(this,kn)[4*t+0]/256}minY(t){return $d(this,kn)[4*t+1]/256}maxX(t){return($d(this,kn)[4*t+2]+1)/256}maxY(t){return($d(this,kn)[4*t+3]+1)/256}}Sn=new WeakMap,kn=new WeakMap;const ek=(t,e)=>{if(!t)return;let i=t.get(e);return i||(i={dependencies:new Set,isRenderingOperation:!1},t.set(e,i)),i};class ik{constructor(t,e,i=!1){Ud(this,Hn),Ud(this,En,{__proto__:null}),Ud(this,Mn,{__proto__:null,transform:[],moveText:[],sameLineText:[],[KS]:[]}),Ud(this,Cn,new Map),Ud(this,Pn,[]),Ud(this,Tn,[]),Ud(this,Rn,[[1,0,0,1,0,0]]),Ud(this,Dn,[-1/0,-1/0,1/0,1/0]),Ud(this,In,new Float64Array([1/0,1/0,-1/0,-1/0])),Ud(this,On,-1),Ud(this,Ln,new Set),Ud(this,Fn,new Map),Ud(this,Nn,new Map),Ud(this,Bn),Ud(this,Wn),Ud(this,jn),Ud(this,$n),Ud(this,Un),Hd(this,Bn,t.width),Hd(this,Wn,t.height),zd(this,Hn,zn).call(this,e),i&&Hd(this,Un,new Map)}growOperationsCount(t){t>=$d(this,$n).length&&zd(this,Hn,zn).call(this,t,$d(this,$n))}save(t){return Hd(this,En,{__proto__:$d(this,En)}),Hd(this,Mn,{__proto__:$d(this,Mn),transform:{__proto__:$d(this,Mn).transform},moveText:{__proto__:$d(this,Mn).moveText},sameLineText:{__proto__:$d(this,Mn).sameLineText},[KS]:{__proto__:$d(this,Mn)[KS]}}),Hd(this,Dn,{__proto__:$d(this,Dn)}),$d(this,Pn).push(t),this}restore(t){const e=Object.getPrototypeOf($d(this,En));if(null===e)return this;Hd(this,En,e),Hd(this,Mn,Object.getPrototypeOf($d(this,Mn))),Hd(this,Dn,Object.getPrototypeOf($d(this,Dn)));const i=$d(this,Pn).pop();return void 0!==i&&(ek($d(this,Un),t)?.dependencies.add(i),$d(this,$n)[t]=$d(this,$n)[i]),this}recordOpenMarker(t){return $d(this,Pn).push(t),this}getOpenMarker(){return 0===$d(this,Pn).length?null:$d(this,Pn).at(-1)}recordCloseMarker(t){const e=$d(this,Pn).pop();return void 0!==e&&(ek($d(this,Un),t)?.dependencies.add(e),$d(this,$n)[t]=$d(this,$n)[e]),this}beginMarkedContent(t){return $d(this,Tn).push(t),this}endMarkedContent(t){const e=$d(this,Tn).pop();return void 0!==e&&(ek($d(this,Un),t)?.dependencies.add(e),$d(this,$n)[t]=$d(this,$n)[e]),this}pushBaseTransform(t){return $d(this,Rn).push(l_.multiplyByDOMMatrix($d(this,Rn).at(-1),t.getTransform())),this}popBaseTransform(){return $d(this,Rn).length>1&&$d(this,Rn).pop(),this}recordSimpleData(t,e){return $d(this,En)[t]=e,this}recordIncrementalData(t,e){return $d(this,Mn)[t].push(e),this}resetIncrementalData(t,e){return $d(this,Mn)[t].length=0,this}recordNamedData(t,e){return $d(this,Cn).set(t,e),this}recordSimpleDataFromNamed(t,e,i){$d(this,En)[t]=$d(this,Cn).get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(KS,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in $d(this,En)&&this.recordFutureForcedDependency(e,$d(this,En)[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of $d(this,Ln))this.recordFutureForcedDependency(KS,t);return this}resetBBox(t){return $d(this,On)!==t&&(Hd(this,On,t),$d(this,In)[0]=1/0,$d(this,In)[1]=1/0,$d(this,In)[2]=-1/0,$d(this,In)[3]=-1/0),this}recordClipBox(t,e,i,n,s,r){const a=l_.multiplyByDOMMatrix($d(this,Rn).at(-1),e.getTransform()),o=[1/0,1/0,-1/0,-1/0];l_.axialAlignedBoundingBox([i,s,n,r],a,o);const l=l_.intersect($d(this,Dn),o);return l?($d(this,Dn)[0]=l[0],$d(this,Dn)[1]=l[1],$d(this,Dn)[2]=l[2],$d(this,Dn)[3]=l[3]):($d(this,Dn)[0]=$d(this,Dn)[1]=1/0,$d(this,Dn)[2]=$d(this,Dn)[3]=-1/0),this}recordBBox(t,e,i,n,s,r){const a=$d(this,Dn);if(a[0]===1/0)return this;const o=l_.multiplyByDOMMatrix($d(this,Rn).at(-1),e.getTransform());if(a[0]===-1/0)return l_.axialAlignedBoundingBox([i,s,n,r],o,$d(this,In)),this;const l=[1/0,1/0,-1/0,-1/0];return l_.axialAlignedBoundingBox([i,s,n,r],o,l),$d(this,In)[0]=Math.min($d(this,In)[0],Math.max(l[0],a[0])),$d(this,In)[1]=Math.min($d(this,In)[1],Math.max(l[1],a[1])),$d(this,In)[2]=Math.max($d(this,In)[2],Math.min(l[2],a[2])),$d(this,In)[3]=Math.max($d(this,In)[3],Math.min(l[3],a[3])),this}recordCharacterBBox(t,e,i,n=1,s=0,r=0,a){const o=i.bbox;let l,h;if(o&&(l=o[2]!==o[0]&&o[3]!==o[1]&&$d(this,Nn).get(i),!1!==l&&(h=[0,0,0,0],l_.axialAlignedBoundingBox(o,i.fontMatrix,h),1===n&&0===s&&0===r||l_.scaleMinMax([n,0,0,-n,s,r],h),l)))return this.recordBBox(t,e,h[0],h[2],h[1],h[3]);if(!a)return this.recordFullPageBBox(t);const c=a();return o&&h&&void 0===l&&(l=h[0]<=s-c.actualBoundingBoxLeft&&h[2]>=s+c.actualBoundingBoxRight&&h[1]<=r-c.actualBoundingBoxAscent&&h[3]>=r+c.actualBoundingBoxDescent,$d(this,Nn).set(i,l),l)?this.recordBBox(t,e,h[0],h[2],h[1],h[3]):this.recordBBox(t,e,s-c.actualBoundingBoxLeft,s+c.actualBoundingBoxRight,r-c.actualBoundingBoxAscent,r+c.actualBoundingBoxDescent)}recordFullPageBBox(t){return $d(this,In)[0]=Math.max(0,$d(this,Dn)[0]),$d(this,In)[1]=Math.max(0,$d(this,Dn)[1]),$d(this,In)[2]=Math.min($d(this,Bn),$d(this,Dn)[2]),$d(this,In)[3]=Math.min($d(this,Wn),$d(this,Dn)[3]),this}getSimpleIndex(t){return $d(this,En)[t]}recordDependencies(t,e){const i=$d(this,Ln),n=$d(this,En),s=$d(this,Mn);for(const r of e)r in $d(this,En)?i.add(n[r]):r in s&&s[r].forEach(i.add,i);return this}recordNamedDependency(t,e){return $d(this,Cn).has(e)&&$d(this,Ln).add($d(this,Cn).get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[KS]),$d(this,Un)){const e=ek($d(this,Un),t),{dependencies:i}=e;$d(this,Ln).forEach(i.add,i),$d(this,Pn).forEach(i.add,i),$d(this,Tn).forEach(i.add,i),i.delete(t),e.isRenderingOperation=!0}if($d(this,On)===t){const i=YS(256*$d(this,In)[0]/$d(this,Bn)),n=YS(256*$d(this,In)[1]/$d(this,Wn)),s=QS(256*$d(this,In)[2]/$d(this,Bn)),r=QS(256*$d(this,In)[3]/$d(this,Wn));JS($d(this,jn),t,i,n,s,r);for(const e of $d(this,Ln))e!==t&&JS($d(this,jn),e,i,n,s,r);for(const e of $d(this,Pn))e!==t&&JS($d(this,jn),e,i,n,s,r);for(const e of $d(this,Tn))e!==t&&JS($d(this,jn),e,i,n,s,r);e||($d(this,Ln).clear(),Hd(this,On,-1))}return this}recordShowTextOperation(t,e=!1){const i=Array.from($d(this,Ln));this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const n of i)this.recordIncrementalData("sameLineText",n);return this}bboxToClipBoxDropOperation(t,e=!1){return $d(this,On)===t&&(Hd(this,On,-1),$d(this,Dn)[0]=Math.max($d(this,Dn)[0],$d(this,In)[0]),$d(this,Dn)[1]=Math.max($d(this,Dn)[1],$d(this,In)[1]),$d(this,Dn)[2]=Math.min($d(this,Dn)[2],$d(this,In)[2]),$d(this,Dn)[3]=Math.min($d(this,Dn)[3],$d(this,In)[3]),e||$d(this,Ln).clear()),this}_takePendingDependencies(){const t=$d(this,Ln);return Hd(this,Ln,new Set),t}_extractOperation(t){const e=$d(this,Fn).get(t);return $d(this,Fn).delete(t),e}_pushPendingDependencies(t){for(const e of t)$d(this,Ln).add(e)}take(){return $d(this,Nn).clear(),new tk($d(this,$n),$d(this,jn))}takeDebugMetadata(){return $d(this,Un)}}En=new WeakMap,Mn=new WeakMap,Cn=new WeakMap,Pn=new WeakMap,Tn=new WeakMap,Rn=new WeakMap,Dn=new WeakMap,In=new WeakMap,On=new WeakMap,Ln=new WeakMap,Fn=new WeakMap,Nn=new WeakMap,Bn=new WeakMap,Wn=new WeakMap,jn=new WeakMap,$n=new WeakMap,Un=new WeakMap,Hn=new WeakSet,zn=function(t,e){const i=new ArrayBuffer(4*t);Hd(this,jn,new Uint8ClampedArray(i)),Hd(this,$n,new Uint32Array(i)),e&&e.length>0?($d(this,$n).set(e),$d(this,$n).fill(ZS,e.length)):$d(this,$n).fill(ZS)},Vn=new WeakMap,Gn=new WeakMap,qn=new WeakMap,Xn=new WeakMap,Kn=new WeakMap;let nk=class t{constructor(e,i,n){if(Ud(this,Vn),Ud(this,Gn),Ud(this,qn),Ud(this,Xn,0),Ud(this,Kn,0),e instanceof t&&$d(e,qn)===!!n)return e;Hd(this,Vn,e),Hd(this,Gn,i),Hd(this,qn,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(t){return Vd(this,Kn)._++,$d(this,Vn).save($d(this,Gn)),this}restore(t){return $d(this,Kn)>0&&($d(this,Vn).restore($d(this,Gn)),Vd(this,Kn)._--),this}recordOpenMarker(t){return Vd(this,Xn)._++,this}getOpenMarker(){return $d(this,Xn)>0?$d(this,Gn):$d(this,Vn).getOpenMarker()}recordCloseMarker(t){return Vd(this,Xn)._--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return $d(this,Vn).pushBaseTransform(t),this}popBaseTransform(){return $d(this,Vn).popBaseTransform(),this}recordSimpleData(t,e){return $d(this,Vn).recordSimpleData(t,$d(this,Gn)),this}recordIncrementalData(t,e){return $d(this,Vn).recordIncrementalData(t,$d(this,Gn)),this}resetIncrementalData(t,e){return $d(this,Vn).resetIncrementalData(t,$d(this,Gn)),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return $d(this,Vn).recordSimpleDataFromNamed(t,e,$d(this,Gn)),this}recordFutureForcedDependency(t,e){return $d(this,Vn).recordFutureForcedDependency(t,$d(this,Gn)),this}inheritSimpleDataAsFutureForcedDependencies(t){return $d(this,Vn).inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return $d(this,Vn).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return $d(this,qn)||$d(this,Vn).resetBBox($d(this,Gn)),this}recordClipBox(t,e,i,n,s,r){return $d(this,qn)||$d(this,Vn).recordClipBox($d(this,Gn),e,i,n,s,r),this}recordBBox(t,e,i,n,s,r){return $d(this,qn)||$d(this,Vn).recordBBox($d(this,Gn),e,i,n,s,r),this}recordCharacterBBox(t,e,i,n,s,r,a){return $d(this,qn)||$d(this,Vn).recordCharacterBBox($d(this,Gn),e,i,n,s,r,a),this}recordFullPageBBox(t){return $d(this,qn)||$d(this,Vn).recordFullPageBBox($d(this,Gn)),this}getSimpleIndex(t){return $d(this,Vn).getSimpleIndex(t)}recordDependencies(t,e){return $d(this,Vn).recordDependencies($d(this,Gn),e),this}recordNamedDependency(t,e){return $d(this,Vn).recordNamedDependency($d(this,Gn),e),this}recordOperation(t){return $d(this,Vn).recordOperation($d(this,Gn),!0),this}recordShowTextOperation(t){return $d(this,Vn).recordShowTextOperation($d(this,Gn),!0),this}bboxToClipBoxDropOperation(t){return $d(this,qn)||$d(this,Vn).bboxToClipBoxDropOperation($d(this,Gn),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};const sk=["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],rk=["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],ak=["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],ok=["filter","fillColor","fillAlpha"],lk=["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],hk=["transform"],ck=["transform","fillColor"],dk="Fill",uk="Stroke",pk="Shading";function fk(t,e){if(!e)return;const i=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],i,n),t.clip(s)}class gk{isModifyingCurrentTransform(){return!1}getPattern(){Gx("Abstract method `getPattern` called.")}}class mk extends gk{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;"axial"===this._type?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,n){let s;if(n===uk||n===dk){const r=e.current.getClippedPathBoundingBox(n,L_(t))||[0,0,0,0],a=Math.ceil(r[2]-r[0])||1,o=Math.ceil(r[3]-r[1])||1,l=e.cachedCanvases.getCanvas("pattern",a,o),h=l.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-r[0],-r[1]),i=l_.transform(i,[1,0,0,1,r[0],r[1]]),h.transform(...e.baseTransform),this.matrix&&h.transform(...this.matrix),fk(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),s=t.createPattern(l.canvas,"no-repeat");const c=new DOMMatrix(i);s.setTransform(c)}else fk(t,this._bbox),s=this._createGradient(t);return s}}function yk(t,e,i,n,s,r,a,o){const l=e.coords,h=e.colors,c=t.data,d=4*t.width;let u;l[i+1]>l[n+1]&&(u=i,i=n,n=u,u=r,r=a,a=u),l[n+1]>l[s+1]&&(u=n,n=s,s=u,u=a,a=o,o=u),l[i+1]>l[n+1]&&(u=i,i=n,n=u,u=r,r=a,a=u);const p=(l[i]+e.offsetX)*e.scaleX,f=(l[i+1]+e.offsetY)*e.scaleY,g=(l[n]+e.offsetX)*e.scaleX,m=(l[n+1]+e.offsetY)*e.scaleY,y=(l[s]+e.offsetX)*e.scaleX,w=(l[s+1]+e.offsetY)*e.scaleY;if(f>=w)return;const v=h[r],b=h[r+1],A=h[r+2],x=h[a],_=h[a+1],S=h[a+2],k=h[o],E=h[o+1],M=h[o+2],C=Math.round(f),P=Math.round(w);let T,R,D,I,O,L,F,N;for(let B=C;B<=P;B++){if(B<m){const t=B<f?0:(f-B)/(f-m);T=p-(p-g)*t,R=v-(v-x)*t,D=b-(b-_)*t,I=A-(A-S)*t}else{let t;t=B>w?1:m===w?0:(m-B)/(m-w),T=g-(g-y)*t,R=x-(x-k)*t,D=_-(_-E)*t,I=S-(S-M)*t}let t;t=B<f?0:B>w?1:(f-B)/(f-w),O=p-(p-y)*t,L=v-(v-k)*t,F=b-(b-E)*t,N=A-(A-M)*t;const e=Math.round(Math.min(T,O)),i=Math.round(Math.max(T,O));let n=d*B+4*e;for(let s=e;s<=i;s++)t=(T-s)/(T-O),t<0?t=0:t>1&&(t=1),c[n++]=R-(R-L)*t|0,c[n++]=D-(D-F)*t|0,c[n++]=I-(I-N)*t|0,c[n++]=255}}function wk(t,e,i){const n=e.coords,s=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(n.length/o)-1,h=o-1;for(r=0;r<l;r++){let e=r*o;for(let r=0;r<h;r++,e++)yk(t,i,n[e],n[e+1],n[e+o],s[e],s[e+1],s[e+o]),yk(t,i,n[e+o+1],n[e+1],n[e+o],s[e+o+1],s[e+1],s[e+o])}break;case"triangles":for(r=0,a=n.length;r<a;r+=3)yk(t,i,n[r],n[r+1],n[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class vk extends gk{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const n=Math.floor(this._bounds[0]),s=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-n,a=Math.ceil(this._bounds[3])-s,o=Math.min(Math.ceil(Math.abs(r*t[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(a*t[1]*1.1)),3e3),h=r/o,c=a/l,d={coords:this._coords,colors:this._colors,offsetX:-n,offsetY:-s,scaleX:1/h,scaleY:1/c},u=o+4,p=l+4,f=i.getCanvas("mesh",u,p),g=f.context,m=g.createImageData(o,l);if(e){const t=m.data;for(let i=0,n=t.length;i<n;i+=4)t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=255}for(const y of this._figures)wk(m,y,d);return g.putImageData(m,2,2),{canvas:f.canvas,offsetX:n-2*h,offsetY:s-2*c,scaleX:h,scaleY:c}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,n){fk(t,this._bbox);const s=new Float32Array(2);if(n===pk)l_.singularValueDecompose2dScale(L_(t),s);else if(this.matrix){l_.singularValueDecompose2dScale(this.matrix,s);const[t,i]=s;l_.singularValueDecompose2dScale(e.baseTransform,s),s[0]*=t,s[1]*=i}else l_.singularValueDecompose2dScale(e.baseTransform,s);const r=this._createMeshCanvas(s,n===pk?null:this._background,e.cachedCanvases);return n!==pk&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(r.offsetX,r.offsetY),t.scale(r.scaleX,r.scaleY),t.createPattern(r.canvas,"no-repeat")}}class bk extends gk{getPattern(){return"hotpink"}}const Ak=class t{constructor(t,e,i,n){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(t,e){const{bbox:i,operatorList:n,paintType:s,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:h}=this;l=Math.abs(l),h=Math.abs(h);const c=i[0],d=i[1],u=i[2],p=i[3],f=u-c,g=p-d,m=new Float32Array(2);l_.singularValueDecompose2dScale(this.matrix,m);const[y,w]=m;l_.singularValueDecompose2dScale(this.baseTransform,m);const v=y*m[0],b=w*m[1];let A=f,x=g,_=!1,S=!1;const k=Math.ceil(l*v),E=Math.ceil(h*b);k>=Math.ceil(f*v)?A=l:_=!0,E>=Math.ceil(g*b)?x=h:S=!0;const M=this.getSizeAndScale(A,this.ctx.canvas.width,v),C=this.getSizeAndScale(x,this.ctx.canvas.height,b),P=t.cachedCanvases.getCanvas("pattern",M.size,C.size),T=P.context,R=o.createCanvasGraphics(T,e);if(R.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(R,s,a),T.translate(-M.scale*c,-C.scale*d),R.transform(0,M.scale,0,0,C.scale,0,0),T.save(),R.dependencyTracker?.save(),this.clipBbox(R,c,d,u,p),R.baseTransform=L_(R.ctx),R.executeOperatorList(n),R.endDrawing(),R.dependencyTracker?.restore(),T.restore(),_||S){const e=P.canvas;_&&(A=l),S&&(x=h);const i=this.getSizeAndScale(A,this.ctx.canvas.width,v),n=this.getSizeAndScale(x,this.ctx.canvas.height,b),s=i.size,r=n.size,a=t.cachedCanvases.getCanvas("pattern-workaround",s,r),o=a.context,u=_?Math.floor(f/l):0,p=S?Math.floor(g/h):0;for(let t=0;t<=u;t++)for(let i=0;i<=p;i++)o.drawImage(e,s*t,r*i,s,r,0,0,s,r);return{canvas:a.canvas,scaleX:i.scale,scaleY:n.scale,offsetX:c,offsetY:d}}return{canvas:P.canvas,scaleX:M.scale,scaleY:C.scale,offsetX:c,offsetY:d}}getSizeAndScale(e,i,n){const s=Math.max(t.MAX_PATTERN_SIZE,i);let r=Math.ceil(e*n);return r>=s?r=s:n=r/e,{scale:n,size:r}}clipBbox(t,e,i,n,s){const r=n-e,a=s-i;t.ctx.rect(e,i,r,a),l_.axialAlignedBoundingBox([e,i,n,s],L_(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const n=t.ctx,s=t.current;switch(e){case 1:const{fillStyle:t,strokeStyle:r}=this.ctx;n.fillStyle=s.fillColor=t,n.strokeStyle=s.strokeColor=r;break;case 2:n.fillStyle=n.strokeStyle=i,s.fillColor=s.strokeColor=i;break;default:throw new i_(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,n,s){let r=i;n!==pk&&(r=l_.transform(r,e.baseTransform),this.matrix&&(r=l_.transform(r,this.matrix)));const a=this.createPatternCanvas(e,s);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=t.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Wd(Ak,"MAX_PATTERN_SIZE",3e3);let xk=Ak;function _k({src:t,srcPos:e=0,dest:i,width:n,height:s,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=a_.isLittleEndian?4278190080:255,[l,h]=a?[r,o]:[o,r],c=n>>3,d=7&n,u=t.length;i=new Uint32Array(i.buffer);let p=0;for(let f=0;f<s;f++){for(const s=e+c;e<s;e++){const n=e<u?t[e]:255;i[p++]=128&n?h:l,i[p++]=64&n?h:l,i[p++]=32&n?h:l,i[p++]=16&n?h:l,i[p++]=8&n?h:l,i[p++]=4&n?h:l,i[p++]=2&n?h:l,i[p++]=1&n?h:l}if(0===d)continue;const n=e<u?t[e++]:255;for(let t=0;t<d;t++)i[p++]=n&1<<7-t?h:l}return{srcPos:e,destPos:p}}const Sk=16,kk=new DOMMatrix,Ek=new Float32Array(2),Mk=new Float32Array([1/0,1/0,-1/0,-1/0]);class Ck{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let n;return void 0!==this.cache[t]?(n=this.cache[t],this.canvasFactory.reset(n,e,i)):(n=this.canvasFactory.create(e,i),this.cache[t]=n),n}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Pk(t,e,i,n,s,r,a,o,l,h){const[c,d,u,p,f,g]=L_(t);if(0===d&&0===u){const m=a*c+f,y=Math.round(m),w=o*p+g,v=Math.round(w),b=(a+l)*c+f,A=Math.abs(Math.round(b)-y)||1,x=(o+h)*p+g,_=Math.abs(Math.round(x)-v)||1;return t.setTransform(Math.sign(c),0,0,Math.sign(p),y,v),t.drawImage(e,i,n,s,r,0,0,A,_),t.setTransform(c,d,u,p,f,g),[A,_]}if(0===c&&0===p){const m=o*u+f,y=Math.round(m),w=a*d+g,v=Math.round(w),b=(o+h)*u+f,A=Math.abs(Math.round(b)-y)||1,x=(a+l)*d+g,_=Math.abs(Math.round(x)-v)||1;return t.setTransform(0,Math.sign(d),Math.sign(u),0,y,v),t.drawImage(e,i,n,s,r,0,0,_,A),t.setTransform(c,d,u,p,f,g),[_,A]}return t.drawImage(e,i,n,s,r,a,o,l,h),[Math.hypot(c,d)*l,Math.hypot(u,p)*h]}class Tk{constructor(t,e,i){Wd(this,"alphaIsShape",!1),Wd(this,"fontSize",0),Wd(this,"fontSizeScale",1),Wd(this,"textMatrix",null),Wd(this,"textMatrixScale",1),Wd(this,"fontMatrix",Rx),Wd(this,"leading",0),Wd(this,"x",0),Wd(this,"y",0),Wd(this,"lineX",0),Wd(this,"lineY",0),Wd(this,"charSpacing",0),Wd(this,"wordSpacing",0),Wd(this,"textHScale",1),Wd(this,"textRenderingMode",0),Wd(this,"textRise",0),Wd(this,"fillColor","#000000"),Wd(this,"strokeColor","#000000"),Wd(this,"patternFill",!1),Wd(this,"patternStroke",!1),Wd(this,"fillAlpha",1),Wd(this,"strokeAlpha",1),Wd(this,"lineWidth",1),Wd(this,"activeSMask",null),Wd(this,"transferMaps","none"),i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Mk.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=dk,e=null){const i=this.minMax.slice();if(t===uk){e||Gx("Stroke bounding box must include transform."),l_.singularValueDecompose2dScale(e,Ek);const t=Ek[0]*this.lineWidth/2,n=Ek[1]*this.lineWidth/2;i[0]-=t,i[1]-=n,i[2]+=t,i[3]+=n}return i}updateClipFromPath(){const t=l_.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Mk,0)}getClippedPathBoundingBox(t=dk,e=null){return l_.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Rk(t,e){if(e instanceof ImageData)return void t.putImageData(e,0,0);const i=e.height,n=e.width,s=i%Sk,r=(i-s)/Sk,a=0===s?r:r+1,o=t.createImageData(n,Sk);let l,h=0;const c=e.data,d=o.data;let u,p,f,g;if(e.kind===Bx.GRAYSCALE_1BPP){const e=c.byteLength,i=new Uint32Array(d.buffer,0,d.byteLength>>2),g=i.length,m=n+7>>3,y=4294967295,w=a_.isLittleEndian?4278190080:255;for(u=0;u<a;u++){for(f=u<r?Sk:s,l=0,p=0;p<f;p++){const t=e-h;let s=0;const r=t>m?n:8*t-7,a=-8&r;let o=0,d=0;for(;s<a;s+=8)d=c[h++],i[l++]=128&d?y:w,i[l++]=64&d?y:w,i[l++]=32&d?y:w,i[l++]=16&d?y:w,i[l++]=8&d?y:w,i[l++]=4&d?y:w,i[l++]=2&d?y:w,i[l++]=1&d?y:w;for(;s<r;s++)0===o&&(d=c[h++],o=128),i[l++]=d&o?y:w,o>>=1}for(;l<g;)i[l++]=0;t.putImageData(o,0,u*Sk)}}else if(e.kind===Bx.RGBA_32BPP){for(p=0,g=n*Sk*4,u=0;u<r;u++)d.set(c.subarray(h,h+g)),h+=g,t.putImageData(o,0,p),p+=Sk;u<a&&(g=n*s*4,d.set(c.subarray(h,h+g)),t.putImageData(o,0,p))}else{if(e.kind!==Bx.RGB_24BPP)throw new Error(`bad image kind: ${e.kind}`);for(f=Sk,g=n*f,u=0;u<a;u++){for(u>=r&&(f=s,g=n*f),l=0,p=g;p--;)d[l++]=c[h++],d[l++]=c[h++],d[l++]=c[h++],d[l++]=255;t.putImageData(o,0,u*Sk)}}}function Dk(t,e){if(e.bitmap)return void t.drawImage(e.bitmap,0,0);const i=e.height,n=e.width,s=i%Sk,r=(i-s)/Sk,a=0===s?r:r+1,o=t.createImageData(n,Sk);let l=0;const h=e.data,c=o.data;for(let d=0;d<a;d++){const e=d<r?Sk:s;({srcPos:l}=_k({src:h,srcPos:l,dest:c,width:n,height:e,nonBlackColor:0})),t.putImageData(o,0,d*Sk)}}function Ik(t,e){const i=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of i)void 0!==t[n]&&(e[n]=t[n]);void 0!==t.setLineDash&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function Ok(t){t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",void 0!==t.setLineDash&&(t.setLineDash([]),t.lineDashOffset=0);const{filter:e}=t;"none"!==e&&""!==e&&(t.filter="none")}function Lk(t,e){if(e)return!0;l_.singularValueDecompose2dScale(t,Ek);const i=Math.fround(B_.pixelRatio*b_.PDF_TO_CSS_UNITS);return Ek[0]<=i&&Ek[1]<=i}const Fk=["butt","round","square"],Nk=["miter","round","bevel"],Bk={},Wk={};Yn=new WeakSet,Qn=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Jn=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==t){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},Zn=function(t,e,i){const n=new Path2D;return n.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),n};let jk=class t{constructor(t,e,i,n,s,{optionalContentConfig:r,markedContentStack:a=null},o,l,h){Ud(this,Yn),this.ctx=t,this.current=new Tk(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=n,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=r,this.cachedCanvases=new Ck(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=o,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=h??null}getObject(t,e,i=null){return"string"==typeof e?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:n=null}){const s=this.ctx.canvas.width,r=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=n||"#ffffff",this.ctx.fillRect(0,0,s,r),this.ctx.fillStyle=a,i){const t=this.cachedCanvases.getCanvas("transparent",s,r);this.compositeCtx=this.ctx,this.transparentCanvas=t.canvas,this.ctx=t.context,this.ctx.save(),this.ctx.transform(...L_(this.compositeCtx))}this.ctx.save(),Ok(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=L_(this.ctx)}executeOperatorList(t,e,i,n,s){const r=t.argsArray,a=t.fnArray;let o=e||0;const l=r.length;if(l===o)return o;const h=l-o>10&&"function"==typeof i,c=h?Date.now()+15:0;let d=0;const u=this.commonObjs,p=this.objs;let f,g;for(;;){if(void 0!==n&&o===n.nextBreakPoint)return n.breakIt(o,i),o;if(!s||s(o))if(f=a[o],g=r[o]??null,f!==$x.dependency)null===g?this[f](o):this[f](o,...g);else for(const t of g){this.dependencyTracker?.recordNamedData(t,o);const e=t.startsWith("g_")?u:p;if(!e.has(t))return e.get(t,i),o}if(o++,o===l)return o;if(h&&++d>10){if(Date.now()>c)return i(),o;d=0}}}endDrawing(){zd(this,Yn,Qn).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),zd(this,Yn,Jn).call(this)}_scaleImage(t,e){const i=t.width??t.displayWidth,n=t.height??t.displayHeight;let s,r,a=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),l=i,h=n,c="prescale1";for(;a>2&&l>1||o>2&&h>1;){let e=l,i=h;a>2&&l>1&&(e=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),a/=l/e),o>2&&h>1&&(i=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/i),s=this.cachedCanvases.getCanvas(c,e,i),r=s.context,r.clearRect(0,0,e,i),r.drawImage(t,0,0,l,h,0,0,e,i),t=s.canvas,l=e,h=i,c="prescale1"===c?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:h}}_createMaskCanvas(t,e){const i=this.ctx,{width:n,height:s}=e,r=this.current.fillColor,a=this.current.patternFill,o=L_(i);let l,h,c,d;if((e.bitmap||e.data)&&e.count>1){const i=e.bitmap||e.data.buffer;h=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(i),l||(l=new Map,this._cachedBitmapsMap.set(i,l));const n=l.get(h);if(n&&!a){const e=Math.round(Math.min(o[0],o[2])+o[4]),i=Math.round(Math.min(o[1],o[3])+o[5]);return this.dependencyTracker?.recordDependencies(t,ck),{canvas:n,offsetX:e,offsetY:i}}c=n}c||(d=this.cachedCanvases.getCanvas("maskCanvas",n,s),Dk(d.context,e));let u=l_.transform(o,[1/n,0,0,-1/s,0,0]);u=l_.transform(u,[1,0,0,1,0,-s]);const p=Mk.slice();l_.axialAlignedBoundingBox([0,0,n,s],u,p);const[f,g,m,y]=p,w=Math.round(m-f)||1,v=Math.round(y-g)||1,b=this.cachedCanvases.getCanvas("fillCanvas",w,v),A=b.context,x=f,_=g;A.translate(-x,-_),A.transform(...u),c||(c=this._scaleImage(d.canvas,F_(A)),c=c.img,l&&a&&l.set(h,c)),A.imageSmoothingEnabled=Lk(L_(A),e.interpolate),Pk(A,c,0,0,c.width,c.height,0,0,n,s),A.globalCompositeOperation="source-in";const S=l_.transform(F_(A),[1,0,0,1,-x,-_]);return A.fillStyle=a?r.getPattern(i,this,S,dk,t):r,A.fillRect(0,0,n,s),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(h,b.canvas)),this.dependencyTracker?.recordDependencies(t,ck),{canvas:b.canvas,offsetX:Math.round(x),offsetY:Math.round(_)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=Fk[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=Nk[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,n]of e)switch(i){case"LW":this.setLineWidth(t,n);break;case"LC":this.setLineCap(t,n);break;case"LJ":this.setLineJoin(t,n);break;case"ML":this.setMiterLimit(t,n);break;case"D":this.setDash(t,n[0],n[1]);break;case"RI":this.setRenderingIntent(t,n);break;case"FL":this.setFlatness(t,n);break;case"Font":this.setFont(t,n[0],n[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=n;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=n;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=n;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(n,e,i);this.suspendedCtx=this.ctx;const r=this.ctx=s.context;r.setTransform(this.suspendedCtx.getTransform()),Ik(this.suspendedCtx,r),function(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(t,i){e.translate(t,i),this.__originalTranslate(t,i)},t.scale=function(t,i){e.scale(t,i),this.__originalScale(t,i)},t.transform=function(t,i,n,s,r,a){e.transform(t,i,n,s,r,a),this.__originalTransform(t,i,n,s,r,a)},t.setTransform=function(t,i,n,s,r,a){e.setTransform(t,i,n,s,r,a),this.__originalSetTransform(t,i,n,s,r,a)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(t){e.rotate(t),this.__originalRotate(t)},t.clip=function(t){e.clip(t),this.__originalClip(t)},t.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},t.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},t.bezierCurveTo=function(t,i,n,s,r,a){e.bezierCurveTo(t,i,n,s,r,a),this.__originalBezierCurveTo(t,i,n,s,r,a)},t.rect=function(t,i,n,s){e.rect(t,i,n,s),this.__originalRect(t,i,n,s)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}(r,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ik(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,n){const s=n[0],r=n[1],a=n[2]-s,o=n[3]-r;0!==a&&0!==o&&(this.genericComposeSMask(e.context,i,a,o,e.subtype,e.backdrop,e.transferMap,s,r,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,n,s,r,a,o,l,h,c){let d=t.canvas,u=o-h,p=l-c;if(r)if(u<0||p<0||u+i>d.width||p+n>d.height){const t=this.cachedCanvases.getCanvas("maskExtension",i,n),e=t.context;e.drawImage(d,-u,-p),e.globalCompositeOperation="destination-atop",e.fillStyle=r,e.fillRect(0,0,i,n),e.globalCompositeOperation="source-over",d=t.canvas,u=p=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const e=new Path2D;e.rect(u,p,i,n),t.clip(e),t.globalCompositeOperation="destination-atop",t.fillStyle=r,t.fillRect(u,p,i,n),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),"Alpha"===s&&a?e.filter=this.filterFactory.addAlphaFilter(a):"Luminosity"===s&&(e.filter=this.filterFactory.addLuminosityFilter(a));const f=new Path2D;f.rect(o,l,i,n),e.clip(f),e.globalCompositeOperation="destination-in",e.drawImage(d,u,p,i,n,o,l,i,n),e.restore()}save(t){this.inSMaskMode&&Ik(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){this.dependencyTracker?.restore(t),0!==this.stateStack.length?(this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Ik(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null):this.inSMaskMode&&this.endSMaskMode()}transform(t,e,i,n,s,r,a){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,n,s,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,n){let[s]=i;if(!n)return s||(s=i[0]=new Path2D),void this[e](t,s);if(null!==this.dependencyTracker){const i=e===$x.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,n[0]-i,n[2]+i,n[1]-i,n[3]+i).recordDependencies(t,["transform"])}if(!(s instanceof Path2D)){const t=i[0]=new Path2D;for(let e=0,i=s.length;e<i;)switch(s[e++]){case 0:t.moveTo(s[e++],s[e++]);break;case 1:t.lineTo(s[e++],s[e++]);break;case 2:t.bezierCurveTo(s[e++],s[e++],s[e++],s[e++],s[e++],s[e++]);break;case 3:t.closePath();break;default:Vx(s[e-1])}s=t}l_.axialAlignedBoundingBox(n,L_(this.ctx),this.current.minMax),this[e](t,s),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const n=this.ctx,s=this.current.strokeColor;if(n.globalAlpha=this.current.strokeAlpha,this.contentVisible)if("object"==typeof s&&s?.getPattern){const i=s.isModifyingCurrentTransform()?n.getTransform():null;if(n.save(),n.strokeStyle=s.getPattern(n,this,F_(n),uk,t),i){const t=new Path2D;t.addPath(e,n.getTransform().invertSelf().multiplySelf(i)),e=t}this.rescaleAndStroke(e,!1),n.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,sk),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(uk,L_(this.ctx))),n.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const n=this.ctx,s=this.current.fillColor;let r=!1;if(this.current.patternFill){const i=s.isModifyingCurrentTransform()?n.getTransform():null;if(this.dependencyTracker?.save(t),n.save(),n.fillStyle=s.getPattern(n,this,F_(n),dk,t),i){const t=new Path2D;t.addPath(e,n.getTransform().invertSelf().multiplySelf(i)),e=t}r=!0}const a=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==a&&(this.pendingEOFill?(n.fill(e,"evenodd"),this.pendingEOFill=!1):n.fill(e)),this.dependencyTracker?.recordDependencies(t,rk),r&&(n.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,a)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,ok).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Bk}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Wk}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;void 0!==e&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",t),i.recordCloseMarker(t)}if(void 0!==e){const t=new Path2D,n=i.getTransform().invertSelf();for(const{transform:i,x:s,y:r,fontSize:a,path:o}of e)o&&t.addPath(o,new DOMMatrix(i).preMultiplySelf(n).translate(s,r).scale(a,-a));i.clip(t)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const n=this.commonObjs.get(e),s=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=n.fontMatrix||Rx,0===s.fontMatrix[0]||s.fontMatrix[3],i<0?(i=-i,s.fontDirection=-1):s.fontDirection=1,this.current.font=n,this.current.fontSize=i,n.isType3Font)return;const r=n.loadedName||"sans-serif",a=n.systemFontInfo?.css||`"${r}", ${n.fallbackName}`;let o="normal";n.black?o="900":n.bold&&(o="bold");const l=n.italic?"italic":"normal";let h=i;i<16?h=16:i>100&&(h=100),this.current.fontSizeScale=i/h,this.ctx.font=`${l} ${o} ${h}px ${a}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}paintChar(t,e,i,n,s,r){const a=this.ctx,o=this.current,l=o.font,h=o.textRenderingMode,c=o.fontSize/o.fontSizeScale,d=3&h,u=!!(4&h),p=o.patternFill&&!l.missingFile,f=o.patternStroke&&!l.missingFile;let g;if((l.disableFontFace||u||p||f)&&!l.missingFile&&(g=l.getPathGenerator(this.commonObjs,e)),g&&(l.disableFontFace||p||f)){let e;if(a.save(),a.translate(i,n),a.scale(c,-c),this.dependencyTracker?.recordCharacterBBox(t,a,l),0===d||2===d)if(s){e=a.getTransform(),a.setTransform(...s);const t=zd(this,Yn,Zn).call(this,g,e,s);a.fill(t)}else a.fill(g);if(1===d||2===d)if(r){e||(e=a.getTransform()),a.setTransform(...r);const{a:t,b:i,c:n,d:s}=e,o=l_.inverseTransform(r),l=l_.transform([t,i,n,s,0,0],o);l_.singularValueDecompose2dScale(l,Ek),a.lineWidth*=Math.max(Ek[0],Ek[1])/c,a.stroke(zd(this,Yn,Zn).call(this,g,e,r))}else a.lineWidth/=c,a.stroke(g);a.restore()}else 0!==d&&2!==d||(a.fillText(e,i,n),this.dependencyTracker?.recordCharacterBBox(t,a,l,c,i,n,()=>a.measureText(e))),1!==d&&2!==d||(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,a,l,c,i,n,()=>a.measureText(e)).recordDependencies(t,sk),a.strokeText(e,i,n));u&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:L_(a),x:i,y:n,fontSize:c,path:g}),this.dependencyTracker?.recordCharacterBBox(t,a,l,c,i,n))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let n=3;n<e.length;n+=4)if(e[n]>0&&e[n]<255){i=!0;break}return Yx(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,lk).resetBBox(t),4&this.current.textRenderingMode&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,n=i.font;if(n.isType3Font)return this.showType3Text(t,e),void this.dependencyTracker?.recordShowTextOperation(t);const s=i.fontSize;if(0===s)return void this.dependencyTracker?.recordOperation(t);const r=this.ctx,a=i.fontSizeScale,o=i.charSpacing,l=i.wordSpacing,h=i.fontDirection,c=i.textHScale*h,d=e.length,u=n.vertical,p=u?1:-1,f=n.defaultVMetrics,g=s*i.fontMatrix[0],m=0===i.textRenderingMode&&!n.disableFontFace&&!i.patternFill;let y,w;if(r.save(),i.textMatrix&&r.transform(...i.textMatrix),r.translate(i.x,i.y+i.textRise),h>0?r.scale(c,-1):r.scale(c,1),i.patternFill){r.save();const e=i.fillColor.getPattern(r,this,F_(r),dk,t);y=L_(r),r.restore(),r.fillStyle=e}if(i.patternStroke){r.save();const e=i.strokeColor.getPattern(r,this,F_(r),uk,t);w=L_(r),r.restore(),r.strokeStyle=e}let v=i.lineWidth;const b=i.textMatrixScale;if(0===b||0===v){const t=3&i.textRenderingMode;1!==t&&2!==t||(v=this.getSinglePixelWidth())}else v/=b;if(1!==a&&(r.scale(a,a),v/=a),r.lineWidth=v,n.isInvalidPDFjsFont){const n=[];let s=0;for(const t of e)n.push(t.unicode),s+=t.width;const a=n.join("");if(r.fillText(a,0,0),null!==this.dependencyTracker){const e=r.measureText(a);this.dependencyTracker.recordBBox(t,this.ctx,-e.actualBoundingBoxLeft,e.actualBoundingBoxRight,-e.actualBoundingBoxAscent,e.actualBoundingBoxDescent).recordShowTextOperation(t)}return i.x+=s*g*c,r.restore(),void this.compose()}let A,x=0;for(A=0;A<d;++A){const i=e[A];if("number"==typeof i){x+=p*i*s/1e3;continue}let c=!1;const d=(i.isSpace?l:0)+o,v=i.fontChar,b=i.accent;let _,S,k,E=i.width;if(u){const t=i.vmetric||f,e=-(i.vmetric?t[1]:.5*E)*g,n=t[2]*g;E=t?-t[0]:E,_=e/a,S=(x+n)/a}else _=x/a,S=0;if(n.remeasure&&E>0){k=r.measureText(v);const t=1e3*k.width/s*a;if(E<t&&this.isFontSubpixelAAEnabled){const e=E/t;c=!0,r.save(),r.scale(e,1),_/=e}else E!==t&&(_+=(E-t)/2e3*s/a)}if(this.contentVisible&&(i.isInFont||n.missingFile))if(m&&!b)r.fillText(v,_,S),this.dependencyTracker?.recordCharacterBBox(t,r,k?{bbox:null}:n,s/a,_,S,()=>k??r.measureText(v));else if(this.paintChar(t,v,_,S,y,w),b){const e=_+s*b.offset.x/a,i=S-s*b.offset.y/a;this.paintChar(t,b.fontChar,e,i,y,w)}x+=u?E*g-d*h:E*g+d*h,c&&r.restore()}u?i.y-=x:i.x+=x*c,r.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,n=this.current,s=n.font,r=n.fontSize,a=n.fontDirection,o=s.vertical?1:-1,l=n.charSpacing,h=n.wordSpacing,c=n.textHScale*a,d=n.fontMatrix||Rx,u=e.length;let p,f,g,m;if(3===n.textRenderingMode||0===r)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),n.textMatrix&&i.transform(...n.textMatrix),i.translate(n.x,n.y+n.textRise),i.scale(c,a);const y=this.dependencyTracker;for(this.dependencyTracker=y?new nk(y,t):null,p=0;p<u;++p){if(f=e[p],"number"==typeof f){m=o*f*r/1e3,this.ctx.translate(m,0),n.x+=m*c;continue}const t=(f.isSpace?h:0)+l,a=s.charProcOperatorList[f.operatorListId];a?this.contentVisible&&(this.save(),i.scale(r,r),i.transform(...d),this.executeOperatorList(a),this.restore()):Vx(f.operatorListId);const u=[f.width,0];l_.applyTransform(u,d),g=u[0]*r+t,i.translate(g,0),n.x+=g*c}i.restore(),y&&(this.dependencyTracker=y)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,n,s,r,a){const o=new Path2D;o.rect(n,s,r-n,a-s),this.ctx.clip(o),this.dependencyTracker?.recordBBox(t,this.ctx,n,r,s,a).recordClipBox(t,this.ctx,n,r,s,a),this.endPath(t)}getColorN_Pattern(e,i){let n;if("TilingPattern"===i[0]){const e=this.baseTransform||L_(this.ctx),s={createCanvasGraphics:(e,i)=>new t(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new nk(this.dependencyTracker,i,!0):null)};n=new xk(i,this.ctx,s,e)}else n=this._getPattern(e,i[1],i[2]);return n}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=function(t){switch(t[0]){case"RadialAxial":return new mk(t);case"Mesh":return new vk(t);case"Dummy":return new bk}throw new Error(`Unknown IR type: ${t[0]}`)}(this.getObject(t,e)),this.cachedPatterns.set(e,n)),i&&(n.matrix=i),n}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const n=this._getPattern(t,e);i.fillStyle=n.getPattern(i,this,F_(i),pk,t);const s=F_(i);if(s){const{width:t,height:e}=i.canvas,n=Mk.slice();l_.axialAlignedBoundingBox([0,0,t,e],s,n);const[r,a,o,l]=n;this.ctx.fillRect(r,a,o-r,l-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,hk).recordDependencies(t,rk).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Gx("Should not call beginInlineImage")}beginImageData(){Gx("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=L_(this.ctx),i)){l_.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[e,n,s,r]=i,a=new Path2D;a.rect(e,n,s-e,r-n),this.ctx.clip(a),this.dependencyTracker?.recordClipBox(t,this.ctx,e,s,n,r),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated,e.knockout;const n=L_(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=Mk.slice();l_.axialAlignedBoundingBox(e.bbox,L_(i),s);const r=[0,0,i.canvas.width,i.canvas.height];s=l_.intersect(s,r)||[0,0,0,0];const a=Math.floor(s[0]),o=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-a,1),h=Math.max(Math.ceil(s[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,h]);let c="groupAt"+this.groupLevel;e.smask&&(c+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(c,l,h),u=d.context;u.translate(-a,-o),u.transform(...n);let p=new Path2D;const[f,g,m,y]=e.bbox;if(p.rect(f,g,m-f,y-g),e.matrix){const t=new Path2D;t.addPath(p,new DOMMatrix(e.matrix)),p=t}u.clip(p),e.smask&&this.smaskStack.push({canvas:d.canvas,context:u,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),e.smask&&!this.dependencyTracker||(i.setTransform(1,0,0,1,0,0),i.translate(a,o),i.save()),Ik(i,u),this.ctx=u,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const e=L_(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...e);const n=Mk.slice();l_.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],e,n),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,e,i,n,s,r){if(zd(this,Yn,Qn).call(this),Ok(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const s=i[2]-i[0],a=i[3]-i[1];if(r&&this.annotationCanvasMap){(n=n.slice())[4]-=i[0],n[5]-=i[1],(i=i.slice())[0]=i[1]=0,i[2]=s,i[3]=a,l_.singularValueDecompose2dScale(L_(this.ctx),Ek);const{viewportScale:t}=this,r=Math.ceil(s*this.outputScaleX*t),o=Math.ceil(a*this.outputScaleY*t);this.annotationCanvas=this.canvasFactory.create(r,o);const{canvas:l,context:h}=this.annotationCanvas;this.annotationCanvasMap.set(e,l),this.annotationCanvas.savedCtx=this.ctx,this.ctx=h,this.ctx.save(),this.ctx.setTransform(Ek[0],0,0,-Ek[1],0,a*Ek[1]),Ok(this.ctx)}else{Ok(this.ctx),this.endPath(t);const e=new Path2D;e.rect(i[0],i[1],s,a),this.ctx.clip(e)}}this.current=new Tk(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...n),this.transform(t,...s)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),zd(this,Yn,Jn).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;(e=this.getObject(t,e.data,e)).count=i;const n=this.ctx,s=this._createMaskCanvas(t,e),r=s.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(r,s.offsetX,s.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,s.offsetX,s.offsetX+r.width,s.offsetY,s.offsetY+r.height).recordOperation(t),n.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,n=0,s=0,r,a){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const o=this.ctx;o.save();const l=L_(o);o.transform(i,n,s,r,0,0);const h=this._createMaskCanvas(t,e);o.setTransform(1,0,0,1,h.offsetX-l[4],h.offsetY-l[5]),this.dependencyTracker?.resetBBox(t);for(let c=0,d=a.length;c<d;c+=2){const e=l_.transform(l,[i,n,s,r,a[c],a[c+1]]);o.drawImage(h.canvas,e[4],e[5]),this.dependencyTracker?.recordBBox(t,this.ctx,e[4],e[4]+h.canvas.width,e[5],e[5]+h.canvas.height)}o.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,n=this.current.fillColor,s=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,ck);for(const r of e){const{data:e,width:a,height:o,transform:l}=r,h=this.cachedCanvases.getCanvas("maskCanvas",a,o),c=h.context;c.save(),Dk(c,this.getObject(t,e,r)),c.globalCompositeOperation="source-in",c.fillStyle=s?n.getPattern(c,this,F_(i),dk,t):n,c.fillRect(0,0,a,o),c.restore(),i.save(),i.transform(...l),i.scale(1,-1),Pk(i,h.canvas,0,0,a,o,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,a,0,o),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);i&&this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,n,s){if(!this.contentVisible)return;const r=this.getObject(t,e);if(!r)return;const a=r.width,o=r.height,l=[];for(let h=0,c=s.length;h<c;h+=2)l.push({transform:[i,0,0,n,s[h],s[h+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(t,r,l)}applyTransferMapsToCanvas(t){return"none"!==this.current.transferMaps&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if("none"===this.current.transferMaps)return t.bitmap;const{bitmap:e,width:i,height:n}=t,s=this.cachedCanvases.getCanvas("inlineImage",i,n),r=s.context;return r.filter=this.current.transferMaps,r.drawImage(e,0,0),r.filter="none",s.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,n=e.height,s=this.ctx;this.save(t);const{filter:r}=s;let a;if("none"!==r&&""!==r&&(s.filter="none"),s.scale(1/i,-1/n),e.bitmap)a=this.applyTransferMapsToBitmap(e);else if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)a=e;else{const t=this.cachedCanvases.getCanvas("inlineImage",i,n).context;Rk(t,e),a=this.applyTransferMapsToCanvas(t)}const o=this._scaleImage(a,F_(s));s.imageSmoothingEnabled=Lk(L_(s),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,s,0,i,-n,0).recordDependencies(t,ak).recordOperation(t),Pk(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-n,i,n),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const n=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const t=e.width,i=e.height,n=this.cachedCanvases.getCanvas("inlineImage",t,i).context;Rk(n,e),s=this.applyTransferMapsToCanvas(n)}this.dependencyTracker?.resetBBox(t);for(const r of i)n.save(),n.transform(...r.transform),n.scale(1,-1),Pk(n,s,r.x,r.y,r.w,r.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,1,-1,0),n.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,rk).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const s=this.ctx;this.pendingClip?(n||(this.pendingClip===Wk?s.clip(e,"evenodd"):s.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=L_(this.ctx);if(0===t[1]&&0===t[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),n=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,n)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:t}=this.current,{a:e,b:i,c:n,d:s}=this.ctx.getTransform();let r,a;if(0===i&&0===n){const i=Math.abs(e),n=Math.abs(s);if(i===n)if(0===t)r=a=1/i;else{const e=i*t;r=a=e<1?1/e:1}else if(0===t)r=1/i,a=1/n;else{const e=i*t,s=n*t;r=e<1?1/e:1,a=s<1?1/s:1}}else{const o=Math.abs(e*s-i*n),l=Math.hypot(e,i),h=Math.hypot(n,s);if(0===t)r=h/o,a=l/o;else{const e=t*o;r=h>e?h/e:1,a=l>e?l/e:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:n}}=this,[s,r]=this.getScaleForStroking();if(s===r)return i.lineWidth=(n||1)*s,void i.stroke(t);const a=i.getLineDash();e&&i.save(),i.scale(s,r),kk.a=1/s,kk.d=1/r;const o=new Path2D;if(o.addPath(t,kk),a.length>0){const t=Math.max(s,r);i.setLineDash(a.map(e=>e/t)),i.lineDashOffset/=t}i.lineWidth=n||1,i.stroke(o),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};for(const KO in $x)void 0!==jk.prototype[KO]&&(jk.prototype[$x[KO]]=jk.prototype[KO]);const $k=class t{constructor(t){Ud(this,ns),Ud(this,ts),Ud(this,es),Ud(this,is),Hd(this,ts,t),Hd(this,es,new DataView($d(this,ts))),Hd(this,is,new TextDecoder)}static write(e){const i=new TextEncoder,n={};let s=0;for(const h of t.strings){const t=i.encode(e[h]);n[h]=t,s+=4+t.length}const r=new ArrayBuffer(s),a=new Uint8Array(r),o=new DataView(r);let l=0;for(const h of t.strings){const t=n[h],e=t.length;o.setUint32(l,e),a.set(t,l+4),l+=4+e}return qx(l===r.byteLength,"CssFontInfo.write: Buffer overflow"),r}get fontFamily(){return zd(this,ns,ss).call(this,0)}get fontWeight(){return zd(this,ns,ss).call(this,1)}get italicAngle(){return zd(this,ns,ss).call(this,2)}};ts=new WeakMap,es=new WeakMap,is=new WeakMap,ns=new WeakSet,ss=function(t){qx(t<$k.strings.length,"Invalid string index");let e=0;for(let n=0;n<t;n++)e+=$d(this,es).getUint32(e)+4;const i=$d(this,es).getUint32(e);return $d(this,is).decode(new Uint8Array($d(this,ts),e+4,i))},Wd($k,"strings",["fontFamily","fontWeight","italicAngle"]);let Uk=$k;const Hk=class t{constructor(t){Ud(this,ls),Ud(this,rs),Ud(this,as),Ud(this,os),Hd(this,rs,t),Hd(this,as,new DataView($d(this,rs))),Hd(this,os,new TextDecoder)}static write(e){const i=new TextEncoder,n={};let s=0;for(const u of t.strings){const t=i.encode(e[u]);n[u]=t,s+=4+t.length}s+=4;let r,a,o=1+s;e.style&&(r=i.encode(e.style.style),a=i.encode(e.style.weight),o+=4+r.length+4+a.length);const l=new ArrayBuffer(o),h=new Uint8Array(l),c=new DataView(l);let d=0;c.setUint8(d++,e.guessFallback?1:0),c.setUint32(d,0),d+=4,s=0;for(const u of t.strings){const t=n[u],e=t.length;s+=4+e,c.setUint32(d,e),h.set(t,d+4),d+=4+e}return c.setUint32(d-s-4,s),e.style&&(c.setUint32(d,r.length),h.set(r,d+4),d+=4+r.length,c.setUint32(d,a.length),h.set(a,d+4),d+=4+a.length),qx(d<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(d)}get guessFallback(){return 0!==$d(this,as).getUint8(0)}get css(){return zd(this,ls,hs).call(this,0)}get loadedName(){return zd(this,ls,hs).call(this,1)}get baseFontName(){return zd(this,ls,hs).call(this,2)}get src(){return zd(this,ls,hs).call(this,3)}get style(){let t=1;t+=4+$d(this,as).getUint32(t);const e=$d(this,as).getUint32(t),i=$d(this,os).decode(new Uint8Array($d(this,rs),t+4,e));t+=4+e;const n=$d(this,as).getUint32(t);return{style:i,weight:$d(this,os).decode(new Uint8Array($d(this,rs),t+4,n))}}};rs=new WeakMap,as=new WeakMap,os=new WeakMap,ls=new WeakSet,hs=function(t){qx(t<Hk.strings.length,"Invalid string index");let e=5;for(let n=0;n<t;n++)e+=$d(this,as).getUint32(e)+4;const i=$d(this,as).getUint32(e);return $d(this,os).decode(new Uint8Array($d(this,rs),e+4,i))},Wd(Hk,"strings",["css","loadedName","baseFontName","src"]);let zk=Hk;const Vk=class t{constructor({data:t,extra:e}){Ud(this,ws),Ud(this,gs),Ud(this,ms),Ud(this,ys),Hd(this,gs,t),Hd(this,ms,new TextDecoder),Hd(this,ys,new DataView($d(this,gs))),e&&Object.assign(this,e)}get black(){return zd(this,ws,vs).call(this,0)}get bold(){return zd(this,ws,vs).call(this,1)}get disableFontFace(){return zd(this,ws,vs).call(this,2)}get fontExtraProperties(){return zd(this,ws,vs).call(this,3)}get isInvalidPDFjsFont(){return zd(this,ws,vs).call(this,4)}get isType3Font(){return zd(this,ws,vs).call(this,5)}get italic(){return zd(this,ws,vs).call(this,6)}get missingFile(){return zd(this,ws,vs).call(this,7)}get remeasure(){return zd(this,ws,vs).call(this,8)}get vertical(){return zd(this,ws,vs).call(this,9)}get ascent(){return zd(this,ws,bs).call(this,0)}get defaultWidth(){return zd(this,ws,bs).call(this,1)}get descent(){return zd(this,ws,bs).call(this,2)}get bbox(){let e=$d(t,ds);if(0===$d(this,ys).getUint8(e))return;e+=1;const i=[];for(let t=0;t<4;t++)i.push($d(this,ys).getInt16(e,!0)),e+=2;return i}get fontMatrix(){let e=$d(t,us);if(0===$d(this,ys).getUint8(e))return;e+=1;const i=[];for(let t=0;t<6;t++)i.push($d(this,ys).getFloat64(e,!0)),e+=8;return i}get defaultVMetrics(){let e=$d(t,ps);if(0===$d(this,ys).getUint8(e))return;e+=1;const i=[];for(let t=0;t<3;t++)i.push($d(this,ys).getInt16(e,!0)),e+=2;return i}get fallbackName(){return zd(this,ws,As).call(this,0)}get loadedName(){return zd(this,ws,As).call(this,1)}get mimetype(){return zd(this,ws,As).call(this,2)}get name(){return zd(this,ws,As).call(this,3)}get data(){let e=$d(t,fs);e+=4+$d(this,ys).getUint32(e),e+=4+$d(this,ys).getUint32(e),e+=4+$d(this,ys).getUint32(e);const i=$d(this,ys).getUint32(e);if(0!==i)return new Uint8Array($d(this,gs),e+4,i)}clearData(){let e=$d(t,fs);e+=4+$d(this,ys).getUint32(e),e+=4+$d(this,ys).getUint32(e),e+=4+$d(this,ys).getUint32(e);const i=$d(this,ys).getUint32(e);new Uint8Array($d(this,gs),e+4,i).fill(0),$d(this,ys).setUint32(e,0)}get cssFontInfo(){let e=$d(t,fs);e+=4+$d(this,ys).getUint32(e),e+=4+$d(this,ys).getUint32(e);const i=$d(this,ys).getUint32(e);if(0===i)return null;const n=new Uint8Array(i);return n.set(new Uint8Array($d(this,gs),e+4,i)),new Uk(n.buffer)}get systemFontInfo(){let e=$d(t,fs);e+=4+$d(this,ys).getUint32(e);const i=$d(this,ys).getUint32(e);if(0===i)return null;const n=new Uint8Array(i);return n.set(new Uint8Array($d(this,gs),e+4,i)),new zk(n.buffer)}static write(e){const i=e.systemFontInfo?zk.write(e.systemFontInfo):null,n=e.cssFontInfo?Uk.write(e.cssFontInfo):null,s=new TextEncoder,r={};let a=0;for(const g of t.strings)r[g]=s.encode(e[g]),a+=4+r[g].length;const o=$d(t,fs)+4+a+4+(i?i.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),h=new Uint8Array(l),c=new DataView(l);let d=0;const u=t.bools.length;let p=0,f=0;for(let g=0;g<u;g++){const i=e[t.bools[g]];p|=(void 0===i?0:i?2:1)<<f,f+=2,8!==f&&g!==u-1||(c.setUint8(d++,p),p=0,f=0)}qx(d===$d(t,cs),"FontInfo.write: Boolean properties offset mismatch");for(const g of t.numbers)c.setFloat64(d,e[g]),d+=8;if(qx(d===$d(t,ds),"FontInfo.write: Number properties offset mismatch"),e.bbox){c.setUint8(d++,4);for(const t of e.bbox)c.setInt16(d,t,!0),d+=2}else c.setUint8(d++,0),d+=8;if(qx(d===$d(t,us),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){c.setUint8(d++,6);for(const t of e.fontMatrix)c.setFloat64(d,t,!0),d+=8}else c.setUint8(d++,0),d+=48;if(qx(d===$d(t,ps),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){c.setUint8(d++,1);for(const t of e.defaultVMetrics)c.setInt16(d,t,!0),d+=2}else c.setUint8(d++,0),d+=6;qx(d===$d(t,fs),"FontInfo.write: DefaultVMetrics properties offset mismatch"),c.setUint32($d(t,fs),0),d+=4;for(const g of t.strings){const t=r[g],e=t.length;c.setUint32(d,e),h.set(t,d+4),d+=4+e}if(c.setUint32($d(t,fs),d-$d(t,fs)-4),i){const t=i.byteLength;c.setUint32(d,t),qx(d+4+t<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),h.set(new Uint8Array(i),d+4),d+=4+t}else c.setUint32(d,0),d+=4;if(n){const t=n.byteLength;c.setUint32(d,t),qx(d+4+t<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),h.set(new Uint8Array(n),d+4),d+=4+t}else c.setUint32(d,0),d+=4;return void 0===e.data?(c.setUint32(d,0),d+=4):(c.setUint32(d,e.data.length),h.set(e.data,d+4),d+=4+e.data.length),qx(d<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(d)}};cs=new WeakMap,ds=new WeakMap,us=new WeakMap,ps=new WeakMap,fs=new WeakMap,gs=new WeakMap,ms=new WeakMap,ys=new WeakMap,ws=new WeakSet,vs=function(t){qx(t<Vk.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=2*t%8,n=$d(this,ys).getUint8(e)>>i&3;return 0===n?void 0:2===n},bs=function(t){return qx(t<Vk.numbers.length,"Invalid number index"),$d(this,ys).getFloat64($d(Vk,cs)+8*t)},As=function(t){qx(t<Vk.strings.length,"Invalid string index");let e=$d(Vk,fs)+4;for(let s=0;s<t;s++)e+=$d(this,ys).getUint32(e)+4;const i=$d(this,ys).getUint32(e),n=new Uint8Array(i);return n.set(new Uint8Array($d(this,gs),e+4,i)),$d(this,ms).decode(n)},Wd(Vk,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),Wd(Vk,"numbers",["ascent","defaultWidth","descent"]),Wd(Vk,"strings",["fallbackName","loadedName","mimetype","name"]),Ud(Vk,cs,Math.ceil(2*Vk.bools.length/8)),Ud(Vk,ds,$d(Vk,cs)+8*Vk.numbers.length),Ud(Vk,us,$d(Vk,ds)+1+8),Ud(Vk,ps,$d(Vk,us)+1+48),Ud(Vk,fs,$d(Vk,ps)+1+6);let Gk=Vk;class qk{static get workerPort(){return $d(this,xs)}static set workerPort(t){if(!("undefined"!=typeof Worker&&t instanceof Worker)&&null!==t)throw new Error("Invalid `workerPort` type.");Hd(this,xs,t)}static get workerSrc(){return $d(this,_s)}static set workerSrc(t){if("string"!=typeof t)throw new Error("Invalid `workerSrc` type.");Hd(this,_s,t)}}xs=new WeakMap,_s=new WeakMap,Ud(qk,xs,null),Ud(qk,_s,"");class Xk{constructor({parsedData:t,rawData:e}){Ud(this,Ss),Ud(this,ks),Hd(this,Ss,t),Hd(this,ks,e)}getRaw(){return $d(this,ks)}get(t){return $d(this,Ss).get(t)??null}[Symbol.iterator](){return $d(this,Ss).entries()}}Ss=new WeakMap,ks=new WeakMap;const Kk=Symbol("INTERNAL");class Yk{constructor(t,{name:e,intent:i,usage:n,rbGroups:s}){Ud(this,Es,!1),Ud(this,Ms,!1),Ud(this,Cs,!1),Ud(this,Ps,!0),Hd(this,Es,!!(2&t)),Hd(this,Ms,!!(4&t)),this.name=e,this.intent=i,this.usage=n,this.rbGroups=s}get visible(){if($d(this,Cs))return $d(this,Ps);if(!$d(this,Ps))return!1;const{print:t,view:e}=this.usage;return $d(this,Es)?"OFF"!==e?.viewState:!$d(this,Ms)||"OFF"!==t?.printState}_setVisible(t,e,i=!1){t!==Kk&&Gx("Internal method `_setVisible` called."),Hd(this,Cs,i),Hd(this,Ps,e)}}Es=new WeakMap,Ms=new WeakMap,Cs=new WeakMap,Ps=new WeakMap;class Qk{constructor(t,e=2){if(Ud(this,Os),Ud(this,Ts,null),Ud(this,Rs,new Map),Ud(this,Ds,null),Ud(this,Is,null),this.renderingIntent=e,this.name=null,this.creator=null,null!==t){this.name=t.name,this.creator=t.creator,Hd(this,Is,t.order);for(const i of t.groups)$d(this,Rs).set(i.id,new Yk(e,i));if("OFF"===t.baseState)for(const t of $d(this,Rs).values())t._setVisible(Kk,!1);for(const e of t.on)$d(this,Rs).get(e)._setVisible(Kk,!0);for(const e of t.off)$d(this,Rs).get(e)._setVisible(Kk,!1);Hd(this,Ds,this.getHash())}}isVisible(t){if(0===$d(this,Rs).size)return!0;if(!t)return!0;if("OCG"===t.type)return $d(this,Rs).has(t.id)?$d(this,Rs).get(t.id).visible:(t.id,!0);if("OCMD"===t.type){if(t.expression)return zd(this,Os,Ls).call(this,t.expression);if(!t.policy||"AnyOn"===t.policy){for(const e of t.ids){if(!$d(this,Rs).has(e))return Vx(),!0;if($d(this,Rs).get(e).visible)return!0}return!1}if("AllOn"===t.policy){for(const e of t.ids){if(!$d(this,Rs).has(e))return Vx(),!0;if(!$d(this,Rs).get(e).visible)return!1}return!0}if("AnyOff"===t.policy){for(const e of t.ids){if(!$d(this,Rs).has(e))return Vx(),!0;if(!$d(this,Rs).get(e).visible)return!0}return!1}if("AllOff"===t.policy){for(const e of t.ids){if(!$d(this,Rs).has(e))return Vx(),!0;if($d(this,Rs).get(e).visible)return!1}return!0}return t.policy,!0}return t.type,!0}setVisibility(t,e=!0,i=!0){const n=$d(this,Rs).get(t);if(n){if(i&&e&&n.rbGroups.length)for(const e of n.rbGroups)for(const i of e)i!==t&&$d(this,Rs).get(i)?._setVisible(Kk,!1,!0);n._setVisible(Kk,!!e,!0),Hd(this,Ts,null)}}setOCGState({state:t,preserveRB:e}){let i;for(const n of t){switch(n){case"ON":case"OFF":case"Toggle":i=n;continue}const t=$d(this,Rs).get(n);if(t)switch(i){case"ON":this.setVisibility(n,!0,e);break;case"OFF":this.setVisibility(n,!1,e);break;case"Toggle":this.setVisibility(n,!t.visible,e)}}Hd(this,Ts,null)}get hasInitialVisibility(){return null===$d(this,Ds)||this.getHash()===$d(this,Ds)}getOrder(){return $d(this,Rs).size?$d(this,Is)?$d(this,Is).slice():[...$d(this,Rs).keys()]:null}getGroup(t){return $d(this,Rs).get(t)||null}getHash(){if(null!==$d(this,Ts))return $d(this,Ts);const t=new bS;for(const[e,i]of $d(this,Rs))t.update(`${e}:${i.visible}`);return Hd(this,Ts,t.hexdigest())}[Symbol.iterator](){return $d(this,Rs).entries()}}Ts=new WeakMap,Rs=new WeakMap,Ds=new WeakMap,Is=new WeakMap,Os=new WeakSet,Ls=function(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let n=1;n<e;n++){const e=t[n];let s;if(Array.isArray(e))s=zd(this,Os,Ls).call(this,e);else{if(!$d(this,Rs).has(e))return Vx(),!0;s=$d(this,Rs).get(e).visible}switch(i){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===i};class Jk{constructor(t,{disableRange:e=!1,disableStream:i=!1}){qx(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:n,initialData:s,progressiveDone:r,contentDispositionFilename:a}=t;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=a,s?.length>0){const t=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(t)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=n,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((t,e)=>{this._onReceiveData({begin:t,chunk:e})}),t.addProgressListener((t,e)=>{this._onProgress({loaded:t,total:e})}),t.addProgressiveReadListener(t=>{this._onReceiveData({chunk:t})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;void 0===t?this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i):qx(this._rangeReaders.some(function(e){return e._begin===t&&(e._enqueue(i),!0)}),"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){void 0===t.total?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){qx(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new Zk(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new tE(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class Zk{constructor(t,e,i=!1,n=null){this._stream=t,this._done=i||!1,this._filename=k_(n)?n:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class tE{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(0===this._requests.length)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function eE(t,e){const i=new Headers;if(!t||!e||"object"!=typeof e)return i;for(const n in e){const t=e[n];void 0!==t&&i.append(n,t)}return i}function iE(t){return URL.parse(t)?.origin??null}function nE({responseHeaders:t,isHttp:e,rangeChunkSize:i,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(t.get("Content-Length"),10);return Number.isInteger(r)?(s.suggestedLength=r,r<=2*i||n||!e||"bytes"!==t.get("Accept-Ranges")||"identity"!==(t.get("Content-Encoding")||"identity")||(s.allowRangeRequests=!0),s):s}function sE(t){const e=t.get("Content-Disposition");if(e){let t=function(t){let e=!0,i=n("filename\\*","i").exec(t);if(i){i=i[1];let t=a(i);return t=unescape(t),t=o(t),t=l(t),r(t)}if(i=function(t){const e=[];let i;const s=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(i=s.exec(t));){let[,t,n,s]=i;if(t=parseInt(t,10),t in e){if(0===t)break}else e[t]=[n,s]}const r=[];for(let n=0;n<e.length&&n in e;++n){let[t,i]=e[n];i=a(i),t&&(i=unescape(i),0===n&&(i=o(i))),r.push(i)}return r.join("")}(t),i)return r(l(i));if(i=n("filename","i").exec(t),i){i=i[1];let t=a(i);return t=l(t),r(t)}function n(t,e){return new RegExp("(?:^|;)\\s*"+t+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',e)}function s(t,i){if(t){if(!/^[\x00-\xFF]+$/.test(i))return i;try{const n=new TextDecoder(t,{fatal:!0}),s=r_(i);i=n.decode(s),e=!1}catch{}}return i}function r(t){return e&&/[\x80-\xff]/.test(t)&&(t=s("utf-8",t),e&&(t=s("iso-8859-1",t))),t}function a(t){if(t.startsWith('"')){const e=t.slice(1).split('\\"');for(let t=0;t<e.length;++t){const i=e[t].indexOf('"');-1!==i&&(e[t]=e[t].slice(0,i),e.length=t+1),e[t]=e[t].replaceAll(/\\(.)/g,"$1")}t=e.join('"')}return t}function o(t){const e=t.indexOf("'");return-1===e?t:s(t.slice(0,e),t.slice(e+1).replace(/^[^']*'/,""))}function l(t){return!t.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(t)?t:t.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(t,e,i,n){if("q"===i||"Q"===i)return s(e,n=(n=n.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,function(t,e){return String.fromCharCode(parseInt(e,16))}));try{n=atob(n)}catch{}return s(e,n)})}return""}(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(k_(t))return t}return null}function rE(t,e){return new e_(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t,404===t||0===t&&e.startsWith("file:"))}function aE(t){return 200===t||206===t}function oE(t,e,i){return{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function lE(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:new Uint8Array(t).buffer}class hE{constructor(t){Wd(this,"_responseOrigin",null),this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=eE(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return qx(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new cE(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new dE(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class cE{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),n=e.url;fetch(n,oE(i,this._withCredentials,this._abortController)).then(e=>{if(t._responseOrigin=iE(e.url),!aE(e.status))throw rE(e.status,n);this._reader=e.body.getReader(),this._headersCapability.resolve();const i=e.headers,{allowRangeRequests:s,suggestedLength:r}=nE({responseHeaders:i,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=r||this._contentLength,this._filename=sE(i),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n_("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:lE(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class dE{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const n=t.source;this._withCredentials=n.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!n.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${i-1}`);const r=n.url;fetch(r,oE(s,this._withCredentials,this._abortController)).then(e=>{const i=iE(e.url);if(i!==t._responseOrigin)throw new Error(`Expected range response-origin "${i}" to match "${t._responseOrigin}".`);if(!aE(e.status))throw rE(e.status,r);this._readCapability.resolve(),this._reader=e.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:lE(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class uE{constructor({url:t,httpHeaders:e,withCredentials:i}){Wd(this,"_responseOrigin",null),this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=eE(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,n=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,r]of this.headers)e.setRequestHeader(s,r);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),n.expectedStatus=206):n.expectedStatus=200,e.responseType="arraybuffer",qx(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),n.onHeadersReceived=t.onHeadersReceived,n.onDone=t.onDone,n.onError=t.onError,n.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const n=i.xhr;if(n.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),4!==n.readyState)return;if(!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],0===n.status&&this.isHttp)return void i.onError(n.status);const s=n.status||200;if((200!==s||206!==i.expectedStatus)&&s!==i.expectedStatus)return void i.onError(n.status);const r=function(t){const e=t.response;return"string"!=typeof e?e:r_(e).buffer}(n);if(206===s){const t=n.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(t);e?i.onDone({begin:parseInt(e[1],10),chunk:r}):i.onError(0)}else r?i.onDone({begin:0,chunk:r}):i.onError(n.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class pE{constructor(t){this._source=t,this._manager=new uE(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return qx(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new fE(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new gE(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class fE{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=iE(e.responseURL);const i=e.getAllResponseHeaders(),n=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(t=>{const[e,...i]=t.split(": ");return[e,i.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:r}=nE({responseHeaders:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=sE(n),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=rE(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class gE{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=iE(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=rE(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const mE=/^[a-z][a-z0-9\-+.]+:/i;class yE{constructor(t){this.source=t,this.url=function(t){if(mE.test(t))return new URL(t);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(t))}(t.url),qx("file:"===this.url.protocol,"PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return qx(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new wE(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new vE(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class wE{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(t=>{this._contentLength=t.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},t=>{"ENOENT"===t.code&&(t=rE(0,this._url.href)),this._storedError=t,this._headersCapability.reject(t)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n_("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class vE{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const n=t.source;this._isStreamingSupported=!n.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return null===t?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){this._readableStream?this._readableStream.destroy(t):this._error(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const bE=Symbol("INITIAL_DATA");class AE{constructor(){Ud(this,Ns),Ud(this,Fs,Object.create(null))}get(t,e=null){if(e){const i=zd(this,Ns,Bs).call(this,t);return i.promise.then(()=>e(i.data)),null}const i=$d(this,Fs)[t];if(!i||i.data===bE)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=$d(this,Fs)[t];return!!e&&e.data!==bE}delete(t){const e=$d(this,Fs)[t];return!(!e||e.data===bE||(delete $d(this,Fs)[t],0))}resolve(t,e=null){const i=zd(this,Ns,Bs).call(this,t);i.data=e,i.resolve()}clear(){for(const t in $d(this,Fs)){const{data:e}=$d(this,Fs)[t];e?.bitmap?.close()}Hd(this,Fs,Object.create(null))}*[Symbol.iterator](){for(const t in $d(this,Fs)){const{data:e}=$d(this,Fs)[t];e!==bE&&(yield[t,e])}}}Fs=new WeakMap,Ns=new WeakSet,Bs=function(t){var e;return(e=$d(this,Fs))[t]||(e[t]={...Promise.withResolvers(),data:bE})};const xE=class t{constructor({textContentSource:e,container:i,viewport:n}){var s;if(Ud(this,lr),Ud(this,Ws,Promise.withResolvers()),Ud(this,js,null),Ud(this,$s,!1),Ud(this,Us,!!globalThis.FontInspector?.enabled),Ud(this,Hs,null),Ud(this,zs,null),Ud(this,Vs,0),Ud(this,Gs,0),Ud(this,qs,null),Ud(this,Xs,null),Ud(this,Ks,0),Ud(this,Ys,0),Ud(this,Qs,Object.create(null)),Ud(this,Js,[]),Ud(this,Zs,null),Ud(this,tr,[]),Ud(this,er,new WeakMap),Ud(this,ir,null),e instanceof ReadableStream)Hd(this,Zs,e);else{if("object"!=typeof e)throw new Error('No "textContentSource" parameter specified.');Hd(this,Zs,new ReadableStream({start(t){t.enqueue(e),t.close()}}))}Hd(this,js,Hd(this,Xs,i)),Hd(this,Ys,n.scale*B_.pixelRatio),Hd(this,Ks,n.rotation),Hd(this,zs,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:a,pageX:o,pageY:l}=n.rawDims;Hd(this,ir,[1,0,0,-1,-o,l+a]),Hd(this,Gs,r),Hd(this,Vs,a),zd(s=t,ur,gr).call(s),N_(i,n),$d(this,Ws).promise.finally(()=>{$d(t,or).delete(this),Hd(this,zs,null),Hd(this,Qs,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=a_.platform;return Yx(this,"fontFamilyMap",new Map([["sans-serif",(t&&e?"Calibri, ":"")+"sans-serif"],["monospace",(t&&e?"Lucida Console, ":"")+"monospace"]]))}render(){const e=()=>{$d(this,qs).read().then(({value:t,done:i})=>{i?$d(this,Ws).resolve():($d(this,Hs)??Hd(this,Hs,t.lang),Object.assign($d(this,Qs),t.styles),zd(this,lr,hr).call(this,t.items),e())},$d(this,Ws).reject)};return Hd(this,qs,$d(this,Zs).getReader()),$d(t,or).add(this),e(),$d(this,Ws).promise}update({viewport:e,onBefore:i=null}){var n;const s=e.scale*B_.pixelRatio,r=e.rotation;if(r!==$d(this,Ks)&&(i?.(),Hd(this,Ks,r),N_($d(this,Xs),{rotation:r})),s!==$d(this,Ys)){i?.(),Hd(this,Ys,s);const e={div:null,properties:null,ctx:zd(n=t,ur,pr).call(n,$d(this,Hs))};for(const t of $d(this,tr))e.properties=$d(this,er).get(t),e.div=t,zd(this,lr,dr).call(this,e)}}cancel(){const t=new n_("TextLayer task cancelled.");$d(this,qs)?.cancel(t).catch(()=>{}),Hd(this,qs,null),$d(this,Ws).reject(t)}get textDivs(){return $d(this,tr)}get textContentItemsStr(){return $d(this,Js)}static cleanup(){if(!($d(this,or).size>0)){$d(this,nr).clear();for(const{canvas:t}of $d(this,sr).values())t.remove();$d(this,sr).clear()}}};Ws=new WeakMap,js=new WeakMap,$s=new WeakMap,Us=new WeakMap,Hs=new WeakMap,zs=new WeakMap,Vs=new WeakMap,Gs=new WeakMap,qs=new WeakMap,Xs=new WeakMap,Ks=new WeakMap,Ys=new WeakMap,Qs=new WeakMap,Js=new WeakMap,Zs=new WeakMap,tr=new WeakMap,er=new WeakMap,ir=new WeakMap,nr=new WeakMap,sr=new WeakMap,rr=new WeakMap,ar=new WeakMap,or=new WeakMap,lr=new WeakSet,hr=function(t){var e,i;if($d(this,$s))return;(i=$d(this,zs)).ctx??(i.ctx=zd(e=xE,ur,pr).call(e,$d(this,Hs)));const n=$d(this,tr),s=$d(this,Js);for(const r of t){if(n.length>1e5)return Vx(),void Hd(this,$s,!0);if(void 0!==r.str)s.push(r.str),zd(this,lr,cr).call(this,r);else if("beginMarkedContentProps"===r.type||"beginMarkedContent"===r.type){const t=$d(this,js);Hd(this,js,document.createElement("span")),$d(this,js).classList.add("markedContent"),r.id&&$d(this,js).setAttribute("id",`${r.id}`),t.append($d(this,js))}else"endMarkedContent"===r.type&&Hd(this,js,$d(this,js).parentNode)}},cr=function(t){var e;const i=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};$d(this,tr).push(i);const s=l_.transform($d(this,ir),t.transform);let r=Math.atan2(s[1],s[0]);const a=$d(this,Qs)[t.fontName];a.vertical&&(r+=Math.PI/2);let o=$d(this,Us)&&a.fontSubstitution||a.fontFamily;o=xE.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),h=l*zd(e=xE,ur,mr).call(e,o,a,$d(this,Hs));let c,d;0===r?(c=s[4],d=s[5]-h):(c=s[4]+h*Math.sin(r),d=s[5]-h*Math.cos(r));const u="calc(var(--total-scale-factor) *",p=i.style;$d(this,js)===$d(this,Xs)?(p.left=`${(100*c/$d(this,Gs)).toFixed(2)}%`,p.top=`${(100*d/$d(this,Vs)).toFixed(2)}%`):(p.left=`${u}${c.toFixed(2)}px)`,p.top=`${u}${d.toFixed(2)}px)`),p.fontSize=`${u}${($d(xE,ar)*l).toFixed(2)}px)`,p.fontFamily=o,n.fontSize=l,i.setAttribute("role","presentation"),i.textContent=t.str,i.dir=t.dir,$d(this,Us)&&(i.dataset.fontName=a.fontSubstitutionLoadedName||t.fontName),0!==r&&(n.angle=r*(180/Math.PI));let f=!1;if(t.str.length>1)f=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),i=Math.abs(t.transform[3]);e!==i&&Math.max(e,i)/Math.min(e,i)>1.5&&(f=!0)}if(f&&(n.canvasWidth=a.vertical?t.height:t.width),$d(this,er).set(i,n),$d(this,zs).div=i,$d(this,zs).properties=n,zd(this,lr,dr).call(this,$d(this,zs)),n.hasText&&$d(this,js).append(i),n.hasEOL){const t=document.createElement("br");t.setAttribute("role","presentation"),$d(this,js).append(t)}},dr=function(t){var e;const{div:i,properties:n,ctx:s}=t,{style:r}=i;let a="";if($d(xE,ar)>1&&(a=`scale(${1/$d(xE,ar)})`),0!==n.canvasWidth&&n.hasText){const{fontFamily:t}=r,{canvasWidth:o,fontSize:l}=n;zd(e=xE,ur,fr).call(e,s,l*$d(this,Ys),t);const{width:h}=s.measureText(i.textContent);h>0&&(a=`scaleX(${o*$d(this,Ys)/h}) ${a}`)}0!==n.angle&&(a=`rotate(${n.angle}deg) ${a}`),a.length>0&&(r.transform=a)},ur=new WeakSet,pr=function(t=null){let e=$d(this,sr).get(t||(t=""));if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),$d(this,sr).set(t,e),$d(this,rr).set(e,{size:0,family:""})}return e},fr=function(t,e,i){const n=$d(this,rr).get(t);e===n.size&&i===n.family||(t.font=`${e}px ${i}`,n.size=e,n.family=i)},gr=function(){if(null!==$d(this,ar))return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),Hd(this,ar,t.getBoundingClientRect().height),t.remove()},mr=function(t,e,i){const n=$d(this,nr).get(t);if(n)return n;const s=zd(this,ur,pr).call(this,i);s.canvas.width=s.canvas.height=30,zd(this,ur,fr).call(this,s,30,t);const r=s.measureText(""),a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let l=.8;return a?l=a/(a+o):(a_.platform.isFirefox,e.ascent?l=e.ascent:e.descent&&(l=1+e.descent)),$d(this,nr).set(t,l),l},Ud(xE,ur),Ud(xE,nr,new Map),Ud(xE,sr,new Map),Ud(xE,rr,new WeakMap),Ud(xE,ar,null),Ud(xE,or,new Set);let _E=xE;function SE(t={}){"string"==typeof t||t instanceof URL?t={url:t}:(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const e=new EE,{docId:i}=e,n=t.url?function(t){if(t instanceof URL)return t.href;if("string"==typeof t){if(Tx)return t;const e=URL.parse(t,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}(t.url):null,s=t.data?function(t){if(Tx&&"undefined"!=typeof Buffer&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if("string"==typeof t)return r_(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||"object"==typeof t&&!isNaN(t?.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}(t.data):null,r=t.httpHeaders||null,a=!0===t.withCredentials,o=t.password??null,l=t.range instanceof ME?t.range:null,h=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:65536;let c=t.worker instanceof RE?t.worker:null;const d=t.verbosity,u="string"!=typeof t.docBaseUrl||S_(t.docBaseUrl)?null:t.docBaseUrl,p=ES(t.cMapUrl),f=!1!==t.cMapPacked,g=t.CMapReaderFactory||(Tx?GS:FS),m=ES(t.iccUrl),y=ES(t.standardFontDataUrl),w=t.StandardFontDataFactory||(Tx?qS:jS),v=ES(t.wasmUrl),b=t.WasmFactory||(Tx?XS:US),A=!0!==t.stopAtErrors,x=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,_=!1!==t.isEvalSupported,S="boolean"==typeof t.isOffscreenCanvasSupported?t.isOffscreenCanvasSupported:!Tx,k="boolean"==typeof t.isImageDecoderSupported?t.isImageDecoderSupported:!Tx&&(a_.platform.isFirefox||!globalThis.chrome),E=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,M="boolean"==typeof t.disableFontFace?t.disableFontFace:Tx,C=!0===t.fontExtraProperties,P=!0===t.enableXfa,T=t.ownerDocument||globalThis.document,R=!0===t.disableRange,D=!0===t.disableStream,I=!0===t.disableAutoFetch,O=!0===t.pdfBug,L=t.CanvasFactory||(Tx?VS:OS),F=t.FilterFactory||(Tx?zS:BS),N=!0===t.enableHWA,B=!1!==t.useWasm,W=l?l.length:t.length??NaN,j="boolean"==typeof t.useSystemFonts?t.useSystemFonts:!Tx&&!M,$="boolean"==typeof t.useWorkerFetch?t.useWorkerFetch:!!(g===FS&&w===jS&&b===US&&p&&y&&v&&P_(p,document.baseURI)&&P_(y,document.baseURI)&&P_(v,document.baseURI));var U;U=d,Number.isInteger(U)&&(Hx=U);const H={canvasFactory:new L({ownerDocument:T,enableHWA:N}),filterFactory:new F({docId:i,ownerDocument:T}),cMapReaderFactory:$?null:new g({baseUrl:p,isCompressed:f}),standardFontDataFactory:$?null:new w({baseUrl:y}),wasmFactory:$?null:new b({baseUrl:v})};c||(c=RE.create({verbosity:d,port:qk.workerPort}),e._worker=c);const z={docId:i,apiVersion:"5.4.296",data:s,password:o,disableAutoFetch:I,rangeChunkSize:h,length:W,docBaseUrl:u,enableXfa:P,evaluatorOptions:{maxImageSize:x,disableFontFace:M,ignoreErrors:A,isEvalSupported:_,isOffscreenCanvasSupported:S,isImageDecoderSupported:k,canvasMaxAreaInBytes:E,fontExtraProperties:C,useSystemFonts:j,useWasm:B,useWorkerFetch:$,cMapUrl:p,iccUrl:m,standardFontDataUrl:y,wasmUrl:v}},V={ownerDocument:T,pdfBug:O,styleElement:null,loadingParams:{disableAutoFetch:I,enableXfa:P}};return c.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const t=c.messageHandler.sendWithPromise("GetDocRequest",z,s?[s.buffer]:null);let o;if(l)o=new Jk(l,{disableRange:R,disableStream:D});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const t=P_(n)?hE:Tx?yE:pE;o=new t({url:n,length:W,httpHeaders:r,withCredentials:a,rangeChunkSize:h,disableRange:R,disableStream:D})}return t.then(t=>{if(e.destroyed)throw new Error("Loading aborted");if(c.destroyed)throw new Error("Worker was destroyed");const n=new DS(i,t,c.port),s=new DE(n,e,o,V,H,N);e._transport=s,n.send("Ready",null)})}).catch(e._capability.reject),e}const kE=class t{constructor(){Wd(this,"_capability",Promise.withResolvers()),Wd(this,"_transport",null),Wd(this,"_worker",null),Wd(this,"docId","d"+Vd(t,yr)._++),Wd(this,"destroyed",!1),Wd(this,"onPassword",null),Wd(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}};yr=new WeakMap,Ud(kE,yr,0);let EE=kE;class ME{constructor(t,e,i=!1,n=null){Ud(this,wr,Promise.withResolvers()),Ud(this,vr,[]),Ud(this,br,[]),Ud(this,Ar,[]),Ud(this,xr,[]),this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=n}addRangeListener(t){$d(this,xr).push(t)}addProgressListener(t){$d(this,Ar).push(t)}addProgressiveReadListener(t){$d(this,br).push(t)}addProgressiveDoneListener(t){$d(this,vr).push(t)}onDataRange(t,e){for(const i of $d(this,xr))i(t,e)}onDataProgress(t,e){$d(this,wr).promise.then(()=>{for(const i of $d(this,Ar))i(t,e)})}onDataProgressiveRead(t){$d(this,wr).promise.then(()=>{for(const e of $d(this,br))e(t)})}onDataProgressiveDone(){$d(this,wr).promise.then(()=>{for(const t of $d(this,vr))t()})}transportReady(){$d(this,wr).resolve()}requestDataRange(t,e){Gx("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}wr=new WeakMap,vr=new WeakMap,br=new WeakMap,Ar=new WeakMap,xr=new WeakMap;class CE{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Yx(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class PE{constructor(t,e,i,n=!1){Ud(this,Sr),Ud(this,_r,!1),this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=n?new C_:null,this._pdfBug=n,this.commonObjs=i.commonObjs,this.objs=new AE,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:n=0,dontFlip:s=!1}={}){return new x_({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:n,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Yx(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:n="display",annotationMode:s=Ix.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:h=null,printAnnotationStorage:c=null,isEditing:d=!1,recordOperations:u=!1,operationsFilter:p=null}){this._stats?.time("Overall");const f=this._transport.getRenderingIntent(n,s,c,d),{renderingIntent:g,cacheKey:m}=f;Hd(this,_r,!1),o||(o=this._transport.getOptionalContentConfig(g));let y=this._intentStates.get(m);y||(y=Object.create(null),this._intentStates.set(m,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const w=!!(4&g);y.displayReadyCapability||(y.displayReadyCapability=Promise.withResolvers(),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f));const v=Boolean(this._pdfBug&&globalThis.StepperManager?.enabled),b=!this.recordedBBoxes&&(u||v),A=t=>{if(y.renderTasks.delete(x),b){const t=x.gfx?.dependencyTracker.take();t&&(x.stepper&&x.stepper.setOperatorBBoxes(t,x.gfx.dependencyTracker.takeDebugMetadata()),u&&(this.recordedBBoxes=t))}w&&Hd(this,_r,!0),zd(this,Sr,kr).call(this),t?(x.capability.reject(t),this._abortOperatorList({intentState:y,reason:t instanceof Error?t:new Error(t)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new LE({callback:A,params:{canvas:e,canvasContext:t,dependencyTracker:b?new ik(e,y.operatorList.length,v):null,viewport:i,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!w,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA,operationsFilter:p});(y.renderTasks||(y.renderTasks=new Set)).add(x);const _=x.task;return Promise.all([y.displayReadyCapability.promise,o]).then(([t,e])=>{if(this.destroyed)A();else{if(this._stats?.time("Rendering"),!(e.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:t,optionalContentConfig:e}),x.operatorListChanged()}}).catch(A),_}getOperatorList({intent:t="display",annotationMode:e=Ix.ENABLE,printAnnotationStorage:i=null,isEditing:n=!1}={}){const s=this._transport.getRenderingIntent(t,e,i,n,!0);let r,a=this._intentStates.get(s.cacheKey);return a||(a=Object.create(null),this._intentStates.set(s.cacheKey,a)),a.opListReadCapability||(r=Object.create(null),r.operatorListChanged=function(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(r))},a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(r),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===t,disableNormalization:!0===e},{highWaterMark:100,size:t=>t.items.length})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(t=>m_.textContent(t));const e=this.streamTextContent(t);return new Promise(function(t,i){const n=e.getReader(),s={items:[],styles:Object.create(null),lang:null};!function e(){n.read().then(function({value:i,done:n}){n?t(s):(s.lang??(s.lang=i.lang),Object.assign(s.styles,i.styles),s.items.push(...i.items),e())},i)}()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),Hd(this,_r,!1),Promise.all(t)}cleanup(t=!1){Hd(this,_r,!0);const e=zd(this,Sr,kr).call(this);return t&&e&&this._stats&&(this._stats=new C_),e}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,n=t.length;i<n;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&zd(this,Sr,kr).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:n}){const{map:s,transfer:r}=i,a=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:n},r).getReader(),o=this._intentStates.get(e);o.streamReader=a;const l=()=>{a.read().then(({value:t,done:e})=>{e?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,o),l())},t=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const t of o.renderTasks)t.operatorListChanged();zd(this,Sr,kr).call(this)}if(o.displayReadyCapability)o.displayReadyCapability.reject(t);else{if(!o.opListReadCapability)throw t;o.opListReadCapability.reject(t)}}})};l()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof __){let i=100;return e.extraDelay>0&&e.extraDelay<1e3&&(i+=e.extraDelay),void(t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},i))}}if(t.streamReader.cancel(new n_(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[e,i]of this._intentStates)if(i===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}_r=new WeakMap,Sr=new WeakSet,kr=function(){if(!$d(this,_r)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Hd(this,_r,!1),!0};const TE=class t{constructor({name:e=null,port:i=null,verbosity:n=zx()}={}){if(Ud(this,Ir),Ud(this,Er,Promise.withResolvers()),Ud(this,Mr,null),Ud(this,Cr,null),Ud(this,Pr,null),this.name=e,this.destroyed=!1,this.verbosity=n,i){if($d(t,Dr).has(i))throw new Error("Cannot use more than one PDFWorker per port.");$d(t,Dr).set(i,this),zd(this,Ir,Lr).call(this,i)}else zd(this,Ir,Fr).call(this)}get promise(){return $d(this,Er).promise}get port(){return $d(this,Cr)}get messageHandler(){return $d(this,Mr)}destroy(){this.destroyed=!0,$d(this,Pr)?.terminate(),Hd(this,Pr,null),$d(t,Dr).delete($d(this,Cr)),Hd(this,Cr,null),$d(this,Mr)?.destroy(),Hd(this,Mr,null)}static create(e){const i=$d(this,Dr).get(e?.port);if(i){if(i._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return i}return new t(e)}static get workerSrc(){if(qk.workerSrc)return qk.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Yx(this,"_setupFakeWorkerGlobal",(async()=>$d(this,Br,Wr)?$d(this,Br,Wr):(await import(this.workerSrc)).WorkerMessageHandler)())}};Er=new WeakMap,Mr=new WeakMap,Cr=new WeakMap,Pr=new WeakMap,Tr=new WeakMap,Rr=new WeakMap,Dr=new WeakMap,Ir=new WeakSet,Or=function(){$d(this,Er).resolve(),$d(this,Mr).send("configure",{verbosity:this.verbosity})},Lr=function(t){Hd(this,Cr,t),Hd(this,Mr,new DS("main","worker",t)),$d(this,Mr).on("ready",()=>{}),zd(this,Ir,Or).call(this)},Fr=function(){if($d(TE,Rr)||$d(TE,Br,Wr))return void zd(this,Ir,Nr).call(this);let{workerSrc:t}=TE;try{TE._isSameOrigin(window.location,t)||(t=TE._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new DS("main","worker",e),n=()=>{s.abort(),i.destroy(),e.terminate(),this.destroyed?$d(this,Er).reject(new Error("Worker was destroyed")):zd(this,Ir,Nr).call(this)},s=new AbortController;e.addEventListener("error",()=>{$d(this,Pr)||n()},{signal:s.signal}),i.on("test",t=>{s.abort(),!this.destroyed&&t?(Hd(this,Mr,i),Hd(this,Cr,e),Hd(this,Pr,e),zd(this,Ir,Or).call(this)):n()}),i.on("ready",t=>{if(s.abort(),this.destroyed)n();else try{r()}catch{zd(this,Ir,Nr).call(this)}});const r=()=>{const t=new Uint8Array;i.send("test",t,[t.buffer])};return void r()}catch{}zd(this,Ir,Nr).call(this)},Nr=function(){$d(TE,Rr)||Hd(TE,Rr,!0),TE._setupFakeWorkerGlobal.then(t=>{if(this.destroyed)return void $d(this,Er).reject(new Error("Worker was destroyed"));const e=new PS;Hd(this,Cr,e);const i="fake"+Vd(TE,Tr)._++,n=new DS(i+"_worker",i,e);t.setup(n,e),Hd(this,Mr,new DS(i,i+"_worker",e)),zd(this,Ir,Or).call(this)}).catch(t=>{$d(this,Er).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Br=new WeakSet,Wr=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ud(TE,Br),Ud(TE,Tr,0),Ud(TE,Rr,!1),Ud(TE,Dr,new WeakMap),Tx&&(Hd(TE,Rr,!0),qk.workerSrc||(qk.workerSrc="./pdf.worker.mjs")),TE._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||"null"===i.origin)return!1;const n=new URL(e,i);return i.origin===n.origin},TE._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},TE.fromPort=t=>{if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return TE.create(t)};let RE=TE;class DE{constructor(t,e,i,n,s,r){Ud(this,Vr),Ud(this,jr,new Map),Ud(this,$r,new Map),Ud(this,Ur,new Map),Ud(this,Hr,new Map),Ud(this,zr,null),this.messageHandler=t,this.loadingTask=e,this.commonObjs=new AE,this.fontLoader=new SS({ownerDocument:n.ownerDocument,styleElement:n.styleElement}),this.loadingParams=n.loadingParams,this._params=n,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=r,this.setupMessageHandler()}get annotationStorage(){return Yx(this,"annotationStorage",new xS)}getRenderingIntent(t,e=Ix.ENABLE,i=null,n=!1,s=!1){let r=2,a=AS;switch(t){case"any":r=1;break;case"display":break;case"print":r=4}const o=4&r&&i instanceof _S?i:this.annotationStorage;switch(e){case Ix.DISABLE:r+=64;break;case Ix.ENABLE:break;case Ix.ENABLE_FORMS:r+=16;break;case Ix.ENABLE_STORAGE:r+=32,a=o.serializable}n&&(r+=128),s&&(r+=256);const{ids:l,hash:h}=o.modifiedIds;return{renderingIntent:r,cacheKey:[r,a.hash,h].join("_"),annotationStorageSerializable:a,modifiedIds:l}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),$d(this,zr)?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of $d(this,$r).values())t.push(i._destroy());$d(this,$r).clear(),$d(this,Ur).clear(),$d(this,Hr).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),$d(this,jr).clear(),this.filterFactory.destroy(),_E.cleanup(),this._networkStream?.cancelAllRequests(new n_("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(t,e)=>{qx(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=t=>{this._lastProgress={loaded:t.loaded,total:t.total}},e.onPull=()=>{this._fullReader.read().then(function({value:t,done:i}){i?e.close():(qx(t instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))}).catch(t=>{e.error(t)})},e.onCancel=t=>{this._fullReader.cancel(t),e.ready.catch(t=>{if(!this.destroyed)throw t})}}),t.on("ReaderHeadersReady",async t=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:n,contentLength:s}=this._fullReader;return i&&n||(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=t=>{e.onProgress?.({loaded:t.loaded,total:t.total})}),{isStreamingSupported:i,isRangeSupported:n,contentLength:s}}),t.on("GetRangeReader",(t,e)=>{qx(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(t.begin,t.end);i?(e.onPull=()=>{i.read().then(function({value:t,done:i}){i?e.close():(qx(t instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),e.enqueue(new Uint8Array(t),1,[t]))}).catch(t=>{e.error(t)})},e.onCancel=t=>{i.cancel(t),e.ready.catch(t=>{if(!this.destroyed)throw t})}):e.close()}),t.on("GetDoc",({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,e._capability.resolve(new CE(t,this))}),t.on("DocException",t=>{e._capability.reject(RS(t))}),t.on("PasswordRequest",t=>{Hd(this,zr,Promise.withResolvers());try{if(!e.onPassword)throw RS(t);const i=t=>{t instanceof Error?$d(this,zr).reject(t):$d(this,zr).resolve({password:t})};e.onPassword(i,t.code)}catch(i){$d(this,zr).reject(i)}return $d(this,zr).promise}),t.on("DataLoaded",t=>{e.onProgress?.({loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)}),t.on("StartRenderPage",t=>{this.destroyed||$d(this,$r).get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)}),t.on("commonobj",([e,i,n])=>{if(this.destroyed)return null;if(this.commonObjs.has(e))return null;switch(i){case"Font":if("error"in n){const t=n.error;this.commonObjs.resolve(e,t);break}const s=new Gk(n),r=this._params.pdfBug&&globalThis.FontInspector?.enabled?(t,e)=>globalThis.FontInspector.fontAdded(t,e):null,a=new kS(s,r,n.extra,n.charProcOperatorList);this.fontLoader.bind(a).catch(()=>t.sendWithPromise("FontFallback",{id:e})).finally(()=>{!a.fontExtraProperties&&a.data&&a.clearData(),this.commonObjs.resolve(e,a)});break;case"CopyLocalImage":const{imageRef:o}=n;qx(o,"The imageRef must be defined.");for(const t of $d(this,$r).values())for(const[,i]of t.objs)if(i?.ref===o)return i.dataLen?(this.commonObjs.resolve(e,structuredClone(i)),i.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(e,n);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([t,e,i,n])=>{if(this.destroyed)return;const s=$d(this,$r).get(e);if(!s.objs.has(t))if(0!==s._intentStates.size)switch(i){case"Image":case"Pattern":s.objs.resolve(t,n);break;default:throw new Error(`Got unknown object type ${i}`)}else n?.bitmap?.close()}),t.on("DocProgress",t=>{this.destroyed||e.onProgress?.({loaded:t.loaded,total:t.total})}),t.on("FetchBinaryData",async t=>{if(this.destroyed)throw new Error("Worker was destroyed.");const e=this[t.type];if(!e)throw new Error(`${t.type} not initialized, see the \`useWorkerFetch\` parameter.`);return e.fetch(t)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size;const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=$d(this,Ur).get(e);if(i)return i;const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&$d(this,Hr).set(i.refStr,t);const n=new PE(e,i,this,this._params.pdfBug);return $d(this,$r).set(e,n),n});return $d(this,Ur).set(e,n),n}getPageIndex(t){return MS(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return zd(this,Vr,Gr).call(this,"GetFieldObjects")}hasJSActions(){return zd(this,Vr,Gr).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return"string"!=typeof t?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return zd(this,Vr,Gr).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return zd(this,Vr,Gr).call(this,"GetOptionalContentConfig").then(e=>new Qk(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=$d(this,jr).get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(t=>({info:t[0],metadata:t[1]?new Xk(t[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return $d(this,jr).set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of $d(this,$r).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),$d(this,jr).clear(),this.filterFactory.destroy(!0),_E.cleanup()}}cachedPageNumber(t){if(!MS(t))return null;const e=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;return $d(this,Hr).get(e)??null}}jr=new WeakMap,$r=new WeakMap,Ur=new WeakMap,Hr=new WeakMap,zr=new WeakMap,Vr=new WeakSet,Gr=function(t,e=null){const i=$d(this,jr).get(t);if(i)return i;const n=this.messageHandler.sendWithPromise(t,e);return $d(this,jr).set(t,n),n};class IE{constructor(t){Ud(this,qr,null),Wd(this,"onContinue",null),Wd(this,"onError",null),Hd(this,qr,t)}get promise(){return $d(this,qr).capability.promise}cancel(t=0){$d(this,qr).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=$d(this,qr).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=$d(this,qr);return t.form||t.canvas&&e?.size>0}}qr=new WeakMap;const OE=class t{constructor({callback:t,params:e,objs:i,commonObjs:n,annotationCanvasMap:s,operatorList:r,pageIndex:a,canvasFactory:o,filterFactory:l,useRequestAnimationFrame:h=!1,pdfBug:c=!1,pageColors:d=null,enableHWA:u=!1,operationsFilter:p=null}){Ud(this,Xr,null),this.callback=t,this.params=e,this.objs=i,this.commonObjs=n,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=a,this.canvasFactory=o,this.filterFactory=l,this._pdfBug=c,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===h&&"undefined"!=typeof window,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new IE(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=u,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=p}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:i}){if(this.cancelled)return;if(this._canvas){if($d(t,Kr).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");$d(t,Kr).add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:r,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new jk(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:i},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:r}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,i=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),$d(this,Xr)&&(window.cancelAnimationFrame($d(this,Xr)),Hd(this,Xr,null)),$d(t,Kr).delete(this._canvas),e||(e=new __(`Rendering cancelled, page ${this._pageIndex+1}`,i)),this.callback(e),this.task.onError?.(e)}operatorListChanged(){this.graphicsReady?(this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?Hd(this,Xr,window.requestAnimationFrame(()=>{Hd(this,Xr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),$d(t,Kr).delete(this._canvas),this.callback())))}};Xr=new WeakMap,Kr=new WeakMap,Ud(OE,Kr,new WeakSet);let LE=OE;const FE="5.4.296",NE="f56dc8601",BE=class t{constructor({editor:e=null,uiManager:i=null}){Ud(this,oa),Ud(this,Yr,null),Ud(this,Qr,null),Ud(this,Jr),Ud(this,Zr,null),Ud(this,ta,!1),Ud(this,ea,!1),Ud(this,ia,null),Ud(this,na),Ud(this,sa,null),Ud(this,ra,null),e?(Hd(this,ea,!1),Hd(this,ia,e)):Hd(this,ea,!0),Hd(this,ra,e?._uiManager||i),Hd(this,na,$d(this,ra)._eventBus),Hd(this,Jr,e?.color?.toUpperCase()||$d(this,ra)?.highlightColors.values().next().value||"#FFFF98"),$d(t,aa)||Hd(t,aa,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Yx(this,"_keyboardManager",new sS([[["Escape","mac+Escape"],t.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],t.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],t.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],t.prototype._moveToPrevious],[["Home","mac+Home"],t.prototype._moveToBeginning],[["End","mac+End"],t.prototype._moveToEnd]]))}renderButton(){const t=Hd(this,Yr,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",$d(this,ia)&&(t.ariaControls=`${$d(this,ia).id}_colorpicker_dropdown`);const e=$d(this,ra)._signal;t.addEventListener("click",zd(this,oa,da).bind(this),{signal:e}),t.addEventListener("keydown",zd(this,oa,ca).bind(this),{signal:e});const i=Hd(this,Qr,document.createElement("span"));return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=$d(this,Jr),t.append(i),t}renderMainDropdown(){const t=Hd(this,Zr,zd(this,oa,la).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}_colorSelectFromKeyboard(t){if(t.target===$d(this,Yr))return void zd(this,oa,da).call(this,t);const e=t.target.getAttribute("data-color");e&&zd(this,oa,ha).call(this,e,t)}_moveToNext(t){$d(this,oa,pa)?t.target!==$d(this,Yr)?t.target.nextSibling?.focus():$d(this,Zr).firstChild?.focus():zd(this,oa,da).call(this,t)}_moveToPrevious(t){t.target!==$d(this,Zr)?.firstChild&&t.target!==$d(this,Yr)?($d(this,oa,pa)||zd(this,oa,da).call(this,t),t.target.previousSibling?.focus()):$d(this,oa,pa)&&this._hideDropdownFromKeyboard()}_moveToBeginning(t){$d(this,oa,pa)?$d(this,Zr).firstChild?.focus():zd(this,oa,da).call(this,t)}_moveToEnd(t){$d(this,oa,pa)?$d(this,Zr).lastChild?.focus():zd(this,oa,da).call(this,t)}hideDropdown(){$d(this,Zr)?.classList.add("hidden"),$d(this,Yr).ariaExpanded="false",$d(this,sa)?.abort(),Hd(this,sa,null)}_hideDropdownFromKeyboard(){$d(this,ea)||($d(this,oa,pa)?(this.hideDropdown(),$d(this,Yr).focus({preventScroll:!0,focusVisible:$d(this,ta)})):$d(this,ia)?.unselect())}updateColor(t){if($d(this,Qr)&&($d(this,Qr).style.backgroundColor=t),!$d(this,Zr))return;const e=$d(this,ra).highlightColors.values();for(const i of $d(this,Zr).children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){$d(this,Yr)?.remove(),Hd(this,Yr,null),Hd(this,Qr,null),$d(this,Zr)?.remove(),Hd(this,Zr,null)}};Yr=new WeakMap,Qr=new WeakMap,Jr=new WeakMap,Zr=new WeakMap,ta=new WeakMap,ea=new WeakMap,ia=new WeakMap,na=new WeakMap,sa=new WeakMap,ra=new WeakMap,aa=new WeakMap,oa=new WeakSet,la=function(){const t=document.createElement("div"),e=$d(this,ra)._signal;t.addEventListener("contextmenu",T_,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),$d(this,ia)&&(t.id=`${$d(this,ia).id}_colorpicker_dropdown`);for(const[i,n]of $d(this,ra).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",n),s.title=i,s.setAttribute("data-l10n-id",$d(BE,aa)[i]);const r=document.createElement("span");s.append(r),r.className="swatch",r.style.backgroundColor=n,s.ariaSelected=n===$d(this,Jr),s.addEventListener("click",zd(this,oa,ha).bind(this,n),{signal:e}),t.append(s)}return t.addEventListener("keydown",zd(this,oa,ca).bind(this),{signal:e}),t},ha=function(t,e){e.stopPropagation(),$d(this,na).dispatch("switchannotationeditorparams",{source:this,type:Fx.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)},ca=function(t){BE._keyboardManager.exec(this,t)},da=function(t){if($d(this,oa,pa))return void this.hideDropdown();if(Hd(this,ta,0===t.detail),$d(this,sa)||(Hd(this,sa,new AbortController),window.addEventListener("pointerdown",zd(this,oa,ua).bind(this),{signal:$d(this,ra).combinedSignal($d(this,sa))})),$d(this,Yr).ariaExpanded="true",$d(this,Zr))return void $d(this,Zr).classList.remove("hidden");const e=Hd(this,Zr,zd(this,oa,la).call(this));$d(this,Yr).append(e)},ua=function(t){$d(this,Zr)?.contains(t.target)||this.hideDropdown()},pa=function(){return $d(this,Zr)&&!$d(this,Zr).classList.contains("hidden")},Ud(BE,aa,null);let WE=BE;const jE=class t{constructor(e){Ud(this,fa,null),Ud(this,ga,null),Ud(this,ma,null),Hd(this,ga,e),Hd(this,ma,e._uiManager),$d(t,ya)||Hd(t,ya,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if($d(this,fa))return $d(this,fa);const{editorType:e,colorType:i,colorValue:n}=$d(this,ga),s=Hd(this,fa,document.createElement("input"));return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",$d(t,ya)[e]),s.addEventListener("input",()=>{$d(this,ma).updateParams(i,s.value)},{signal:$d(this,ma)._signal}),s}update(t){$d(this,fa)&&($d(this,fa).value=t)}destroy(){$d(this,fa)?.remove(),Hd(this,fa,null)}hideDropdown(){}};fa=new WeakMap,ga=new WeakMap,ma=new WeakMap,ya=new WeakMap,Ud(jE,ya,null);let $E=jE;function UE(t){return Math.floor(255*Math.max(0,Math.min(1,t))).toString(16).padStart(2,"0")}function HE(t){return Math.max(0,Math.min(255,255*t))}class zE{static CMYK_G([t,e,i,n]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+n)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return[t=HE(t),t,t]}static G_HTML([t]){const e=UE(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(HE)}static RGB_HTML(t){return`#${t.map(UE).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,n]){return["RGB",1-Math.min(1,t+n),1-Math.min(1,i+n),1-Math.min(1,e+n)]}static CMYK_rgb([t,e,i,n]){return[HE(1-Math.min(1,t+n)),HE(1-Math.min(1,i+n)),HE(1-Math.min(1,e+n))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const n=1-t,s=1-e,r=1-i;return["CMYK",n,s,r,Math.min(n,s,r)]}}class VE{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const n=this._createSVG("svg:svg");return n.setAttribute("version","1.1"),i||(n.setAttribute("width",`${t}px`),n.setAttribute("height",`${e}px`)),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox",`0 0 ${t} ${e}`),n}createElement(t){if("string"!=typeof t)throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Gx("Abstract method `_createSVG` called.")}}class GE extends VE{_createSVG(t){return document.createElementNS(w_,t)}}const qE=new WeakSet,XE=60*(new Date).getTimezoneOffset()*1e3;class KE{static create(t){switch(t.data.annotationType){case Wx.LINK:return new JE(t);case Wx.TEXT:return new ZE(t);case Wx.WIDGET:switch(t.data.fieldType){case"Tx":return new eM(t);case"Btn":return t.data.radioButton?new sM(t):t.data.checkBox?new nM(t):new rM(t);case"Ch":return new aM(t);case"Sig":return new iM(t)}return new tM(t);case Wx.POPUP:return new oM(t);case Wx.FREETEXT:return new hM(t);case Wx.LINE:return new cM(t);case Wx.SQUARE:return new dM(t);case Wx.CIRCLE:return new uM(t);case Wx.POLYLINE:return new pM(t);case Wx.CARET:return new gM(t);case Wx.INK:return new mM(t);case Wx.POLYGON:return new fM(t);case Wx.HIGHLIGHT:return new yM(t);case Wx.UNDERLINE:return new wM(t);case Wx.SQUIGGLY:return new vM(t);case Wx.STRIKEOUT:return new bM(t);case Wx.STAMP:return new AM(t);case Wx.FILEATTACHMENT:return new xM(t);default:return new YE(t)}}}wa=new WeakMap,va=new WeakMap,ba=new WeakMap,Aa=new WeakSet,xa=function(t){const{container:{style:e},data:{rect:i,rotation:n},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:r,pageX:a,pageY:o}}}}=this;i?.splice(0,4,...t),e.left=100*(t[0]-a)/s+"%",e.top=100*(r-t[3]+o)/r+"%",0===n?(e.width=100*(t[2]-t[0])/s+"%",e.height=100*(t[3]-t[1])/r+"%"):this.setRotation(n)};let YE=class t{constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:n=!1}={}){Ud(this,Aa),Ud(this,wa,null),Ud(this,va,!1),Ud(this,ba,null),this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),n&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!(!t?.str&&!e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return t._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:n}=this.data;let s=-1/0,r=-1/0;if(e?.length>=8){for(let t=0;t<e.length;t+=8)e[t+1]>r?(r=e[t+1],s=e[t+2]):e[t+1]===r&&(s=Math.max(s,e[t+2]));return[s,r]}if(i?.length>=1){for(const t of i)for(let e=0,i=t.length;e<i;e+=2)t[e+1]>r?(r=t[e+1],s=t[e]):t[e+1]===r&&(s=Math.max(s,t[e]));if(s!==1/0)return[s,r]}return n?[n[2],n[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:s,pageY:r}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-s)/i,t[1]=100*(t[1]-r)/n,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Ox}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Ox}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){($d(this,ba)?.popup||this.popup)?.remove(),Hd(this,ba,this.popup=null)}updateEdited(t){if(!this.container)return;t.rect&&($d(this,wa)||Hd(this,wa,{rect:this.data.rect.slice(0)}));const{rect:e,popup:i}=t;e&&zd(this,Aa,xa).call(this,e);let n=$d(this,ba)?.popup||this.popup;!n&&i?.text&&(this._createPopup(i),n=$d(this,ba).popup),n&&(n.updateEdited(t),i?.deleted&&(n.remove(),Hd(this,ba,null),this.popup=null))}resetEdited(){$d(this,wa)&&(zd(this,Aa,xa).call(this,$d(this,wa).rect),$d(this,ba)?.popup.resetEdited(),Hd(this,wa,null))}_createContainer(t){const{data:e,parent:{page:i,viewport:n}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof tM||this instanceof JE||(s.tabIndex=0);const{style:r}=s;if(r.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof oM){const{rotation:t}=e;return e.hasOwnCanvas||0===t||this.setRotation(t,s),s}const{width:a,height:o}=this;if(!t&&e.borderStyle.width>0){r.borderWidth=`${e.borderStyle.width}px`;const t=e.borderStyle.horizontalCornerRadius,i=e.borderStyle.verticalCornerRadius;if(t>0||i>0){const e=`calc(${t}px * var(--total-scale-factor)) / calc(${i}px * var(--total-scale-factor))`;r.borderRadius=e}else if(this instanceof sM){const t=`calc(${a}px * var(--total-scale-factor)) / calc(${o}px * var(--total-scale-factor))`;r.borderRadius=t}switch(e.borderStyle.style){case 1:r.borderStyle="solid";break;case 2:r.borderStyle="dashed";break;case 3:case 4:break;case 5:r.borderBottomStyle="solid"}const n=e.borderColor||null;n?(Hd(this,va,!0),r.borderColor=l_.makeHexColor(0|n[0],0|n[1],0|n[2])):r.borderWidth=0}const l=l_.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:c,pageX:d,pageY:u}=n.rawDims;r.left=100*(l[0]-d)/h+"%",r.top=100*(l[1]-u)/c+"%";const{rotation:p}=e;return e.hasOwnCanvas||0===p?(r.width=100*a/h+"%",r.height=100*o/c+"%"):this.setRotation(p,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:n}=this.parent.viewport.rawDims;let{width:s,height:r}=this;t%180!=0&&([s,r]=[r,s]),e.style.width=100*s/i+"%",e.style.height=100*r/n+"%",e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(t,e,i)=>{const n=i.detail[t],s=n[0],r=n.slice(1);i.target.style[e]=zE[`${s}_HTML`](r),this.annotationStorage.setValue(this.data.id,{[e]:zE[`${s}_rgb`](r)})};return Yx(this,"_commonActions",{display:t=>{const{display:e}=t.detail,i=e%2==1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:1===e||2===e})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:e}=t.detail;this.container.style.visibility=e?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:e,noView:e})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:t=>{const e=t.detail.rotation;this.setRotation(e),this.annotationStorage.setValue(this.data.id,{rotation:e})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const n of Object.keys(e.detail)){const s=t[n]||i[n];s?.(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[n,s]of Object.entries(e)){const r=i[n];r&&(r({detail:{[n]:s},target:t}),delete e[n])}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,n,s]=this.data.rect.map(t=>Math.fround(t));if(8===t.length){const[r,a,o,l]=t.subarray(2,6);if(n===r&&s===a&&e===o&&i===l)return}const{style:r}=this.container;let a;if($d(this,va)){const{borderColor:t,borderWidth:e}=r;r.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${t}" stroke-width="${e}">`],this.container.classList.add("hasBorder")}const o=n-e,l=s-i,{svgFactory:h}=this,c=h.createElement("svg");c.classList.add("quadrilateralsContainer"),c.setAttribute("width",0),c.setAttribute("height",0),c.role="none";const d=h.createElement("defs");c.append(d);const u=h.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),d.append(u);for(let f=2,g=t.length;f<g;f+=8){const i=t[f],n=t[f+1],r=t[f+2],c=t[f+3],d=h.createElement("rect"),p=(r-e)/o,g=(s-n)/l,m=(i-r)/o,y=(n-c)/l;d.setAttribute("x",p),d.setAttribute("y",g),d.setAttribute("width",m),d.setAttribute("height",y),u.append(d),a?.push(`<rect vector-effect="non-scaling-stroke" x="${p}" y="${g}" width="${m}" height="${y}"/>`)}$d(this,va)&&(a.push("</g></svg>')"),r.backgroundImage=a.join("")),this.container.append(c),this.container.style.clipPath=`url(#${p})`}_createPopup(t=null){const{data:e}=this;let i,n;t?(i={str:t.text},n=t.date):(i=e.contentsObj,n=e.modificationDate);const s=Hd(this,ba,new oM({data:{color:e.color,titleObj:e.titleObj,modificationDate:n,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(s.render())}get hasPopupElement(){return!!($d(this,ba)||this.popup||this.data.popupRef)}get extraPopupElement(){return $d(this,ba)}render(){Gx("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const n=this._fieldObjects[t];if(n)for(const{page:t,id:s,exportValues:r}of n){if(-1===t)continue;if(s===e)continue;const n="string"==typeof r?r:null,a=document.querySelector(`[data-element-id="${s}"]`);!a||qE.has(a)?i.push({id:s,exportValue:n,domElement:a}):Vx()}return i}for(const n of document.getElementsByName(t)){const{exportValue:t}=n,s=n.getAttribute("data-element-id");s!==e&&qE.has(n)&&i.push({id:s,exportValue:t,domElement:n})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};class QE extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&(this._createPopup(t.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class JE extends YE{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),Ud(this,_a),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let n=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),n=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),n=!0):t.attachment?(zd(this,_a,ka).call(this,i,t.attachment,t.overlaidText,t.attachmentDest),n=!0):t.setOCGState?(zd(this,_a,Ea).call(this,i,t.setOCGState,t.overlaidText),n=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),n=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),n=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),n=!0):this.isTooltipOnly&&!n&&(this._bindLink(i,""),n=!0)),this.container.classList.add("linkAnnotation"),n&&this.container.append(i),this.container}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||""===e)&&zd(this,_a,Sa).call(this),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),zd(this,_a,Sa).call(this)}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const n of Object.keys(e.actions)){const s=i.get(n);s&&(t[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:n}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),zd(this,_a,Sa).call(this)}_bindResetFormAction(t,e){const i=t.onclick;i||(t.href=this.linkService.getAnchorUrl("")),zd(this,_a,Sa).call(this),this._fieldObjects?t.onclick=()=>{i?.();const{fields:t,refs:n,include:s}=e,r=[];if(0!==t.length||0!==n.length){const e=new Set(n);for(const i of t){const t=this._fieldObjects[i]||[];for(const{id:i}of t)e.add(i)}for(const t of Object.values(this._fieldObjects))for(const i of t)e.has(i.id)===s&&r.push(i)}else for(const e of Object.values(this._fieldObjects))r.push(...e);const a=this.annotationStorage,o=[];for(const e of r){const{id:t}=e;switch(o.push(t),e.type){case"text":{const i=e.defaultValue||"";a.setValue(t,{value:i});break}case"checkbox":case"radiobutton":{const i=e.defaultValue===e.exportValues;a.setValue(t,{value:i});break}case"combobox":case"listbox":{const i=e.defaultValue||"";a.setValue(t,{value:i});break}default:continue}const i=document.querySelector(`[data-element-id="${t}"]`);i&&(qE.has(i)?i.dispatchEvent(new Event("resetform")):Vx())}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:o,name:"ResetForm"}}),!1}:i||(t.onclick=()=>!1)}}_a=new WeakSet,Sa=function(){this.container.setAttribute("data-internal-link","")},ka=function(t,e,i="",n=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,n),!1),zd(this,_a,Sa).call(this)},Ea=function(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),zd(this,_a,Sa).call(this)};class ZE extends YE{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class tM extends YE{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&("CANVAS"===t.previousSibling?.nodeName&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return a_.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,n,s){i.includes("mouse")?t.addEventListener(i,t=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(t),shift:t.shiftKey,modifier:this._getKeyModifier(t)}})}):t.addEventListener(i,t=>{if("blur"===i){if(!e.focused||!t.relatedTarget)return;e.focused=!1}else if("focus"===i){if(e.focused)return;e.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:n,value:s(t)}})})}_setEventListeners(t,e,i,n){for(const[s,r]of i)("Action"===r||this.data.actions?.[r])&&("Focus"!==r&&"Blur"!==r||e||(e={focused:!1}),this._setEventListener(t,e,s,r,n),"Focus"!==r||this.data.actions?.Blur?"Blur"!==r||this.data.actions?.Focus||this._setEventListener(t,e,"focus","Focus",null):this._setEventListener(t,e,"blur","Blur",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=null===e?"transparent":l_.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const{fontColor:e}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||9,n=t.style;let s;const r=t=>Math.round(10*t)/10;if(this.data.multiLine){const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2),e=t/(Math.round(t/(Dx*i))||1);s=Math.min(i,r(e/Dx))}else{const t=Math.abs(this.data.rect[3]-this.data.rect[1]-2);s=Math.min(i,r(t/Dx))}n.fontSize=`calc(${s}px * var(--total-scale-factor))`,n.color=l_.makeHexColor(e[0],e[1],e[2]),null!==this.data.textAlignment&&(n.textAlign=["left","center","right"][this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class eM extends tM{constructor(t){super(t,{isRenderable:t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue})}setPropertyOnSiblings(t,e,i,n){const s=this.annotationStorage;for(const r of this._getElementsByName(t.name,t.id))r.domElement&&(r.domElement[e]=i),s.setValue(r.id,{[n]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const n=t.getValue(e,{value:this.data.fieldValue});let s=n.value||"";const r=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;r&&s.length>r&&(s=s.slice(0,r));let a=n.formattedValue||this.data.textContent?.join("\n")||null;a&&this.data.comb&&(a=a.replaceAll(/\s+/g,""));const o={userValue:s,formattedValue:a,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=a??s,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",a??s),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),qE.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:l,datetimeType:h,timeStep:c}=this.data,d=!!h&&this.enableScripting;l&&(i.title=l),this._setRequired(i,this.data.required),r&&(i.maxLength=r),i.addEventListener("input",n=>{t.setValue(e,{value:n.target.value}),this.setPropertyOnSiblings(i,"value",n.target.value,"value"),o.formattedValue=null}),i.addEventListener("resetform",t=>{const e=this.data.defaultFieldValue??"";i.value=o.userValue=e,o.formattedValue=null});let u=t=>{const{formattedValue:e}=o;null!=e&&(t.target.value=e),t.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",t=>{if(o.focused)return;const{target:e}=t;if(d&&(e.type=h,c&&(e.step=c)),o.userValue){const t=o.userValue;if(d)if("time"===h){const i=new Date(t),n=[i.getHours(),i.getMinutes(),i.getSeconds()];e.value=n.map(t=>t.toString().padStart(2,"0")).join(":")}else e.value=new Date(t-XE).toISOString().split("date"===h?"T":".",1)[0];else e.value=t}o.lastCommittedValue=e.value,o.commitKey=1,this.data.actions?.Focus||(o.focused=!0)}),i.addEventListener("updatefromsandbox",i=>{this.showElementAndHideCanvas(i.target);const n={value(i){o.userValue=i.detail.value??"",d||t.setValue(e,{value:o.userValue.toString()}),i.target.value=o.userValue},formattedValue(i){const{formattedValue:n}=i.detail;o.formattedValue=n,null!=n&&i.target!==document.activeElement&&(i.target.value=n);const s={formattedValue:n};d&&(s.value=n),t.setValue(e,s)},selRange(t){t.target.setSelectionRange(...t.detail.selRange)},charLimit:i=>{const{charLimit:n}=i.detail,{target:s}=i;if(0===n)return void s.removeAttribute("maxLength");s.setAttribute("maxLength",n);let r=o.userValue;!r||r.length<=n||(r=r.slice(0,n),s.value=o.userValue=r,t.setValue(e,{value:r}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:r,willCommit:!0,commitKey:1,selStart:s.selectionStart,selEnd:s.selectionEnd}}))}};this._dispatchEventFromSandbox(n,i)}),i.addEventListener("keydown",t=>{o.commitKey=1;let i=-1;if("Escape"===t.key?i=0:"Enter"!==t.key||this.data.multiLine?"Tab"===t.key&&(o.commitKey=3):i=2,-1===i)return;const{value:n}=t.target;o.lastCommittedValue!==n&&(o.lastCommittedValue=n,o.userValue=n,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:n,willCommit:!0,commitKey:i,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}))});const n=u;u=null,i.addEventListener("blur",t=>{if(!o.focused||!t.relatedTarget)return;this.data.actions?.Blur||(o.focused=!1);const{target:i}=t;let{value:s}=i;if(d){if(s&&"time"===h){const t=s.split(":").map(t=>parseInt(t,10));s=new Date(2e3,0,1,t[0],t[1],t[2]||0).valueOf(),i.step=""}else s.includes("T")||(s=`${s}T00:00`),s=new Date(s).valueOf();i.type="text"}o.userValue=s,o.lastCommittedValue!==s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,willCommit:!0,commitKey:o.commitKey,selStart:t.target.selectionStart,selEnd:t.target.selectionEnd}}),n(t)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",t=>{o.lastCommittedValue=null;const{data:i,target:n}=t,{value:s,selectionStart:r,selectionEnd:a}=n;let l=r,h=a;switch(t.inputType){case"deleteWordBackward":{const t=s.substring(0,r).match(/\w*[^\w]*$/);t&&(l-=t[0].length);break}case"deleteWordForward":{const t=s.substring(r).match(/^[^\w]*\w*/);t&&(h+=t[0].length);break}case"deleteContentBackward":r===a&&(l-=1);break;case"deleteContentForward":r===a&&(h+=1)}t.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:s,change:i||"",willCommit:!1,selStart:l,selEnd:h}})}),this._setEventListeners(i,o,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],t=>t.target.value)}if(u&&i.addEventListener("blur",u),this.data.comb){const t=(this.data.rect[2]-this.data.rect[0])/r;i.classList.add("comb"),i.style.letterSpacing=`calc(${t}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class iM extends tM{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class nM extends tM{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;"string"==typeof n&&(n="Off"!==n,t.setValue(i,{value:n})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return qE.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=0,s.addEventListener("change",n=>{const{name:s,checked:r}=n.target;for(const a of this._getElementsByName(s,i)){const i=r&&a.exportValue===e.exportValue;a.domElement&&(a.domElement.checked=i),t.setValue(a.id,{value:i})}t.setValue(i,{value:r})}),s.addEventListener("resetform",t=>{const i=e.defaultFieldValue||"Off";t.target.checked=i===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",e=>{const n={value(e){e.target.checked="Off"!==e.detail.value,t.setValue(i,{value:e.target.checked})}};this._dispatchEventFromSandbox(n,e)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],t=>t.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class sM extends tM{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let n=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if("string"==typeof n&&(n=n!==e.buttonValue,t.setValue(i,{value:n})),n)for(const r of this._getElementsByName(e.fieldName,i))t.setValue(r.id,{value:!1});const s=document.createElement("input");if(qE.add(s),s.setAttribute("data-element-id",i),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,n&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",e=>{const{name:n,checked:s}=e.target;for(const r of this._getElementsByName(n,i))t.setValue(r.id,{value:!1});t.setValue(i,{value:s})}),s.addEventListener("resetform",t=>{const i=e.defaultFieldValue;t.target.checked=null!=i&&i===e.buttonValue}),this.enableScripting&&this.hasJSActions){const n=e.buttonValue;s.addEventListener("updatefromsandbox",e=>{const s={value:e=>{const s=n===e.detail.value;for(const n of this._getElementsByName(e.target.name)){const e=s&&n.id===i;n.domElement&&(n.domElement.checked=e),t.setValue(n.id,{value:e})}}};this._dispatchEventFromSandbox(s,e)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],t=>t.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class rM extends JE{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",t=>{this._dispatchEventFromSandbox({},t)})),t}}class aM extends tM{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),n=document.createElement("select");qE.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,this._setRequired(n,this.data.required),n.name=this.data.fieldName,n.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0)),n.addEventListener("resetform",t=>{const e=this.data.defaultFieldValue;for(const i of n.options)i.selected=i.value===e});for(const h of this.data.options){const t=document.createElement("option");t.textContent=h.displayValue,t.value=h.exportValue,i.value.includes(h.exportValue)&&(t.setAttribute("selected",!0),s=!1),n.append(t)}let r=null;if(s){const t=document.createElement("option");t.value=" ",t.setAttribute("hidden",!0),t.setAttribute("selected",!0),n.prepend(t),r=()=>{t.remove(),n.removeEventListener("input",r),r=null},n.addEventListener("input",r)}const a=t=>{const e=t?"value":"textContent",{options:i,multiple:s}=n;return s?Array.prototype.filter.call(i,t=>t.selected).map(t=>t[e]):-1===i.selectedIndex?null:i[i.selectedIndex][e]};let o=a(!1);const l=t=>{const e=t.target.options;return Array.prototype.map.call(e,t=>({displayValue:t.textContent,exportValue:t.value}))};return this.enableScripting&&this.hasJSActions?(n.addEventListener("updatefromsandbox",i=>{const s={value(i){r?.();const s=i.detail.value,l=new Set(Array.isArray(s)?s:[s]);for(const t of n.options)t.selected=l.has(t.value);t.setValue(e,{value:a(!0)}),o=a(!1)},multipleSelection(t){n.multiple=!0},remove(i){const s=n.options,r=i.detail.remove;s[r].selected=!1,n.remove(r),s.length>0&&-1===Array.prototype.findIndex.call(s,t=>t.selected)&&(s[0].selected=!0),t.setValue(e,{value:a(!0),items:l(i)}),o=a(!1)},clear(i){for(;0!==n.length;)n.remove(0);t.setValue(e,{value:null,items:[]}),o=a(!1)},insert(i){const{index:s,displayValue:r,exportValue:h}=i.detail.insert,c=n.children[s],d=document.createElement("option");d.textContent=r,d.value=h,c?c.before(d):n.append(d),t.setValue(e,{value:a(!0),items:l(i)}),o=a(!1)},items(i){const{items:s}=i.detail;for(;0!==n.length;)n.remove(0);for(const t of s){const{displayValue:e,exportValue:i}=t,s=document.createElement("option");s.textContent=e,s.value=i,n.append(s)}n.options.length>0&&(n.options[0].selected=!0),t.setValue(e,{value:a(!0),items:l(i)}),o=a(!1)},indices(i){const n=new Set(i.detail.indices);for(const t of i.target.options)t.selected=n.has(t.index);t.setValue(e,{value:a(!0)}),o=a(!1)},editable(t){t.target.disabled=!t.detail.editable}};this._dispatchEventFromSandbox(s,i)}),n.addEventListener("input",i=>{const n=a(!0),s=a(!1);t.setValue(e,{value:n}),i.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:o,change:s,changeEx:n,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(n,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],t=>t.target.value)):n.addEventListener("input",function(i){t.setValue(e,{value:a(!0)})}),this.data.combo&&this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class oM extends YE{constructor(t){const{data:e,elements:i,parent:n}=t,s=!!n._commentManager;if(super(t,{isRenderable:!s&&YE._hasPopupData(e)}),Ud(this,Ma),this.elements=i,s&&YE._hasPopupData(e)){const t=this.popup=zd(this,Ma,Ca).call(this);for(const e of i)e.popup=t}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=zd(this,Ma,Ca).call(this),i=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",i.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(t=>`${p_}${t}`).join(",")),this.container}}Ma=new WeakSet,Ca=function(){return new lM({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};class lM{constructor({container:t,color:e,elements:i,titleObj:n,modificationDate:s,contentsObj:r,richText:a,parent:o,rect:l,parentRect:h,open:c,commentManager:d=null}){Ud(this,eo),Ud(this,Pa,null),Ud(this,Ta,zd(this,eo,co).bind(this)),Ud(this,Ra,zd(this,eo,go).bind(this)),Ud(this,Da,zd(this,eo,fo).bind(this)),Ud(this,Ia,zd(this,eo,po).bind(this)),Ud(this,Oa,null),Ud(this,La,null),Ud(this,Fa,null),Ud(this,Na,null),Ud(this,Ba,null),Ud(this,Wa,null),Ud(this,ja,null),Ud(this,$a,!1),Ud(this,Ua,null),Ud(this,Ha,null),Ud(this,za,null),Ud(this,Va,null),Ud(this,Ga,null),Ud(this,qa,null),Ud(this,Xa,null),Ud(this,Ka,null),Ud(this,Ya,null),Ud(this,Qa,null),Ud(this,Ja,!1),Ud(this,Za,null),Ud(this,to,null),Hd(this,La,t),Hd(this,Ya,n),Hd(this,Fa,r),Hd(this,Ka,a),Hd(this,Wa,o),Hd(this,Oa,e),Hd(this,Xa,l),Hd(this,ja,h),Hd(this,Ba,i),Hd(this,Pa,d),Hd(this,Za,i[0]),Hd(this,Na,D_.toDateObject(s)),this.trigger=i.flatMap(t=>t.getElementsToTriggerPopup()),d?this.renderCommentButton():(zd(this,eo,io).call(this),$d(this,La).hidden=!0,c&&zd(this,eo,po).call(this))}renderCommentButton(){if($d(this,Va))return;if($d(this,Ga)||zd(this,eo,no).call(this),!$d(this,Ga))return;const{signal:t}=Hd(this,Ha,new AbortController),e=!!$d(this,Za).extraPopupElement,i=()=>{$d(this,Pa).toggleCommentPopup(this,!0,void 0,!e)},n=()=>{$d(this,Pa).toggleCommentPopup(this,!1,!0,!e)},s=()=>{$d(this,Pa).toggleCommentPopup(this,!1,!1)};if(e){Hd(this,Va,$d(this,Za).container);for(const e of this.trigger)e.ariaHasPopup="dialog",e.ariaControls="commentPopup",e.addEventListener("keydown",$d(this,Ta),{signal:t}),e.addEventListener("click",i,{signal:t}),e.addEventListener("pointerenter",n,{signal:t}),e.addEventListener("pointerleave",s,{signal:t}),e.classList.add("popupTriggerArea")}else{const e=Hd(this,Va,document.createElement("button"));e.className="annotationCommentButton";const r=$d(this,Za).container;e.style.zIndex=r.style.zIndex+1,e.tabIndex=0,e.ariaHasPopup="dialog",e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button"),zd(this,eo,ro).call(this),zd(this,eo,so).call(this),e.addEventListener("keydown",$d(this,Ta),{signal:t}),e.addEventListener("click",i,{signal:t}),e.addEventListener("pointerenter",n,{signal:t}),e.addEventListener("pointerleave",s,{signal:t}),r.after(e)}}get commentButtonColor(){const{color:t,opacity:e}=$d(this,Za).commentData;return t?$d(this,Wa)._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{$d(this,Va)?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:n,modificationDate:s}=$d(this,Za).commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:n,modificationDate:s}}get elementBeforePopup(){return $d(this,Va)}get comment(){return $d(this,to)||Hd(this,to,$d(this,Za).commentText),$d(this,to)}set comment(t){t!==this.comment&&($d(this,Za).commentText=Hd(this,to,t))}get parentBoundingClientRect(){return $d(this,Za).layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){$d(this,Va)&&($d(this,Va).classList.toggle("selected",t),$d(this,Va).ariaExpanded=e)}setSelectedCommentButton(t){$d(this,Va).classList.toggle("selected",t)}get commentPopupPosition(){if($d(this,qa))return $d(this,qa);const{x:t,y:e,height:i}=$d(this,Va).getBoundingClientRect(),{x:n,y:s,width:r,height:a}=$d(this,Za).layer.getBoundingClientRect();return[(t-n)/r,(e+i-s)/a]}set commentPopupPosition(t){Hd(this,qa,t)}hasDefaultPopupPosition(){return null===$d(this,qa)}get commentButtonPosition(){return $d(this,Ga)}get commentButtonWidth(){return $d(this,Va).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=$d(this,qa)||this.commentButtonPosition.map(t=>t/100),n=this.parentBoundingClientRect,{x:s,y:r,width:a,height:o}=n;$d(this,Pa).showDialog(null,this,s+e*a,r+i*o,{...t,parentDimensions:n})}render(){if($d(this,Ua))return;const t=Hd(this,Ua,document.createElement("div"));if(t.className="popup",$d(this,Oa)){const e=t.style.outlineColor=l_.makeHexColor(...$d(this,Oa));t.style.backgroundColor=`color-mix(in srgb, ${e} 30%, white)`}const e=document.createElement("span");if(e.className="header",$d(this,Ya)?.str){const t=document.createElement("span");t.className="title",e.append(t),({dir:t.dir,str:t.textContent}=$d(this,Ya))}if(t.append(e),$d(this,Na)){const t=document.createElement("time");t.className="popupDate",t.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),t.setAttribute("data-l10n-args",JSON.stringify({dateObj:$d(this,Na).valueOf()})),t.dateTime=$d(this,Na).toISOString(),e.append(t)}K_({html:$d(this,eo,ao)||$d(this,Fa).str,dir:$d(this,Fa)?.dir,className:"popupContent"},t),$d(this,La).append(t)}updateEdited({rect:t,popup:e,deleted:i}){if($d(this,Pa))return i?(this.remove(),Hd(this,to,null)):e&&(e.deleted?this.remove():(zd(this,eo,ro).call(this),Hd(this,to,e.text))),void(t&&(Hd(this,Ga,null),zd(this,eo,no).call(this),zd(this,eo,so).call(this)));i||e?.deleted?this.remove():(zd(this,eo,io).call(this),$d(this,Qa)||Hd(this,Qa,{contentsObj:$d(this,Fa),richText:$d(this,Ka)}),t&&Hd(this,za,null),e&&e.text&&(Hd(this,Ka,zd(this,eo,ho).call(this,e.text)),Hd(this,Na,D_.toDateObject(e.date)),Hd(this,Fa,null)),$d(this,Ua)?.remove(),Hd(this,Ua,null))}resetEdited(){$d(this,Qa)&&(({contentsObj:Vd(this,Fa)._,richText:Vd(this,Ka)._}=$d(this,Qa)),Hd(this,Qa,null),$d(this,Ua)?.remove(),Hd(this,Ua,null),Hd(this,za,null))}remove(){if($d(this,Ha)?.abort(),Hd(this,Ha,null),$d(this,Ua)?.remove(),Hd(this,Ua,null),Hd(this,Ja,!1),Hd(this,$a,!1),$d(this,Va)?.remove(),Hd(this,Va,null),this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}forceHide(){Hd(this,Ja,this.isVisible),$d(this,Ja)&&($d(this,La).hidden=!0)}maybeShow(){$d(this,Pa)||(zd(this,eo,io).call(this),$d(this,Ja)&&($d(this,Ua)||zd(this,eo,fo).call(this),Hd(this,Ja,!1),$d(this,La).hidden=!1))}get isVisible(){return!$d(this,Pa)&&!1===$d(this,La).hidden}}Pa=new WeakMap,Ta=new WeakMap,Ra=new WeakMap,Da=new WeakMap,Ia=new WeakMap,Oa=new WeakMap,La=new WeakMap,Fa=new WeakMap,Na=new WeakMap,Ba=new WeakMap,Wa=new WeakMap,ja=new WeakMap,$a=new WeakMap,Ua=new WeakMap,Ha=new WeakMap,za=new WeakMap,Va=new WeakMap,Ga=new WeakMap,qa=new WeakMap,Xa=new WeakMap,Ka=new WeakMap,Ya=new WeakMap,Qa=new WeakMap,Ja=new WeakMap,Za=new WeakMap,to=new WeakMap,eo=new WeakSet,io=function(){if($d(this,Ha))return;Hd(this,Ha,new AbortController);const{signal:t}=$d(this,Ha);for(const e of this.trigger)e.addEventListener("click",$d(this,Ia),{signal:t}),e.addEventListener("pointerenter",$d(this,Da),{signal:t}),e.addEventListener("pointerleave",$d(this,Ra),{signal:t}),e.classList.add("popupTriggerArea");for(const e of $d(this,Ba))e.container?.addEventListener("keydown",$d(this,Ta),{signal:t})},no=function(){const t=$d(this,Ba).find(t=>t.hasCommentButton);t&&Hd(this,Ga,t._normalizePoint(t.commentButtonPosition))},so=function(){if($d(this,Za).extraPopupElement&&!$d(this,Za).editor)return;this.renderCommentButton();const[t,e]=$d(this,Ga),{style:i}=$d(this,Va);i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`},ro=function(){$d(this,Za).extraPopupElement||(this.renderCommentButton(),$d(this,Va).style.backgroundColor=this.commentButtonColor||"")},ao=function(){const t=$d(this,Ka),e=$d(this,Fa);return!t?.str||e?.str&&e.str!==t.str?null:$d(this,Ka).html||null},oo=function(){return $d(this,eo,ao)?.attributes?.style?.fontSize||0},lo=function(){return $d(this,eo,ao)?.attributes?.style?.color||null},ho=function(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},n={style:{color:$d(this,eo,lo),fontSize:$d(this,eo,oo)?`calc(${$d(this,eo,oo)}px * var(--total-scale-factor))`:""}};for(const s of t.split("\n"))e.push({name:"span",value:s,attributes:n});return i},co=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||("Enter"===t.key||"Escape"===t.key&&$d(this,$a))&&zd(this,eo,po).call(this)},uo=function(){if(null!==$d(this,za))return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:n,pageY:s}}}=$d(this,Wa);let r=!!$d(this,ja),a=$d(this,r?ja:Xa);for(const u of $d(this,Ba))if(!a||null!==l_.intersect(u.data.rect,a)){a=u.data.rect,r=!0;break}const o=l_.normalizeRect([a[0],t[3]-a[1]+t[1],a[2],t[3]-a[3]+t[1]]),l=r?a[2]-a[0]+5:0,h=o[0]+l,c=o[1];Hd(this,za,[100*(h-n)/e,100*(c-s)/i]);const{style:d}=$d(this,La);d.left=`${$d(this,za)[0]}%`,d.top=`${$d(this,za)[1]}%`},po=function(){$d(this,Pa)?$d(this,Pa).toggleCommentPopup(this,!1):(Hd(this,$a,!$d(this,$a)),$d(this,$a)?(zd(this,eo,fo).call(this),$d(this,La).addEventListener("click",$d(this,Ia)),$d(this,La).addEventListener("keydown",$d(this,Ta))):(zd(this,eo,go).call(this),$d(this,La).removeEventListener("click",$d(this,Ia)),$d(this,La).removeEventListener("keydown",$d(this,Ta))))},fo=function(){$d(this,Ua)||this.render(),this.isVisible?$d(this,$a)&&$d(this,La).classList.add("focused"):(zd(this,eo,uo).call(this),$d(this,La).hidden=!1,$d(this,La).style.zIndex=parseInt($d(this,La).style.zIndex)+1e3)},go=function(){$d(this,La).classList.remove("focused"),!$d(this,$a)&&this.isVisible&&($d(this,La).hidden=!0,$d(this,La).style.zIndex=parseInt($d(this,La).style.zIndex)-1e3)};class hM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Lx.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class cM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Ud(this,mo,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),s=Hd(this,mo,this.svgFactory.createElement("svg:line"));return s.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),s.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),s.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),s.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),s.setAttribute("stroke-width",t.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),n.append(s),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $d(this,mo)}addHighlightArea(){this.container.classList.add("highlightArea")}}mo=new WeakMap;class dM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Ud(this,yo,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,r=Hd(this,yo,this.svgFactory.createElement("svg:rect"));return r.setAttribute("x",s/2),r.setAttribute("y",s/2),r.setAttribute("width",e-s),r.setAttribute("height",i-s),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $d(this,yo)}addHighlightArea(){this.container.classList.add("highlightArea")}}yo=new WeakMap;class uM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Ud(this,wo,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,n=this.svgFactory.create(e,i,!0),s=t.borderStyle.width,r=Hd(this,wo,this.svgFactory.createElement("svg:ellipse"));return r.setAttribute("cx",e/2),r.setAttribute("cy",i/2),r.setAttribute("rx",e/2-s/2),r.setAttribute("ry",i/2-s/2),r.setAttribute("stroke-width",s||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),n.append(r),this.container.append(n),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $d(this,wo)}addHighlightArea(){this.container.classList.add("highlightArea")}}wo=new WeakMap;class pM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Ud(this,vo,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:n},width:s,height:r}=this;if(!e)return this.container;const a=this.svgFactory.create(s,r,!0);let o=[];for(let h=0,c=e.length;h<c;h+=2){const i=e[h]-t[0],n=t[3]-e[h+1];o.push(`${i},${n}`)}o=o.join(" ");const l=Hd(this,vo,this.svgFactory.createElement(this.svgElementName));return l.setAttribute("points",o),l.setAttribute("stroke-width",i.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!n&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return $d(this,vo)}addHighlightArea(){this.container.classList.add("highlightArea")}}vo=new WeakMap;class fM extends pM{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class gM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class mM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),Ud(this,xo),Ud(this,bo,null),Ud(this,Ao,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType="InkHighlight"===this.data.it?Lx.HIGHLIGHT:Lx.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:n,popupRef:s}}=this,{transform:r,width:a,height:o}=zd(this,xo,_o).call(this,e,t),l=this.svgFactory.create(a,o,!0),h=Hd(this,bo,this.svgFactory.createElement("svg:g"));l.append(h),h.setAttribute("stroke-width",n.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",r);for(let c=0,d=i.length;c<d;c++){const t=this.svgFactory.createElement(this.svgElementName);$d(this,Ao).push(t),t.setAttribute("points",i[c].join(",")),h.append(t)}return!s&&this.hasPopupData&&this._createPopup(),this.container.append(l),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:n}=t,s=$d(this,bo);if(e>=0&&s.setAttribute("stroke-width",e||1),i)for(let r=0,a=$d(this,Ao).length;r<a;r++)$d(this,Ao)[r].setAttribute("points",i[r].join(","));if(n){const{transform:t,width:e,height:i}=zd(this,xo,_o).call(this,this.data.rotation,n);s.parentElement.setAttribute("viewBox",`0 0 ${e} ${i}`),s.setAttribute("transform",t)}}getElementsToTriggerPopup(){return $d(this,Ao)}addHighlightArea(){this.container.classList.add("highlightArea")}}bo=new WeakMap,Ao=new WeakMap,xo=new WeakSet,_o=function(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}};class yM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Lx.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const e=document.createElement("mark");e.classList.add("overlaidText"),e.textContent=t,this.container.append(e)}return this.container}}class wM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const e=document.createElement("u");e.classList.add("overlaidText"),e.textContent=t,this.container.append(e)}return this.container}}class vM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const e=document.createElement("u");e.classList.add("overlaidText"),e.textContent=t,this.container.append(e)}return this.container}}class bM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const e=document.createElement("s");e.classList.add("overlaidText"),e.textContent=t,this.container.append(e)}return this.container}}class AM extends YE{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Lx.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class xM extends YE{constructor(t){super(t,{isRenderable:!0}),Ud(this,ko),Ud(this,So,null);const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||0===e.fillAlpha?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(100*e.fillAlpha)}%);`)),i.addEventListener("dblclick",zd(this,ko,Eo).bind(this)),Hd(this,So,i);const{isMac:n}=a_.platform;return t.addEventListener("keydown",t=>{"Enter"===t.key&&(n?t.metaKey:t.ctrlKey)&&zd(this,ko,Eo).call(this)}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return $d(this,So)}addHighlightArea(){this.container.classList.add("highlightArea")}}So=new WeakMap,ko=new WeakSet,Eo=function(){this.downloadManager?.openOrDownloadData(this.content,this.filename)},Mo=new WeakMap,Co=new WeakMap,Po=new WeakMap,To=new WeakMap,Ro=new WeakMap,Do=new WeakMap,Io=new WeakSet,Oo=async function(t,e,i){const n=t.firstChild||t,s=n.id=`${p_}${e}`,r=await($d(this,Ro)?.getAriaAttributes(s));if(r)for(const[a,o]of r)n.setAttribute(a,o);i?i.at(-1).container.after(t):(this.div.append(t),$d(this,Mo)?.moveElementInDOM(this.div,t,n,!1))},Lo=function(){if(!$d(this,Co))return;const t=this.div;for(const[e,i]of $d(this,Co)){const n=t.querySelector(`[data-annotation-id="${e}"]`);if(!n)continue;i.className="annotationContent";const{firstChild:s}=n;s?"CANVAS"===s.nodeName?s.replaceWith(i):s.classList.contains("annotationContent")?s.after(i):s.before(i):n.append(i);const r=$d(this,To).get(e);r&&(r._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,n.id,i),r._hasNoCanvas=!1):r.canvas=i)}$d(this,Co).clear()};let _M=class t{constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:n,page:s,viewport:r,structTreeLayer:a,commentManager:o,linkService:l,annotationStorage:h}){Ud(this,Io),Ud(this,Mo,null),Ud(this,Co,null),Ud(this,Po,null),Ud(this,To,new Map),Ud(this,Ro,null),Ud(this,Do,null),this.div=t,Hd(this,Mo,e),Hd(this,Co,i),Hd(this,Ro,a||null),Hd(this,Do,l||null),Hd(this,Po,h||new xS),this.page=s,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=n,this._commentManager=o||null}hasEditableAnnotations(){return $d(this,To).size>0}async render(t){const{annotations:e}=t,i=this.div;N_(i,this.viewport);const n=new Map,s={data:null,layer:i,linkService:$d(this,Do),downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:!1!==t.renderForms,svgFactory:new GE,annotationStorage:$d(this,Po),enableComment:!0===t.enableComment,enableScripting:!0===t.enableScripting,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const r of e){if(r.noHTML)continue;const t=r.annotationType===Wx.POPUP;if(t){const t=n.get(r.id);if(!t)continue;s.elements=t}else if(r.rect[2]===r.rect[0]||r.rect[3]===r.rect[1])continue;s.data=r;const e=KE.create(s);if(!e.isRenderable)continue;if(!t&&r.popupRef){const t=n.get(r.popupRef);t?t.push(e):n.set(r.popupRef,[e])}const i=e.render();r.hidden&&(i.style.visibility="hidden"),await zd(this,Io,Oo).call(this,i,r.id,s.elements),e.extraPopupElement?.popup?.renderCommentButton(),e._isEditable&&($d(this,To).set(e.data.id,e),this._annotationEditorUIManager?.renderAnnotationElement(e))}zd(this,Io,Lo).call(this)}async addLinkAnnotations(e){const i={data:null,layer:this.div,linkService:$d(this,Do),svgFactory:new GE,parent:this};for(const n of e){n.borderStyle||(n.borderStyle=t._defaultBorderStyle),i.data=n;const e=KE.create(i);if(!e.isRenderable)continue;const s=e.render();await zd(this,Io,Oo).call(this,s,n.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,N_(e,{rotation:t.rotation}),zd(this,Io,Lo).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from($d(this,To).values())}getEditableAnnotation(t){return $d(this,To).get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:n}=t,s=new QE({data:{id:i,rect:t.getPDFRect(),rotation:n},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:$d(this,Do),annotationStorage:$d(this,Po)}),r=s.render();return e.append(r),$d(this,Mo)?.moveElementInDOM(e,r,r,!1),s.createOrUpdatePopup(),s}static get _defaultBorderStyle(){return Yx(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:1,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const SM=/\r\n?|\n/g,kM=class t extends gS{constructor(e){super({...e,name:"freeTextEditor"}),Ud(this,jo),Ud(this,Fo,""),Ud(this,No,`${this.id}-editor`),Ud(this,Bo,null),Ud(this,Wo),Wd(this,"_colorPicker",null),this.color=e.color||t._defaultColor||gS._defaultLineColor,Hd(this,Wo,e.fontSize||t._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const e=t.prototype,i=t=>t.isEmpty(),n=lS.TRANSLATE_SMALL,s=lS.TRANSLATE_BIG;return Yx(this,"_keyboardManager",new sS([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:i}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:i}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:i}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:i}]]))}static initialize(t,e){gS.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,i){switch(e){case Fx.FREETEXT_SIZE:t._defaultFontSize=i;break;case Fx.FREETEXT_COLOR:t._defaultColor=i}}updateParams(t,e){switch(t){case Fx.FREETEXT_SIZE:zd(this,jo,$o).call(this,e);break;case Fx.FREETEXT_COLOR:zd(this,jo,Uo).call(this,e)}}static get defaultPropertiesToUpdate(){return[[Fx.FREETEXT_SIZE,t._defaultFontSize],[Fx.FREETEXT_COLOR,t._defaultColor||gS._defaultLineColor]]}get propertiesToUpdate(){return[[Fx.FREETEXT_SIZE,$d(this,Wo)],[Fx.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new $E(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Fx.FREETEXT_COLOR}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const e=this.parentScale;return[-t._internalPadding*e,-(t._internalPadding+$d(this,Wo))*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),Hd(this,Bo,new AbortController);const t=this._uiManager.combinedSignal($d(this,Bo));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return!!super.disableEditMode()&&(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",$d(this,No)),this._isDraggable=!0,$d(this,Bo)?.abort(),Hd(this,Bo,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0)}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=$d(this,Fo),e=Hd(this,Fo,zd(this,jo,Ho).call(this).trimEnd());if(t===e)return;const i=t=>{Hd(this,Fo,t),t?(zd(this,jo,qo).call(this),this._uiManager.rebuild(this),zd(this,jo,zo).call(this)):this.remove()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),zd(this,jo,zo).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&"Enter"===t.key&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(e){t._keyboardManager.exec(this,e)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",$d(this,No)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${$d(this,Wo)}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,n]=this.parentDimensions;if(this.annotationElementId){const{position:s}=this._initialData;let[r,a]=this.getInitialTranslation();[r,a]=this.pageTranslationToScreen(r,a);const[o,l]=this.pageDimensions,[h,c]=this.pageTranslation;let d,u;switch(this.rotation){case 0:d=t+(s[0]-h)/o,u=e+this.height-(s[1]-c)/l;break;case 90:d=t+(s[0]-h)/o,u=e-(s[1]-c)/l,[r,a]=[a,-r];break;case 180:d=t-this.width+(s[0]-h)/o,u=e-(s[1]-c)/l,[r,a]=[-r,-a];break;case 270:d=t+(s[0]-h-this.height*l)/o,u=e+(s[1]-c-this.width*o)/l,[r,a]=[-a,r]}this.setAt(d*i,u*n,r,a)}else this._moveAfterPaste(t,e);zd(this,jo,qo).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var i,n,s;const r=e.clipboardData||window.clipboardData,{types:a}=r;if(1===a.length&&"text/plain"===a[0])return;e.preventDefault();const o=zd(i=t,Vo,Ko).call(i,r.getData("text")||"").replaceAll(SM,"\n");if(!o)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const h=l.getRangeAt(0);if(!o.includes("\n"))return h.insertNode(document.createTextNode(o)),this.editorDiv.normalize(),void l.collapseToStart();const{startContainer:c,startOffset:d}=h,u=[],p=[];if(c.nodeType===Node.TEXT_NODE){const e=c.parentElement;if(p.push(c.nodeValue.slice(d).replaceAll(SM,"")),e!==this.editorDiv){let i=u;for(const s of this.editorDiv.childNodes)s!==e?i.push(zd(n=t,Vo,Go).call(n,s)):i=p}u.push(c.nodeValue.slice(0,d).replaceAll(SM,""))}else if(c===this.editorDiv){let e=u,i=0;for(const n of this.editorDiv.childNodes)i++===d&&(e=p),e.push(zd(s=t,Vo,Go).call(s,n))}Hd(this,Fo,`${u.join("\n")}${o}${p.join("\n")}`),zd(this,jo,qo).call(this);const f=new Range;let g=Math.sumPrecise(u.map(t=>t.length));for(const{firstChild:t}of this.editorDiv.childNodes)if(t.nodeType===Node.TEXT_NODE){const e=t.nodeValue.length;if(g<=e){f.setStart(t,g),f.setEnd(t,g);break}g-=e}l.removeAllRanges(),l.addRange(f)}get contentDiv(){return this.editorDiv}getPDFRect(){const e=t._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,i,n){var s;let r=null;if(e instanceof hM){const{data:{defaultAppearanceData:{fontSize:t,fontColor:i},rect:n,rotation:s,id:a,popupRef:o,richText:l,contentsObj:h,creationDate:c,modificationDate:d},textContent:u,textPosition:p,parent:{page:{pageNumber:f}}}=e;if(!u||0===u.length)return null;r=e={annotationType:Lx.FREETEXT,color:Array.from(i),fontSize:t,value:u.join("\n"),position:p,pageIndex:f-1,rect:n.slice(0),rotation:s,annotationElementId:a,id:a,deleted:!1,popupRef:o,comment:h?.str||null,richText:l,creationDate:c,modificationDate:d}}const a=await super.deserialize(e,i,n);return Hd(a,Wo,e.fontSize),a.color=l_.makeHexColor(...e.color),Hd(a,Fo,zd(s=t,Vo,Ko).call(s,e.value)),a._initialData=r,e.comment&&a.setCommentData(e),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=gS._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:$d(this,Wo),value:zd(this,jo,Xo).call(this)});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!zd(this,jo,Yo).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${$d(this,Wo)}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const n of $d(this,Fo).split("\n")){const t=document.createElement("div");t.append(n?document.createTextNode(n):document.createElement("br")),e.append(t)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:$d(this,Fo)}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Fo=new WeakMap,No=new WeakMap,Bo=new WeakMap,Wo=new WeakMap,jo=new WeakSet,$o=function(t){const e=t=>{this.editorDiv.style.fontSize=`calc(${t}px * var(--total-scale-factor))`,this.translate(0,-(t-$d(this,Wo))*this.parentScale),Hd(this,Wo,t),zd(this,jo,zo).call(this)},i=$d(this,Wo);this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fx.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Uo=function(t){const e=t=>{this.color=t,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fx.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ho=function(){var t;const e=[];this.editorDiv.normalize();let i=null;for(const n of this.editorDiv.childNodes)i?.nodeType===Node.TEXT_NODE&&"BR"===n.nodeName||(e.push(zd(t=kM,Vo,Go).call(t,n)),i=n);return e.join("\n")},zo=function(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:t,div:e}=this,n=e.style.display,s=e.classList.contains("hidden");e.classList.remove("hidden"),e.style.display="hidden",t.div.append(this.div),i=e.getBoundingClientRect(),e.remove(),e.style.display=n,e.classList.toggle("hidden",s)}this.rotation%180==this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()},Vo=new WeakSet,Go=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(SM,"")},qo=function(){if(this.editorDiv.replaceChildren(),$d(this,Fo))for(const t of $d(this,Fo).split("\n")){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}},Xo=function(){return $d(this,Fo).replaceAll(""," ")},Ko=function(t){return t.replaceAll(" ","")},Yo=function(t){const{value:e,fontSize:i,color:n,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((t,e)=>t!==n[e])||t.pageIndex!==s},Ud(kM,Vo),Wd(kM,"_freeTextDefaultContent",""),Wd(kM,"_internalPadding",0),Wd(kM,"_defaultColor",null),Wd(kM,"_defaultFontSize",10),Wd(kM,"_type","freetext"),Wd(kM,"_editorType",Lx.FREETEXT);let EM=kM;class MM{toSVGPath(){Gx("Abstract method `toSVGPath` must be implemented.")}get box(){Gx("Abstract getter `box` must be implemented.")}serialize(t,e){Gx("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,n,s,r){r||(r=new Float32Array(t.length));for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a]*n,r[a+1]=i+t[a+1]*s;return r}static _rescaleAndSwap(t,e,i,n,s,r){r||(r=new Float32Array(t.length));for(let a=0,o=t.length;a<o;a+=2)r[a]=e+t[a+1]*n,r[a+1]=i+t[a]*s;return r}static _translate(t,e,i,n){n||(n=new Float32Array(t.length));for(let s=0,r=t.length;s<r;s+=2)n[s]=e+t[s],n[s+1]=i+t[s+1];return n}static svgRound(t){return Math.round(1e4*t)}static _normalizePoint(t,e,i,n,s){switch(s){case 90:return[1-e/i,t/n];case 180:return[1-t/i,1-e/n];case 270:return[e/i,1-t/n];default:return[t/i,e/n]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,n,s,r){return[(t+5*i)/6,(e+5*n)/6,(5*i+s)/6,(5*n+r)/6,(i+s)/2,(n+r)/2]}}Wd(MM,"PRECISION",1e-4);const CM=class t{constructor({x:e,y:i},n,s,r,a,o=0){Ud(this,pl),Ud(this,Qo),Ud(this,Jo,[]),Ud(this,Zo),Ud(this,tl),Ud(this,el,[]),Ud(this,il,new Float32Array(18)),Ud(this,nl),Ud(this,sl),Ud(this,rl),Ud(this,al),Ud(this,ol),Ud(this,ll),Ud(this,hl,[]),Hd(this,Qo,n),Hd(this,ll,r*s),Hd(this,tl,a),$d(this,il).set([NaN,NaN,NaN,NaN,e,i],6),Hd(this,Zo,o),Hd(this,al,$d(t,cl)*s),Hd(this,rl,$d(t,ul)*s),Hd(this,ol,s),$d(this,hl).push(e,i)}isEmpty(){return isNaN($d(this,il)[8])}add({x:t,y:e}){Hd(this,nl,t),Hd(this,sl,e);const[i,n,s,r]=$d(this,Qo);let[a,o,l,h]=$d(this,il).subarray(8,12);const c=t-l,d=e-h,u=Math.hypot(c,d);if(u<$d(this,rl))return!1;const p=u-$d(this,al),f=p/u,g=f*c,m=f*d;let y=a,w=o;a=l,o=h,l+=g,h+=m,$d(this,hl)?.push(t,e);const v=g/p,b=-m/p*$d(this,ll),A=v*$d(this,ll);return $d(this,il).set($d(this,il).subarray(2,8),0),$d(this,il).set([l+b,h+A],4),$d(this,il).set($d(this,il).subarray(14,18),12),$d(this,il).set([l-b,h-A],16),isNaN($d(this,il)[6])?(0===$d(this,el).length&&($d(this,il).set([a+b,o+A],2),$d(this,el).push(NaN,NaN,NaN,NaN,(a+b-i)/s,(o+A-n)/r),$d(this,il).set([a-b,o-A],14),$d(this,Jo).push(NaN,NaN,NaN,NaN,(a-b-i)/s,(o-A-n)/r)),$d(this,il).set([y,w,a,o,l,h],6),!this.isEmpty()):($d(this,il).set([y,w,a,o,l,h],6),Math.abs(Math.atan2(w-o,y-a)-Math.atan2(m,g))<Math.PI/2?([a,o,l,h]=$d(this,il).subarray(2,6),$d(this,el).push(NaN,NaN,NaN,NaN,((a+l)/2-i)/s,((o+h)/2-n)/r),[a,o,y,w]=$d(this,il).subarray(14,18),$d(this,Jo).push(NaN,NaN,NaN,NaN,((y+a)/2-i)/s,((w+o)/2-n)/r),!0):([y,w,a,o,l,h]=$d(this,il).subarray(0,6),$d(this,el).push(((y+5*a)/6-i)/s,((w+5*o)/6-n)/r,((5*a+l)/6-i)/s,((5*o+h)/6-n)/r,((a+l)/2-i)/s,((o+h)/2-n)/r),[l,h,a,o,y,w]=$d(this,il).subarray(12,18),$d(this,Jo).push(((y+5*a)/6-i)/s,((w+5*o)/6-n)/r,((5*a+l)/6-i)/s,((5*o+h)/6-n)/r,((a+l)/2-i)/s,((o+h)/2-n)/r),!0))}toSVGPath(){if(this.isEmpty())return"";const t=$d(this,el),e=$d(this,Jo);if(isNaN($d(this,il)[6])&&!this.isEmpty())return zd(this,pl,gl).call(this);const i=[];i.push(`M${t[4]} ${t[5]}`);for(let n=6;n<t.length;n+=6)isNaN(t[n])?i.push(`L${t[n+4]} ${t[n+5]}`):i.push(`C${t[n]} ${t[n+1]} ${t[n+2]} ${t[n+3]} ${t[n+4]} ${t[n+5]}`);zd(this,pl,yl).call(this,i);for(let n=e.length-6;n>=6;n-=6)isNaN(e[n])?i.push(`L${e[n+4]} ${e[n+5]}`):i.push(`C${e[n]} ${e[n+1]} ${e[n+2]} ${e[n+3]} ${e[n+4]} ${e[n+5]}`);return zd(this,pl,ml).call(this,i),i.join(" ")}newFreeDrawOutline(t,e,i,n,s,r){return new TM(t,e,i,n,s,r)}getOutlines(){const t=$d(this,el),e=$d(this,Jo),i=$d(this,il),[n,s,r,a]=$d(this,Qo),o=new Float32Array(($d(this,hl)?.length??0)+2);for(let c=0,d=o.length-2;c<d;c+=2)o[c]=($d(this,hl)[c]-n)/r,o[c+1]=($d(this,hl)[c+1]-s)/a;if(o[o.length-2]=($d(this,nl)-n)/r,o[o.length-1]=($d(this,sl)-s)/a,isNaN(i[6])&&!this.isEmpty())return zd(this,pl,wl).call(this,o);const l=new Float32Array($d(this,el).length+24+$d(this,Jo).length);let h=t.length;for(let c=0;c<h;c+=2)isNaN(t[c])?l[c]=l[c+1]=NaN:(l[c]=t[c],l[c+1]=t[c+1]);h=zd(this,pl,bl).call(this,l,h);for(let c=e.length-6;c>=6;c-=6)for(let t=0;t<6;t+=2)isNaN(e[c+t])?(l[h]=l[h+1]=NaN,h+=2):(l[h]=e[c+t],l[h+1]=e[c+t+1],h+=2);return zd(this,pl,vl).call(this,l,h),this.newFreeDrawOutline(l,o,$d(this,Qo),$d(this,ol),$d(this,Zo),$d(this,tl))}};Qo=new WeakMap,Jo=new WeakMap,Zo=new WeakMap,tl=new WeakMap,el=new WeakMap,il=new WeakMap,nl=new WeakMap,sl=new WeakMap,rl=new WeakMap,al=new WeakMap,ol=new WeakMap,ll=new WeakMap,hl=new WeakMap,cl=new WeakMap,dl=new WeakMap,ul=new WeakMap,pl=new WeakSet,fl=function(){const t=$d(this,il).subarray(4,6),e=$d(this,il).subarray(16,18),[i,n,s,r]=$d(this,Qo);return[($d(this,nl)+(t[0]-e[0])/2-i)/s,($d(this,sl)+(t[1]-e[1])/2-n)/r,($d(this,nl)+(e[0]-t[0])/2-i)/s,($d(this,sl)+(e[1]-t[1])/2-n)/r]},gl=function(){const[t,e,i,n]=$d(this,Qo),[s,r,a,o]=zd(this,pl,fl).call(this);return`M${($d(this,il)[2]-t)/i} ${($d(this,il)[3]-e)/n} L${($d(this,il)[4]-t)/i} ${($d(this,il)[5]-e)/n} L${s} ${r} L${a} ${o} L${($d(this,il)[16]-t)/i} ${($d(this,il)[17]-e)/n} L${($d(this,il)[14]-t)/i} ${($d(this,il)[15]-e)/n} Z`},ml=function(t){const e=$d(this,Jo);t.push(`L${e[4]} ${e[5]} Z`)},yl=function(t){const[e,i,n,s]=$d(this,Qo),r=$d(this,il).subarray(4,6),a=$d(this,il).subarray(16,18),[o,l,h,c]=zd(this,pl,fl).call(this);t.push(`L${(r[0]-e)/n} ${(r[1]-i)/s} L${o} ${l} L${h} ${c} L${(a[0]-e)/n} ${(a[1]-i)/s}`)},wl=function(t){const e=$d(this,il),[i,n,s,r]=$d(this,Qo),[a,o,l,h]=zd(this,pl,fl).call(this),c=new Float32Array(36);return c.set([NaN,NaN,NaN,NaN,(e[2]-i)/s,(e[3]-n)/r,NaN,NaN,NaN,NaN,(e[4]-i)/s,(e[5]-n)/r,NaN,NaN,NaN,NaN,a,o,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,(e[16]-i)/s,(e[17]-n)/r,NaN,NaN,NaN,NaN,(e[14]-i)/s,(e[15]-n)/r],0),this.newFreeDrawOutline(c,t,$d(this,Qo),$d(this,ol),$d(this,Zo),$d(this,tl))},vl=function(t,e){const i=$d(this,Jo);return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+6},bl=function(t,e){const i=$d(this,il).subarray(4,6),n=$d(this,il).subarray(16,18),[s,r,a,o]=$d(this,Qo),[l,h,c,d]=zd(this,pl,fl).call(this);return t.set([NaN,NaN,NaN,NaN,(i[0]-s)/a,(i[1]-r)/o,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,c,d,NaN,NaN,NaN,NaN,(n[0]-s)/a,(n[1]-r)/o],e),e+24},Ud(CM,cl,8),Ud(CM,dl,2),Ud(CM,ul,$d(CM,cl)+$d(CM,dl));let PM=CM;class TM extends MM{constructor(t,e,i,n,s,r){super(),Ud(this,Cl),Ud(this,Al),Ud(this,xl,new Float32Array(4)),Ud(this,_l),Ud(this,Sl),Ud(this,kl),Ud(this,El),Ud(this,Ml),Hd(this,Ml,t),Hd(this,kl,e),Hd(this,Al,i),Hd(this,El,n),Hd(this,_l,s),Hd(this,Sl,r),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],zd(this,Cl,Pl).call(this,r);const[a,o,l,h]=$d(this,xl);for(let c=0,d=t.length;c<d;c+=2)t[c]=(t[c]-a)/l,t[c+1]=(t[c+1]-o)/h;for(let c=0,d=e.length;c<d;c+=2)e[c]=(e[c]-a)/l,e[c+1]=(e[c+1]-o)/h}toSVGPath(){const t=[`M${$d(this,Ml)[4]} ${$d(this,Ml)[5]}`];for(let e=6,i=$d(this,Ml).length;e<i;e+=6)isNaN($d(this,Ml)[e])?t.push(`L${$d(this,Ml)[e+4]} ${$d(this,Ml)[e+5]}`):t.push(`C${$d(this,Ml)[e]} ${$d(this,Ml)[e+1]} ${$d(this,Ml)[e+2]} ${$d(this,Ml)[e+3]} ${$d(this,Ml)[e+4]} ${$d(this,Ml)[e+5]}`);return t.push("Z"),t.join(" ")}serialize([t,e,i,n],s){const r=i-t,a=n-e;let o,l;switch(s){case 0:o=MM._rescale($d(this,Ml),t,n,r,-a),l=MM._rescale($d(this,kl),t,n,r,-a);break;case 90:o=MM._rescaleAndSwap($d(this,Ml),t,e,r,a),l=MM._rescaleAndSwap($d(this,kl),t,e,r,a);break;case 180:o=MM._rescale($d(this,Ml),i,e,-r,a),l=MM._rescale($d(this,kl),i,e,-r,a);break;case 270:o=MM._rescaleAndSwap($d(this,Ml),i,n,-r,-a),l=MM._rescaleAndSwap($d(this,kl),i,n,-r,-a)}return{outline:Array.from(o),points:[Array.from(l)]}}get box(){return $d(this,xl)}newOutliner(t,e,i,n,s,r=0){return new PM(t,e,i,n,s,r)}getNewOutline(t,e){const[i,n,s,r]=$d(this,xl),[a,o,l,h]=$d(this,Al),c=s*l,d=r*h,u=i*l+a,p=n*h+o,f=this.newOutliner({x:$d(this,kl)[0]*c+u,y:$d(this,kl)[1]*d+p},$d(this,Al),$d(this,El),t,$d(this,Sl),e??$d(this,_l));for(let g=2;g<$d(this,kl).length;g+=2)f.add({x:$d(this,kl)[g]*c+u,y:$d(this,kl)[g+1]*d+p});return f.getOutlines()}}Al=new WeakMap,xl=new WeakMap,_l=new WeakMap,Sl=new WeakMap,kl=new WeakMap,El=new WeakMap,Ml=new WeakMap,Cl=new WeakSet,Pl=function(t){const e=$d(this,Ml);let i=e[4],n=e[5];const s=[i,n,i,n];let r=i,a=n,o=i,l=n;const h=t?Math.max:Math.min,c=new Float32Array(4);for(let u=6,p=e.length;u<p;u+=6){const t=e[u+4],d=e[u+5];isNaN(e[u])?(l_.pointBoundingBox(t,d,s),a>d?(r=t,a=d):a===d&&(r=h(r,t)),l<d?(o=t,l=d):l===d&&(o=h(o,t))):(c[0]=c[1]=1/0,c[2]=c[3]=-1/0,l_.bezierBoundingBox(i,n,...e.slice(u,u+6),c),l_.rectBoundingBox(c[0],c[1],c[2],c[3],s),a>c[1]?(r=c[0],a=c[1]):a===c[1]&&(r=h(r,c[0])),l<c[3]?(o=c[2],l=c[3]):l===c[3]&&(o=h(o,c[2]))),i=t,n=d}const d=$d(this,xl);d[0]=s[0]-$d(this,_l),d[1]=s[1]-$d(this,_l),d[2]=s[2]-s[0]+2*$d(this,_l),d[3]=s[3]-s[1]+2*$d(this,_l),this.firstPoint=[r,a],this.lastPoint=[o,l]};class RM{constructor(t,e=0,i=0,n=!0){Ud(this,Ll),Ud(this,Tl),Ud(this,Rl),Ud(this,Dl),Ud(this,Il,[]),Ud(this,Ol,[]);const s=[1/0,1/0,-1/0,-1/0],r=10**-4;for(const{x:f,y:g,width:m,height:y}of t){const t=Math.floor((f-e)/r)*r,i=Math.ceil((f+m+e)/r)*r,n=Math.floor((g-e)/r)*r,a=Math.ceil((g+y+e)/r)*r,o=[t,n,a,!0],l=[i,n,a,!1];$d(this,Il).push(o,l),l_.rectBoundingBox(t,n,i,a,s)}const a=s[2]-s[0]+2*i,o=s[3]-s[1]+2*i,l=s[0]-i,h=s[1]-i;let c=n?-1/0:1/0,d=1/0;const u=$d(this,Il).at(n?-1:-2),p=[u[0],u[2]];for(const f of $d(this,Il)){const[t,e,i,s]=f;!s&&n?e<d?(d=e,c=t):e===d&&(c=Math.max(c,t)):s&&!n&&(e<d?(d=e,c=t):e===d&&(c=Math.min(c,t))),f[0]=(t-l)/a,f[1]=(e-h)/o,f[2]=(i-h)/o}Hd(this,Tl,new Float32Array([l,h,a,o])),Hd(this,Rl,[c,d]),Hd(this,Dl,p)}getOutlines(){$d(this,Il).sort((t,e)=>t[0]-e[0]||t[1]-e[1]||t[2]-e[2]);const t=[];for(const e of $d(this,Il))e[3]?(t.push(...zd(this,Ll,jl).call(this,e)),zd(this,Ll,Bl).call(this,e)):(zd(this,Ll,Wl).call(this,e),t.push(...zd(this,Ll,jl).call(this,e)));return zd(this,Ll,Fl).call(this,t)}}Tl=new WeakMap,Rl=new WeakMap,Dl=new WeakMap,Il=new WeakMap,Ol=new WeakMap,Ll=new WeakSet,Fl=function(t){const e=[],i=new Set;for(const r of t){const[t,i,n]=r;e.push([t,i,r],[t,n,r])}e.sort((t,e)=>t[1]-e[1]||t[0]-e[0]);for(let r=0,a=e.length;r<a;r+=2){const t=e[r][2],n=e[r+1][2];t.push(n),n.push(t),i.add(t),i.add(n)}const n=[];let s;for(;i.size>0;){const t=i.values().next().value;let[e,r,a,o,l]=t;i.delete(t);let h=e,c=r;for(s=[e,a],n.push(s);;){let t;if(i.has(o))t=o;else{if(!i.has(l))break;t=l}i.delete(t),[e,r,a,o,l]=t,h!==e&&(s.push(h,c,e,c===r?r:a),h=e),c=c===r?a:r}s.push(h,c)}return new DM(n,$d(this,Tl),$d(this,Rl),$d(this,Dl))},Nl=function(t){const e=$d(this,Ol);let i=0,n=e.length-1;for(;i<=n;){const s=i+n>>1,r=e[s][0];if(r===t)return s;r<t?i=s+1:n=s-1}return n+1},Bl=function([,t,e]){const i=zd(this,Ll,Nl).call(this,t);$d(this,Ol).splice(i,0,[t,e])},Wl=function([,t,e]){const i=zd(this,Ll,Nl).call(this,t);for(let n=i;n<$d(this,Ol).length;n++){const[i,s]=$d(this,Ol)[n];if(i!==t)break;if(i===t&&s===e)return void $d(this,Ol).splice(n,1)}for(let n=i-1;n>=0;n--){const[i,s]=$d(this,Ol)[n];if(i!==t)break;if(i===t&&s===e)return void $d(this,Ol).splice(n,1)}},jl=function(t){const[e,i,n]=t,s=[[e,i,n]],r=zd(this,Ll,Nl).call(this,n);for(let a=0;a<r;a++){const[t,i]=$d(this,Ol)[a];for(let n=0,r=s.length;n<r;n++){const[,a,o]=s[n];if(!(i<=a||o<=t))if(a>=t)if(o>i)s[n][1]=i;else{if(1===r)return[];s.splice(n,1),n--,r--}else s[n][2]=t,o>i&&s.push([e,i,o])}}return s};class DM extends MM{constructor(t,e,i,n){super(),Ud(this,$l),Ud(this,Ul),Hd(this,Ul,t),Hd(this,$l,e),this.firstPoint=i,this.lastPoint=n}toSVGPath(){const t=[];for(const e of $d(this,Ul)){let[i,n]=e;t.push(`M${i} ${n}`);for(let s=2;s<e.length;s+=2){const r=e[s],a=e[s+1];r===i?(t.push(`V${a}`),n=a):a===n&&(t.push(`H${r}`),i=r)}t.push("Z")}return t.join(" ")}serialize([t,e,i,n],s){const r=[],a=i-t,o=n-e;for(const l of $d(this,Ul)){const e=new Array(l.length);for(let i=0;i<l.length;i+=2)e[i]=t+l[i]*a,e[i+1]=n-l[i+1]*o;r.push(e)}return r}get box(){return $d(this,$l)}get classNamesForOutlining(){return["highlightOutline"]}}$l=new WeakMap,Ul=new WeakMap;class IM extends PM{newFreeDrawOutline(t,e,i,n,s,r){return new OM(t,e,i,n,s,r)}}class OM extends TM{newOutliner(t,e,i,n,s,r=0){return new IM(t,e,i,n,s,r)}}const LM=class t extends gS{constructor(e){super({...e,name:"highlightEditor"}),Ud(this,oh),Ud(this,Hl,null),Ud(this,zl,0),Ud(this,Vl),Ud(this,Gl,null),Ud(this,ql,null),Ud(this,Xl,null),Ud(this,Kl,null),Ud(this,Yl,0),Ud(this,Ql,null),Ud(this,Jl,null),Ud(this,Zl,null),Ud(this,th,!1),Ud(this,eh,null),Ud(this,ih,null),Ud(this,nh,null),Ud(this,sh,""),Ud(this,rh),Ud(this,ah,""),this.color=e.color||t._defaultColor,Hd(this,rh,e.thickness||t._defaultThickness),this.opacity=e.opacity||t._defaultOpacity,Hd(this,Vl,e.boxes||null),Hd(this,ah,e.methodOfCreation||""),Hd(this,sh,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(Hd(this,th,!0),zd(this,oh,hh).call(this,e),zd(this,oh,fh).call(this)):$d(this,Vl)&&(Hd(this,Hl,e.anchorNode),Hd(this,zl,e.anchorOffset),Hd(this,Kl,e.focusNode),Hd(this,Yl,e.focusOffset),zd(this,oh,lh).call(this),zd(this,oh,fh).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const e=t.prototype;return Yx(this,"_keyboardManager",new sS([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:$d(this,th)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:$d(this,rh),methodOfCreation:$d(this,ah)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(e,i){gS.initialize(e,i),t._defaultColor||(t._defaultColor=i.highlightColors?.values().next().value||"#fff066")}static updateDefaultParams(e,i){switch(e){case Fx.HIGHLIGHT_COLOR:t._defaultColor=i;break;case Fx.HIGHLIGHT_THICKNESS:t._defaultThickness=i}}translateInPage(t,e){}get toolbarPosition(){return $d(this,ih)}get commentButtonPosition(){return $d(this,eh)}updateParams(t,e){switch(t){case Fx.HIGHLIGHT_COLOR:zd(this,oh,ch).call(this,e);break;case Fx.HIGHLIGHT_THICKNESS:zd(this,oh,dh).call(this,e)}}static get defaultPropertiesToUpdate(){return[[Fx.HIGHLIGHT_COLOR,t._defaultColor],[Fx.HIGHLIGHT_THICKNESS,t._defaultThickness]]}get propertiesToUpdate(){return[[Fx.HIGHLIGHT_COLOR,this.color||t._defaultColor],[Fx.HIGHLIGHT_THICKNESS,$d(this,rh)||t._defaultThickness],[Fx.HIGHLIGHT_FREE,$d(this,th)]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties($d(this,Zl),{root:{fill:this.color,"fill-opacity":this.opacity}}),$d(this,ql)?.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",Hd(this,ql,new WE({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(zd(this,oh,vh).call(this))}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,zd(this,oh,vh).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){zd(this,oh,ph).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(zd(this,oh,fh).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?zd(this,oh,ph).call(this):t&&(zd(this,oh,fh).call(this,t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}rotate(e){var i,n,s;const{drawLayer:r}=this.parent;let a;$d(this,th)?(e=(e-this.rotation+360)%360,a=zd(i=t,gh,mh).call(i,$d(this,Jl).box,e)):a=zd(n=t,gh,mh).call(n,[this.x,this.y,this.width,this.height],e),r.updateProperties($d(this,Zl),{bbox:a,root:{"data-main-rotation":e}}),r.updateProperties($d(this,nh),{bbox:zd(s=t,gh,mh).call(s,$d(this,Xl).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const t=super.render();$d(this,sh)&&(t.setAttribute("aria-label",$d(this,sh)),t.setAttribute("role","mark")),$d(this,th)?t.classList.add("free"):this.div.addEventListener("keydown",zd(this,oh,yh).bind(this),{signal:this._uiManager._signal});const e=Hd(this,Ql,document.createElement("div"));return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=$d(this,Gl),this.setDims(this.width,this.height),Z_(this,$d(this,Ql),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties($d(this,nh),{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties($d(this,nh),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:zd(this,oh,wh).call(this,!0);break;case 1:case 3:zd(this,oh,wh).call(this,!1)}}select(){super.select(),$d(this,nh)&&this.parent?.drawLayer.updateProperties($d(this,nh),{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),$d(this,nh)&&(this.parent?.drawLayer.updateProperties($d(this,nh),{rootClass:{selected:!1}}),$d(this,th)||zd(this,oh,wh).call(this,!1))}get _mustFixPosition(){return!$d(this,th)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties($d(this,Zl),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties($d(this,nh),{rootClass:{hidden:!t}}))}static startHighlighting(t,e,{target:i,x:n,y:s}){const{x:r,y:a,width:o,height:l}=i.getBoundingClientRect(),h=new AbortController,c=t.combinedSignal(h),d=e=>{h.abort(),zd(this,gh,_h).call(this,t,e)};window.addEventListener("blur",d,{signal:c}),window.addEventListener("pointerup",d,{signal:c}),window.addEventListener("pointerdown",R_,{capture:!0,passive:!1,signal:c}),window.addEventListener("contextmenu",T_,{signal:c}),i.addEventListener("pointermove",zd(this,gh,xh).bind(this,t),{signal:c}),this._freeHighlight=new IM({x:n,y:s},[r,a,o,l],t.scale,this._defaultThickness/2,e,.001),({id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0))}static async deserialize(t,e,i){var n,s,r,a;let o=null;if(t instanceof yM){const{data:{quadPoints:e,rect:i,rotation:n,id:s,color:r,opacity:a,popupRef:l,richText:h,contentsObj:c,creationDate:d,modificationDate:u},parent:{page:{pageNumber:p}}}=t;o=t={annotationType:Lx.HIGHLIGHT,color:Array.from(r),opacity:a,quadPoints:e,boxes:null,pageIndex:p-1,rect:i.slice(0),rotation:n,annotationElementId:s,id:s,deleted:!1,popupRef:l,richText:h,comment:c?.str||null,creationDate:d,modificationDate:u}}else if(t instanceof mM){const{data:{inkLists:e,rect:i,rotation:n,id:s,color:r,borderStyle:{rawWidth:a},popupRef:l,richText:h,contentsObj:c,creationDate:d,modificationDate:u},parent:{page:{pageNumber:p}}}=t;o=t={annotationType:Lx.HIGHLIGHT,color:Array.from(r),thickness:a,inkLists:e,boxes:null,pageIndex:p-1,rect:i.slice(0),rotation:n,annotationElementId:s,id:s,deleted:!1,popupRef:l,richText:h,comment:c?.str||null,creationDate:d,modificationDate:u}}const{color:l,quadPoints:h,inkLists:c,opacity:d}=t,u=await super.deserialize(t,e,i);u.color=l_.makeHexColor(...l),u.opacity=d||1,c&&Hd(u,rh,t.thickness),u._initialData=o,t.comment&&u.setCommentData(t);const[p,f]=u.pageDimensions,[g,m]=u.pageTranslation;if(h){const t=Hd(u,Vl,[]);for(let e=0;e<h.length;e+=8)t.push({x:(h[e]-g)/p,y:1-(h[e+1]-m)/f,width:(h[e+2]-h[e])/p,height:(h[e+1]-h[e+5])/f});zd(n=u,oh,lh).call(n),zd(s=u,oh,fh).call(s),u.rotate(u.rotation)}else if(c){Hd(u,th,!0);const t=c[0],i={x:t[0]-g,y:f-(t[1]-m)},n=new IM(i,[0,0,p,f],1,$d(u,rh)/2,!0,.001);for(let e=0,r=t.length;e<r;e+=2)i.x=t[e]-g,i.y=f-(t[e+1]-m),n.add(i);const{id:s,clipPathId:o}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:n.toSVGPath()}},!0,!0);zd(r=u,oh,hh).call(r,{highlightOutlines:n.getOutlines(),highlightId:s,clipPathId:o}),zd(a=u,oh,fh).call(a),u.rotate(u.parentRotation)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=gS._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:$d(this,rh),quadPoints:zd(this,oh,bh).call(this),outlines:zd(this,oh,Ah).call(this,i.rect)}),this.addComment(i),this.annotationElementId&&!zd(this,oh,Sh).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Hl=new WeakMap,zl=new WeakMap,Vl=new WeakMap,Gl=new WeakMap,ql=new WeakMap,Xl=new WeakMap,Kl=new WeakMap,Yl=new WeakMap,Ql=new WeakMap,Jl=new WeakMap,Zl=new WeakMap,th=new WeakMap,eh=new WeakMap,ih=new WeakMap,nh=new WeakMap,sh=new WeakMap,rh=new WeakMap,ah=new WeakMap,oh=new WeakSet,lh=function(){const t=new RM($d(this,Vl),.001);Hd(this,Jl,t.getOutlines()),[this.x,this.y,this.width,this.height]=$d(this,Jl).box;const e=new RM($d(this,Vl),.0025,.001,"ltr"===this._uiManager.direction);Hd(this,Xl,e.getOutlines());const{firstPoint:i}=$d(this,Jl);Hd(this,eh,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]);const{lastPoint:n}=$d(this,Xl);Hd(this,ih,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},hh=function({highlightOutlines:t,highlightId:e,clipPathId:i}){var n,s;if(Hd(this,Jl,t),Hd(this,Xl,t.getNewOutline($d(this,rh)/2+1.5,.0025)),e>=0)Hd(this,Zl,e),Hd(this,Gl,i),this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),Hd(this,nh,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:$d(this,Xl).box,path:{d:$d(this,Xl).toSVGPath()}},!0));else if(this.parent){const e=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties($d(this,Zl),{bbox:zd(n=LM,gh,mh).call(n,$d(this,Jl).box,(e-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties($d(this,nh),{bbox:zd(s=LM,gh,mh).call(s,$d(this,Xl).box,e),path:{d:$d(this,Xl).toSVGPath()}})}const[r,a,o,l]=t.box;switch(this.rotation){case 0:this.x=r,this.y=a,this.width=o,this.height=l;break;case 90:{const[t,e]=this.parentDimensions;this.x=a,this.y=1-r,this.width=o*e/t,this.height=l*t/e;break}case 180:this.x=1-r,this.y=1-a,this.width=o,this.height=l;break;case 270:{const[t,e]=this.parentDimensions;this.x=1-a,this.y=r,this.width=o*e/t,this.height=l*t/e;break}}const{firstPoint:h}=t;Hd(this,eh,[(h[0]-r)/o,(h[1]-a)/l]);const{lastPoint:c}=$d(this,Xl);Hd(this,ih,[(c[0]-r)/o,(c[1]-a)/l])},ch=function(t){const e=(t,e)=>{this.color=t,this.opacity=e,this.onUpdatedColor()},i=this.color,n=this.opacity;this.addCommands({cmd:e.bind(this,t,LM._defaultOpacity),undo:e.bind(this,i,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fx.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},dh=function(t){const e=$d(this,rh),i=t=>{Hd(this,rh,t),zd(this,oh,uh).call(this,t)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Fx.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},uh=function(t){$d(this,th)&&(zd(this,oh,hh).call(this,{highlightOutlines:$d(this,Jl).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},ph=function(){null!==$d(this,Zl)&&this.parent&&(this.parent.drawLayer.remove($d(this,Zl)),Hd(this,Zl,null),this.parent.drawLayer.remove($d(this,nh)),Hd(this,nh,null))},fh=function(t=this.parent){null===$d(this,Zl)&&(({id:Vd(this,Zl)._,clipPathId:Vd(this,Gl)._}=t.drawLayer.draw({bbox:$d(this,Jl).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:$d(this,th)},path:{d:$d(this,Jl).toSVGPath()}},!1,!0)),Hd(this,nh,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:$d(this,th)},bbox:$d(this,Xl).box,path:{d:$d(this,Xl).toSVGPath()}},$d(this,th))),$d(this,Ql)&&($d(this,Ql).style.clipPath=$d(this,Gl)))},gh=new WeakSet,mh=function([t,e,i,n],s){switch(s){case 90:return[1-e-n,t,n,i];case 180:return[1-t-i,1-e-n,i,n];case 270:return[e,1-t-i,n,i]}return[t,e,i,n]},yh=function(t){LM._keyboardManager.exec(this,t)},wh=function(t){if(!$d(this,Hl))return;const e=window.getSelection();t?e.setPosition($d(this,Hl),$d(this,zl)):e.setPosition($d(this,Kl),$d(this,Yl))},vh=function(){return $d(this,th)?this.rotation:0},bh=function(){if($d(this,th))return null;const[t,e]=this.pageDimensions,[i,n]=this.pageTranslation,s=$d(this,Vl),r=new Float32Array(8*s.length);let a=0;for(const{x:o,y:l,width:h,height:c}of s){const s=o*t+i,d=(1-l)*e+n;r[a]=r[a+4]=s,r[a+1]=r[a+3]=d,r[a+2]=r[a+6]=s+h*t,r[a+5]=r[a+7]=d-c*e,a+=8}return r},Ah=function(t){return $d(this,Jl).serialize(t,zd(this,oh,vh).call(this))},xh=function(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},_h=function(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},Sh=function(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((t,i)=>t!==e[i])},Ud(LM,gh),Wd(LM,"_defaultColor",null),Wd(LM,"_defaultOpacity",1),Wd(LM,"_defaultThickness",12),Wd(LM,"_type","highlight"),Wd(LM,"_editorType",Lx.HIGHLIGHT),Wd(LM,"_freeHighlightId",-1),Wd(LM,"_freeHighlight",null),Wd(LM,"_freeHighlightClipId","");let FM=LM;class NM{constructor(){Ud(this,kh,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){$d(this,kh)[t]=e}toSVGProperties(){const t=$d(this,kh);return Hd(this,kh,Object.create(null)),{root:t}}reset(){Hd(this,kh,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Gx("Not implemented")}}kh=new WeakMap;const BM=class t extends gS{constructor(t){super(t),Ud(this,Lh),Ud(this,Eh,null),Ud(this,Mh),Wd(this,"_colorPicker",null),Wd(this,"_drawId",null),Hd(this,Mh,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(zd(this,Lh,Fh).call(this,t),zd(this,Lh,Wh).call(this))}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[n,s]of Object.entries(e))i.has(n)?Object.assign(t[n],s):t[n]=s;return t}static getDefaultDrawingOptions(t){Gx("Not implemented")}static get typesMap(){Gx("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,i){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,i),this._currentParent&&($d(t,Ch).updateProperty(n,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,n]of this.typesMap)t.push([i,e[n]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,n]of this.constructor.typesMap)t.push([i,e[n]]);return t}_updateProperty(t,e,i){const n=this._drawingOptions,s=n[e],r=i=>{n.updateProperty(e,i);const s=$d(this,Eh).updateProperty(e,i);s&&zd(this,Lh,Uh).call(this,s),this.parent?.drawLayer.updateProperties(this._drawId,n.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:r.bind(this,i),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,t._mergeSVGProperties($d(this,Eh).getPathResizingSVGProperties(zd(this,Lh,$h).call(this)),{bbox:zd(this,Lh,Hh).call(this)}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,t._mergeSVGProperties($d(this,Eh).getPathResizedSVGProperties(zd(this,Lh,$h).call(this)),{bbox:zd(this,Lh,Hh).call(this)}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:zd(this,Lh,Hh).call(this)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,t._mergeSVGProperties($d(this,Eh).getPathTranslatedSVGProperties(zd(this,Lh,$h).call(this),this.parentDimensions),{bbox:zd(this,Lh,Hh).call(this)}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,$d(this,Mh)&&(Hd(this,Mh,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){zd(this,Lh,Bh).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(zd(this,Lh,Wh).call(this),zd(this,Lh,Uh).call(this,$d(this,Eh).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),zd(this,Lh,Bh).call(this)):t&&(this._uiManager.addShouldRescale(this),zd(this,Lh,Wh).call(this,t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,t._mergeSVGProperties({bbox:zd(this,Lh,Hh).call(this)},$d(this,Eh).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&zd(this,Lh,Uh).call(this,$d(this,Eh).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const n=document.createElement("div");return i.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,n,s){Gx("Not implemented")}static startDrawing(e,i,n,s){const{target:r,offsetX:a,offsetY:o,pointerId:l,pointerType:h}=s;if($d(t,Dh)&&$d(t,Dh)!==h)return;const{viewport:{rotation:c}}=e,{width:d,height:u}=r.getBoundingClientRect(),p=Hd(t,Ph,new AbortController),f=e.combinedSignal(p);$d(t,Rh)||Hd(t,Rh,l),$d(t,Dh)??Hd(t,Dh,h),window.addEventListener("pointerup",e=>{$d(t,Rh)===e.pointerId?this._endDraw(e):$d(t,Ih)?.delete(e.pointerId)},{signal:f}),window.addEventListener("pointercancel",e=>{$d(t,Rh)===e.pointerId?this._currentParent.endDrawingSession():$d(t,Ih)?.delete(e.pointerId)},{signal:f}),window.addEventListener("pointerdown",e=>{$d(t,Dh)===e.pointerType&&(($d(t,Ih)||Hd(t,Ih,new Set)).add(e.pointerId),$d(t,Ch).isCancellable()&&($d(t,Ch).removeLastElement(),$d(t,Ch).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",T_,{signal:f}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:f}),r.addEventListener("touchmove",e=>{e.timeStamp===$d(t,Oh)&&R_(e)},{signal:f}),e.toggleDrawing(),i._editorUndoBar?.hide(),$d(t,Ch)?e.drawLayer.updateProperties(this._currentDrawId,$d(t,Ch).startNew(a,o,d,u,c)):(i.updateUIForDefaultProperties(this),Hd(t,Ch,this.createDrawerInstance(a,o,d,u,c)),Hd(t,Th,this.getDefaultDrawingOptions()),this._currentParent=e,({id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties($d(t,Th).toSVGProperties(),$d(t,Ch).defaultSVGProperties),!0,!1)))}static _drawMove(e){if(Hd(t,Oh,-1),!$d(t,Ch))return;const{offsetX:i,offsetY:n,pointerId:s}=e;$d(t,Rh)===s&&($d(t,Ih)?.size>=1?this._endDraw(e):(this._currentParent.drawLayer.updateProperties(this._currentDrawId,$d(t,Ch).add(i,n)),Hd(t,Oh,e.timeStamp),R_(e)))}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,Hd(t,Ch,null),Hd(t,Th,null),Hd(t,Dh,null),Hd(t,Oh,NaN)),$d(t,Ph)&&($d(t,Ph).abort(),Hd(t,Ph,null),Hd(t,Rh,NaN),Hd(t,Ih,null))}static _endDraw(e){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),e?.target===i.div&&i.drawLayer.updateProperties(this._currentDrawId,$d(t,Ch).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const e=$d(t,Ch),n=this._currentDrawId,s=e.getLastElement();return void i.addCommands({cmd:()=>{i.drawLayer.updateProperties(n,e.setLastElement(s))},undo:()=>{i.drawLayer.updateProperties(n,e.removeLastElement())},mustExec:!1,type:Fx.DRAW_STEP})}this.endDrawing(!1)}}static endDrawing(e){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(Fx.DRAW_STEP),!$d(t,Ch).isEmpty()){const{pageDimensions:[n,s],scale:r}=i,a=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:$d(t,Ch).getOutlines(n*r,s*r,r,this._INNER_MARGIN),drawingOptions:$d(t,Th),mustBeCommitted:!e});return this._cleanup(!0),a}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,n,s,r){Gx("Not implemented")}static async deserialize(t,e,i){var n,s;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=e.viewport,h=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),c=await super.deserialize(t,e,i);return c.createDrawingOptions(t),zd(n=c,Lh,Fh).call(n,{drawOutlines:h}),zd(s=c,Lh,Wh).call(s),c.onScaleChanging(),c.rotate(),c}serializeDraw(t){const[e,i]=this.pageTranslation,[n,s]=this.pageDimensions;return $d(this,Eh).serialize([e,i,n,s],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Eh=new WeakMap,Mh=new WeakMap,Ch=new WeakMap,Ph=new WeakMap,Th=new WeakMap,Rh=new WeakMap,Dh=new WeakMap,Ih=new WeakMap,Oh=new WeakMap,Lh=new WeakSet,Fh=function({drawOutlines:t,drawId:e,drawingOptions:i}){Hd(this,Eh,t),this._drawingOptions||(this._drawingOptions=i),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=zd(this,Lh,Nh).call(this,t,this.parent),zd(this,Lh,Uh).call(this,t.box)},Nh=function(t,e){const{id:i}=e.drawLayer.draw(BM._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},Bh=function(){null!==this._drawId&&this.parent&&(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Wh=function(t=this.parent){null!==this._drawId&&this.parent===t||(null===this._drawId?(this._drawingOptions.updateAll(),this._drawId=zd(this,Lh,Nh).call(this,$d(this,Eh),t)):this.parent.drawLayer.updateParent(this._drawId,t.drawLayer))},jh=function([t,e,i,n]){const{parentDimensions:[s,r],rotation:a}=this;switch(a){case 90:return[e,1-t,i*(r/s),n*(s/r)];case 180:return[1-t,1-e,i,n];case 270:return[1-e,t,i*(r/s),n*(s/r)];default:return[t,e,i,n]}},$h=function(){const{x:t,y:e,width:i,height:n,parentDimensions:[s,r],rotation:a}=this;switch(a){case 90:return[1-e,t,i*(s/r),n*(r/s)];case 180:return[1-t,1-e,i,n];case 270:return[e,1-t,i*(s/r),n*(r/s)];default:return[t,e,i,n]}},Uh=function(t){[this.x,this.y,this.width,this.height]=zd(this,Lh,jh).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Hh=function(){const{x:t,y:e,width:i,height:n,rotation:s,parentRotation:r,parentDimensions:[a,o]}=this;switch((4*s+r)/90){case 1:return[1-e-n,t,n,i];case 2:return[1-t-i,1-e-n,i,n];case 3:return[e,1-t-i,n,i];case 4:return[t,e-i*(a/o),n*(o/a),i*(a/o)];case 5:return[1-e,t,i*(a/o),n*(o/a)];case 6:return[1-t-n*(o/a),1-e,n*(o/a),i*(a/o)];case 7:return[e-i*(a/o),1-t-n*(o/a),i*(a/o),n*(o/a)];case 8:return[t-i,e-n,i,n];case 9:return[1-e,t-i,n,i];case 10:return[1-t,1-e,i,n];case 11:return[e-n,1-t,n,i];case 12:return[t-n*(o/a),e,n*(o/a),i*(a/o)];case 13:return[1-e-i*(a/o),t-n*(o/a),i*(a/o),n*(o/a)];case 14:return[1-t,1-e-i*(a/o),n*(o/a),i*(a/o)];case 15:return[e,1-t,i*(a/o),n*(o/a)];default:return[t,e,i,n]}},Wd(BM,"_currentDrawId",-1),Wd(BM,"_currentParent",null),Ud(BM,Ch,null),Ud(BM,Ph,null),Ud(BM,Th,null),Ud(BM,Rh,NaN),Ud(BM,Dh,null),Ud(BM,Ih,null),Ud(BM,Oh,NaN),Wd(BM,"_INNER_MARGIN",3);let WM=BM;class jM{constructor(t,e,i,n,s,r){Ud(this,ec),Ud(this,zh,new Float64Array(6)),Ud(this,Vh),Ud(this,Gh),Ud(this,qh),Ud(this,Xh),Ud(this,Kh),Ud(this,Yh,""),Ud(this,Qh,0),Ud(this,Jh,new $M),Ud(this,Zh),Ud(this,tc),Hd(this,Zh,i),Hd(this,tc,n),Hd(this,qh,s),Hd(this,Xh,r),[t,e]=zd(this,ec,ic).call(this,t,e);const a=Hd(this,Vh,[NaN,NaN,NaN,NaN,t,e]);Hd(this,Kh,[t,e]),Hd(this,Gh,[{line:a,points:$d(this,Kh)}]),$d(this,zh).set(a,0)}updateProperty(t,e){"stroke-width"===t&&Hd(this,Xh,e)}isEmpty(){return!$d(this,Gh)||0===$d(this,Gh).length}isCancellable(){return $d(this,Kh).length<=10}add(t,e){[t,e]=zd(this,ec,ic).call(this,t,e);const[i,n,s,r]=$d(this,zh).subarray(2,6),a=t-s,o=e-r;return Math.hypot($d(this,Zh)*a,$d(this,tc)*o)<=2?null:($d(this,Kh).push(t,e),isNaN(i)?($d(this,zh).set([s,r,t,e],2),$d(this,Vh).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN($d(this,zh)[0])&&$d(this,Vh).splice(6,6),$d(this,zh).set([i,n,s,r,t,e],0),$d(this,Vh).push(...MM.createBezierPoints(i,n,s,r,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){return this.add(t,e)||(2===$d(this,Kh).length?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,n,s){Hd(this,Zh,i),Hd(this,tc,n),Hd(this,qh,s),[t,e]=zd(this,ec,ic).call(this,t,e);const r=Hd(this,Vh,[NaN,NaN,NaN,NaN,t,e]);Hd(this,Kh,[t,e]);const a=$d(this,Gh).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),$d(this,Gh).push({line:r,points:$d(this,Kh)}),$d(this,zh).set(r,0),Hd(this,Qh,0),this.toSVGPath(),null}getLastElement(){return $d(this,Gh).at(-1)}setLastElement(t){return $d(this,Gh)?($d(this,Gh).push(t),Hd(this,Vh,t.line),Hd(this,Kh,t.points),Hd(this,Qh,0),{path:{d:this.toSVGPath()}}):$d(this,Jh).setLastElement(t)}removeLastElement(){if(!$d(this,Gh))return $d(this,Jh).removeLastElement();$d(this,Gh).pop(),Hd(this,Yh,"");for(let t=0,e=$d(this,Gh).length;t<e;t++){const{line:e,points:i}=$d(this,Gh)[t];Hd(this,Vh,e),Hd(this,Kh,i),Hd(this,Qh,0),this.toSVGPath()}return{path:{d:$d(this,Yh)}}}toSVGPath(){const t=MM.svgRound($d(this,Vh)[4]),e=MM.svgRound($d(this,Vh)[5]);if(2===$d(this,Kh).length)return Hd(this,Yh,`${$d(this,Yh)} M ${t} ${e} Z`),$d(this,Yh);if($d(this,Kh).length<=6){const i=$d(this,Yh).lastIndexOf("M");Hd(this,Yh,`${$d(this,Yh).slice(0,i)} M ${t} ${e}`),Hd(this,Qh,6)}if(4===$d(this,Kh).length){const t=MM.svgRound($d(this,Vh)[10]),e=MM.svgRound($d(this,Vh)[11]);return Hd(this,Yh,`${$d(this,Yh)} L ${t} ${e}`),Hd(this,Qh,12),$d(this,Yh)}const i=[];0===$d(this,Qh)&&(i.push(`M ${t} ${e}`),Hd(this,Qh,6));for(let n=$d(this,Qh),s=$d(this,Vh).length;n<s;n+=6){const[t,e,s,r,a,o]=$d(this,Vh).slice(n,n+6).map(MM.svgRound);i.push(`C${t} ${e} ${s} ${r} ${a} ${o}`)}return Hd(this,Yh,$d(this,Yh)+i.join(" ")),Hd(this,Qh,$d(this,Vh).length),$d(this,Yh)}getOutlines(t,e,i,n){const s=$d(this,Gh).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),$d(this,Jh).build($d(this,Gh),t,e,i,$d(this,qh),$d(this,Xh),n),Hd(this,zh,null),Hd(this,Vh,null),Hd(this,Gh,null),Hd(this,Yh,null),$d(this,Jh)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}zh=new WeakMap,Vh=new WeakMap,Gh=new WeakMap,qh=new WeakMap,Xh=new WeakMap,Kh=new WeakMap,Yh=new WeakMap,Qh=new WeakMap,Jh=new WeakMap,Zh=new WeakMap,tc=new WeakMap,ec=new WeakSet,ic=function(t,e){return MM._normalizePoint(t,e,$d(this,Zh),$d(this,tc),$d(this,qh))};class $M extends MM{constructor(){super(...arguments),Ud(this,uc),Ud(this,nc),Ud(this,sc,0),Ud(this,rc),Ud(this,ac),Ud(this,oc),Ud(this,lc),Ud(this,hc),Ud(this,cc),Ud(this,dc)}build(t,e,i,n,s,r,a){Hd(this,oc,e),Hd(this,lc,i),Hd(this,hc,n),Hd(this,cc,s),Hd(this,dc,r),Hd(this,rc,a??0),Hd(this,ac,t),zd(this,uc,gc).call(this)}get thickness(){return $d(this,dc)}setLastElement(t){return $d(this,ac).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return $d(this,ac).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of $d(this,ac))if(t.push(`M${MM.svgRound(e[4])} ${MM.svgRound(e[5])}`),6!==e.length)if(12===e.length&&isNaN(e[6]))t.push(`L${MM.svgRound(e[10])} ${MM.svgRound(e[11])}`);else for(let i=6,n=e.length;i<n;i+=6){const[n,s,r,a,o,l]=e.subarray(i,i+6).map(MM.svgRound);t.push(`C${n} ${s} ${r} ${a} ${o} ${l}`)}else t.push("Z");return t.join("")}serialize([t,e,i,n],s){const r=[],a=[],[o,l,h,c]=zd(this,uc,fc).call(this);let d,u,p,f,g,m,y,w,v;switch($d(this,cc)){case 0:v=MM._rescale,d=t,u=e+n,p=i,f=-n,g=t+o*i,m=e+(1-l-c)*n,y=t+(o+h)*i,w=e+(1-l)*n;break;case 90:v=MM._rescaleAndSwap,d=t,u=e,p=i,f=n,g=t+l*i,m=e+o*n,y=t+(l+c)*i,w=e+(o+h)*n;break;case 180:v=MM._rescale,d=t+i,u=e,p=-i,f=n,g=t+(1-o-h)*i,m=e+l*n,y=t+(1-o)*i,w=e+(l+c)*n;break;case 270:v=MM._rescaleAndSwap,d=t+i,u=e+n,p=-i,f=-n,g=t+(1-l-c)*i,m=e+(1-o-h)*n,y=t+(1-l)*i,w=e+(1-o)*n}for(const{line:b,points:A}of $d(this,ac))r.push(v(b,d,u,p,f,s?new Array(b.length):null)),a.push(v(A,d,u,p,f,s?new Array(A.length):null));return{lines:r,points:a,rect:[g,m,y,w]}}static deserialize(t,e,i,n,s,{paths:{lines:r,points:a},rotation:o,thickness:l}){const h=[];let c,d,u,p,f;switch(o){case 0:f=MM._rescale,c=-t/i,d=e/n+1,u=1/i,p=-1/n;break;case 90:f=MM._rescaleAndSwap,c=-e/n,d=-t/i,u=1/n,p=1/i;break;case 180:f=MM._rescale,c=t/i+1,d=-e/n,u=-1/i,p=1/n;break;case 270:f=MM._rescaleAndSwap,c=e/n+1,d=t/i+1,u=-1/n,p=-1/i}if(!r){r=[];for(const t of a){const e=t.length;if(2===e){r.push(new Float32Array([NaN,NaN,NaN,NaN,t[0],t[1]]));continue}if(4===e){r.push(new Float32Array([NaN,NaN,NaN,NaN,t[0],t[1],NaN,NaN,NaN,NaN,t[2],t[3]]));continue}const i=new Float32Array(3*(e-2));r.push(i);let[n,s,a,o]=t.subarray(0,4);i.set([NaN,NaN,NaN,NaN,n,s],0);for(let r=4;r<e;r+=2){const e=t[r],l=t[r+1];i.set(MM.createBezierPoints(n,s,a,o,e,l),3*(r-2)),[n,s,a,o]=[a,o,e,l]}}}for(let m=0,y=r.length;m<y;m++)h.push({line:f(r[m].map(t=>t??NaN),c,d,u,p),points:f(a[m].map(t=>t??NaN),c,d,u,p)});const g=new this.prototype.constructor;return g.build(h,i,n,1,o,l,s),g}get box(){return $d(this,nc)}updateProperty(t,e){return"stroke-width"===t?zd(this,uc,mc).call(this,e):null}updateParentDimensions([t,e],i){const[n,s]=zd(this,uc,pc).call(this);Hd(this,oc,t),Hd(this,lc,e),Hd(this,hc,i);const[r,a]=zd(this,uc,pc).call(this),o=r-n,l=a-s,h=$d(this,nc);return h[0]-=o,h[1]-=l,h[2]+=2*o,h[3]+=2*l,h}updateRotation(t){return Hd(this,sc,t),{path:{transform:this.rotationTransform}}}get viewBox(){return $d(this,nc).map(MM.svgRound).join(" ")}get defaultProperties(){const[t,e]=$d(this,nc);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${MM.svgRound(t)} ${MM.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=$d(this,nc);let i=0,n=0,s=0,r=0,a=0,o=0;switch($d(this,sc)){case 90:n=e/t,s=-t/e,a=t;break;case 180:i=-1,r=-1,a=t,o=e;break;case 270:n=-e/t,s=t/e,o=e;break;default:return""}return`matrix(${i} ${n} ${s} ${r} ${MM.svgRound(a)} ${MM.svgRound(o)})`}getPathResizingSVGProperties([t,e,i,n]){const[s,r]=zd(this,uc,pc).call(this),[a,o,l,h]=$d(this,nc);if(Math.abs(l-s)<=MM.PRECISION||Math.abs(h-r)<=MM.PRECISION){const s=t+i/2-(a+l/2),r=e+n/2-(o+h/2);return{path:{"transform-origin":`${MM.svgRound(t)} ${MM.svgRound(e)}`,transform:`${this.rotationTransform} translate(${s} ${r})`}}}const c=(i-2*s)/(l-2*s),d=(n-2*r)/(h-2*r),u=l/i,p=h/n;return{path:{"transform-origin":`${MM.svgRound(a)} ${MM.svgRound(o)}`,transform:`${this.rotationTransform} scale(${u} ${p}) translate(${MM.svgRound(s)} ${MM.svgRound(r)}) scale(${c} ${d}) translate(${MM.svgRound(-s)} ${MM.svgRound(-r)})`}}}getPathResizedSVGProperties([t,e,i,n]){const[s,r]=zd(this,uc,pc).call(this),a=$d(this,nc),[o,l,h,c]=a;if(a[0]=t,a[1]=e,a[2]=i,a[3]=n,Math.abs(h-s)<=MM.PRECISION||Math.abs(c-r)<=MM.PRECISION){const s=t+i/2-(o+h/2),r=e+n/2-(l+c/2);for(const{line:t,points:e}of $d(this,ac))MM._translate(t,s,r,t),MM._translate(e,s,r,e);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${MM.svgRound(t)} ${MM.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const d=(i-2*s)/(h-2*s),u=(n-2*r)/(c-2*r),p=-d*(o+s)+t+s,f=-u*(l+r)+e+r;if(1!==d||1!==u||0!==p||0!==f)for(const{line:g,points:m}of $d(this,ac))MM._rescale(g,p,f,d,u,g),MM._rescale(m,p,f,d,u,m);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${MM.svgRound(t)} ${MM.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[n,s]=i,r=$d(this,nc),a=t-r[0],o=e-r[1];if($d(this,oc)===n&&$d(this,lc)===s)for(const{line:l,points:h}of $d(this,ac))MM._translate(l,a,o,l),MM._translate(h,a,o,h);else{const t=$d(this,oc)/n,e=$d(this,lc)/s;Hd(this,oc,n),Hd(this,lc,s);for(const{line:i,points:n}of $d(this,ac))MM._rescale(i,a,o,t,e,i),MM._rescale(n,a,o,t,e,n);r[2]*=t,r[3]*=e}return r[0]=t,r[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${MM.svgRound(t)} ${MM.svgRound(e)}`}}}get defaultSVGProperties(){const t=$d(this,nc);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${MM.svgRound(t[0])} ${MM.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}nc=new WeakMap,sc=new WeakMap,rc=new WeakMap,ac=new WeakMap,oc=new WeakMap,lc=new WeakMap,hc=new WeakMap,cc=new WeakMap,dc=new WeakMap,uc=new WeakSet,pc=function(t=$d(this,dc)){const e=$d(this,rc)+t/2*$d(this,hc);return $d(this,cc)%180==0?[e/$d(this,oc),e/$d(this,lc)]:[e/$d(this,lc),e/$d(this,oc)]},fc=function(){const[t,e,i,n]=$d(this,nc),[s,r]=zd(this,uc,pc).call(this,0);return[t+s,e+r,i-2*s,n-2*r]},gc=function(){const t=Hd(this,nc,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:n}of $d(this,ac)){if(n.length<=12){for(let e=4,i=n.length;e<i;e+=6)l_.pointBoundingBox(n[e],n[e+1],t);continue}let e=n[4],i=n[5];for(let s=6,r=n.length;s<r;s+=6){const[r,a,o,l,h,c]=n.subarray(s,s+6);l_.bezierBoundingBox(e,i,r,a,o,l,h,c,t),e=h,i=c}}const[e,i]=zd(this,uc,pc).call(this);t[0]=f_(t[0]-e,0,1),t[1]=f_(t[1]-i,0,1),t[2]=f_(t[2]+e,0,1),t[3]=f_(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]},mc=function(t){const[e,i]=zd(this,uc,pc).call(this);Hd(this,dc,t);const[n,s]=zd(this,uc,pc).call(this),[r,a]=[n-e,s-i],o=$d(this,nc);return o[0]-=r,o[1]-=a,o[2]+=2*r,o[3]+=2*a,o};class UM extends NM{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:gS._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){"stroke-width"===t&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new UM(this._viewParameters);return t.updateAll(this),t}}const HM=class t extends WM{constructor(t){super({...t,name:"inkEditor"}),Ud(this,yc),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){gS.initialize(t,e),this._defaultDrawingOptions=new UM(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Yx(this,"typesMap",new Map([[Fx.INK_THICKNESS,"stroke-width"],[Fx.INK_COLOR,"stroke"],[Fx.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,n,s){return new jM(t,e,i,n,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,n,s,r){return $M.deserialize(t,e,i,n,s,r)}static async deserialize(t,e,i){let n=null;if(t instanceof mM){const{data:{inkLists:e,rect:i,rotation:s,id:r,color:a,opacity:o,borderStyle:{rawWidth:l},popupRef:h,richText:c,contentsObj:d,creationDate:u,modificationDate:p},parent:{page:{pageNumber:f}}}=t;n=t={annotationType:Lx.INK,color:Array.from(a),thickness:l,opacity:o,paths:{points:e},boxes:null,pageIndex:f-1,rect:i.slice(0),rotation:s,annotationElementId:r,id:r,deleted:!1,popupRef:h,richText:c,comment:d?.str||null,creationDate:u,modificationDate:p}}const s=await super.deserialize(t,e,i);return s._initialData=n,t.comment&&s.setCommentData(t),s}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new $E(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Fx.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:i,opacity:n}){this._drawingOptions=t.getDefaultDrawingOptions({stroke:l_.makeHexColor(...e),"stroke-width":i,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:n,"stroke-opacity":s,"stroke-width":r}}=this,a=Object.assign(super.serialize(t),{color:gS._colorManager.convert(n),opacity:s,thickness:r,paths:{lines:e,points:i}});return this.addComment(a),t?(a.isCopy=!0,a):this.annotationElementId&&!zd(this,yc,wc).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}};yc=new WeakSet,wc=function(t){const{color:e,thickness:i,opacity:n,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((t,i)=>t!==e[i])||t.thickness!==i||t.opacity!==n||t.pageIndex!==s},Wd(HM,"_type","ink"),Wd(HM,"_editorType",Lx.INK),Wd(HM,"_defaultDrawingOptions",null);let zM=HM;class VM extends $M{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}class GM{static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:n},s,r,a,o){let l=new OffscreenCanvas(1,1),h=l.getContext("2d",{alpha:!1});const c=h.font=`${i} ${n} 200px ${e}`,{actualBoundingBoxLeft:d,actualBoundingBoxRight:u,actualBoundingBoxAscent:p,actualBoundingBoxDescent:f,fontBoundingBoxAscent:g,fontBoundingBoxDescent:m,width:y}=h.measureText(t),w=Math.ceil(1.5*Math.max(Math.abs(d)+Math.abs(u)||0,y)),v=Math.ceil(1.5*Math.max(Math.abs(p)+Math.abs(f)||200,Math.abs(g)+Math.abs(m)||200));l=new OffscreenCanvas(w,v),h=l.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=c,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,w,v),h.fillStyle="black",h.fillText(t,.5*w/2,1.5*v/2);const b=zd(this,bc,Tc).call(this,h.getImageData(0,0,w,v).data),A=zd(this,bc,Pc).call(this,b),x=zd(this,bc,Rc).call(this,A),_=zd(this,bc,kc).call(this,b,w,v,x);return this.processDrawnLines({lines:{curves:_,width:w,height:v},pageWidth:s,pageHeight:r,rotation:a,innerMargin:o,mustSmooth:!0,areContours:!0})}static process(t,e,i,n,s){const[r,a,o]=zd(this,bc,Dc).call(this,t),[l,h]=zd(this,bc,Cc).call(this,r,a,o,Math.hypot(a,o)*$d(this,vc).sigmaSFactor,$d(this,vc).sigmaR,$d(this,vc).kernelSize),c=zd(this,bc,Rc).call(this,h),d=zd(this,bc,kc).call(this,l,a,o,c);return this.processDrawnLines({lines:{curves:d,width:a,height:o},pageWidth:e,pageHeight:i,rotation:n,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:n,innerMargin:s,mustSmooth:r,areContours:a}){n%180!=0&&([e,i]=[i,e]);const{curves:o,width:l,height:h}=t,c=t.thickness??0,d=[],u=Math.min(e/l,i/h),p=u/e,f=u/i,g=[];for(const{points:y}of o){const t=r?zd(this,bc,Mc).call(this,y):y;if(!t)continue;g.push(t);const e=t.length,i=new Float32Array(e),n=new Float32Array(3*(2===e?2:e-2));if(d.push({line:n,points:i}),2===e){i[0]=t[0]*p,i[1]=t[1]*f,n.set([NaN,NaN,NaN,NaN,i[0],i[1]],0);continue}let[s,a,o,l]=t;s*=p,a*=f,o*=p,l*=f,i.set([s,a,o,l],0),n.set([NaN,NaN,NaN,NaN,s,a],0);for(let r=4;r<e;r+=2){const e=i[r]=t[r]*p,h=i[r+1]=t[r+1]*f;n.set(MM.createBezierPoints(s,a,o,l,e,h),3*(r-2)),[s,a,o,l]=[o,l,e,h]}}if(0===d.length)return null;const m=a?new VM:new $M;return m.build(d,e,i,1,n,a?0:c,s),{outline:m,newCurves:g,areContours:a,thickness:c,width:l,height:h}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:n,height:s}){let r,a=1/0,o=-1/0,l=0;for(const y of t){l+=y.length;for(let t=2,e=y.length;t<e;t++){const e=y[t]-y[t-2];a=Math.min(a,e),o=Math.max(o,e)}}r=a>=-128&&o<=127?Int8Array:a>=-32768&&o<=32767?Int16Array:Int32Array;const h=t.length,c=8+3*h,d=new Uint32Array(c);let u=0;d[u++]=c*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*r.BYTES_PER_ELEMENT,d[u++]=0,d[u++]=n,d[u++]=s,d[u++]=e?0:1,d[u++]=Math.max(0,Math.floor(i??0)),d[u++]=h,d[u++]=r.BYTES_PER_ELEMENT;for(const y of t)d[u++]=y.length-2,d[u++]=y[0],d[u++]=y[1];const p=new CompressionStream("deflate-raw"),f=p.writable.getWriter();await f.ready,f.write(d);const g=r.prototype.constructor;for(const y of t){const t=new g(y.length-2);for(let e=2,i=y.length;e<i;e++)t[e-2]=y[e]-y[e-2];f.write(t)}f.close();const m=await new Response(p.readable).arrayBuffer();return g_(new Uint8Array(m))}static async decompressSignature(t){try{const i=(e=t,Uint8Array.fromBase64?Uint8Array.fromBase64(e):r_(atob(e))),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),r=s.getWriter();await r.ready,r.write(i).then(async()=>{await r.ready,await r.close()}).catch(()=>{});let a=null,o=0;for await(const t of n)a||(a=new Uint8Array(new Uint32Array(t.buffer,0,4)[0])),a.set(t,o),o+=t.length;const l=new Uint32Array(a.buffer,0,a.length>>2),h=l[1];if(0!==h)throw new Error(`Invalid version: ${h}`);const c=l[2],d=l[3],u=0===l[4],p=l[5],f=l[6],g=l[7],m=[],y=(8+3*f)*Uint32Array.BYTES_PER_ELEMENT;let w;switch(g){case Int8Array.BYTES_PER_ELEMENT:w=new Int8Array(a.buffer,y);break;case Int16Array.BYTES_PER_ELEMENT:w=new Int16Array(a.buffer,y);break;case Int32Array.BYTES_PER_ELEMENT:w=new Int32Array(a.buffer,y)}o=0;for(let t=0;t<f;t++){const e=l[3*t+8],i=new Float32Array(e+2);m.push(i);for(let n=0;n<2;n++)i[n]=l[3*t+8+n+1];for(let t=0;t<e;t++)i[t+2]=i[t]+w[o++]}return{areContours:u,thickness:p,outlines:m,width:c,height:d}}catch(XO){return null}var e}}vc=new WeakMap,bc=new WeakSet,Ac=function(t,e,i,n){return n-=e,0===(i-=t)?n>0?0:4:1===i?n+6:2-n},xc=new WeakMap,_c=function(t,e,i,n,s,r,a){const o=zd(this,bc,Ac).call(this,i,n,s,r);for(let l=0;l<8;l++){const s=(-l+o-a+16)%8;if(0!==t[(i+$d(this,xc)[2*s])*e+(n+$d(this,xc)[2*s+1])])return s}return-1},Sc=function(t,e,i,n,s,r,a){const o=zd(this,bc,Ac).call(this,i,n,s,r);for(let l=0;l<8;l++){const s=(l+o+a+16)%8;if(0!==t[(i+$d(this,xc)[2*s])*e+(n+$d(this,xc)[2*s+1])])return s}return-1},kc=function(t,e,i,n){const s=t.length,r=new Int32Array(s);for(let h=0;h<s;h++)r[h]=t[h]<=n?1:0;for(let h=1;h<i-1;h++)r[h*e]=r[h*e+e-1]=0;for(let h=0;h<e;h++)r[h]=r[e*i-1-h]=0;let a,o=1;const l=[];for(let h=1;h<i-1;h++){a=1;for(let t=1;t<e-1;t++){const i=h*e+t,n=r[i];if(0===n)continue;let s=h,c=t;if(1===n&&0===r[i-1])o+=1,c-=1;else{if(!(n>=1&&0===r[i+1])){1!==n&&(a=Math.abs(n));continue}o+=1,c+=1,n>1&&(a=n)}const d=[t,h],u=c===t+1,p={isHole:u,points:d,id:o,parent:0};let f;l.push(p);for(const t of l)if(t.id===a){f=t;break}f?f.isHole?p.parent=u?f.parent:a:p.parent=u?a:f.parent:p.parent=u?a:0;const g=zd(this,bc,_c).call(this,r,e,h,t,s,c,0);if(-1===g){r[i]=-o,1!==r[i]&&(a=Math.abs(r[i]));continue}let m=$d(this,xc)[2*g],y=$d(this,xc)[2*g+1];const w=h+m,v=t+y;s=w,c=v;let b=h,A=t;for(;;){const n=zd(this,bc,Sc).call(this,r,e,b,A,s,c,1);m=$d(this,xc)[2*n],y=$d(this,xc)[2*n+1];const l=b+m,u=A+y;d.push(u,l);const p=b*e+A;if(0===r[p+1]?r[p]=-o:1===r[p]&&(r[p]=o),l===h&&u===t&&b===w&&A===v){1!==r[i]&&(a=Math.abs(r[i]));break}s=b,c=A,b=l,A=u}}}return l},Ec=function(t,e,i,n){if(i-e<=4){for(let s=e;s<i-2;s+=2)n.push(t[s],t[s+1]);return}const s=t[e],r=t[e+1],a=t[i-4]-s,o=t[i-3]-r,l=Math.hypot(a,o),h=a/l,c=o/l,d=h*r-c*s,u=o/a,p=1/l,f=Math.atan(u),g=Math.cos(f),m=Math.sin(f),y=p*(Math.abs(g)+Math.abs(m)),w=p*(1-y+y**2),v=Math.max(Math.atan(Math.abs(m+g)*w),Math.atan(Math.abs(m-g)*w));let b=0,A=e;for(let x=e+2;x<i-2;x+=2){const e=Math.abs(d-h*t[x+1]+c*t[x]);e>b&&(A=x,b=e)}b>(l*v)**2?(zd(this,bc,Ec).call(this,t,e,A+2,n),zd(this,bc,Ec).call(this,t,A,i,n)):n.push(s,r)},Mc=function(t){const e=[],i=t.length;return zd(this,bc,Ec).call(this,t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e},Cc=function(t,e,i,n,s,r){const a=new Float32Array(r**2),o=-2*n**2,l=r>>1;for(let f=0;f<r;f++){const t=(f-l)**2;for(let e=0;e<r;e++)a[f*r+e]=Math.exp((t+(e-l)**2)/o)}const h=new Float32Array(256),c=-2*s**2;for(let f=0;f<256;f++)h[f]=Math.exp(f**2/c);const d=t.length,u=new Uint8Array(d),p=new Uint32Array(256);for(let f=0;f<i;f++)for(let n=0;n<e;n++){const s=f*e+n,o=t[s];let c=0,d=0;for(let u=0;u<r;u++){const s=f+u-l;if(!(s<0||s>=i))for(let i=0;i<r;i++){const p=n+i-l;if(p<0||p>=e)continue;const f=t[s*e+p],g=a[u*r+i]*h[Math.abs(f-o)];c+=f*g,d+=g}}p[u[s]=Math.round(c/d)]++}return[u,p]},Pc=function(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e},Tc=function(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let n=-1/0,s=1/0;for(let a=0,o=i.length;a<o;a++){const e=i[a]=t[a<<2];n=Math.max(n,e),s=Math.min(s,e)}const r=255/(n-s);for(let a=0,o=i.length;a<o;a++)i[a]=(i[a]-s)*r;return i},Rc=function(t){let e,i=-1/0,n=-1/0;const s=t.findIndex(t=>0!==t);let r=s,a=s;for(e=s;e<256;e++){const s=t[e];s>i&&(e-r>n&&(n=e-r,a=e-1),i=s,r=e)}for(e=a-1;e>=0&&!(t[e]>t[e+1]);e--);return e},Dc=function(t){const e=t,{width:i,height:n}=t,{maxDim:s}=$d(this,vc);let r=i,a=n;if(i>s||n>s){let o=i,l=n,h=Math.log2(Math.max(i,n)/s);const c=Math.floor(h);h=h===c?c-1:c;for(let i=0;i<h;i++){r=Math.ceil(o/2),a=Math.ceil(l/2);const i=new OffscreenCanvas(r,a);i.getContext("2d").drawImage(t,0,0,o,l,0,0,r,a),o=r,l=a,t!==e&&t.close(),t=i.transferToImageBitmap()}const d=Math.min(s/r,s/a);r=Math.round(r*d),a=Math.round(a*d)}const o=new OffscreenCanvas(r,a).getContext("2d",{willReadFrequently:!0});o.fillStyle="white",o.fillRect(0,0,r,a),o.filter="grayscale(1)",o.drawImage(t,0,0,t.width,t.height,0,0,r,a);const l=o.getImageData(0,0,r,a).data;return[zd(this,bc,Tc).call(this,l),r,a]},Ud(GM,bc),Ud(GM,vc,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),Ud(GM,xc,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class qM extends NM{constructor(){super(),super.updateProperties({fill:gS._defaultLineColor,"stroke-width":0})}clone(){const t=new qM;return t.updateAll(this),t}}class XM extends UM{constructor(t){super(t),super.updateProperties({stroke:gS._defaultLineColor,"stroke-width":1})}clone(){const t=new XM(this._viewParameters);return t.updateAll(this),t}}const KM=class t extends WM{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),Ud(this,Ic,!1),Ud(this,Oc,null),Ud(this,Lc,null),Ud(this,Fc,null),this._willKeepAspectRatio=!0,Hd(this,Lc,t.signatureData||null),Hd(this,Oc,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){gS.initialize(t,e),this._defaultDrawingOptions=new qM,this._defaultDrawnSignatureOptions=new XM(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Yx(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!$d(this,Oc)}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){null!==this._drawId&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,i;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,i=this.y),super.render(),null===this._drawId)if($d(this,Lc)){const{lines:e,mustSmooth:i,areContours:n,description:s,uuid:r,heightInPage:a}=$d(this,Lc),{rawDims:{pageWidth:o,pageHeight:l},rotation:h}=this.parent.viewport,c=GM.processDrawnLines({lines:e,pageWidth:o,pageHeight:l,rotation:h,innerMargin:t._INNER_MARGIN,mustSmooth:i,areContours:n});this.addSignature(c,a,s,r)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:$d(this,Oc)||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,i)),this.div}setUuid(t){Hd(this,Fc,t),this.addEditToolbar()}getUuid(){return $d(this,Fc)}get description(){return $d(this,Oc)}set description(t){Hd(this,Oc,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:n,height:s}=$d(this,Lc),r=Math.max(n,s);return{areContours:e,outline:GM.processDrawnLines({lines:{curves:t.map(t=>({points:t})),thickness:i,width:n,height:s},pageWidth:r,pageHeight:r,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e}).outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,i,n,s){const{x:r,y:a}=this,{outline:o}=Hd(this,Lc,e);let l;Hd(this,Ic,o instanceof VM),this.description=n,$d(this,Ic)?l=t.getDefaultDrawingOptions():(l=t._defaultDrawnSignatureOptions.clone(),l.updateProperties({"stroke-width":o.thickness})),this._addOutlines({drawOutlines:o,drawingOptions:l});const[,h]=this.pageDimensions;let c=i/h;c=c>=1?.5:c,this.width*=c/this.height,this.width>=1&&(c*=.9/this.width,this.width=.9),this.height=c,this.setDims(),this.x=r,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:i,pageHeight:n},rotation:s}=this.parent.viewport;return GM.process(e,i,n,s,t._INNER_MARGIN)}getFromText(e,i){const{rawDims:{pageWidth:n,pageHeight:s},rotation:r}=this.parent.viewport;return GM.extractContoursFromText(e,i,n,s,r,t._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:i,pageHeight:n},rotation:s}=this.parent.viewport;return GM.processDrawnLines({lines:e,pageWidth:i,pageHeight:n,rotation:s,innerMargin:t._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:i}){e?this._drawingOptions=t.getDefaultDrawingOptions():(this._drawingOptions=t._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":i}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":n}}=this,s=Object.assign(super.serialize(t),{isSignature:!0,areContours:$d(this,Ic),color:[0,0,0],thickness:$d(this,Ic)?0:n});return this.addComment(s),t?(s.paths={lines:e,points:i},s.uuid=$d(this,Fc),s.isCopy=!0):s.lines=e,$d(this,Oc)&&(s.accessibilityData={type:"Figure",alt:$d(this,Oc)}),s}static deserializeDraw(t,e,i,n,s,r){return r.areContours?VM.deserialize(t,e,i,n,s,r):$M.deserialize(t,e,i,n,s,r)}static async deserialize(t,e,i){const n=await super.deserialize(t,e,i);return Hd(n,Ic,t.areContours),n.description=t.accessibilityData?.alt||"",Hd(n,Fc,t.uuid),n}};Ic=new WeakMap,Oc=new WeakMap,Lc=new WeakMap,Fc=new WeakMap,Wd(KM,"_type","signature"),Wd(KM,"_editorType",Lx.SIGNATURE),Wd(KM,"_defaultDrawingOptions",null);let YM=KM;class QM extends gS{constructor(t){super({...t,name:"stampEditor"}),Ud(this,Xc),Ud(this,Nc,null),Ud(this,Bc,null),Ud(this,Wc,null),Ud(this,jc,null),Ud(this,$c,null),Ud(this,Uc,""),Ud(this,Hc,null),Ud(this,zc,!1),Ud(this,Vc,null),Ud(this,Gc,!1),Ud(this,qc,!1),Hd(this,jc,t.bitmapUrl),Hd(this,$c,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){gS.initialize(t,e)}static isHandlingMimeForPasting(t){return W_.includes(t)}static paste(t,e){e.pasteEditor({mode:Lx.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!(await i.isEnabledFor("altText")))throw new Error("ML isn't enabled for alt text.");const{data:n,width:s,height:r}=t||this.copyCanvas(null,null,!0).imageData,a=await i.guess({name:"altText",request:{data:n,width:s,height:r,channels:n.length/(s*r)}});if(!a)throw new Error("No response from the AI service.");if(a.error)throw new Error("Error from the AI service.");if(a.cancel)return null;if(!a.output)throw new Error("No valid response from the AI service.");const o=a.output;return await this.setGuessedAltText(o),e&&!this.hasAltTextData()&&(this.altTextData={alt:o,decorative:!1}),o}remove(){$d(this,Bc)&&(Hd(this,Nc,null),this._uiManager.imageManager.deleteId($d(this,Bc)),$d(this,Hc)?.remove(),Hd(this,Hc,null),$d(this,Vc)&&(clearTimeout($d(this,Vc)),Hd(this,Vc,null))),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&($d(this,Bc)&&null===$d(this,Hc)&&zd(this,Xc,Qc).call(this),this.isAttachedToDOM||this.parent.add(this))):$d(this,Bc)&&zd(this,Xc,Qc).call(this)}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!($d(this,Wc)||$d(this,Nc)||$d(this,jc)||$d(this,$c)||$d(this,Bc)||$d(this,zc))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),$d(this,zc)||($d(this,Nc)?zd(this,Xc,Jc).call(this):zd(this,Xc,Qc).call(this)),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:n}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(Hd(this,Bc,i),n&&Hd(this,Nc,n),Hd(this,zc,!1),zd(this,Xc,Jc).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){this.parent&&(null!==$d(this,Vc)&&clearTimeout($d(this,Vc)),Hd(this,Vc,setTimeout(()=>{Hd(this,Vc,null),zd(this,Xc,td).call(this)},200)))}copyCanvas(t,e,i=!1){t||(t=224);const{width:n,height:s}=$d(this,Nc),r=new B_;let a=$d(this,Nc),o=n,l=s,h=null;if(e){if(n>e||s>e){const t=Math.min(e/n,e/s);o=Math.floor(n*t),l=Math.floor(s*t)}h=document.createElement("canvas");const t=h.width=Math.ceil(o*r.sx),i=h.height=Math.ceil(l*r.sy);$d(this,Gc)||(a=zd(this,Xc,Zc).call(this,t,i));const c=h.getContext("2d");c.filter=this._uiManager.hcmFilter;let d="white",u="#cfcfd8";"none"!==this._uiManager.hcmFilter?u="black":j_.isDarkMode&&(d="#8f8f9d",u="#42414d");const p=15,f=p*r.sx,g=p*r.sy,m=new OffscreenCanvas(2*f,2*g),y=m.getContext("2d");y.fillStyle=d,y.fillRect(0,0,2*f,2*g),y.fillStyle=u,y.fillRect(0,0,f,g),y.fillRect(f,g,f,g),c.fillStyle=c.createPattern(m,"repeat"),c.fillRect(0,0,t,i),c.drawImage(a,0,0,a.width,a.height,0,0,t,i)}let c=null;if(i){let e,i;if(r.symmetric&&a.width<t&&a.height<t)e=a.width,i=a.height;else if(a=$d(this,Nc),n>t||s>t){const r=Math.min(t/n,t/s);e=Math.floor(n*r),i=Math.floor(s*r),$d(this,Gc)||(a=zd(this,Xc,Zc).call(this,e,i))}const o=new OffscreenCanvas(e,i).getContext("2d",{willReadFrequently:!0});o.drawImage(a,0,0,a.width,a.height,0,0,e,i),c={width:e,height:i,data:o.getImageData(0,0,e,i).data}}return{canvas:h,width:o,height:l,imageData:c}}static async deserialize(t,e,i){let n=null,s=!1;if(t instanceof AM){const{data:{rect:r,rotation:a,id:o,structParent:l,popupRef:h,richText:c,contentsObj:d,creationDate:u,modificationDate:p},container:f,parent:{page:{pageNumber:g}},canvas:m}=t;let y,w;m?(delete t.canvas,({id:y,bitmap:w}=i.imageManager.getFromCanvas(f.id,m)),m.remove()):(s=!0,t._hasNoCanvas=!0);const v=(await e._structTree.getAriaAttributes(`${p_}${o}`))?.get("aria-label")||"";n=t={annotationType:Lx.STAMP,bitmapId:y,bitmap:w,pageIndex:g-1,rect:r.slice(0),rotation:a,annotationElementId:o,id:o,deleted:!1,accessibilityData:{decorative:!1,altText:v},isSvg:!1,structParent:l,popupRef:h,richText:c,comment:d?.str||null,creationDate:u,modificationDate:p}}const r=await super.deserialize(t,e,i),{rect:a,bitmap:o,bitmapUrl:l,bitmapId:h,isSvg:c,accessibilityData:d}=t;s?(i.addMissingCanvas(t.id,r),Hd(r,zc,!0)):h&&i.imageManager.isValidId(h)?(Hd(r,Bc,h),o&&Hd(r,Nc,o)):Hd(r,jc,l),Hd(r,Gc,c);const[u,p]=r.pageDimensions;return r.width=(a[2]-a[0])/u,r.height=(a[3]-a[1])/p,d&&(r.altTextData=d),r._initialData=n,t.comment&&r.setCommentData(t),Hd(r,qc,!!n),r}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:$d(this,Bc),isSvg:$d(this,Gc)});if(this.addComment(i),t)return i.bitmapUrl=zd(this,Xc,ed).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:n,altText:s}=this.serializeAltText(!1);if(!n&&s&&(i.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const t=zd(this,Xc,id).call(this,i);return t.isSame?null:(t.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(null===e)return i;e.stamps||(e.stamps=new Map);const r=$d(this,Gc)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(e.stamps.has($d(this,Bc))){if($d(this,Gc)){const t=e.stamps.get($d(this,Bc));r>t.area&&(t.area=r,t.serialized.bitmap.close(),t.serialized.bitmap=zd(this,Xc,ed).call(this,!1))}}else e.stamps.set($d(this,Bc),{area:r,serialized:i}),i.bitmap=zd(this,Xc,ed).call(this,!1);return i}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Nc=new WeakMap,Bc=new WeakMap,Wc=new WeakMap,jc=new WeakMap,$c=new WeakMap,Uc=new WeakMap,Hc=new WeakMap,zc=new WeakMap,Vc=new WeakMap,Gc=new WeakMap,qc=new WeakMap,Xc=new WeakSet,Kc=function(t,e=!1){t?(Hd(this,Nc,t.bitmap),e||(Hd(this,Bc,t.id),Hd(this,Gc,t.isSvg)),t.file&&Hd(this,Uc,t.file.name),zd(this,Xc,Jc).call(this)):this.remove()},Yc=function(){if(Hd(this,Wc,null),this._uiManager.enableWaiting(!1),$d(this,Hc))if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&$d(this,Nc))this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});else{if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&$d(this,Nc)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Qc=function(){if($d(this,Bc))return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId($d(this,Bc)).then(t=>zd(this,Xc,Kc).call(this,t,!0)).finally(()=>zd(this,Xc,Yc).call(this));if($d(this,jc)){const t=$d(this,jc);return Hd(this,jc,null),this._uiManager.enableWaiting(!0),void Hd(this,Wc,this._uiManager.imageManager.getFromUrl(t).then(t=>zd(this,Xc,Kc).call(this,t)).finally(()=>zd(this,Xc,Yc).call(this)))}if($d(this,$c)){const t=$d(this,$c);return Hd(this,$c,null),this._uiManager.enableWaiting(!0),void Hd(this,Wc,this._uiManager.imageManager.getFromFile(t).then(t=>zd(this,Xc,Kc).call(this,t)).finally(()=>zd(this,Xc,Yc).call(this)))}const t=document.createElement("input");t.type="file",t.accept=W_.join(",");const e=this._uiManager._signal;Hd(this,Wc,new Promise(i=>{t.addEventListener("change",async()=>{if(t.files&&0!==t.files.length){this._uiManager.enableWaiting(!0);const e=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),zd(this,Xc,Kc).call(this,e)}else this.remove();i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>zd(this,Xc,Yc).call(this))),t.click()},Jc=function(){const{div:t}=this;let{width:e,height:i}=$d(this,Nc);const[n,s]=this.pageDimensions,r=.75;if(this.width)e=this.width*n,i=this.height*s;else if(e>r*n||i>r*s){const t=Math.min(r*n/e,r*s/i);e*=t,i*=t}this._uiManager.enableWaiting(!1);const a=Hd(this,Hc,document.createElement("canvas"));a.setAttribute("role","img"),this.addContainer(a),this.width=e/n,this.height=i/s,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&!this.annotationElementId||(t.hidden=!1),zd(this,Xc,td).call(this),$d(this,qc)||(this.parent.addUndoableEditor(this),Hd(this,qc,!0)),this._reportTelemetry({action:"inserted_image"}),$d(this,Uc)&&this.div.setAttribute("aria-description",$d(this,Uc)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Zc=function(t,e){const{width:i,height:n}=$d(this,Nc);let s=i,r=n,a=$d(this,Nc);for(;s>2*t||r>2*e;){const i=s,n=r;s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2));const o=new OffscreenCanvas(s,r);o.getContext("2d").drawImage(a,0,0,i,n,0,0,s,r),a=o.transferToImageBitmap()}return a},td=function(){const[t,e]=this.parentDimensions,{width:i,height:n}=this,s=new B_,r=Math.ceil(i*t*s.sx),a=Math.ceil(n*e*s.sy),o=$d(this,Hc);if(!o||o.width===r&&o.height===a)return;o.width=r,o.height=a;const l=$d(this,Gc)?$d(this,Nc):zd(this,Xc,Zc).call(this,r,a),h=o.getContext("2d");h.filter=this._uiManager.hcmFilter,h.drawImage(l,0,0,l.width,l.height,0,0,r,a)},ed=function(t){if(t){if($d(this,Gc)){const t=this._uiManager.imageManager.getSvgUrl($d(this,Bc));if(t)return t}const t=document.createElement("canvas");return({width:t.width,height:t.height}=$d(this,Nc)),t.getContext("2d").drawImage($d(this,Nc),0,0),t.toDataURL()}if($d(this,Gc)){const[t,e]=this.pageDimensions,i=Math.round(this.width*t*b_.PDF_TO_CSS_UNITS),n=Math.round(this.height*e*b_.PDF_TO_CSS_UNITS),s=new OffscreenCanvas(i,n);return s.getContext("2d").drawImage($d(this,Nc),0,0,$d(this,Nc).width,$d(this,Nc).height,0,0,i,n),s.transferToImageBitmap()}return structuredClone($d(this,Nc))},id=function(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,n=t.pageIndex===e,s=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&n&&s,isSameAltText:s}},Wd(QM,"_type","stamp"),Wd(QM,"_editorType",Lx.STAMP);const JM=class t{constructor({uiManager:e,pageIndex:i,div:n,structTreeLayer:s,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:h,l10n:c}){Ud(this,bd),Ud(this,nd),Ud(this,sd,!1),Ud(this,rd,null),Ud(this,ad,null),Ud(this,od,null),Ud(this,ld,new Map),Ud(this,hd,!1),Ud(this,cd,!1),Ud(this,dd,!1),Ud(this,ud,null),Ud(this,pd,null),Ud(this,fd,null),Ud(this,gd,null),Ud(this,md,null),Ud(this,yd,-1),Ud(this,wd);const d=[...$d(t,vd).values()];if(!t._initialized){t._initialized=!0;for(const t of d)t.initialize(c,e)}e.registerEditorTypes(d),Hd(this,wd,e),this.pageIndex=i,this.div=n,Hd(this,nd,r),Hd(this,rd,a),this.viewport=h,Hd(this,fd,l),this.drawLayer=o,this._structTree=s,$d(this,wd).addLayer(this)}get isEmpty(){return 0===$d(this,ld).size}get isInvisible(){return this.isEmpty&&$d(this,wd).getMode()===Lx.NONE}updateToolbar(t){$d(this,wd).updateToolbar(t)}updateMode(e=$d(this,wd).getMode()){switch(zd(this,bd,Ed).call(this),e){case Lx.NONE:return this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),void this.disableClick();case Lx.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Lx.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:i}=this.div;if(i.toggle("nonEditing",!1),e===Lx.POPUP)i.toggle("commentEditing",!0);else{i.toggle("commentEditing",!1);for(const n of $d(t,vd).values())i.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===$d(this,fd)?.div}setEditingState(t){$d(this,wd).setEditingState(t)}addCommands(t){$d(this,wd).addCommands(t)}cleanUndoStack(t){$d(this,wd).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){$d(this,rd)?.div.classList.toggle("disabled",!t)}async enable(){Hd(this,dd,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),$d(this,md)?.abort(),Hd(this,md,null);const t=new Set;for(const i of $d(this,bd,Ad))i.enableEditing(),i.show(!0),i.annotationElementId&&($d(this,wd).removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=$d(this,rd);if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),$d(this,wd).isDeletedAnnotationElement(i.data.id))continue;if(t.has(i.data.id))continue;const e=await this.deserialize(i);e&&(this.addOrRebuild(e),e.enableEditing())}Hd(this,dd,!1),$d(this,wd)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(Hd(this,cd,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),$d(this,fd)&&!$d(this,md)){Hd(this,md,new AbortController);const t=$d(this,wd).combinedSignal($d(this,md));$d(this,fd).div.addEventListener("pointerdown",t=>{const{clientX:e,clientY:i,timeStamp:n}=t;if(n-$d(this,yd)>500)return void Hd(this,yd,n);Hd(this,yd,-1);const{classList:s}=this.div;s.toggle("getElements",!0);const r=document.elementsFromPoint(e,i);if(s.toggle("getElements",!1),!this.div.contains(r[0]))return;let a;const o=new RegExp(`^${Ox}[0-9]+$`);for(const h of r)if(o.test(h.id)){a=h.id;break}if(!a)return;const l=$d(this,ld).get(a);null===l?.annotationElementId&&(t.stopPropagation(),t.preventDefault(),l.dblclick(t))},{signal:t,capture:!0})}const e=$d(this,rd);if(e){const t=new Map,i=new Map;for(const s of $d(this,bd,Ad))s.disableEditing(),s.annotationElementId?null===s.serialize()?(i.set(s.annotationElementId,s),this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()):t.set(s.annotationElementId,s):s.updateFakeAnnotationElement(e);const n=e.getEditableAnnotations();for(const e of n){const{id:n}=e.data;if($d(this,wd).isDeletedAnnotationElement(n)){e.updateEdited({deleted:!0});continue}let s=i.get(n);s?(s.resetAnnotationElement(e),s.show(!1),e.show()):(s=t.get(n),s&&($d(this,wd).addChangedExistingAnnotation(s),s.renderAnnotationElement(e)&&s.show(!1)),e.show())}}zd(this,bd,Ed).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const n of $d(t,vd).values())i.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),Hd(this,cd,!1)}getEditableAnnotation(t){return $d(this,rd)?.getEditableAnnotation(t)||null}setActiveEditor(t){$d(this,wd).getActive()!==t&&$d(this,wd).setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,$d(this,fd)?.div&&!$d(this,gd)){Hd(this,gd,new AbortController);const t=$d(this,wd).combinedSignal($d(this,gd));$d(this,fd).div.addEventListener("pointerdown",zd(this,bd,xd).bind(this),{signal:t}),$d(this,fd).div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,$d(this,fd)?.div&&$d(this,gd)&&($d(this,gd).abort(),Hd(this,gd,null),$d(this,fd).div.classList.remove("highlighting"))}enableClick(){if($d(this,ad))return;Hd(this,ad,new AbortController);const t=$d(this,wd).combinedSignal($d(this,ad));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){$d(this,ad)?.abort(),Hd(this,ad,null)}attach(t){$d(this,ld).set(t.id,t);const{annotationElementId:e}=t;e&&$d(this,wd).isDeletedAnnotationElement(e)&&$d(this,wd).removeDeletedAnnotationElement(t)}detach(t){$d(this,ld).delete(t.id),$d(this,nd)?.removePointerInTextLayer(t.contentDiv),!$d(this,cd)&&t.annotationElementId&&$d(this,wd).addDeletedAnnotationElement(t)}remove(t){this.detach(t),$d(this,wd).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&($d(this,wd).addDeletedAnnotationElement(t.annotationElementId),gS.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(t.parent!==this||!t.isAttachedToDOM){if(this.changeParent(t),$d(this,wd).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!$d(this,dd)),$d(this,wd).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!$d(this,od)&&(t._focusEventsAllowed=!1,Hd(this,od,setTimeout(()=>{Hd(this,od,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:$d(this,wd)._signal}),e.focus())},0))),t._structTreeParentId=$d(this,nd)?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){this.addCommands({cmd:()=>t._uiManager.rebuild(t),undo:()=>{t.remove()},mustExec:!1})}getEditorByUID(t){for(const e of $d(this,ld).values())if(e.uid===t)return e;return null}getNextId(){return $d(this,wd).getId()}combinedSignal(t){return $d(this,wd).combinedSignal(t)}canCreateNewEmptyEditor(){return $d(this,bd,_d)?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await $d(this,wd).updateMode(t.mode);const{offsetX:i,offsetY:n}=zd(this,bd,kd).call(this),s=this.getNextId(),r=zd(this,bd,Sd).call(this,{parent:this,id:s,x:i,y:n,uiManager:$d(this,wd),isCentered:!0,...e});r&&this.add(r)}async deserialize(e){return await($d(t,vd).get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,$d(this,wd)))||null}createAndAddNewEditor(t,e,i={}){const n=this.getNextId(),s=zd(this,bd,Sd).call(this,{parent:this,id:n,x:t.offsetX,y:t.offsetY,uiManager:$d(this,wd),isCentered:e,...i});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(t={}){this.createAndAddNewEditor(zd(this,bd,kd).call(this),!0,t)}setSelected(t){$d(this,wd).setSelected(t)}toggleSelected(t){$d(this,wd).toggleSelected(t)}unselect(t){$d(this,wd).unselect(t)}pointerup(t){const{isMac:e}=a_.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;if(!$d(this,hd))return;if(Hd(this,hd,!1),$d(this,bd,_d)?.isDrawer&&$d(this,bd,_d).supportMultipleDrawings)return;if(!$d(this,sd))return void Hd(this,sd,!0);const i=$d(this,wd).getMode();i!==Lx.STAMP&&i!==Lx.SIGNATURE?this.createAndAddNewEditor(t,!1):$d(this,wd).unselectAll()}pointerdown(t){if($d(this,wd).getMode()===Lx.HIGHLIGHT&&this.enableTextSelection(),$d(this,hd))return void Hd(this,hd,!1);const{isMac:e}=a_.platform;if(0!==t.button||t.ctrlKey&&e)return;if(t.target!==this.div)return;if(Hd(this,hd,!0),$d(this,bd,_d)?.isDrawer)return void this.startDrawingSession(t);const i=$d(this,wd).getActive();Hd(this,sd,!i||i.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),$d(this,ud))return void $d(this,bd,_d).startDrawing(this,$d(this,wd),!1,t);$d(this,wd).setCurrentDrawingSession(this),Hd(this,ud,new AbortController);const e=$d(this,wd).combinedSignal($d(this,ud));this.div.addEventListener("blur",({relatedTarget:t})=>{t&&!this.div.contains(t)&&(Hd(this,pd,null),this.commitOrRemove())},{signal:e}),$d(this,bd,_d).startDrawing(this,$d(this,wd),!1,t)}pause(t){if(t){const{activeElement:t}=document;return void(this.div.contains(t)&&Hd(this,pd,t))}$d(this,pd)&&setTimeout(()=>{$d(this,pd)?.focus(),Hd(this,pd,null)},0)}endDrawingSession(t=!1){return $d(this,ud)?($d(this,wd).setCurrentDrawingSession(null),$d(this,ud).abort(),Hd(this,ud,null),Hd(this,pd,null),$d(this,bd,_d).endDrawing(t)):null}findNewParent(t,e,i){const n=$d(this,wd).findParent(e,i);return null!==n&&n!==this&&(n.changeParent(t),!0)}commitOrRemove(){return!!$d(this,ud)&&(this.endDrawingSession(),!0)}onScaleChanging(){$d(this,ud)&&$d(this,bd,_d).onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),$d(this,wd).getActive()?.parent===this&&($d(this,wd).commitOrRemove(),$d(this,wd).setActiveEditor(null)),$d(this,od)&&(clearTimeout($d(this,od)),Hd(this,od,null));for(const t of $d(this,ld).values())$d(this,nd)?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,$d(this,ld).clear(),$d(this,wd).removeLayer(this)}render({viewport:t}){this.viewport=t,N_(this.div,t);for(const e of $d(this,wd).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){$d(this,wd).commitOrRemove(),zd(this,bd,Ed).call(this);const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,N_(this.div,{rotation:i}),e!==i)for(const n of $d(this,ld).values())n.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return $d(this,wd).viewParameters.realScale}};nd=new WeakMap,sd=new WeakMap,rd=new WeakMap,ad=new WeakMap,od=new WeakMap,ld=new WeakMap,hd=new WeakMap,cd=new WeakMap,dd=new WeakMap,ud=new WeakMap,pd=new WeakMap,fd=new WeakMap,gd=new WeakMap,md=new WeakMap,yd=new WeakMap,wd=new WeakMap,vd=new WeakMap,bd=new WeakSet,Ad=function(){return 0!==$d(this,ld).size?$d(this,ld).values():$d(this,wd).getEditors(this.pageIndex)},xd=function(t){$d(this,wd).unselectAll();const{target:e}=t;if(e===$d(this,fd).div||("img"===e.getAttribute("role")||e.classList.contains("endOfContent"))&&$d(this,fd).div.contains(e)){const{isMac:e}=a_.platform;if(0!==t.button||t.ctrlKey&&e)return;$d(this,wd).showAllEditors("highlight",!0,!0),$d(this,fd).div.classList.add("free"),this.toggleDrawing(),FM.startHighlighting(this,"ltr"===$d(this,wd).direction,{target:$d(this,fd).div,x:t.x,y:t.y}),$d(this,fd).div.addEventListener("pointerup",()=>{$d(this,fd).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:$d(this,wd)._signal}),t.preventDefault()}},_d=function(){return $d(JM,vd).get($d(this,wd).getMode())},Sd=function(t){const e=$d(this,bd,_d);return e?new e.prototype.constructor(t):null},kd=function(){const{x:t,y:e,width:i,height:n}=this.boundingClientRect,s=Math.max(0,t),r=Math.max(0,e),a=(s+Math.min(window.innerWidth,t+i))/2-t,o=(r+Math.min(window.innerHeight,e+n))/2-e,[l,h]=this.viewport.rotation%180==0?[a,o]:[o,a];return{offsetX:l,offsetY:h}},Ed=function(){for(const t of $d(this,ld).values())t.isEmpty()&&t.remove()},Wd(JM,"_initialized",!1),Ud(JM,vd,new Map([EM,zM,QM,FM,YM].map(t=>[t._editorType,t])));let ZM=JM;const tC=class t{constructor({pageIndex:t}){Ud(this,Id),Ud(this,Md,null),Ud(this,Cd,new Map),Ud(this,Pd,new Map),this.pageIndex=t}setParent(t){if($d(this,Md)){if($d(this,Md)!==t){if($d(this,Cd).size>0)for(const e of $d(this,Cd).values())e.remove(),t.append(e);Hd(this,Md,t)}}else Hd(this,Md,t)}static get _svgFactory(){return Yx(this,"_svgFactory",new GE)}draw(e,i=!1,n=!1){const s=Vd(t,Td)._++,r=zd(this,Id,Od).call(this),a=t._svgFactory.createElement("defs");r.append(a);const o=t._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),i&&$d(this,Pd).set(s,o);const h=n?zd(this,Id,Ld).call(this,a,l):null,c=t._svgFactory.createElement("use");return r.append(c),c.setAttribute("href",`#${l}`),this.updateProperties(r,e),$d(this,Cd).set(s,r),{id:s,clipPathId:`url(#${h})`}}drawOutline(e,i){const n=Vd(t,Td)._++,s=zd(this,Id,Od).call(this),r=t._svgFactory.createElement("defs");s.append(r);const a=t._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${n}`;let l;if(a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke"),i){const e=t._svgFactory.createElement("mask");r.append(e),l=`mask_p${this.pageIndex}_${n}`,e.setAttribute("id",l),e.setAttribute("maskUnits","objectBoundingBox");const i=t._svgFactory.createElement("rect");e.append(i),i.setAttribute("width","1"),i.setAttribute("height","1"),i.setAttribute("fill","white");const s=t._svgFactory.createElement("use");e.append(s),s.setAttribute("href",`#${o}`),s.setAttribute("stroke","none"),s.setAttribute("fill","black"),s.setAttribute("fill-rule","nonzero"),s.classList.add("mask")}const h=t._svgFactory.createElement("use");s.append(h),h.setAttribute("href",`#${o}`),l&&h.setAttribute("mask",`url(#${l})`);const c=h.cloneNode();return s.append(c),h.classList.add("mainOutline"),c.classList.add("secondaryOutline"),this.updateProperties(s,e),$d(this,Cd).set(n,s),n}finalizeDraw(t,e){$d(this,Pd).delete(t),this.updateProperties(t,e)}updateProperties(e,i){var n;if(!i)return;const{root:s,bbox:r,rootClass:a,path:o}=i,l="number"==typeof e?$d(this,Cd).get(e):e;if(l){if(s&&zd(this,Id,Fd).call(this,l,s),r&&zd(n=t,Rd,Dd).call(n,l,r),a){const{classList:t}=l;for(const[e,i]of Object.entries(a))t.toggle(e,i)}if(o){const t=l.firstChild.firstChild;zd(this,Id,Fd).call(this,t,o)}}}updateParent(t,e){if(e===this)return;const i=$d(this,Cd).get(t);i&&($d(e,Md).append(i),$d(this,Cd).delete(t),$d(e,Cd).set(t,i))}remove(t){$d(this,Pd).delete(t),null!==$d(this,Md)&&($d(this,Cd).get(t).remove(),$d(this,Cd).delete(t))}destroy(){Hd(this,Md,null);for(const t of $d(this,Cd).values())t.remove();$d(this,Cd).clear(),$d(this,Pd).clear()}};Md=new WeakMap,Cd=new WeakMap,Pd=new WeakMap,Td=new WeakMap,Rd=new WeakSet,Dd=function(t,[e,i,n,s]){const{style:r}=t;r.top=100*i+"%",r.left=100*e+"%",r.width=100*n+"%",r.height=100*s+"%"},Id=new WeakSet,Od=function(){const t=tC._svgFactory.create(1,1,!0);return $d(this,Md).append(t),t.setAttribute("aria-hidden",!0),t},Ld=function(t,e){const i=tC._svgFactory.createElement("clipPath");t.append(i);const n=`clip_${e}`;i.setAttribute("id",n),i.setAttribute("clipPathUnits","objectBoundingBox");const s=tC._svgFactory.createElement("use");return i.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),n},Fd=function(t,e){for(const[i,n]of Object.entries(e))null===n?t.removeAttribute(i):t.setAttribute(i,n)},Ud(tC,Rd),Ud(tC,Td,0);let eC=tC;globalThis._pdfjsTestingUtils={HighlightOutliner:RM},globalThis.pdfjsLib={AbortException:n_,AnnotationEditorLayer:ZM,AnnotationEditorParamsType:Fx,AnnotationEditorType:Lx,AnnotationEditorUIManager:lS,AnnotationLayer:_M,AnnotationMode:Ix,AnnotationType:Wx,applyOpacity:U_,build:NE,ColorPicker:WE,createValidAbsoluteUrl:Xx,CSSConstants:$_,DOMSVGFactory:GE,DrawLayer:eC,FeatureTest:a_,fetchData:A_,findContrastColor:X_,getDocument:SE,getFilenameFromUrl:E_,getPdfFilenameFromUrl:M_,getRGB:O_,getUuid:u_,getXfaPageViewport:I_,GlobalWorkerOptions:qk,ImageKind:Bx,InvalidPDFException:t_,isDataScheme:S_,isPdfFile:k_,isValidExplicitDest:CS,MathClamp:f_,noContextMenu:T_,normalizeUnicode:d_,OPS:$x,OutputScale:B_,PasswordResponses:Ux,PDFDataRangeTransport:ME,PDFDateString:D_,PDFWorker:RE,PermissionFlag:Nx,PixelsPerInch:b_,RenderingCancelledException:__,renderRichText:K_,ResponseException:e_,setLayerDimensions:N_,shadow:Yx,SignatureExtractor:GM,stopEvent:R_,SupportedImageMimeTypes:W_,TextLayer:_E,TouchManager:pS,updateUrlHash:Kx,Util:l_,VerbosityLevel:jx,version:FE,XfaLayer:y_};const iC=Object.freeze(Object.defineProperty({__proto__:null,AbortException:n_,AnnotationEditorLayer:ZM,AnnotationEditorParamsType:Fx,AnnotationEditorType:Lx,AnnotationEditorUIManager:lS,AnnotationLayer:_M,AnnotationMode:Ix,AnnotationType:Wx,CSSConstants:$_,ColorPicker:WE,DOMSVGFactory:GE,DrawLayer:eC,FeatureTest:a_,GlobalWorkerOptions:qk,ImageKind:Bx,InvalidPDFException:t_,MathClamp:f_,OPS:$x,OutputScale:B_,PDFDataRangeTransport:ME,PDFDateString:D_,PDFWorker:RE,PasswordResponses:Ux,PermissionFlag:Nx,PixelsPerInch:b_,RenderingCancelledException:__,ResponseException:e_,SignatureExtractor:GM,SupportedImageMimeTypes:W_,TextLayer:_E,TouchManager:pS,Util:l_,VerbosityLevel:jx,XfaLayer:y_,applyOpacity:U_,build:NE,createValidAbsoluteUrl:Xx,fetchData:A_,findContrastColor:X_,getDocument:SE,getFilenameFromUrl:E_,getPdfFilenameFromUrl:M_,getRGB:O_,getUuid:u_,getXfaPageViewport:I_,isDataScheme:S_,isPdfFile:k_,isValidExplicitDest:CS,noContextMenu:T_,normalizeUnicode:d_,renderRichText:K_,setLayerDimensions:N_,shadow:Yx,stopEvent:R_,updateUrlHash:Kx,version:FE},Symbol.toStringTag,{value:"Module"}));function nC(t){var e,i,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(i=nC(t[e]))&&(n&&(n+=" "),n+=i)}else for(i in t)t[i]&&(n&&(n+=" "),n+=i);return n}function sC(){for(var t,e,i=0,n="",s=arguments.length;i<s;i++)(t=arguments[i])&&(e=nC(t))&&(n&&(n+=" "),n+=e);return n}var rC=Object.prototype.hasOwnProperty;function aC(t,e,i){for(i of t.keys())if(oC(i,e))return i}function oC(t,e){var i,n,s;if(t===e)return!0;if(t&&e&&(i=t.constructor)===e.constructor){if(i===Date)return t.getTime()===e.getTime();if(i===RegExp)return t.toString()===e.toString();if(i===Array){if((n=t.length)===e.length)for(;n--&&oC(t[n],e[n]););return-1===n}if(i===Set){if(t.size!==e.size)return!1;for(n of t){if((s=n)&&"object"==typeof s&&!(s=aC(e,s)))return!1;if(!e.has(s))return!1}return!0}if(i===Map){if(t.size!==e.size)return!1;for(n of t){if((s=n[0])&&"object"==typeof s&&!(s=aC(e,s)))return!1;if(!oC(n[1],e.get(s)))return!1}return!0}if(i===ArrayBuffer)t=new Uint8Array(t),e=new Uint8Array(e);else if(i===DataView){if((n=t.byteLength)===e.byteLength)for(;n--&&t.getInt8(n)===e.getInt8(n););return-1===n}if(ArrayBuffer.isView(t)){if((n=t.byteLength)===e.byteLength)for(;n--&&t[n]===e[n];);return-1===n}if(!i||"object"==typeof t){for(i in n=0,t){if(rC.call(t,i)&&++n&&!rC.call(e,i))return!1;if(!(i in e)||!oC(t[i],e[i]))return!1}return Object.keys(e).length===n}}return t!=t&&e!=e}function lC(t){let e=!1;return{promise:new Promise((i,n)=>{t.then(t=>!e&&i(t)).catch(t=>!e&&n(t))}),cancel(){e=!0}}}const hC=["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onBlur","onInput","onInvalid","onReset","onSubmit","onLoad","onError","onKeyDown","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onAnimationStart","onAnimationEnd","onAnimationIteration","onTransitionEnd","onChange","onToggle"];function cC(t,e){const i={};for(const n of hC){const s=t[n];s&&(i[n]=e?t=>s(t,e(n)):s)}return i}function dC(t,e){if(!t)throw new Error("Invariant failed")}const uC=Gd(function(){});function pC(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.filter(Boolean);return i.length<=1?i[0]||null:function(t){for(var e=0,n=i;e<n.length;e++){var s=n[e];"function"==typeof s?s(t):s&&(s.current=t)}}}function fC(t,e){const i=Kd.useRef(e);Kd.useEffect(function(){e!==i.current&&null!=t.attributionControl&&(null!=i.current&&t.attributionControl.removeAttribution(i.current),null!=e&&t.attributionControl.addAttribution(e)),i.current=e},[t,e])}function gC(t){return Object.freeze({__version:1,map:t})}function mC(t,e){return Object.freeze({...t,...e})}const yC=Kd.createContext(null),wC=yC.Provider;function vC(){const t=Kd.useContext(yC);if(null==t)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function bC(t){function e(e,i){const{instance:n,context:s}=t(e).current;return Kd.useImperativeHandle(i,()=>n),null==e.children?null:Qd.createElement(wC,{value:s},e.children)}return Kd.forwardRef(e)}function AC(t,e){const i=Kd.useRef();Kd.useEffect(function(){return null!=e&&t.instance.on(e),i.current=e,function(){null!=i.current&&t.instance.off(i.current),i.current=null}},[t,e])}function xC(t,e){const i=t.pane??e.pane;return i?{...t,pane:i}:t}function _C(t,e,i){return Object.freeze({instance:t,context:e,container:i})}function SC(t,e){return null==e?function(e,i){const n=Kd.useRef();return n.current||(n.current=t(e,i)),n}:function(i,n){const s=Kd.useRef();s.current||(s.current=t(i,n));const r=Kd.useRef(i),{instance:a}=s.current;return Kd.useEffect(function(){r.current!==i&&(e(a,i,r.current),r.current=i)},[a,i,n]),s}}function kC(t,e){Kd.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function EC(t){return function(e){const i=vC(),n=t(xC(e,i),i);return fC(i.map,e.attribution),AC(n.current,e.eventHandlers),kC(n.current,i),n}}function MC(t,e){return bC(EC(SC(t,e)))}function CC(t,e){const i=function(t,e){return function(i,n){const s=vC(),r=t(xC(i,s),s);return fC(s.map,i.attribution),AC(r.current,i.eventHandlers),e(r.current,s,i,n),r}}(SC(t),e);return function(t){function e(e,i){const[n,s]=Kd.useState(!1),{instance:r}=t(e,s).current;Kd.useImperativeHandle(i,()=>r),Kd.useEffect(function(){n&&r.update()},[r,n,e.children]);const a=r._contentNode;return a?Yd.createPortal(e.children,a):null}return Kd.forwardRef(e)}(i)}function PC(t,e){return bC((i=SC(t,e),function(t){const e=vC(),n=i(xC(t,e),e);return AC(n.current,t.eventHandlers),kC(n.current,e),function(t,e){const i=Kd.useRef();Kd.useEffect(function(){if(e.pathOptions!==i.current){const n=e.pathOptions??{};t.instance.setStyle(n),i.current=n}},[t,e])}(n.current,t),n}));var i}function TC(t,e){return function(t){function e(e,i){const{instance:n}=t(e).current;return Kd.useImperativeHandle(i,()=>n),null}return Kd.forwardRef(e)}(EC(SC(t,e)))}function RC(t,e,i){const{opacity:n,zIndex:s}=e;null!=n&&n!==i.opacity&&t.setOpacity(n),null!=s&&s!==i.zIndex&&t.setZIndex(s)}function DC(t,e){-1===t.indexOf(e)&&t.push(e)}function IC(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}const OC=(t,e,i)=>i>e?e:i<t?t:i,LC={},FC=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function NC(t){return"object"==typeof t&&null!==t}const BC=t=>/^0[^.\s]+$/u.test(t);function WC(t){let e;return()=>(void 0===e&&(e=t()),e)}const jC=t=>t,$C=(t,e)=>i=>e(t(i)),UC=(...t)=>t.reduce($C),HC=(t,e,i)=>{const n=e-t;return 0===n?1:(i-t)/n};class zC{constructor(){this.subscriptions=[]}add(t){return DC(this.subscriptions,t),()=>IC(this.subscriptions,t)}notify(t,e,i){const n=this.subscriptions.length;if(n)if(1===n)this.subscriptions[0](t,e,i);else for(let s=0;s<n;s++){const n=this.subscriptions[s];n&&n(t,e,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const VC=t=>1e3*t,GC=t=>t/1e3;function qC(t,e){return e?t*(1e3/e):0}const XC=(t,e,i)=>(((1-3*i+3*e)*t+(3*i-6*e))*t+3*e)*t;function KC(t,e,i,n){if(t===e&&i===n)return jC;return s=>0===s||1===s?s:XC(function(t,e,i,n,s){let r,a,o=0;do{a=e+(i-e)/2,r=XC(a,n,s)-t,r>0?i=a:e=a}while(Math.abs(r)>1e-7&&++o<12);return a}(s,0,1,t,i),e,n)}const YC=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,QC=t=>e=>1-t(1-e),JC=KC(.33,1.53,.69,.99),ZC=QC(JC),tP=YC(ZC),eP=t=>(t*=2)<1?.5*ZC(t):.5*(2-Math.pow(2,-10*(t-1))),iP=t=>1-Math.sin(Math.acos(t)),nP=QC(iP),sP=YC(iP),rP=KC(.42,0,1,1),aP=KC(0,0,.58,1),oP=KC(.42,0,.58,1),lP=t=>Array.isArray(t)&&"number"==typeof t[0],hP={linear:jC,easeIn:rP,easeInOut:oP,easeOut:aP,circIn:iP,circInOut:sP,circOut:nP,backIn:ZC,backInOut:tP,backOut:JC,anticipate:eP},cP=t=>{if(lP(t)){t.length;const[e,i,n,s]=t;return KC(e,i,n,s)}return"string"==typeof t?hP[t]:t},dP=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function uP(t,e){let i=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},r=()=>i=!0,a=dP.reduce((t,e)=>(t[e]=function(t){let e=new Set,i=new Set,n=!1,s=!1;const r=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(e){r.has(e)&&(l.schedule(e),t()),e(a)}const l={schedule:(t,s=!1,a=!1)=>{const o=a&&n?e:i;return s&&r.add(t),o.has(t)||o.add(t),t},cancel:t=>{i.delete(t),r.delete(t)},process:t=>{a=t,n?s=!0:(n=!0,[e,i]=[i,e],e.forEach(o),e.clear(),n=!1,s&&(s=!1,l.process(t)))}};return l}(r),t),{}),{setup:o,read:l,resolveKeyframes:h,preUpdate:c,update:d,preRender:u,render:p,postRender:f}=a,g=()=>{const r=LC.useManualTiming?s.timestamp:performance.now();i=!1,LC.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(r-s.timestamp,40),1)),s.timestamp=r,s.isProcessing=!0,o.process(s),l.process(s),h.process(s),c.process(s),d.process(s),u.process(s),p.process(s),f.process(s),s.isProcessing=!1,i&&e&&(n=!1,t(g))};return{schedule:dP.reduce((e,r)=>{const o=a[r];return e[r]=(e,r=!1,a=!1)=>(i||(i=!0,n=!0,s.isProcessing||t(g)),o.schedule(e,r,a)),e},{}),cancel:t=>{for(let e=0;e<dP.length;e++)a[dP[e]].cancel(t)},state:s,steps:a}}const{schedule:pP,cancel:fP,state:gP,steps:mP}=uP("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:jC,!0);let yP;function wP(){yP=void 0}const vP={now:()=>(void 0===yP&&vP.set(gP.isProcessing||LC.useManualTiming?gP.timestamp:performance.now()),yP),set:t=>{yP=t,queueMicrotask(wP)}},bP=t=>e=>"string"==typeof e&&e.startsWith(t),AP=bP("--"),xP=bP("var(--"),_P=t=>!!xP(t)&&SP.test(t.split("/*")[0].trim()),SP=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,kP={test:t=>"number"==typeof t,parse:parseFloat,transform:t=>t},EP={...kP,transform:t=>OC(0,1,t)},MP={...kP,default:1},CP=t=>Math.round(1e5*t)/1e5,PP=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu,TP=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,RP=(t,e)=>i=>Boolean("string"==typeof i&&TP.test(i)&&i.startsWith(t)||e&&!function(t){return null==t}(i)&&Object.prototype.hasOwnProperty.call(i,e)),DP=(t,e,i)=>n=>{if("string"!=typeof n)return n;const[s,r,a,o]=n.match(PP);return{[t]:parseFloat(s),[e]:parseFloat(r),[i]:parseFloat(a),alpha:void 0!==o?parseFloat(o):1}},IP={...kP,transform:t=>Math.round((t=>OC(0,255,t))(t))},OP={test:RP("rgb","red"),parse:DP("red","green","blue"),transform:({red:t,green:e,blue:i,alpha:n=1})=>"rgba("+IP.transform(t)+", "+IP.transform(e)+", "+IP.transform(i)+", "+CP(EP.transform(n))+")"},LP={test:RP("#"),parse:function(t){let e="",i="",n="",s="";return t.length>5?(e=t.substring(1,3),i=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),i=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,i+=i,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}},transform:OP.transform},FP=t=>({test:e=>"string"==typeof e&&e.endsWith(t)&&1===e.split(" ").length,parse:parseFloat,transform:e=>`${e}${t}`}),NP=FP("deg"),BP=FP("%"),WP=FP("px"),jP=FP("vh"),$P=FP("vw"),UP=(()=>({...BP,parse:t=>BP.parse(t)/100,transform:t=>BP.transform(100*t)}))(),HP={test:RP("hsl","hue"),parse:DP("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:i,alpha:n=1})=>"hsla("+Math.round(t)+", "+BP.transform(CP(e))+", "+BP.transform(CP(i))+", "+CP(EP.transform(n))+")"},zP={test:t=>OP.test(t)||LP.test(t)||HP.test(t),parse:t=>OP.test(t)?OP.parse(t):HP.test(t)?HP.parse(t):LP.parse(t),transform:t=>"string"==typeof t?t:t.hasOwnProperty("red")?OP.transform(t):HP.transform(t),getAnimatableNone:t=>{const e=zP.parse(t);return e.alpha=0,zP.transform(e)}},VP=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu,GP="number",qP="color",XP=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function KP(t){const e=t.toString(),i=[],n={color:[],number:[],var:[]},s=[];let r=0;const a=e.replace(XP,t=>(zP.test(t)?(n.color.push(r),s.push(qP),i.push(zP.parse(t))):t.startsWith("var(")?(n.var.push(r),s.push("var"),i.push(t)):(n.number.push(r),s.push(GP),i.push(parseFloat(t))),++r,"${}")).split("${}");return{values:i,split:a,indexes:n,types:s}}function YP(t){return KP(t).values}function QP(t){const{split:e,types:i}=KP(t),n=e.length;return t=>{let s="";for(let r=0;r<n;r++)if(s+=e[r],void 0!==t[r]){const e=i[r];s+=e===GP?CP(t[r]):e===qP?zP.transform(t[r]):t[r]}return s}}const JP=t=>"number"==typeof t?0:zP.test(t)?zP.getAnimatableNone(t):t,ZP={test:function(t){return isNaN(t)&&"string"==typeof t&&(t.match(PP)?.length||0)+(t.match(VP)?.length||0)>0},parse:YP,createTransformer:QP,getAnimatableNone:function(t){const e=YP(t);return QP(t)(e.map(JP))}};function tT(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function eT(t,e){return i=>i>0?e:t}const iT=(t,e,i)=>t+(e-t)*i,nT=(t,e,i)=>{const n=t*t,s=i*(e*e-n)+n;return s<0?0:Math.sqrt(s)},sT=[LP,OP,HP];function rT(t){const e=(i=t,sT.find(t=>t.test(i)));var i;if(!Boolean(e))return!1;let n=e.parse(t);return e===HP&&(n=function({hue:t,saturation:e,lightness:i,alpha:n}){t/=360,i/=100;let s=0,r=0,a=0;if(e/=100){const n=i<.5?i*(1+e):i+e-i*e,o=2*i-n;s=tT(o,n,t+1/3),r=tT(o,n,t),a=tT(o,n,t-1/3)}else s=r=a=i;return{red:Math.round(255*s),green:Math.round(255*r),blue:Math.round(255*a),alpha:n}}(n)),n}const aT=(t,e)=>{const i=rT(t),n=rT(e);if(!i||!n)return eT(t,e);const s={...i};return t=>(s.red=nT(i.red,n.red,t),s.green=nT(i.green,n.green,t),s.blue=nT(i.blue,n.blue,t),s.alpha=iT(i.alpha,n.alpha,t),OP.transform(s))},oT=new Set(["none","hidden"]);function lT(t,e){return i=>iT(t,e,i)}function hT(t){return"number"==typeof t?lT:"string"==typeof t?_P(t)?eT:zP.test(t)?aT:uT:Array.isArray(t)?cT:"object"==typeof t?zP.test(t)?aT:dT:eT}function cT(t,e){const i=[...t],n=i.length,s=t.map((t,i)=>hT(t)(t,e[i]));return t=>{for(let e=0;e<n;e++)i[e]=s[e](t);return i}}function dT(t,e){const i={...t,...e},n={};for(const s in i)void 0!==t[s]&&void 0!==e[s]&&(n[s]=hT(t[s])(t[s],e[s]));return t=>{for(const e in n)i[e]=n[e](t);return i}}const uT=(t,e)=>{const i=ZP.createTransformer(e),n=KP(t),s=KP(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?oT.has(t)&&!s.values.length||oT.has(e)&&!n.values.length?function(t,e){return oT.has(t)?i=>i<=0?t:e:i=>i>=1?e:t}(t,e):UC(cT(function(t,e){const i=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const r=e.types[s],a=t.indexes[r][n[r]],o=t.values[a]??0;i[s]=o,n[r]++}return i}(n,s),s.values),i):eT(t,e)};function pT(t,e,i){return"number"==typeof t&&"number"==typeof e&&"number"==typeof i?iT(t,e,i):hT(t)(t,e)}const fT=t=>{const e=({timestamp:e})=>t(e);return{start:(t=!0)=>pP.update(e,t),stop:()=>fP(e),now:()=>gP.isProcessing?gP.timestamp:vP.now()}},gT=(t,e,i=10)=>{let n="";const s=Math.max(Math.round(e/i),2);for(let r=0;r<s;r++)n+=Math.round(1e4*t(r/(s-1)))/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},mT=2e4;function yT(t){let e=0,i=t.next(e);for(;!i.done&&e<mT;)e+=50,i=t.next(e);return e>=mT?1/0:e}function wT(t,e,i){const n=Math.max(e-5,0);return qC(i-t(n),e-n)}const vT=.01,bT=2,AT=.005,xT=.5;const _T=12;function ST(t,e){return t*Math.sqrt(1-e*e)}const kT=["duration","bounce"],ET=["stiffness","damping","mass"];function MT(t,e){return e.some(e=>void 0!==t[e])}function CT(t=.3,e=.3){const i="object"!=typeof t?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=i;const r=i.keyframes[0],a=i.keyframes[i.keyframes.length-1],o={done:!1,value:r},{stiffness:l,damping:h,mass:c,duration:d,velocity:u,isResolvedFromDuration:p}=function(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!MT(t,ET)&&MT(t,kT))if(t.visualDuration){const i=t.visualDuration,n=2*Math.PI/(1.2*i),s=n*n,r=2*OC(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:1,stiffness:s,damping:r}}else{const i=function({duration:t=800,bounce:e=.3,velocity:i=0,mass:n=1}){let s,r,a=1-e;a=OC(.05,1,a),t=OC(.01,10,GC(t)),a<1?(s=e=>{const n=e*a,s=n*t;return.001-(n-i)/ST(e,a)*Math.exp(-s)},r=e=>{const n=e*a*t,r=n*i+i,o=Math.pow(a,2)*Math.pow(e,2)*t,l=Math.exp(-n),h=ST(Math.pow(e,2),a);return(.001-s(e)>0?-1:1)*((r-o)*l)/h}):(s=e=>Math.exp(-e*t)*((e-i)*t+1)-.001,r=e=>Math.exp(-e*t)*(t*t*(i-e)));const o=function(t,e,i){let n=i;for(let s=1;s<_T;s++)n-=t(n)/e(n);return n}(s,r,5/t);if(t=VC(t),isNaN(o))return{stiffness:100,damping:10,duration:t};{const e=Math.pow(o,2)*n;return{stiffness:e,damping:2*a*Math.sqrt(n*e),duration:t}}}(t);e={...e,...i,mass:1},e.isResolvedFromDuration=!0}return e}({...i,velocity:-GC(i.velocity||0)}),f=u||0,g=h/(2*Math.sqrt(l*c)),m=a-r,y=GC(Math.sqrt(l/c)),w=Math.abs(m)<5;let v;if(n||(n=w?vT:bT),s||(s=w?AT:xT),g<1){const t=ST(y,g);v=e=>{const i=Math.exp(-g*y*e);return a-i*((f+g*y*m)/t*Math.sin(t*e)+m*Math.cos(t*e))}}else if(1===g)v=t=>a-Math.exp(-y*t)*(m+(f+y*m)*t);else{const t=y*Math.sqrt(g*g-1);v=e=>{const i=Math.exp(-g*y*e),n=Math.min(t*e,300);return a-i*((f+g*y*m)*Math.sinh(n)+t*m*Math.cosh(n))/t}}const b={calculatedDuration:p&&d||null,next:t=>{const e=v(t);if(p)o.done=t>=d;else{let i=0===t?f:0;g<1&&(i=0===t?VC(f):wT(v,t,e));const r=Math.abs(i)<=n,l=Math.abs(a-e)<=s;o.done=r&&l}return o.value=o.done?a:e,o},toString:()=>{const t=Math.min(yT(b),mT),e=gT(e=>b.next(t*e).value,t,30);return t+"ms "+e},toTransition:()=>{}};return b}function PT({keyframes:t,velocity:e=0,power:i=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:r=500,modifyTarget:a,min:o,max:l,restDelta:h=.5,restSpeed:c}){const d=t[0],u={done:!1,value:d},p=t=>void 0===o?l:void 0===l||Math.abs(o-t)<Math.abs(l-t)?o:l;let f=i*e;const g=d+f,m=void 0===a?g:a(g);m!==g&&(f=m-d);const y=t=>-f*Math.exp(-t/n),w=t=>m+y(t),v=t=>{const e=y(t),i=w(t);u.done=Math.abs(e)<=h,u.value=u.done?m:i};let b,A;const x=t=>{var e;e=u.value,(void 0!==o&&e<o||void 0!==l&&e>l)&&(b=t,A=CT({keyframes:[u.value,p(u.value)],velocity:wT(w,t,u.value),damping:s,stiffness:r,restDelta:h,restSpeed:c}))};return x(0),{calculatedDuration:null,next:t=>{let e=!1;return A||void 0!==b||(e=!0,v(t),x(t)),void 0!==b&&t>=b?A.next(t-b):(!e&&v(t),u)}}}function TT(t,e,{clamp:i=!0,ease:n,mixer:s}={}){const r=t.length;if(e.length,1===r)return()=>e[0];if(2===r&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=function(t,e,i){const n=[],s=i||LC.mix||pT,r=t.length-1;for(let a=0;a<r;a++){let i=s(t[a],t[a+1]);if(e){const t=Array.isArray(e)?e[a]||jC:e;i=UC(t,i)}n.push(i)}return n}(e,n,s),l=o.length,h=i=>{if(a&&i<t[0])return e[0];let n=0;if(l>1)for(;n<t.length-2&&!(i<t[n+1]);n++);const s=HC(t[n],t[n+1],i);return o[n](s)};return i?e=>h(OC(t[0],t[r-1],e)):h}function RT({duration:t=300,keyframes:e,times:i,ease:n="easeInOut"}){const s=(t=>Array.isArray(t)&&"number"!=typeof t[0])(n)?n.map(cP):cP(n),r={done:!1,value:e[0]},a=function(t,e){return t.map(t=>t*e)}(i&&i.length===e.length?i:function(t){const e=[0];return function(t,e){const i=t[t.length-1];for(let n=1;n<=e;n++){const s=HC(0,e,n);t.push(iT(i,1,s))}}(e,t.length-1),e}(e),t),o=TT(a,e,{ease:Array.isArray(s)?s:(l=e,h=s,l.map(()=>h||oP).splice(0,l.length-1))});var l,h;return{calculatedDuration:t,next:e=>(r.value=o(e),r.done=e>=t,r)}}CT.applyToOptions=t=>{const e=function(t,e=100){const i=CT({...t,keyframes:[0,e]}),n=Math.min(yT(i),mT);return{type:"keyframes",ease:t=>i.next(n*t).value/e,duration:GC(n)}}(t,100);return t.ease=e.ease,t.duration=VC(e.duration),t.type="keyframes",t};const DT=t=>null!==t;function IT(t,{repeat:e,repeatType:i="loop"},n,s=1){const r=t.filter(DT),a=s<0||e&&"loop"!==i&&e%2==1?0:r.length-1;return a&&void 0!==n?n:r[a]}const OT={decay:PT,inertia:PT,tween:RT,keyframes:RT,spring:CT};function LT(t){"string"==typeof t.type&&(t.type=OT[t.type])}class FT{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,e){return this.finished.then(t,e)}}const NT=t=>t/100;class BT extends FT{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:t}=this.options;t&&t.updatedAt!==vP.now()&&this.tick(vP.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),!1===t.autoplay&&this.pause()}initAnimation(){const{options:t}=this;LT(t);const{type:e=RT,repeat:i=0,repeatDelay:n=0,repeatType:s,velocity:r=0}=t;let{keyframes:a}=t;const o=e||RT;o!==RT&&"number"!=typeof a[0]&&(this.mixKeyframes=UC(NT,pT(a[0],a[1])),a=[0,100]);const l=o({...t,keyframes:a});"mirror"===s&&(this.mirroredGenerator=o({...t,keyframes:[...a].reverse(),velocity:-r})),null===l.calculatedDuration&&(l.calculatedDuration=yT(l));const{calculatedDuration:h}=l;this.calculatedDuration=h,this.resolvedDuration=h+n,this.totalDuration=this.resolvedDuration*(i+1)-n,this.generator=l}updateTime(t){const e=Math.round(t-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=e}tick(t,e=!1){const{generator:i,totalDuration:n,mixKeyframes:s,mirroredGenerator:r,resolvedDuration:a,calculatedDuration:o}=this;if(null===this.startTime)return i.next(0);const{delay:l=0,keyframes:h,repeat:c,repeatType:d,repeatDelay:u,type:p,onUpdate:f,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-n/this.speed,this.startTime)),e?this.currentTime=t:this.updateTime(t);const m=this.currentTime-l*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?m<0:m>n;this.currentTime=Math.max(m,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=n);let w=this.currentTime,v=i;if(c){const t=Math.min(this.currentTime,n)/a;let e=Math.floor(t),i=t%1;!i&&t>=1&&(i=1),1===i&&e--,e=Math.min(e,c+1),Boolean(e%2)&&("reverse"===d?(i=1-i,u&&(i-=u/a)):"mirror"===d&&(v=r)),w=OC(0,1,i)*a}const b=y?{done:!1,value:h[0]}:v.next(w);s&&(b.value=s(b.value));let{done:A}=b;y||null===o||(A=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const x=null===this.holdTime&&("finished"===this.state||"running"===this.state&&A);return x&&p!==PT&&(b.value=IT(h,this.options,g,this.speed)),f&&f(b.value),x&&this.finish(),b}then(t,e){return this.finished.then(t,e)}get duration(){return GC(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+GC(t)}get time(){return GC(this.currentTime)}set time(t){t=VC(t),this.currentTime=t,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(vP.now());const e=this.playbackSpeed!==t;this.playbackSpeed=t,e&&(this.time=GC(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=fT,startTime:e}=this.options;this.driver||(this.driver=t(t=>this.tick(t))),this.options.onPlay?.();const i=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=i):null!==this.holdTime?this.startTime=i-this.holdTime:this.startTime||(this.startTime=e??i),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(vP.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}const WT=t=>180*t/Math.PI,jT=t=>{const e=WT(Math.atan2(t[1],t[0]));return UT(e)},$T={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:jT,rotateZ:jT,skewX:t=>WT(Math.atan(t[1])),skewY:t=>WT(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},UT=t=>((t%=360)<0&&(t+=360),t),HT=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),zT=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),VT={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:HT,scaleY:zT,scale:t=>(HT(t)+zT(t))/2,rotateX:t=>UT(WT(Math.atan2(t[6],t[5]))),rotateY:t=>UT(WT(Math.atan2(-t[2],t[0]))),rotateZ:jT,rotate:jT,skewX:t=>WT(Math.atan(t[4])),skewY:t=>WT(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function GT(t){return t.includes("scale")?1:0}function qT(t,e){if(!t||"none"===t)return GT(e);const i=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(i)n=VT,s=i;else{const e=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=$T,s=e}if(!s)return GT(e);const r=n[e],a=s[1].split(",").map(KT);return"function"==typeof r?r(a):a[r]}const XT=(t,e)=>{const{transform:i="none"}=getComputedStyle(t);return qT(i,e)};function KT(t){return parseFloat(t.trim())}const YT=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],QT=(()=>new Set(YT))(),JT=t=>t===kP||t===WP,ZT=new Set(["x","y","z"]),tR=YT.filter(t=>!ZT.has(t)),eR={width:({x:t},{paddingLeft:e="0",paddingRight:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),height:({y:t},{paddingTop:e="0",paddingBottom:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>qT(e,"x"),y:(t,{transform:e})=>qT(e,"y")};eR.translateX=eR.x,eR.translateY=eR.y;const iR=new Set;let nR=!1,sR=!1,rR=!1;function aR(){if(sR){const t=Array.from(iR).filter(t=>t.needsMeasurement),e=new Set(t.map(t=>t.element)),i=new Map;e.forEach(t=>{const e=function(t){const e=[];return tR.forEach(i=>{const n=t.getValue(i);void 0!==n&&(e.push([i,n.get()]),n.set(i.startsWith("scale")?1:0))}),e}(t);e.length&&(i.set(t,e),t.render())}),t.forEach(t=>t.measureInitialState()),e.forEach(t=>{t.render();const e=i.get(t);e&&e.forEach(([e,i])=>{t.getValue(e)?.set(i)})}),t.forEach(t=>t.measureEndState()),t.forEach(t=>{void 0!==t.suspendedScrollY&&window.scrollTo(0,t.suspendedScrollY)})}sR=!1,nR=!1,iR.forEach(t=>t.complete(rR)),iR.clear()}function oR(){iR.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(sR=!0)})}class lR{constructor(t,e,i,n,s,r=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=e,this.name=i,this.motionValue=n,this.element=s,this.isAsync=r}scheduleResolve(){this.state="scheduled",this.isAsync?(iR.add(this),nR||(nR=!0,pP.read(oR),pP.resolveKeyframes(aR))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:e,element:i,motionValue:n}=this;if(null===t[0]){const s=n?.get(),r=t[t.length-1];if(void 0!==s)t[0]=s;else if(i&&e){const n=i.readValue(e,r);null!=n&&(t[0]=n)}void 0===t[0]&&(t[0]=r),n&&void 0===s&&n.set(t[0])}!function(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),iR.delete(this)}cancel(){"scheduled"===this.state&&(iR.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const hR=WC(()=>void 0!==window.ScrollTimeline),cR={};function dR(t,e){const i=WC(t);return()=>cR[e]??i()}const uR=dR(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(XO){return!1}return!0},"linearEasing"),pR=([t,e,i,n])=>`cubic-bezier(${t}, ${e}, ${i}, ${n})`,fR={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:pR([0,.65,.55,1]),circOut:pR([.55,0,1,.45]),backIn:pR([.31,.01,.66,-.59]),backOut:pR([.33,1.53,.69,.99])};function gR(t,e){return t?"function"==typeof t?uR()?gT(t,e):"ease-out":lP(t)?pR(t):Array.isArray(t)?t.map(t=>gR(t,e)||fR.easeOut):fR[t]:void 0}function mR(t,e,i,{delay:n=0,duration:s=300,repeat:r=0,repeatType:a="loop",ease:o="easeOut",times:l}={},h=void 0){const c={[e]:i};l&&(c.offset=l);const d=gR(o,s);Array.isArray(d)&&(c.easing=d);const u={delay:n,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:r+1,direction:"reverse"===a?"alternate":"normal"};return h&&(u.pseudoElement=h),t.animate(c,u)}function yR(t){return"function"==typeof t&&"applyToOptions"in t}class wR extends FT{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:e,name:i,keyframes:n,pseudoElement:s,allowFlatten:r=!1,finalKeyframe:a,onComplete:o}=t;this.isPseudoElement=Boolean(s),this.allowFlatten=r,this.options=t,t.type;const l=function({type:t,...e}){return yR(t)&&uR()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}(t);this.animation=mR(e,i,n,l,s),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const t=IT(n,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(t):function(t,e,i){(t=>t.startsWith("--"))(e)?t.style.setProperty(e,i):t.style[e]=i}(e,i,t),this.animation.cancel()}o?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch(XO){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;"idle"!==t&&"finished"!==t&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return GC(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+GC(t)}get time(){return GC(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=VC(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:e}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&hR()?(this.animation.timeline=t,jC):e(this)}}const vR={anticipate:eP,backInOut:tP,circInOut:sP};class bR extends wR{constructor(t){var e;"string"==typeof(e=t).ease&&e.ease in vR&&(e.ease=vR[e.ease]),LT(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:e,onUpdate:i,onComplete:n,element:s,...r}=this.options;if(!e)return;if(void 0!==t)return void e.set(t);const a=new BT({...r,autoplay:!1}),o=VC(this.finishedTime??this.time);e.setWithVelocity(a.sample(o-10).value,a.sample(o).value,10),a.stop()}}const AR=(t,e)=>!("zIndex"===e||"number"!=typeof t&&!Array.isArray(t)&&("string"!=typeof t||!ZP.test(t)&&"0"!==t||t.startsWith("url(")));function xR(t){t.duration=0,t.type="keyframes"}const _R=new Set(["opacity","clipPath","filter","transform"]),SR=WC(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class kR extends FT{constructor({autoplay:t=!0,delay:e=0,type:i="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:r="loop",keyframes:a,name:o,motionValue:l,element:h,...c}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=vP.now();const d={autoplay:t,delay:e,type:i,repeat:n,repeatDelay:s,repeatType:r,name:o,motionValue:l,element:h,...c},u=h?.KeyframeResolver||lR;this.keyframeResolver=new u(a,(t,e,i)=>this.onKeyframesResolved(t,e,d,!i),o,l,h),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,e,i,n){this.keyframeResolver=void 0;const{name:s,type:r,velocity:a,delay:o,isHandoff:l,onUpdate:h}=i;this.resolvedAt=vP.now(),function(t,e,i,n){const s=t[0];if(null===s)return!1;if("display"===e||"visibility"===e)return!0;const r=t[t.length-1],a=AR(s,e),o=AR(r,e);return!(!a||!o)&&(function(t){const e=t[0];if(1===t.length)return!0;for(let i=0;i<t.length;i++)if(t[i]!==e)return!0}(t)||("spring"===i||yR(i))&&n)}(t,s,r,a)||(!LC.instantAnimations&&o||h?.(IT(t,i,e)),t[0]=t[t.length-1],xR(i),i.repeat=0);const c={startTime:n?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:e,...i,keyframes:t},d=!l&&function(t){const{motionValue:e,name:i,repeatDelay:n,repeatType:s,damping:r,type:a}=t,o=e?.owner?.current;if(!(o instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:h}=e.owner.getProps();return SR()&&i&&_R.has(i)&&("transform"!==i||!h)&&!l&&!n&&"mirror"!==s&&0!==r&&"inertia"!==a}(c)?new bR({...c,element:c.motionValue.owner.current}):new BT(c);d.finished.then(()=>this.notifyFinished()).catch(jC),this.pendingTimeline&&(this.stopTimeline=d.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=d}get finished(){return this._animation?this.animation.finished:this._finished}then(t,e){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),rR=!0,oR(),aR(),rR=!1),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const ER=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function MR(t,e,i=1){const[n,s]=function(t){const e=ER.exec(t);if(!e)return[,];const[,i,n,s]=e;return[`--${i??n}`,s]}(t);if(!n)return;const r=window.getComputedStyle(e).getPropertyValue(n);if(r){const t=r.trim();return FC(t)?parseFloat(t):t}return _P(s)?MR(s,e,i+1):s}function CR(t,e){return t?.[e]??t?.default??t}const PR=new Set(["width","height","top","left","right","bottom",...YT]),TR=t=>e=>e.test(t),RR=[kP,WP,BP,NP,$P,jP,{test:t=>"auto"===t,parse:t=>t}],DR=t=>RR.find(TR(t));function IR(t){return"number"==typeof t?0===t:null===t||"none"===t||"0"===t||BC(t)}const OR=new Set(["brightness","contrast","saturate","opacity"]);function LR(t){const[e,i]=t.slice(0,-1).split("(");if("drop-shadow"===e)return t;const[n]=i.match(PP)||[];if(!n)return t;const s=i.replace(n,"");let r=OR.has(e)?1:0;return n!==i&&(r*=100),e+"("+r+s+")"}const FR=/\b([a-z-]*)\(.*?\)/gu,NR={...ZP,getAnimatableNone:t=>{const e=t.match(FR);return e?e.map(LR).join(" "):t}},BR={...kP,transform:Math.round},WR={borderWidth:WP,borderTopWidth:WP,borderRightWidth:WP,borderBottomWidth:WP,borderLeftWidth:WP,borderRadius:WP,radius:WP,borderTopLeftRadius:WP,borderTopRightRadius:WP,borderBottomRightRadius:WP,borderBottomLeftRadius:WP,width:WP,maxWidth:WP,height:WP,maxHeight:WP,top:WP,right:WP,bottom:WP,left:WP,padding:WP,paddingTop:WP,paddingRight:WP,paddingBottom:WP,paddingLeft:WP,margin:WP,marginTop:WP,marginRight:WP,marginBottom:WP,marginLeft:WP,backgroundPositionX:WP,backgroundPositionY:WP,rotate:NP,rotateX:NP,rotateY:NP,rotateZ:NP,scale:MP,scaleX:MP,scaleY:MP,scaleZ:MP,skew:NP,skewX:NP,skewY:NP,distance:WP,translateX:WP,translateY:WP,translateZ:WP,x:WP,y:WP,z:WP,perspective:WP,transformPerspective:WP,opacity:EP,originX:UP,originY:UP,originZ:WP,zIndex:BR,fillOpacity:EP,strokeOpacity:EP,numOctaves:BR},jR={...WR,color:zP,backgroundColor:zP,outlineColor:zP,fill:zP,stroke:zP,borderColor:zP,borderTopColor:zP,borderRightColor:zP,borderBottomColor:zP,borderLeftColor:zP,filter:NR,WebkitFilter:NR},$R=t=>jR[t];function UR(t,e){let i=$R(t);return i!==NR&&(i=ZP),i.getAnimatableNone?i.getAnimatableNone(e):void 0}const HR=new Set(["auto","none","0"]);class zR extends lR{constructor(t,e,i,n,s){super(t,e,i,n,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:e,name:i}=this;if(!e||!e.current)return;super.readKeyframes();for(let o=0;o<t.length;o++){let i=t[o];if("string"==typeof i&&(i=i.trim(),_P(i))){const n=MR(i,e.current);void 0!==n&&(t[o]=n),o===t.length-1&&(this.finalKeyframe=i)}}if(this.resolveNoneKeyframes(),!PR.has(i)||2!==t.length)return;const[n,s]=t,r=DR(n),a=DR(s);if(r!==a)if(JT(r)&&JT(a))for(let o=0;o<t.length;o++){const e=t[o];"string"==typeof e&&(t[o]=parseFloat(e))}else eR[i]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:e}=this,i=[];for(let n=0;n<t.length;n++)(null===t[n]||IR(t[n]))&&i.push(n);i.length&&function(t,e,i){let n,s=0;for(;s<t.length&&!n;){const e=t[s];"string"==typeof e&&!HR.has(e)&&KP(e).values.length&&(n=t[s]),s++}if(n&&i)for(const r of e)t[r]=UR(i,n)}(t,i,e)}measureInitialState(){const{element:t,unresolvedKeyframes:e,name:i}=this;if(!t||!t.current)return;"height"===i&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=eR[i](t.measureViewportBox(),window.getComputedStyle(t.current)),e[0]=this.measuredOrigin;const n=e[e.length-1];void 0!==n&&t.getValue(i,n).jump(n,!1)}measureEndState(){const{element:t,name:e,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const n=t.getValue(e);n&&n.jump(this.measuredOrigin,!1);const s=i.length-1,r=i[s];i[s]=eR[e](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==r&&void 0===this.finalKeyframe&&(this.finalKeyframe=r),this.removedTransforms?.length&&this.removedTransforms.forEach(([e,i])=>{t.getValue(e).set(i)}),this.resolveNoneKeyframes()}}const VR=(t,e)=>e&&"number"==typeof t?e.transform(t):t,GR={current:void 0};class qR{constructor(t,e={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=t=>{const e=vP.now();if(this.updatedAt!==e&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(t),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=e.owner}setCurrent(t){var e;this.current=t,this.updatedAt=vP.now(),null===this.canTrackVelocity&&void 0!==t&&(this.canTrackVelocity=(e=this.current,!isNaN(parseFloat(e))))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,e){this.events[t]||(this.events[t]=new zC);const i=this.events[t].add(e);return"change"===t?()=>{i(),pP.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,e){this.passiveEffect=t,this.stopPassiveEffect=e}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,e,i){this.set(e),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,e=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,e&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return GR.current&&GR.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=vP.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||t-this.updatedAt>30)return 0;const e=Math.min(this.updatedAt-this.prevUpdatedAt,30);return qC(parseFloat(this.current)-parseFloat(this.prevFrameValue),e)}start(t){return this.stop(),new Promise(e=>{this.hasAnimated=!0,this.animation=t(e),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function XR(t,e){return new qR(t,e)}const{schedule:KR}=uP(queueMicrotask,!1),YR={x:!1,y:!1};function QR(){return YR.x||YR.y}function JR(t){return"x"===t||"y"===t?YR[t]?null:(YR[t]=!0,()=>{YR[t]=!1}):YR.x||YR.y?null:(YR.x=YR.y=!0,()=>{YR.x=YR.y=!1})}function ZR(t,e){const i=function(t){if(t instanceof EventTarget)return[t];if("string"==typeof t){const e=document.querySelectorAll(t);return e?Array.from(e):[]}return Array.from(t)}(t),n=new AbortController;return[i,{passive:!0,...e,signal:n.signal},()=>n.abort()]}function tD(t){return!("touch"===t.pointerType||QR())}function eD(t,e,i={}){const[n,s,r]=ZR(t,i),a=t=>{if(!tD(t))return;const{target:i}=t,n=e(i,t);if("function"!=typeof n||!i)return;const r=t=>{tD(t)&&(n(t),i.removeEventListener("pointerleave",r))};i.addEventListener("pointerleave",r,s)};return n.forEach(t=>{t.addEventListener("pointerenter",a,s)}),r}const iD=(t,e)=>!!e&&(t===e||iD(t,e.parentElement)),nD=t=>"mouse"===t.pointerType?"number"!=typeof t.button||t.button<=0:!1!==t.isPrimary,sD=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]),rD=new WeakSet;function aD(t){return e=>{"Enter"===e.key&&t(e)}}function oD(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}function lD(t){return nD(t)&&!QR()}function hD(t,e,i={}){const[n,s,r]=ZR(t,i),a=t=>{const n=t.currentTarget;if(!lD(t))return;rD.add(n);const r=e(n,t),a=(t,e)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),rD.has(n)&&rD.delete(n),lD(t)&&"function"==typeof r&&r(t,{success:e})},o=t=>{a(t,n===window||n===document||i.useGlobalTarget||iD(n,t.target))},l=t=>{a(t,!1)};window.addEventListener("pointerup",o,s),window.addEventListener("pointercancel",l,s)};return n.forEach(t=>{var e;(i.useGlobalTarget?window:t).addEventListener("pointerdown",a,s),NC(e=t)&&"offsetHeight"in e&&(t.addEventListener("focus",t=>((t,e)=>{const i=t.currentTarget;if(!i)return;const n=aD(()=>{if(rD.has(i))return;oD(i,"down");const t=aD(()=>{oD(i,"up")});i.addEventListener("keyup",t,e),i.addEventListener("blur",()=>oD(i,"cancel"),e)});i.addEventListener("keydown",n,e),i.addEventListener("blur",()=>i.removeEventListener("keydown",n),e)})(t,s)),function(t){return sD.has(t.tagName)||-1!==t.tabIndex}(t)||t.hasAttribute("tabindex")||(t.tabIndex=0))}),r}function cD(t){return NC(t)&&"ownerSVGElement"in t}function dD(t){return cD(t)&&"svg"===t.tagName}function uD(...t){const e=!Array.isArray(t[0]),i=e?0:-1,n=t[0+i],s=TT(t[1+i],t[2+i],t[3+i]);return e?s(n):s}const pD=t=>Boolean(t&&t.getVelocity),fD=[...RR,zP,ZP],gD=t=>fD.find(TR(t));var mD={};!function(t){class e{constructor(t,e){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=e,this.nowDrawingDensity=this.createdDensity,this.render=t}setDensity(t){this.createdDensity=t,this.nowDrawingDensity=t}setDrawingDensity(t){this.nowDrawingDensity=t}setPosition(t){this.state.position=t}setAngle(t){this.state.angle=t}setArea(t){this.state.area=t}setHardDrawingAngle(t){this.state.hardDrawingAngle=t}setHardAngle(t){this.state.hardAngle=t,this.state.hardDrawingAngle=t}setOrientation(t){this.orientation=t}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class i extends e{constructor(t,e,i){super(t,i),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=e}draw(t){const e=this.render.getContext(),i=this.render.convertToGlobal(this.state.position),n=this.render.getRect().pageWidth,s=this.render.getRect().height;e.save(),e.translate(i.x,i.y),e.beginPath();for(let r of this.state.area)null!==r&&(r=this.render.convertToGlobal(r),e.lineTo(r.x-i.x,r.y-i.y));e.rotate(this.state.angle),e.clip(),this.isLoad?e.drawImage(this.image,0,0,n,s):this.drawLoader(e,{x:0,y:0},n,s),e.restore()}simpleDraw(t){const e=this.render.getRect(),i=this.render.getContext(),n=e.pageWidth,s=e.height,r=1===t?e.left+e.pageWidth:e.left,a=e.top;this.isLoad?i.drawImage(this.image,r,a,n,s):this.drawLoader(i,{x:r,y:a},n,s)}drawLoader(t,e,i,n){t.beginPath(),t.strokeStyle="rgb(200, 200, 200)",t.fillStyle="rgb(255, 255, 255)",t.lineWidth=1,t.rect(e.x+1,e.y+1,i-1,n-1),t.stroke(),t.fill();const s={x:e.x+i/2,y:e.y+n/2};t.beginPath(),t.lineWidth=10,t.arc(s.x,s.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),t.stroke(),t.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class n{constructor(t,e){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=e,this.app=t,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let e=0;e<this.pages.length;e++)this.portraitSpread.push([e]);let t=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([t]),t++);for(let e=t;e<this.pages.length;e+=2)e<this.pages.length-1?this.landscapeSpread.push([e,e+1]):(this.landscapeSpread.push([e]),this.pages[e].setDensity("hard"))}getSpread(){return"landscape"===this.render.getOrientation()?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(t){const e=this.getSpread();for(let i=0;i<e.length;i++)if(t===e[i][0]||t===e[i][1])return i;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(t){if(t>=0&&t<this.pages.length)return this.pages[t];throw new Error("Invalid page number")}nextBy(t){const e=this.pages.indexOf(t);return e<this.pages.length-1?this.pages[e+1]:null}prevBy(t){const e=this.pages.indexOf(t);return e>0?this.pages[e-1]:null}getFlippingPage(t){const e=this.currentSpreadIndex;if("portrait"===this.render.getOrientation())return 0===t?this.pages[e].newTemporaryCopy():this.pages[e-1];{const i=0===t?this.getSpread()[e+1]:this.getSpread()[e-1];return 1===i.length||0===t?this.pages[i[0]]:this.pages[i[1]]}}getBottomPage(t){const e=this.currentSpreadIndex;if("portrait"===this.render.getOrientation())return 0===t?this.pages[e+1]:this.pages[e-1];{const i=0===t?this.getSpread()[e+1]:this.getSpread()[e-1];return 1===i.length?this.pages[i[0]]:0===t?this.pages[i[1]]:this.pages[i[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(t=null){if(null===t&&(t=this.currentPageIndex),t<0||t>=this.pages.length)return;const e=this.getSpreadIndexByPage(t);null!==e&&(this.currentSpreadIndex=e,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(t){if(!(t>=0&&t<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=t}showSpread(){const t=this.getSpread()[this.currentSpreadIndex];2===t.length?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(this.pages[t[1]])):"landscape"===this.render.getOrientation()&&t[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[t[0]])),this.currentPageIndex=t[0],this.app.updatePageIndex(this.currentPageIndex)}}class s extends n{constructor(t,e,i){super(t,e),this.imagesHref=i}load(){for(const t of this.imagesHref){const e=new i(this.render,t,"soft");e.load(),this.pages.push(e)}this.createSpread()}}class r{static GetDistanceBetweenTwoPoint(t,e){return null===t||null===e?1/0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static GetSegmentLength(t){return r.GetDistanceBetweenTwoPoint(t[0],t[1])}static GetAngleBetweenTwoLine(t,e){const i=t[0].y-t[1].y,n=e[0].y-e[1].y,s=t[1].x-t[0].x,r=e[1].x-e[0].x;return Math.acos((i*n+s*r)/(Math.sqrt(i*i+s*s)*Math.sqrt(n*n+r*r)))}static PointInRect(t,e){return null===e?null:e.x>=t.left&&e.x<=t.width+t.left&&e.y>=t.top&&e.y<=t.top+t.height?e:null}static GetRotatedPoint(t,e,i){return{x:t.x*Math.cos(i)+t.y*Math.sin(i)+e.x,y:t.y*Math.cos(i)-t.x*Math.sin(i)+e.y}}static LimitPointToCircle(t,e,i){if(r.GetDistanceBetweenTwoPoint(t,i)<=e)return i;const n=t.x,s=t.y,a=i.x,o=i.y;let l=Math.sqrt(Math.pow(e,2)*Math.pow(n-a,2)/(Math.pow(n-a,2)+Math.pow(s-o,2)))+n;i.x<0&&(l*=-1);let h=(l-n)*(s-o)/(n-a)+s;return n-a+s===0&&(h=e),{x:l,y:h}}static GetIntersectBetweenTwoSegment(t,e,i){return r.PointInRect(t,r.GetIntersectBeetwenTwoLine(e,i))}static GetIntersectBeetwenTwoLine(t,e){const i=t[0].y-t[1].y,n=e[0].y-e[1].y,s=t[1].x-t[0].x,r=e[1].x-e[0].x,a=t[0].x*t[1].y-t[1].x*t[0].y,o=e[0].x*e[1].y-e[1].x*e[0].y,l=i*o-n*a,h=s*o-r*a,c=-(a*r-o*s)/(i*r-n*s),d=-(i*o-n*a)/(i*r-n*s);if(isFinite(c)&&isFinite(d))return{x:c,y:d};if(Math.abs(l-h)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(t,e){const i=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y),s=Math.max(i,n),r=[t];function a(t,e,i,n,s){return e>t?t+s*(i/n):e<t?t-s*(i/n):t}for(let o=1;o<=s;o+=1)r.push({x:a(t.x,e.x,i,s,o),y:a(t.y,e.y,n,s,o)});return r}}class a extends e{constructor(t,e,i){super(t,i),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=e,this.element.classList.add("stf__item"),this.element.classList.add("--"+i)}newTemporaryCopy(){return"hard"===this.nowDrawingDensity?this:(null===this.temporaryCopy&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new a(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){null!==this.temporaryCopy&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(t){const e=t||this.nowDrawingDensity,i=this.render.convertToGlobal(this.state.position),n=this.render.getRect().pageWidth,s=this.render.getRect().height;this.element.classList.remove("--simple");const r=`\n            display: block;\n            z-index: ${this.element.style.zIndex};\n            left: 0;\n            top: 0;\n            width: ${n}px;\n            height: ${s}px;\n        `;"hard"===e?this.drawHard(r):this.drawSoft(i,r)}drawHard(t=""){const e=this.render.getRect().left+this.render.getRect().width/2,i=this.state.hardDrawingAngle,n=t+"\n                backface-visibility: hidden;\n                -webkit-backface-visibility: hidden;\n                clip-path: none;\n                -webkit-clip-path: none;\n            "+(0===this.orientation?`transform-origin: ${this.render.getRect().pageWidth}px 0; \n                   transform: translate3d(0, 0, 0) rotateY(${i}deg);`:`transform-origin: 0 0; \n                   transform: translate3d(${e}px, 0, 0) rotateY(${i}deg);`);this.element.style.cssText=n}drawSoft(t,e=""){let i="polygon( ";for(const s of this.state.area)if(null!==s){let t=1===this.render.getDirection()?{x:-s.x+this.state.position.x,y:s.y-this.state.position.y}:{x:s.x-this.state.position.x,y:s.y-this.state.position.y};t=r.GetRotatedPoint(t,{x:0,y:0},this.state.angle),i+=t.x+"px "+t.y+"px, "}i=i.slice(0,-2),i+=")";const n=e+`transform-origin: 0 0; clip-path: ${i}; -webkit-clip-path: ${i};`+(this.render.isSafari()&&0===this.state.angle?`transform: translate(${t.x}px, ${t.y}px);`:`transform: translate3d(${t.x}px, ${t.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=n}simpleDraw(t){const e=this.render.getRect(),i=e.pageWidth,n=e.height,s=1===t?e.left+e.pageWidth:e.left,r=e.top;this.element.classList.add("--simple"),this.element.style.cssText=`\n            position: absolute; \n            display: block; \n            height: ${n}px; \n            left: ${s}px; \n            top: ${r}px; \n            width: ${i}px; \n            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(t){super.setOrientation(t),this.element.classList.remove("--left","--right"),this.element.classList.add(1===t?"--right":"--left")}setDrawingDensity(t){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+t),super.setDrawingDensity(t)}}class o extends n{constructor(t,e,i,n){super(t,e),this.element=i,this.pagesElement=n}load(){for(const t of this.pagesElement){const e=new a(this.render,t,"hard"===t.dataset.density?"hard":"soft");e.load(),this.pages.push(e)}this.createSpread()}}class l{constructor(t,e,i,n){this.direction=t,this.corner=e,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(i,10),this.pageHeight=parseInt(n,10)}calc(t){try{return this.position=this.calcAngleAndPosition(t),this.calculateIntersectPoint(this.position),!0}catch(e){return!1}}getFlippingClipArea(){const t=[];let e=!1;return t.push(this.rect.topLeft),t.push(this.topIntersectPoint),null===this.sideIntersectPoint?e=!0:(t.push(this.sideIntersectPoint),null===this.bottomIntersectPoint&&(e=!1)),t.push(this.bottomIntersectPoint),(e||"bottom"===this.corner)&&t.push(this.rect.bottomLeft),t}getBottomClipArea(){const t=[];return t.push(this.topIntersectPoint),"top"===this.corner?t.push({x:this.pageWidth,y:0}):(null!==this.topIntersectPoint&&t.push({x:this.pageWidth,y:0}),t.push({x:this.pageWidth,y:this.pageHeight})),null!==this.sideIntersectPoint?r.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&t.push(this.sideIntersectPoint):"top"===this.corner&&t.push({x:this.pageWidth,y:this.pageHeight}),t.push(this.bottomIntersectPoint),t.push(this.topIntersectPoint),t}getAngle(){return 0===this.direction?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return 0===this.direction?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return 1===this.direction?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return"top"===this.corner?this.topIntersectPoint:null!==this.sideIntersectPoint?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const t=r.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return 0===this.direction?t:Math.PI-t}calcAngleAndPosition(t){let e=t;if(this.updateAngleAndGeometry(e),e="top"===this.corner?this.checkPositionAtCenterLine(e,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(e,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(e.x-this.pageWidth)<1&&Math.abs(e.y)<1)throw new Error("Point is too small");return e}updateAngleAndGeometry(t){this.angle=this.calculateAngle(t),this.rect=this.getPageRect(t)}calculateAngle(t){const e=this.pageWidth-t.x+1,i="bottom"===this.corner?this.pageHeight-t.y:t.y;let n=2*Math.acos(e/Math.sqrt(i*i+e*e));i<0&&(n=-n);const s=Math.PI-n;if(!isFinite(n)||s>=0&&s<.003)throw new Error("The G point is too small");return"bottom"===this.corner&&(n=-n),n}getPageRect(t){return"top"===this.corner?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],t):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],t)}getRectFromBasePoint(t,e){return{topLeft:this.getRotatedPoint(t[0],e),topRight:this.getRotatedPoint(t[1],e),bottomLeft:this.getRotatedPoint(t[2],e),bottomRight:this.getRotatedPoint(t[3],e)}}getRotatedPoint(t,e){return{x:t.x*Math.cos(this.angle)+t.y*Math.sin(this.angle)+e.x,y:t.y*Math.cos(this.angle)-t.x*Math.sin(this.angle)+e.y}}calculateIntersectPoint(t){const e={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};"top"===this.corner?(this.topIntersectPoint=r.GetIntersectBetweenTwoSegment(e,[t,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=r.GetIntersectBetweenTwoSegment(e,[t,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=r.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=r.GetIntersectBetweenTwoSegment(e,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=r.GetIntersectBetweenTwoSegment(e,[t,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=r.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(t,e,i){let n=t;const s=r.LimitPointToCircle(e,this.pageWidth,n);n!==s&&(n=s,this.updateAngleAndGeometry(n));const a=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let o=this.rect.bottomRight,l=this.rect.topLeft;if("bottom"===this.corner&&(o=this.rect.topRight,l=this.rect.bottomLeft),o.x<=0){const t=r.LimitPointToCircle(i,a,l);t!==n&&(n=t,this.updateAngleAndGeometry(n))}return n}getSegmentToShadowLine(){const t=this.getShadowStartPoint();return[t,t!==this.sideIntersectPoint&&null!==this.sideIntersectPoint?this.sideIntersectPoint:this.bottomIntersectPoint]}}class h{constructor(t,e){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=t,this.app=e}fold(t){this.setState("user_fold"),null===this.calc&&this.start(t),this.do(this.render.convertToPage(t))}flip(t){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(t))return;if(null!==this.calc&&this.render.finishAnimation(),!this.start(t))return;const e=this.getBoundsRect();this.setState("flipping");const i=e.height/10,n="bottom"===this.calc.getCorner()?e.height-i:i,s="bottom"===this.calc.getCorner()?e.height:0;this.calc.calc({x:e.pageWidth-i,y:n}),this.animateFlippingTo({x:e.pageWidth-i,y:n},{x:-e.pageWidth,y:s},!0)}start(t){this.reset();const e=this.render.convertToBook(t),i=this.getBoundsRect(),n=this.getDirectionByPoint(e),s=e.y>=i.height/2?"bottom":"top";if(!this.checkDirection(n))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(n),this.bottomPage=this.app.getPageCollection().getBottomPage(n),"landscape"===this.render.getOrientation())if(1===n){const t=this.app.getPageCollection().nextBy(this.flippingPage);null!==t&&this.flippingPage.getDensity()!==t.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),t.setDrawingDensity("hard"))}else{const t=this.app.getPageCollection().prevBy(this.flippingPage);null!==t&&this.flippingPage.getDensity()!==t.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),t.setDrawingDensity("hard"))}return this.render.setDirection(n),this.calc=new l(n,s,i.pageWidth.toString(10),i.height.toString(10)),!0}catch(r){return!1}}do(t){if(null!==this.calc&&this.calc.calc(t)){const t=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),0===this.calc.getDirection()?this.flippingPage.setHardAngle(90*(200-2*t)/100):this.flippingPage.setHardAngle(-90*(200-2*t)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),t,this.calc.getDirection())}}flipToPage(t,e){const i=this.app.getPageCollection().getCurrentSpreadIndex(),n=this.app.getPageCollection().getSpreadIndexByPage(t);try{n>i&&(this.app.getPageCollection().setCurrentSpreadIndex(n-1),this.flipNext(e)),n<i&&(this.app.getPageCollection().setCurrentSpreadIndex(n+1),this.flipPrev(e))}catch(s){}}flipNext(t){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:"top"===t?1:this.render.getRect().height-2})}flipPrev(t){this.flip({x:10,y:"top"===t?1:this.render.getRect().height-2})}stopMove(){if(null===this.calc)return;const t=this.calc.getPosition(),e=this.getBoundsRect(),i="bottom"===this.calc.getCorner()?e.height:0;t.x<=0?this.animateFlippingTo(t,{x:-e.pageWidth,y:i},!0):this.animateFlippingTo(t,{x:e.pageWidth,y:i},!1)}showCorner(t){if(!this.checkState("read","fold_corner"))return;const e=this.getBoundsRect(),i=e.pageWidth;if(this.isPointOnCorners(t))if(null===this.calc){if(!this.start(t))return;this.setState("fold_corner"),this.calc.calc({x:i-1,y:1});const n=50,s="bottom"===this.calc.getCorner()?e.height-1:1,r="bottom"===this.calc.getCorner()?e.height-n:n;this.animateFlippingTo({x:i-1,y:s},{x:i-n,y:r},!1,!1)}else this.do(this.render.convertToPage(t));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(t,e,i,n=!0){const s=r.GetCordsFromTwoPoint(t,e),a=[];for(const r of s)a.push(()=>this.do(r));const o=this.getAnimationDuration(s.length);this.render.startAnimation(a,o,()=>{this.calc&&(i&&(1===this.calc.getDirection()?this.app.turnToPrevPage():this.app.turnToNextPage()),n&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))})}getCalculation(){return this.calc}getState(){return this.state}setState(t){this.state!==t&&(this.app.updateState(t),this.state=t)}getDirectionByPoint(t){const e=this.getBoundsRect();if("portrait"===this.render.getOrientation()){if(t.x-e.pageWidth<=e.width/5)return 1}else if(t.x<e.width/2)return 1;return 0}getAnimationDuration(t){const e=this.app.getSettings().flippingTime;return t>=1e3?e:t/1e3*e}checkDirection(t){return 0===t?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...t){for(const e of t)if(this.state===e)return!0;return!1}isPointOnCorners(t){const e=this.getBoundsRect(),i=e.pageWidth,n=Math.sqrt(Math.pow(i,2)+Math.pow(e.height,2))/5,s=this.render.convertToBook(t);return s.x>0&&s.y>0&&s.x<e.width&&s.y<e.height&&(s.x<n||s.x>e.width-n)&&(s.y<n||s.y>e.height-n)}}class c{constructor(t,e){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=e,this.app=t;const i=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=null!==i.exec(window.navigator.userAgent)}render(t){if(null!==this.animation){const e=Math.round((t-this.animation.startedAt)/this.animation.durationFrame);e<this.animation.frames.length?this.animation.frames[e]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=t,this.drawFrame()}start(){this.update();const t=e=>{this.render(e),requestAnimationFrame(t)};requestAnimationFrame(t)}startAnimation(t,e,i){this.finishAnimation(),this.animation={frames:t,duration:e,durationFrame:e/t.length,onAnimateEnd:i,startedAt:this.timer}}finishAnimation(){null!==this.animation&&(this.animation.frames[this.animation.frames.length-1](),null!==this.animation.onAnimateEnd&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const t=this.calculateBoundsRect();this.orientation!==t&&(this.orientation=t,this.app.updateOrientation(t))}calculateBoundsRect(){let t="landscape";const e=this.getBlockWidth(),i=e/2,n=this.getBlockHeight()/2,s=this.setting.width/this.setting.height;let r=this.setting.width,a=this.setting.height,o=i-r;return"stretch"===this.setting.size?(e<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(t="portrait"),r="portrait"===t?this.getBlockWidth():this.getBlockWidth()/2,r>this.setting.maxWidth&&(r=this.setting.maxWidth),a=r/s,a>this.getBlockHeight()&&(a=this.getBlockHeight(),r=a*s),o="portrait"===t?i-r/2-r:i-r):e<2*r&&this.app.getSettings().usePortrait&&(t="portrait",o=i-r/2-r),this.boundsRect={left:o,top:n-a/2,width:2*r,height:a,pageWidth:r},t}setShadowData(t,e,i,n){if(!this.app.getSettings().drawShadow)return;const s=100*this.getSettings().maxShadowOpacity;this.shadow={pos:t,angle:e,width:3*this.getRect().pageWidth/4*i/100,opacity:(100-i)*s/100/100,direction:n,progress:2*i}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return null===this.boundsRect&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(t){this.pageRect=t}setDirection(t){this.direction=t}setRightPage(t){null!==t&&t.setOrientation(1),this.rightPage=t}setLeftPage(t){null!==t&&t.setOrientation(0),this.leftPage=t}setBottomPage(t){null!==t&&t.setOrientation(1===this.direction?0:1),this.bottomPage=t}setFlippingPage(t){null!==t&&t.setOrientation(0===this.direction&&"portrait"!==this.orientation?0:1),this.flippingPage=t}convertToBook(t){const e=this.getRect();return{x:t.x-e.left,y:t.y-e.top}}isSafari(){return this.safari}convertToPage(t,e){e||(e=this.direction);const i=this.getRect();return{x:0===e?t.x-i.left-i.width/2:i.width/2-t.x+i.left,y:t.y-i.top}}convertToGlobal(t,e){if(e||(e=this.direction),null==t)return null;const i=this.getRect();return{x:0===e?t.x+i.left+i.width/2:i.width/2-t.x+i.left,y:t.y+i.top}}convertRectToGlobal(t,e){return e||(e=this.direction),{topLeft:this.convertToGlobal(t.topLeft,e),topRight:this.convertToGlobal(t.topRight,e),bottomLeft:this.convertToGlobal(t.bottomLeft,e),bottomRight:this.convertToGlobal(t.bottomRight,e)}}}class d extends c{constructor(t,e,i){super(t,e),this.canvas=i,this.ctx=i.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),"portrait"!==this.orientation&&null!=this.leftPage&&this.leftPage.simpleDraw(0),null!=this.rightPage&&this.rightPage.simpleDraw(1),null!=this.bottomPage&&this.bottomPage.draw(),this.drawBookShadow(),null!=this.flippingPage&&this.flippingPage.draw(),null!=this.shadow&&(this.drawOuterShadow(),this.drawInnerShadow());const t=this.getRect();"portrait"===this.orientation&&(this.ctx.beginPath(),this.ctx.rect(t.left+t.pageWidth,t.top,t.width,t.height),this.ctx.clip())}drawBookShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=t.width/20;this.ctx.rect(t.left,t.top,t.width,t.height);const i={x:t.left+t.width/2-e/2,y:0};this.ctx.translate(i.x,i.y);const n=this.ctx.createLinearGradient(0,0,e,0);n.addColorStop(0,"rgba(0, 0, 0, 0)"),n.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),n.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),n.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),n.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),n.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=n,this.ctx.fillRect(0,0,e,2*t.height),this.ctx.restore()}drawOuterShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t.left,t.top,t.width,t.height);const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const i=this.ctx.createLinearGradient(0,0,this.shadow.width,0);0===this.shadow.direction?(this.ctx.translate(0,-100),i.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),i.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),i.addColorStop(0,"rgba(0, 0, 0, 0)"),i.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,this.shadow.width,2*t.height),this.ctx.restore()}drawInnerShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(i.topLeft.x,i.topLeft.y),this.ctx.lineTo(i.topRight.x,i.topRight.y),this.ctx.lineTo(i.bottomRight.x,i.bottomRight.y),this.ctx.lineTo(i.bottomLeft.x,i.bottomLeft.y),this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const n=3*this.shadow.width/4,s=this.ctx.createLinearGradient(0,0,n,0);0===this.shadow.direction?(this.ctx.translate(-n,-100),s.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),s.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),s.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),s.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),s.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),s.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),s.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),s.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=s,this.ctx.fillRect(0,0,n,2*t.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class u{constructor(t,e,i){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=t=>{if(this.checkTarget(t.target)){const e=this.getMousePos(t.clientX,t.clientY);this.app.startUserTouch(e),t.preventDefault()}},this.onTouchStart=t=>{if(this.checkTarget(t.target)&&t.changedTouches.length>0){const e=t.changedTouches[0],i=this.getMousePos(e.clientX,e.clientY);this.touchPoint={point:i,time:Date.now()},setTimeout(()=>{null!==this.touchPoint&&this.app.startUserTouch(i)},this.swipeTimeout),this.app.getSettings().mobileScrollSupport||t.preventDefault()}},this.onMouseUp=t=>{const e=this.getMousePos(t.clientX,t.clientY);this.app.userStop(e)},this.onMouseMove=t=>{const e=this.getMousePos(t.clientX,t.clientY);this.app.userMove(e,!1)},this.onTouchMove=t=>{if(t.changedTouches.length>0){const e=t.changedTouches[0],i=this.getMousePos(e.clientX,e.clientY);this.app.getSettings().mobileScrollSupport?(null!==this.touchPoint&&(Math.abs(this.touchPoint.point.x-i.x)>10||"read"!==this.app.getState())&&t.cancelable&&this.app.userMove(i,!0),"read"!==this.app.getState()&&t.preventDefault()):this.app.userMove(i,!0)}},this.onTouchEnd=t=>{if(t.changedTouches.length>0){const e=t.changedTouches[0],i=this.getMousePos(e.clientX,e.clientY);let n=!1;if(null!==this.touchPoint){const t=i.x-this.touchPoint.point.x,e=Math.abs(i.y-this.touchPoint.point.y);Math.abs(t)>this.swipeDistance&&e<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(t>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),n=!0),this.touchPoint=null}this.app.userStop(i,n)}},this.parentElement=t,t.classList.add("stf__parent"),t.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=t.querySelector(".stf__wrapper"),this.app=e;const n=this.app.getSettings().usePortrait?1:2;t.style.minWidth=i.minWidth*n+"px",t.style.minHeight=i.minHeight+"px","fixed"===i.size&&(t.style.minWidth=i.width*n+"px",t.style.minHeight=i.height+"px"),i.autoSize&&(t.style.width="100%",t.style.maxWidth=2*i.maxWidth+"px"),t.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=i.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(t){this.wrapper.classList.remove("--portrait","--landscape"),"portrait"===t?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(t,e){const i=this.distElement.getBoundingClientRect();return{x:t-i.left,y:e-i.top}}checkTarget(t){return!this.app.getSettings().clickEventForward||!["a","button"].includes(t.tagName.toLowerCase())}}class p extends u{constructor(t,e,i,n){super(t,e,i),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=t.querySelector(".stf__block"),this.items=n;for(const s of n)this.distElement.appendChild(s);this.setHandlers()}clear(){for(const t of this.items)this.parentElement.appendChild(t)}updateItems(t){this.removeHandlers(),this.distElement.innerHTML="";for(const e of t)this.distElement.appendChild(e);this.items=t,this.setHandlers()}update(){this.app.getRender().update()}}class f extends u{constructor(t,e,i){super(t,e,i),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=t.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const t=getComputedStyle(this.canvas),e=parseInt(t.getPropertyValue("width"),10),i=parseInt(t.getPropertyValue("height"),10);this.canvas.width=e,this.canvas.height=i}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class g extends c{constructor(t,e,i){super(t,e),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=i,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",'<div class="stf__outerShadow"></div>\n             <div class="stf__innerShadow"></div>\n             <div class="stf__hardShadow"></div>\n             <div class="stf__hardInnerShadow"></div>'),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const t=this.getRect(),e=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let i=(100-e)*(2.5*t.pageWidth)/100+20;i>t.pageWidth&&(i=t.pageWidth);let n=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+5).toString(10)};\n            width: ${i}px;\n            height: ${t.height}px;\n            background: linear-gradient(to right,\n                rgba(0, 0, 0, ${this.shadow.opacity*e/100}) 5%,\n                rgba(0, 0, 0, 0) 100%);\n            left: ${t.left+t.width/2}px;\n            transform-origin: 0 0;\n        `;n+=0===this.getDirection()&&this.shadow.progress>100||1===this.getDirection()&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=n}drawHardOuterShadow(){const t=this.getRect();let e=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*t.pageWidth)/100+20;e>t.pageWidth&&(e=t.pageWidth);let i=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+4).toString(10)};\n            width: ${e}px;\n            height: ${t.height}px;\n            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);\n            left: ${t.left+t.width/2}px;\n            transform-origin: 0 0;\n        `;i+=0===this.getDirection()&&this.shadow.progress>100||1===this.getDirection()&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=i}drawInnerShadow(){const t=this.getRect(),e=3*this.shadow.width/4,i=0===this.getDirection()?e:0,n=0===this.getDirection()?"to left":"to right",s=this.convertToGlobal(this.shadow.pos),a=this.shadow.angle+3*Math.PI/2,o=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let l="polygon( ";for(const c of o){let t=1===this.getDirection()?{x:-c.x+this.shadow.pos.x,y:c.y-this.shadow.pos.y}:{x:c.x-this.shadow.pos.x,y:c.y-this.shadow.pos.y};t=r.GetRotatedPoint(t,{x:i,y:100},a),l+=t.x+"px "+t.y+"px, "}l=l.slice(0,-2),l+=")";const h=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+10).toString(10)};\n            width: ${e}px;\n            height: ${2*t.height}px;\n            background: linear-gradient(${n},\n                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,\n                rgba(0, 0, 0, 0.05) 15%,\n                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,\n                rgba(0, 0, 0, 0) 100%);\n            transform-origin: ${i}px 100px;\n            transform: translate3d(${s.x-i}px, ${s.y-100}px, 0) rotate(${a}rad);\n            clip-path: ${l};\n            -webkit-clip-path: ${l};\n        `;this.innerShadow.style.cssText=h}drawOuterShadow(){const t=this.getRect(),e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),i=this.shadow.angle+3*Math.PI/2,n=1===this.getDirection()?this.shadow.width:0,s=0===this.getDirection()?"to right":"to left",a=[{x:0,y:0},{x:t.pageWidth,y:0},{x:t.pageWidth,y:t.height},{x:0,y:t.height}];let o="polygon( ";for(const h of a)if(null!==h){let t=1===this.getDirection()?{x:-h.x+this.shadow.pos.x,y:h.y-this.shadow.pos.y}:{x:h.x-this.shadow.pos.x,y:h.y-this.shadow.pos.y};t=r.GetRotatedPoint(t,{x:n,y:100},i),o+=t.x+"px "+t.y+"px, "}o=o.slice(0,-2),o+=")";const l=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+10).toString(10)};\n            width: ${this.shadow.width}px;\n            height: ${2*t.height}px;\n            background: linear-gradient(${s}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));\n            transform-origin: ${n}px 100px;\n            transform: translate3d(${e.x-n}px, ${e.y-100}px, 0) rotate(${i}rad);\n            clip-path: ${o};\n            -webkit-clip-path: ${o};\n        `;this.outerShadow.style.cssText=l}drawLeftPage(){"portrait"!==this.orientation&&null!==this.leftPage&&(1===this.direction&&null!==this.flippingPage&&"hard"===this.flippingPage.getDrawingDensity()?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){null!==this.rightPage&&(0===this.direction&&null!==this.flippingPage&&"hard"===this.flippingPage.getDrawingDensity()?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(null===this.bottomPage)return;const t=null!=this.flippingPage?this.flippingPage.getDrawingDensity():null;"portrait"===this.orientation&&1===this.direction||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(t))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),null!=this.flippingPage&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),null!=this.shadow&&null!==this.flippingPage&&("soft"===this.flippingPage.getDrawingDensity()?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const t of this.app.getPageCollection().getPages())t!==this.leftPage&&t!==this.rightPage&&t!==this.flippingPage&&t!==this.bottomPage&&(t.getElement().style.cssText="display: none"),t.getTemporaryCopy()!==this.flippingPage&&t.hideTemporaryCopy()}update(){super.update(),null!==this.rightPage&&this.rightPage.setOrientation(1),null!==this.leftPage&&this.leftPage.setOrientation(0)}}class m{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(t){const e=this._default;if(Object.assign(e,t),"stretch"!==e.size&&"fixed"!==e.size)throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(e.width<=0||e.height<=0)throw new Error("Invalid width or height");if(e.flippingTime<=0)throw new Error("Invalid flipping time");return"stretch"===e.size?(e.minWidth<=0&&(e.minWidth=100),e.maxWidth<e.minWidth&&(e.maxWidth=2e3),e.minHeight<=0&&(e.minHeight=100),e.maxHeight<e.minHeight&&(e.maxHeight=2e3)):(e.minWidth=e.width,e.maxWidth=e.width,e.minHeight=e.height,e.maxHeight=e.height),e}}!function(t,e){void 0===e&&(e={});var i=e.insertAt;if("undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===i&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}}(".stf__parent {\n  position: relative;\n  display: block;\n  box-sizing: border-box;\n  transform: translateZ(0);\n\n  -ms-touch-action: pan-y;\n  touch-action: pan-y;\n}\n\n.sft__wrapper {\n  position: relative;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.stf__parent canvas {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}\n\n.stf__block {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  perspective: 2000px;\n}\n\n.stf__item {\n  display: none;\n  position: absolute;\n  transform-style: preserve-3d;\n}\n\n.stf__outerShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n.stf__innerShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n.stf__hardShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n.stf__hardInnerShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}"),t.PageFlip=class extends class{constructor(){this.events=new Map}on(t,e){return this.events.has(t)?this.events.get(t).push(e):this.events.set(t,[e]),this}off(t){this.events.delete(t)}trigger(t,e,i=null){if(this.events.has(t))for(const n of this.events.get(t))n({data:i,object:e})}}{constructor(t,e){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=(new m).getSettings(e),this.block=t}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(t){this.ui=new f(this.block,this,this.setting);const e=this.ui.getCanvas();this.render=new d(this,this.setting,e),this.flipController=new h(this.render,this),this.pages=new s(this,this.render,t),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}loadFromHTML(t){this.ui=new p(this.block,this,this.setting,t),this.render=new g(this,this.setting,this.ui.getDistElement()),this.flipController=new h(this.render,this),this.pages=new o(this,this.render,this.ui.getDistElement(),t),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout(()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})},1)}updateFromImages(t){const e=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new s(this,this.render,t),this.pages.load(),this.pages.show(e),this.trigger("update",this,{page:e,mode:this.render.getOrientation()})}updateFromHtml(t){const e=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new o(this,this.render,this.ui.getDistElement(),t),this.pages.load(),this.ui.updateItems(t),this.render.reload(),this.pages.show(e),this.trigger("update",this,{page:e,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(t){this.pages.show(t)}flipNext(t="top"){this.flipController.flipNext(t)}flipPrev(t="top"){this.flipController.flipPrev(t)}flip(t,e="top"){this.flipController.flipToPage(t,e)}updateState(t){this.trigger("changeState",this,t)}updatePageIndex(t){this.trigger("flip",this,t)}updateOrientation(t){this.ui.setOrientationStyle(t),this.update(),this.trigger("changeOrientation",this,t)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(t){return this.pages.getPage(t)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(t){this.mousePosition=t,this.isUserTouch=!0,this.isUserMove=!1}userMove(t,e){this.isUserTouch||e||!this.setting.showPageCorners?this.isUserTouch&&r.GetDistanceBetweenTwoPoint(this.mousePosition,t)>5&&(this.isUserMove=!0,this.flipController.fold(t)):this.flipController.showCorner(t)}userStop(t,e=!1){this.isUserTouch&&(this.isUserTouch=!1,e||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(t)))}},Object.defineProperty(t,"__esModule",{value:!0})}(mD);var yD=mD;function wD(t,e){return(wD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function vD(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,wD(t,e)}function bD(){return bD=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},bD.apply(null,arguments)}function AD(t){return(AD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xD(t,e,i){return(e=function(t){var e=function(t,e){if("object"!=AD(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e);if("object"!=AD(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==AD(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _D(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function SD(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?_D(Object(i),!0).forEach(function(e){xD(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):_D(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function kD(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var ED="function"==typeof Symbol&&Symbol.observable||"@@observable",MD=function(){return Math.random().toString(36).substring(7).split("").join(".")},CD={INIT:"@@redux/INIT"+MD(),REPLACE:"@@redux/REPLACE"+MD()};function PD(t,e,i){var n;if("function"==typeof e&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error(kD(0));if("function"==typeof e&&void 0===i&&(i=e,e=void 0),void 0!==i){if("function"!=typeof i)throw new Error(kD(1));return i(PD)(t,e)}if("function"!=typeof t)throw new Error(kD(2));var s=t,r=e,a=[],o=a,l=!1;function h(){o===a&&(o=a.slice())}function c(){if(l)throw new Error(kD(3));return r}function d(t){if("function"!=typeof t)throw new Error(kD(4));if(l)throw new Error(kD(5));var e=!0;return h(),o.push(t),function(){if(e){if(l)throw new Error(kD(6));e=!1,h();var i=o.indexOf(t);o.splice(i,1),a=null}}}function u(t){if(!function(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}(t))throw new Error(kD(7));if(void 0===t.type)throw new Error(kD(8));if(l)throw new Error(kD(9));try{l=!0,r=s(r,t)}finally{l=!1}for(var e=a=o,i=0;i<e.length;i++)(0,e[i])();return t}return u({type:CD.INIT}),(n={dispatch:u,subscribe:d,getState:c,replaceReducer:function(t){if("function"!=typeof t)throw new Error(kD(10));s=t,u({type:CD.REPLACE})}})[ED]=function(){var t,e=d;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new Error(kD(11));function i(){t.next&&t.next(c())}return i(),{unsubscribe:e(i)}}})[ED]=function(){return this},t},n}function TD(t,e){return function(){return e(t.apply(this,arguments))}}function RD(t,e){if("function"==typeof t)return TD(t,e);if("object"!=typeof t||null===t)throw new Error(kD(16));var i={};for(var n in t){var s=t[n];"function"==typeof s&&(i[n]=TD(s,e))}return i}function DD(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce(function(t,e){return function(){return t(e.apply(void 0,arguments))}})}function ID(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){return function(){var i=t.apply(void 0,arguments),n=function(){throw new Error(kD(15))},s={getState:i.getState,dispatch:function(){return n.apply(void 0,arguments)}},r=e.map(function(t){return t(s)});return n=DD.apply(void 0,r)(i.dispatch),SD(SD({},i),{},{dispatch:n})}}}var OD=Qd.createContext(null),LD=function(t){t()};var FD={notify:function(){},get:function(){return[]}};function ND(t,e){var i,n=FD;function s(){a.onStateChange&&a.onStateChange()}function r(){var r,a,o;i||(i=e?e.addNestedSub(s):t.subscribe(s),r=LD,a=null,o=null,n={clear:function(){a=null,o=null},notify:function(){r(function(){for(var t=a;t;)t.callback(),t=t.next})},get:function(){for(var t=[],e=a;e;)t.push(e),e=e.next;return t},subscribe:function(t){var e=!0,i=o={callback:t,next:null,prev:o};return i.prev?i.prev.next=i:a=i,function(){e&&null!==a&&(e=!1,i.next?i.next.prev=i.prev:o=i.prev,i.prev?i.prev.next=i.next:a=i.next)}}})}var a={addNestedSub:function(t){return r(),n.subscribe(t)},notifyNestedSubs:function(){n.notify()},handleChangeWrapper:s,isSubscribed:function(){return Boolean(i)},trySubscribe:r,tryUnsubscribe:function(){i&&(i(),i=void 0,n.clear(),n=FD)},getListeners:function(){return n}};return a}var BD="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?Kd.useLayoutEffect:Kd.useEffect;function WD(t){var e=t.store,i=t.context,n=t.children,s=Kd.useMemo(function(){var t=ND(e);return{store:e,subscription:t}},[e]),r=Kd.useMemo(function(){return e.getState()},[e]);BD(function(){var t=s.subscription;return t.onStateChange=t.notifyNestedSubs,t.trySubscribe(),r!==e.getState()&&t.notifyNestedSubs(),function(){t.tryUnsubscribe(),t.onStateChange=null}},[s,r]);var a=i||OD;return Qd.createElement(a.Provider,{value:s},n)}function jD(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(-1!==e.indexOf(n))continue;i[n]=t[n]}return i}var $D={exports:{}},UD={},HD="function"==typeof Symbol&&Symbol.for,zD=HD?Symbol.for("react.element"):60103,VD=HD?Symbol.for("react.portal"):60106,GD=HD?Symbol.for("react.fragment"):60107,qD=HD?Symbol.for("react.strict_mode"):60108,XD=HD?Symbol.for("react.profiler"):60114,KD=HD?Symbol.for("react.provider"):60109,YD=HD?Symbol.for("react.context"):60110,QD=HD?Symbol.for("react.async_mode"):60111,JD=HD?Symbol.for("react.concurrent_mode"):60111,ZD=HD?Symbol.for("react.forward_ref"):60112,tI=HD?Symbol.for("react.suspense"):60113,eI=HD?Symbol.for("react.suspense_list"):60120,iI=HD?Symbol.for("react.memo"):60115,nI=HD?Symbol.for("react.lazy"):60116,sI=HD?Symbol.for("react.block"):60121,rI=HD?Symbol.for("react.fundamental"):60117,aI=HD?Symbol.for("react.responder"):60118,oI=HD?Symbol.for("react.scope"):60119;function lI(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case zD:switch(t=t.type){case QD:case JD:case GD:case XD:case qD:case tI:return t;default:switch(t=t&&t.$$typeof){case YD:case ZD:case nI:case iI:case KD:return t;default:return e}}case VD:return e}}}function hI(t){return lI(t)===JD}UD.AsyncMode=QD,UD.ConcurrentMode=JD,UD.ContextConsumer=YD,UD.ContextProvider=KD,UD.Element=zD,UD.ForwardRef=ZD,UD.Fragment=GD,UD.Lazy=nI,UD.Memo=iI,UD.Portal=VD,UD.Profiler=XD,UD.StrictMode=qD,UD.Suspense=tI,UD.isAsyncMode=function(t){return hI(t)||lI(t)===QD},UD.isConcurrentMode=hI,UD.isContextConsumer=function(t){return lI(t)===YD},UD.isContextProvider=function(t){return lI(t)===KD},UD.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===zD},UD.isForwardRef=function(t){return lI(t)===ZD},UD.isFragment=function(t){return lI(t)===GD},UD.isLazy=function(t){return lI(t)===nI},UD.isMemo=function(t){return lI(t)===iI},UD.isPortal=function(t){return lI(t)===VD},UD.isProfiler=function(t){return lI(t)===XD},UD.isStrictMode=function(t){return lI(t)===qD},UD.isSuspense=function(t){return lI(t)===tI},UD.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===GD||t===JD||t===XD||t===qD||t===tI||t===eI||"object"==typeof t&&null!==t&&(t.$$typeof===nI||t.$$typeof===iI||t.$$typeof===KD||t.$$typeof===YD||t.$$typeof===ZD||t.$$typeof===rI||t.$$typeof===aI||t.$$typeof===oI||t.$$typeof===sI)},UD.typeOf=lI,$D.exports=UD;var cI=$D.exports,dI={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},uI={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},pI={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},fI={};function gI(t){return cI.isMemo(t)?pI:fI[t.$$typeof]||dI}fI[cI.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},fI[cI.Memo]=pI;var mI=Object.defineProperty,yI=Object.getOwnPropertyNames,wI=Object.getOwnPropertySymbols,vI=Object.getOwnPropertyDescriptor,bI=Object.getPrototypeOf,AI=Object.prototype;const xI=Gd(function t(e,i,n){if("string"!=typeof i){if(AI){var s=bI(i);s&&s!==AI&&t(e,s,n)}var r=yI(i);wI&&(r=r.concat(wI(i)));for(var a=gI(e),o=gI(i),l=0;l<r.length;++l){var h=r[l];if(!(uI[h]||n&&n[h]||o&&o[h]||a&&a[h])){var c=vI(i,h);try{mI(e,h,c)}catch(XO){}}}}return e});var _I={exports:{}},SI={},kI=60103,EI=60106,MI=60107,CI=60108,PI=60114,TI=60109,RI=60110,DI=60112,II=60113,OI=60120,LI=60115,FI=60116,NI=60121,BI=60122,WI=60117,jI=60129,$I=60131;if("function"==typeof Symbol&&Symbol.for){var UI=Symbol.for;kI=UI("react.element"),EI=UI("react.portal"),MI=UI("react.fragment"),CI=UI("react.strict_mode"),PI=UI("react.profiler"),TI=UI("react.provider"),RI=UI("react.context"),DI=UI("react.forward_ref"),II=UI("react.suspense"),OI=UI("react.suspense_list"),LI=UI("react.memo"),FI=UI("react.lazy"),NI=UI("react.block"),BI=UI("react.server.block"),WI=UI("react.fundamental"),jI=UI("react.debug_trace_mode"),$I=UI("react.legacy_hidden")}function HI(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case kI:switch(t=t.type){case MI:case PI:case CI:case II:case OI:return t;default:switch(t=t&&t.$$typeof){case RI:case DI:case FI:case LI:case TI:return t;default:return e}}case EI:return e}}}var zI=TI,VI=kI,GI=DI,qI=MI,XI=FI,KI=LI,YI=EI,QI=PI,JI=CI,ZI=II;SI.ContextConsumer=RI,SI.ContextProvider=zI,SI.Element=VI,SI.ForwardRef=GI,SI.Fragment=qI,SI.Lazy=XI,SI.Memo=KI,SI.Portal=YI,SI.Profiler=QI,SI.StrictMode=JI,SI.Suspense=ZI,SI.isAsyncMode=function(){return!1},SI.isConcurrentMode=function(){return!1},SI.isContextConsumer=function(t){return HI(t)===RI},SI.isContextProvider=function(t){return HI(t)===TI},SI.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===kI},SI.isForwardRef=function(t){return HI(t)===DI},SI.isFragment=function(t){return HI(t)===MI},SI.isLazy=function(t){return HI(t)===FI},SI.isMemo=function(t){return HI(t)===LI},SI.isPortal=function(t){return HI(t)===EI},SI.isProfiler=function(t){return HI(t)===PI},SI.isStrictMode=function(t){return HI(t)===CI},SI.isSuspense=function(t){return HI(t)===II},SI.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===MI||t===PI||t===jI||t===CI||t===II||t===OI||t===$I||"object"==typeof t&&null!==t&&(t.$$typeof===FI||t.$$typeof===LI||t.$$typeof===TI||t.$$typeof===RI||t.$$typeof===DI||t.$$typeof===WI||t.$$typeof===NI||t[0]===BI)},SI.typeOf=HI,_I.exports=SI;var tO=_I.exports,eO=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],iO=["reactReduxForwardedRef"],nO=[],sO=[null,null];function rO(t,e){var i=t[1];return[e.payload,i+1]}function aO(t,e,i){BD(function(){return t.apply(void 0,e)},i)}function oO(t,e,i,n,s,r,a){t.current=n,e.current=s,i.current=!1,r.current&&(r.current=null,a())}function lO(t,e,i,n,s,r,a,o,l,h){if(t){var c=!1,d=null,u=function(){if(!c){var t,i,u=e.getState();try{t=n(u,s.current)}catch(XO){i=XO,d=XO}i||(d=null),t===r.current?a.current||l():(r.current=t,o.current=t,a.current=!0,h({type:"STORE_UPDATED",payload:{error:i}}))}};return i.onStateChange=u,i.trySubscribe(),u(),function(){if(c=!0,i.tryUnsubscribe(),i.onStateChange=null,d)throw d}}}var hO=function(){return[null,0]};function cO(t,e){void 0===e&&(e={});var i=e,n=i.getDisplayName,s=void 0===n?function(t){return"ConnectAdvanced("+t+")"}:n,r=i.methodName,a=void 0===r?"connectAdvanced":r,o=i.renderCountProp,l=void 0===o?void 0:o,h=i.shouldHandleStateChanges,c=void 0===h||h,d=i.storeKey,u=void 0===d?"store":d;i.withRef;var p=i.forwardRef,f=void 0!==p&&p,g=i.context,m=void 0===g?OD:g,y=jD(i,eO),w=m;return function(e){var i=e.displayName||e.name||"Component",n=s(i),r=bD({},y,{getDisplayName:s,methodName:a,renderCountProp:l,shouldHandleStateChanges:c,storeKey:u,displayName:n,wrappedComponentName:i,WrappedComponent:e}),o=y.pure,h=o?Kd.useMemo:function(t){return t()};function d(i){var n=Kd.useMemo(function(){var t=i.reactReduxForwardedRef,e=jD(i,iO);return[i.context,t,e]},[i]),s=n[0],a=n[1],o=n[2],l=Kd.useMemo(function(){return s&&s.Consumer&&tO.isContextConsumer(Qd.createElement(s.Consumer,null))?s:w},[s,w]),d=Kd.useContext(l),u=Boolean(i.store)&&Boolean(i.store.getState)&&Boolean(i.store.dispatch);Boolean(d)&&Boolean(d.store);var p=u?i.store:d.store,f=Kd.useMemo(function(){return function(e){return t(e.dispatch,r)}(p)},[p]),g=Kd.useMemo(function(){if(!c)return sO;var t=ND(p,u?null:d.subscription),e=t.notifyNestedSubs.bind(t);return[t,e]},[p,u,d]),m=g[0],y=g[1],v=Kd.useMemo(function(){return u?d:bD({},d,{subscription:m})},[u,d,m]),b=Kd.useReducer(rO,nO,hO),A=b[0][0],x=b[1];if(A&&A.error)throw A.error;var _=Kd.useRef(),S=Kd.useRef(o),k=Kd.useRef(),E=Kd.useRef(!1),M=h(function(){return k.current&&o===S.current?k.current:f(p.getState(),o)},[p,A,o]);aO(oO,[S,_,E,o,M,k,y]),aO(lO,[c,p,m,f,S,_,E,k,y,x],[p,m,f]);var C=Kd.useMemo(function(){return Qd.createElement(e,bD({},M,{ref:a}))},[a,e,M]);return Kd.useMemo(function(){return c?Qd.createElement(l.Provider,{value:v},C):C},[l,C,v])}var p=o?Qd.memo(d):d;if(p.WrappedComponent=e,p.displayName=d.displayName=n,f){var g=Qd.forwardRef(function(t,e){return Qd.createElement(p,bD({},t,{reactReduxForwardedRef:e}))});return g.displayName=n,g.WrappedComponent=e,xI(g,e)}return xI(p,e)}}function dO(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function uO(t,e){if(dO(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(var s=0;s<i.length;s++)if(!Object.prototype.hasOwnProperty.call(e,i[s])||!dO(t[i[s]],e[i[s]]))return!1;return!0}function pO(t){return function(e,i){var n=t(e,i);function s(){return n}return s.dependsOnOwnProps=!1,s}}function fO(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function gO(t,e){return function(e,i){i.displayName;var n=function(t,e){return n.dependsOnOwnProps?n.mapToProps(t,e):n.mapToProps(t)};return n.dependsOnOwnProps=!0,n.mapToProps=function(e,i){n.mapToProps=t,n.dependsOnOwnProps=fO(t);var s=n(e,i);return"function"==typeof s&&(n.mapToProps=s,n.dependsOnOwnProps=fO(s),s=n(e,i)),s},n}}const mO=[function(t){return"function"==typeof t?gO(t):void 0},function(t){return t?void 0:pO(function(t){return{dispatch:t}})},function(t){return t&&"object"==typeof t?pO(function(e){return function(t,e){var i={},n=function(n){var s=t[n];"function"==typeof s&&(i[n]=function(){return e(s.apply(void 0,arguments))})};for(var s in t)n(s);return i}(t,e)}):void 0}],yO=[function(t){return"function"==typeof t?gO(t):void 0},function(t){return t?void 0:pO(function(){return{}})}];function wO(t,e,i){return bD({},i,t,e)}const vO=[function(t){return"function"==typeof t?function(t){return function(e,i){i.displayName;var n,s=i.pure,r=i.areMergedPropsEqual,a=!1;return function(e,i,o){var l=t(e,i,o);return a?s&&r(l,n)||(n=l):(a=!0,n=l),n}}}(t):void 0},function(t){return t?void 0:function(){return wO}}];var bO=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function AO(t,e,i,n){return function(s,r){return i(t(s,r),e(n,r),r)}}function xO(t,e,i,n,s){var r,a,o,l,h,c=s.areStatesEqual,d=s.areOwnPropsEqual,u=s.areStatePropsEqual,p=!1;return function(s,f){return p?function(s,p){var f,g,m=!d(p,a),y=!c(s,r,p,a);return r=s,a=p,m&&y?(o=t(r,a),e.dependsOnOwnProps&&(l=e(n,a)),h=i(o,l,a)):m?(t.dependsOnOwnProps&&(o=t(r,a)),e.dependsOnOwnProps&&(l=e(n,a)),h=i(o,l,a)):y?(f=t(r,a),g=!u(f,o),o=f,g&&(h=i(o,l,a)),h):h}(s,f):(o=t(r=s,a=f),l=e(n,a),h=i(o,l,a),p=!0,h)}}function _O(t,e){var i=e.initMapStateToProps,n=e.initMapDispatchToProps,s=e.initMergeProps,r=jD(e,bO),a=i(t,r),o=n(t,r),l=s(t,r);return(r.pure?xO:AO)(a,o,l,t,r)}var SO=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function kO(t,e,i){for(var n=e.length-1;n>=0;n--){var s=e[n](t);if(s)return s}return function(e,n){throw new Error("Invalid value of type "+typeof t+" for "+i+" argument when connecting component "+n.wrappedComponentName+".")}}function EO(t,e){return t===e}function MO(t){var e=void 0===t?{}:t,i=e.connectHOC,n=void 0===i?cO:i,s=e.mapStateToPropsFactories,r=void 0===s?yO:s,a=e.mapDispatchToPropsFactories,o=void 0===a?mO:a,l=e.mergePropsFactories,h=void 0===l?vO:l,c=e.selectorFactory,d=void 0===c?_O:c;return function(t,e,i,s){void 0===s&&(s={});var a=s,l=a.pure,c=void 0===l||l,u=a.areStatesEqual,p=void 0===u?EO:u,f=a.areOwnPropsEqual,g=void 0===f?uO:f,m=a.areStatePropsEqual,y=void 0===m?uO:m,w=a.areMergedPropsEqual,v=void 0===w?uO:w,b=jD(a,SO),A=kO(t,r,"mapStateToProps"),x=kO(e,o,"mapDispatchToProps"),_=kO(i,h,"mergeProps");return n(d,bD({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:A,initMapDispatchToProps:x,initMergeProps:_,pure:c,areStatesEqual:p,areOwnPropsEqual:g,areStatePropsEqual:y,areMergedPropsEqual:v},b))}}const CO=MO();var PO;function TO(t,e){var i=Kd.useState(function(){return{inputs:e,result:t()}})[0],n=Kd.useRef(!0),s=Kd.useRef(i),r=n.current||Boolean(e&&s.current.inputs&&function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}(e,s.current.inputs))?s.current:{inputs:e,result:t()};return Kd.useEffect(function(){n.current=!1,s.current=r},[r]),r.result}PO=Yd.unstable_batchedUpdates,LD=PO;var RO=TO,DO=function(t,e){return TO(function(){return t},e)},IO=function(t){var e=t.top,i=t.right,n=t.bottom,s=t.left;return{top:e,right:i,bottom:n,left:s,width:i-s,height:n-e,x:s,y:e,center:{x:(i+s)/2,y:(n+e)/2}}},OO=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},LO=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},FO={top:0,right:0,bottom:0,left:0},NO=function(t){var e=t.borderBox,i=t.margin,n=void 0===i?FO:i,s=t.border,r=void 0===s?FO:s,a=t.padding,o=void 0===a?FO:a,l=IO(OO(e,n)),h=IO(LO(e,r)),c=IO(LO(h,o));return{marginBox:l,borderBox:IO(e),paddingBox:h,contentBox:c,margin:n,border:r,padding:o}},BO=function(t){var e=t.slice(0,-2);if("px"!==t.slice(-2))return 0;var i=Number(e);return isNaN(i)&&dC(!1),i},WO=function(t,e){var i=t.borderBox,n=t.border,s=t.margin,r=t.padding,a=function(t,e){return{top:t.top+e.y,left:t.left+e.x,bottom:t.bottom+e.y,right:t.right+e.x}}(i,e);return NO({borderBox:a,border:n,margin:s,padding:r})},jO=function(t,e){return void 0===e&&(e={x:window.pageXOffset,y:window.pageYOffset}),WO(t,e)},$O=function(t,e){var i={top:BO(e.marginTop),right:BO(e.marginRight),bottom:BO(e.marginBottom),left:BO(e.marginLeft)},n={top:BO(e.paddingTop),right:BO(e.paddingRight),bottom:BO(e.paddingBottom),left:BO(e.paddingLeft)},s={top:BO(e.borderTopWidth),right:BO(e.borderRightWidth),bottom:BO(e.borderBottomWidth),left:BO(e.borderLeftWidth)};return NO({borderBox:t,margin:i,padding:n,border:s})},UO=function(t){var e=t.getBoundingClientRect(),i=window.getComputedStyle(t);return $O(e,i)},HO=Number.isNaN||function(t){return"number"==typeof t&&t!=t};function zO(t,e){return t===e||!(!HO(t)||!HO(e))}function VO(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(!zO(t[i],e[i]))return!1;return!0}function GO(t,e){var i;void 0===e&&(e=VO);var n,s=[],r=!1;return function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return r&&i===this&&e(a,s)||(n=t.apply(this,a),r=!0,i=this,s=a),n}}var qO=function(t){var e=[],i=null,n=function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];e=s,i||(i=requestAnimationFrame(function(){i=null,t.apply(void 0,e)}))};return n.cancel=function(){i&&(cancelAnimationFrame(i),i=null)},n};export{vD as $,kR as A,gP as B,UC as C,zR as D,GC as E,HC as F,OC as G,JR as H,BP as I,BT as J,lR as K,jC as L,LC as M,DC as N,IC as O,nP as P,cD as Q,dD as R,zC as S,mP as T,eD as U,hD as V,GR as W,uD as X,CO as Y,RO as Z,bD as _,YT as a,DO as a0,RD as a1,WD as a2,GO as a3,qO as a4,PD as a5,DD as a6,ID as a7,jO as a8,UO as a9,SE as aA,cC as aB,sC as aC,_M as aD,Ix as aE,pC as aF,_E as aG,qk as aH,Mw as aI,Cw as aJ,LA as aK,JA as aL,Px as aM,FE as aN,OO as aa,NO as ab,IO as ac,$O as ad,WO as ae,yD as af,ef as ag,Sw as ah,Ef as ai,kw as aj,vC as ak,gC as al,wC as am,MC as an,_C as ao,mC as ap,PC as aq,CC as ar,TC as as,RC as at,xC as au,dC as av,uC as aw,oC as ax,iC as ay,lC as az,pD as b,ZP as c,XR as d,vP as e,pP as f,VR as g,fP as h,AP as i,FC as j,BC as k,gD as l,iT as m,WR as n,UR as o,WP as p,KR as q,GT as r,XT as s,QT as t,$R as u,CR as v,VC as w,xR as x,PR as y,nD as z};
