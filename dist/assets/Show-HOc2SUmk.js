import{c as z,a,u as O,j as e,H as I}from"./app-CpTrn_zj.js";import{c as R}from"./createLucideIcon-C0075d5o.js";import{X as C}from"./x-B-eKawcc.js";import{S as H}from"./sparkles-BbA2MjWt.js";import{C as K}from"./clock-TF7sowUU.js";import{C as P}from"./calendar-DXMR76L4.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],B=R("bell-ring",G);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]],X=R("mail-check",J),Y="/tuiroomkit/index.html",W="tuiroomkit",V="myspacelove",M="schedule:open",D="schedule:close";function Z(i){if(!i)return"Belum dijadwalkan";const r=new Date(i);return Number.isNaN(r.getTime())?"Belum dijadwalkan":new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(r)}function q(i){if(!i)return null;const r=new Date(i);if(Number.isNaN(r.getTime()))return null;const j=Date.now(),x=r.getTime()-j,o=Math.abs(x),h=[["year",1e3*60*60*24*365],["month",1e3*60*60*24*30],["week",1e3*60*60*24*7],["day",1e3*60*60*24],["hour",1e3*60*60],["minute",1e3*60]],d=new Intl.RelativeTimeFormat(void 0,{numeric:"auto"});for(const[c,f]of h)if(o>=f||c==="minute"){const b=Math.round(x/f);if(b!==0)return d.format(b,c)}return d.format(0,"minute")}function ne({spaceId:i,space:r,schedules:j=[]}){const{props:x}=z(),o=x.auth?.user,h=x.currentSpace,d=r?.slug??h?.slug??`space-${i}`,c=r?.title??h?.title??`Space #${i}`,f=o?.id?`user-${String(o.id)}`:`guest-${i}`,b=(()=>{const t=o?.name??o?.email??"Guest",s=String(t).trim();return s.length>0?s:`Guest ${i}`})(),v=o?.profile_photo_url?String(o.profile_photo_url):void 0,_=a.useRef(null),[g,y]=a.useState(!1),[T,S]=a.useState(null),l=a.useRef(void 0),w=a.useMemo(()=>[...j].filter(t=>!!t).sort((t,s)=>{const n=t.scheduled_for?new Date(t.scheduled_for).getTime():Number.MAX_SAFE_INTEGER,m=s.scheduled_for?new Date(s.scheduled_for).getTime():Number.MAX_SAFE_INTEGER;return n-m}),[j]),E=a.useMemo(()=>{const t=Date.now();return w.find(s=>{if(!s.scheduled_for)return!1;const n=new Date(s.scheduled_for).getTime();return!Number.isNaN(n)&&n>=t-60*1e3})},[w]),{data:u,setData:k,post:U,processing:F,errors:p,reset:L}=O({title:"",scheduled_for:"",description:"",timezone:""});a.useEffect(()=>{if(!u.timezone)try{const t=Intl.DateTimeFormat().resolvedOptions().timeZone;t&&k("timezone",t)}catch{}},[u.timezone,k]);const N=a.useCallback(()=>{y(!1)},[]);a.useEffect(()=>{const t=typeof window<"u"?window.location.origin:void 0;function s(n){if(t&&n.origin!==t)return;const m=n.data;!m||typeof m!="object"||m.source===W&&(m.type===M&&y(!0),m.type===D&&y(!1))}return window.addEventListener("message",s),()=>{window.removeEventListener("message",s)}},[]),a.useEffect(()=>{if(!g)return;function t(s){s.key==="Escape"&&(s.preventDefault(),N())}return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[N,g]),a.useEffect(()=>{const t=_.current?.contentWindow,s=typeof window<"u"?window.location.origin:"*";t&&t.postMessage({source:V,type:g?M:D},s)},[g]),a.useEffect(()=>()=>{l.current&&(window.clearTimeout(l.current),l.current=void 0)},[]);const A=t=>{t.preventDefault(),!(!r?.slug&&!h?.slug)&&U(route("space.nobar.schedules.store",{space:d}),{preserveScroll:!0,onSuccess:()=>{L("title","scheduled_for","description"),N(),l.current&&(window.clearTimeout(l.current),l.current=void 0),S("Jadwal berhasil disimpan dan email pengingat telah dikirim."),l.current=window.setTimeout(()=>{S(null),l.current=void 0},6e3)}})},$=a.useMemo(()=>{const t=new URLSearchParams({roomId:`space-${i}`,userId:f,userName:b,lang:"id-ID",spaceSlug:d,spaceTitle:c,dashboardUrl:`/spaces/${d}/dashboard`});return v&&t.set("avatarUrl",v),`${Y}?${t.toString()}`},[v,d,c,f,b,i]);return e.jsxs(e.Fragment,{children:[e.jsx(I,{title:`Nobar ${c}`}),T&&e.jsx("div",{className:"fixed inset-x-0 top-6 z-40 flex justify-center px-4",children:e.jsxs("div",{className:"flex items-center gap-3 rounded-full bg-emerald-600/95 px-5 py-3 text-sm font-medium text-white shadow-xl shadow-emerald-300/40",children:[e.jsx(B,{className:"h-4 w-4","aria-hidden":"true"}),e.jsx("span",{children:T}),e.jsx("button",{type:"button",onClick:()=>S(null),className:"rounded-full bg-white/20 p-1 hover:bg-white/30 focus:outline-none focus-visible:ring-2 focus-visible:ring-white/60","aria-label":"Tutup notifikasi",children:e.jsx(C,{className:"h-3.5 w-3.5","aria-hidden":"true"})})]})}),g&&e.jsxs("div",{className:"fixed inset-0 z-40 flex items-center justify-center",role:"dialog","aria-modal":"true",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-950/70 backdrop-blur-sm",onClick:N}),e.jsx("div",{className:"relative z-10 w-full max-w-5xl px-4 sm:px-6",children:e.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-pink-200/60 bg-white shadow-2xl shadow-pink-200/50",children:[e.jsx("div",{className:"absolute inset-x-0 top-0 h-32 bg-gradient-to-br from-pink-100 via-white to-transparent opacity-90","aria-hidden":"true"}),e.jsxs("div",{className:"relative px-6 py-6 sm:px-8 sm:py-8",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("span",{className:"inline-flex items-center gap-2 text-xs font-semibold uppercase tracking-[0.28em] text-pink-500",children:[e.jsx(H,{className:"h-3.5 w-3.5","aria-hidden":"true"}),"Nobar Scheduler"]}),e.jsxs("h2",{className:"text-2xl font-semibold text-slate-900",children:["Atur jadwal nobar untuk ",c]}),e.jsx("p",{className:"text-sm text-slate-500 max-w-xl",children:"Undangan email akan dikirim ke anggota space setelah jadwal disimpan. Kamu masih bisa memakai tombol Join/Create di TUIRoomKit seperti biasa."})]}),e.jsx("button",{type:"button",onClick:N,className:"rounded-full bg-white/80 p-2 text-slate-500 shadow-sm ring-1 ring-slate-200 transition hover:text-slate-700 hover:ring-slate-300 focus:outline-none focus-visible:ring-2 focus-visible:ring-pink-300","aria-label":"Tutup jadwal",children:e.jsx(C,{className:"h-4 w-4","aria-hidden":"true"})})]}),e.jsxs("div",{className:"mt-6 grid gap-6 lg:grid-cols-[minmax(0,340px)_minmax(0,1fr)]",children:[e.jsxs("form",{onSubmit:A,className:"space-y-5 rounded-2xl border border-pink-100 bg-pink-50/50 p-5 shadow-inner shadow-pink-100",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"nobar-title",className:"text-sm font-medium text-slate-700",children:"Judul acara"}),e.jsx("input",{id:"nobar-title",type:"text",value:u.title,onChange:t=>k("title",t.target.value),className:"w-full rounded-xl border border-pink-200 bg-white px-4 py-2.5 text-sm text-slate-900 placeholder:text-slate-400 focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-200",placeholder:"Movie night, konser online, dll",autoFocus:!0}),p.title&&e.jsx("p",{className:"text-sm text-rose-500",children:p.title})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"nobar-schedule",className:"text-sm font-medium text-slate-700",children:"Waktu nobar"}),e.jsx("input",{id:"nobar-schedule",type:"datetime-local",value:u.scheduled_for,onChange:t=>k("scheduled_for",t.target.value),className:"w-full rounded-xl border border-pink-200 bg-white px-4 py-2.5 text-sm text-slate-900 focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-200"}),u.timezone&&e.jsxs("p",{className:"flex items-center gap-1 text-xs text-slate-400",children:[e.jsx(K,{className:"h-3.5 w-3.5","aria-hidden":"true"}),"Disimpan sebagai zona waktu ",e.jsx("span",{className:"font-medium",children:u.timezone})]}),p.scheduled_for&&e.jsx("p",{className:"text-sm text-rose-500",children:p.scheduled_for})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{htmlFor:"nobar-notes",className:"text-sm font-medium text-slate-700",children:"Catatan tambahan (opsional)"}),e.jsx("textarea",{id:"nobar-notes",value:u.description,onChange:t=>k("description",t.target.value),className:"w-full rounded-xl border border-pink-200 bg-white px-4 py-2.5 text-sm text-slate-900 focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-200",rows:3,placeholder:"Link film, daftar camilan, atau dress code lucu"}),p.description&&e.jsx("p",{className:"text-sm text-rose-500",children:p.description})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{type:"submit",disabled:F,className:"inline-flex w-full items-center justify-center gap-2 rounded-full bg-gradient-to-r from-pink-500 via-pink-400 to-rose-400 px-6 py-2.5 text-sm font-semibold text-white shadow-lg shadow-pink-200 transition hover:shadow-xl hover:shadow-pink-300 disabled:cursor-not-allowed disabled:opacity-60",children:[e.jsx(X,{className:"h-4 w-4","aria-hidden":"true"}),"Kirim pengingat ke email"]})})]}),e.jsxs("div",{className:"rounded-2xl border border-pink-100 bg-white/90 p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-semibold text-slate-900",children:"Agenda nobar kalian"}),e.jsx("p",{className:"text-sm text-slate-500",children:w.length===0?"Belum ada jadwal nobar yang tersimpan.":"Lihat jadwal terdekat dan siapkan popcornnya üçø"})]}),E&&e.jsx("span",{className:"inline-flex items-center rounded-full bg-pink-100 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-pink-600",children:"Jadwal terdekat"})]}),e.jsx("div",{className:"mt-4 max-h-80 space-y-4 overflow-y-auto pr-1",children:w.length===0?e.jsx("div",{className:"rounded-xl border border-dashed border-pink-200 bg-pink-50/70 p-6 text-center text-sm text-pink-500",children:"Klik tombol Schedule di TUIRoomKit untuk membuat jadwal pertama kalian."}):e.jsx("ul",{className:"space-y-4",children:w.map(t=>{const s=E?.id===t.id,n=q(t.scheduled_for);return e.jsx("li",{className:`rounded-xl border px-4 py-3 text-sm transition ${s?"border-pink-300 bg-pink-50/80 shadow-sm shadow-pink-100":"border-pink-100 bg-white hover:border-pink-200"}`,children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:t.title}),e.jsxs("span",{className:"flex items-center gap-2 text-xs text-slate-500",children:[e.jsx(P,{className:"h-3.5 w-3.5 text-pink-400","aria-hidden":"true"}),Z(t.scheduled_for)]})]}),t.description&&e.jsx("p",{className:"text-xs text-slate-600 whitespace-pre-line",children:t.description}),n&&e.jsx("span",{className:"inline-flex w-fit items-center rounded-full bg-white/90 px-3 py-1 text-[11px] font-medium text-pink-600 shadow-inner",children:n})]})},t.id)})})})]})]})]})]})})]}),e.jsx("div",{className:"h-screen bg-neutral-900",children:e.jsx("iframe",{ref:_,title:"Tencent Nobar Room",src:$,className:"h-full w-full border-0 bg-neutral-900",allowFullScreen:!0,allow:"microphone; camera; fullscreen; display-capture; clipboard-read; clipboard-write; speaker"})})]})}export{ne as default};
