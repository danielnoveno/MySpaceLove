import{a as r,j as e,H as P,L as b}from"./app-CpTrn_zj.js";import{A as H}from"./AuthenticatedLayout-Du1ilKJG.js";import{u as L}from"./useCurrentSpace-BBxOMrc3.js";import{H as C}from"./heart-Bwdc_jE9.js";import{C as I}from"./calendar-DXMR76L4.js";import{E as _}from"./eye-DEKhWvEc.js";import{S as A,P as D}from"./square-pen-DtMzjbFp.js";import{X as R}from"./x-B-eKawcc.js";import"./ApplicationLogo-CIVcEVux.js";import"./transition-D8AHnLll.js";import"./createLucideIcon-C0075d5o.js";function U({timelines:w}){const p=L();if(!p)return null;const i=p.slug,T=p.title,[l,g]=r.useState(null),[v,j]=r.useState(null),[c,N]=r.useState({});r.useEffect(()=>{try{const t=window.localStorage.getItem(`timeline-thumbnails:${i}`);if(t){const a=JSON.parse(t);N(a)}}catch(t){console.warn("Failed to load saved thumbnail selections",t)}},[i]),r.useEffect(()=>{try{window.localStorage.setItem(`timeline-thumbnails:${i}`,JSON.stringify(c))}catch(t){console.warn("Failed to persist thumbnail selections",t)}},[i,c]);const $=(t,a)=>{N(n=>({...n,[t]:a}))},y=r.useRef(null),[k,z]=r.useState({x:0,y:0}),[M]=r.useState(()=>Array.from({length:40},()=>({x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,size:Math.random()*14+8,opacity:Math.random()*.5+.2})));r.useEffect(()=>{const t=y.current;if(!t)return;const a=t.getContext("2d");if(!a)return;t.width=window.innerWidth,t.height=window.innerHeight;const n=[],d=(s,o)=>{n.push({x:s,y:o,size:Math.random()*8+10,dx:(Math.random()-.5)*2,dy:(Math.random()-.5)*2})},m=(s,o,f,h,E=.6)=>{s.save(),s.translate(o,f),s.scale(h/20,h/20),s.beginPath(),s.moveTo(0,0),s.bezierCurveTo(0,-3,-5,-15,-20,-15),s.bezierCurveTo(-55,-15,-55,22.5,-55,22.5),s.bezierCurveTo(-55,40,-35,62,0,80),s.bezierCurveTo(35,62,55,40,55,22.5),s.bezierCurveTo(55,22.5,55,-15,20,-15),s.bezierCurveTo(5,-15,0,-3,0,0),s.fillStyle=`rgba(244,63,94,${E})`,s.fill(),s.restore()},u=()=>{a.clearRect(0,0,t.width,t.height),n.forEach((s,o)=>{s.x+=s.dx,s.y+=s.dy,m(a,s.x,s.y,s.size),(s.x<0||s.y<0||s.x>t.width||s.y>t.height)&&n.splice(o,1)}),requestAnimationFrame(u)};u();const x=s=>{for(let h=0;h<2;h++)d(s.clientX,s.clientY);const o=window.innerWidth/2,f=window.innerHeight/2;z({x:(s.clientX-o)*.02,y:(s.clientY-f)*.02})};return window.addEventListener("mousemove",x),window.addEventListener("resize",()=>{t.width=window.innerWidth,t.height=window.innerHeight}),()=>{window.removeEventListener("mousemove",x)}},[]);const S=t=>new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"});return e.jsxs(H,{header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-pink-500"}),"Love Timeline"]}),e.jsxs(b,{href:route("timeline.create",{space:i}),className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white px-4 py-2 rounded-lg shadow-lg transition-all duration-300 flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Tambah Momen"]})]}),children:[e.jsx(P,{title:`Love Timeline - ${T}`}),e.jsxs("div",{className:"relative min-h-screen bg-gradient-to-br from-pink-50 via-white to-rose-50 py-10 px-4 sm:px-6 lg:px-8 overflow-hidden",children:[e.jsx("canvas",{ref:y,className:"absolute inset-0 w-full h-full pointer-events-none"}),e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:M.map((t,a)=>e.jsx("div",{className:"absolute text-pink-400 select-none",style:{left:t.x,top:t.y,fontSize:t.size,opacity:t.opacity,transform:`translate3d(${k.x*.5}px, ${k.y*.5}px, 0)`,transition:"transform 0.2s ease-out"},children:"â™¥"},a))}),e.jsx("div",{className:"relative z-10 max-w-6xl mx-auto",children:w.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl shadow-lg p-8 max-w-md mx-auto border border-gray-100",children:[e.jsx(C,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-600 mb-2",children:"Belum ada momen tersimpan"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Mulai tambahkan momen spesial pertama kalian!"}),e.jsx(b,{href:route("timeline.create",{space:i}),className:"bg-gradient-to-r from-pink-500 to-purple-600 text-white px-6 py-2 rounded-lg inline-block hover:shadow-lg transition-all",children:"Tambah Momen Pertama"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(t=>{const a=t.media_paths??[],n=c[t.id]?`/storage/${c[t.id]}`:a[0]?`/storage/${a[0]}`:null;return e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-2xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300 overflow-hidden group",children:[n&&e.jsx("div",{className:"h-48 overflow-hidden",children:e.jsx("img",{src:n,alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-2",children:[e.jsx(I,{className:"w-4 h-4"}),S(t.date)]}),e.jsx("h3",{className:"font-semibold text-gray-800 text-lg mb-2 line-clamp-2",children:t.title}),e.jsx("p",{className:"text-gray-600 text-sm line-clamp-3 mb-4",children:t.description}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>g(t),className:"text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm font-medium",children:[e.jsx(_,{className:"w-4 h-4"}),"Detail"]}),e.jsxs(b,{href:route("timeline.edit",{space:i,id:t.id}),className:"text-pink-600 hover:text-pink-700 flex items-center gap-1 text-sm font-medium",children:[e.jsx(A,{className:"w-4 h-4"}),"Edit"]})]}),a.length>1&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-xs uppercase tracking-[0.2em] text-pink-400 mb-2",children:"Pilih thumbnail"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.map((d,m)=>{const u=`/storage/${d}`,x=c[t.id]?c[t.id]===d:m===0;return e.jsx("button",{type:"button",onClick:()=>$(t.id,d),className:`relative h-14 w-14 overflow-hidden rounded-lg border transition shadow-sm focus:outline-none focus:ring-2 focus:ring-pink-400 ${x?"border-pink-400 ring-2 ring-pink-300":"border-transparent"}`,"aria-label":`Pilih thumbnail ${m+1}`,children:e.jsx("img",{src:u,alt:`thumbnail-${m}`,className:"h-full w-full object-cover"})},d)})})]})]})]},t.id)})})}),l&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",onClick:()=>g(null),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 max-w-[90vw] max-h-[90vh] overflow-auto relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:()=>g(null),className:"absolute top-3 right-3 bg-black/50 text-white p-1 rounded-full hover:bg-black transition",children:e.jsx(R,{className:"w-4 h-4"})}),l.media_paths&&l.media_paths.length>0&&e.jsx("div",{className:"flex flex-wrap justify-center gap-3 mb-6",children:l.media_paths.map((t,a)=>e.jsx("img",{src:`/storage/${t}`,alt:`media-${a}`,onClick:()=>j(`/storage/${t}`),className:"w-32 h-32 object-cover rounded-lg cursor-pointer hover:opacity-80 transition"},a))}),e.jsx("h3",{className:"text-2xl font-semibold mb-2 text-center",children:l.title}),e.jsx("p",{className:"text-gray-500 text-sm mb-4 text-center",children:S(l.date)}),e.jsx("p",{className:"text-gray-700 text-center whitespace-pre-line",children:l.description})]})}),v&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4",onClick:()=>j(null),children:e.jsx("img",{src:v,alt:"fullscreen",className:"max-h-[90vh] max-w-[90vw] object-contain rounded-lg"})})]})]})}export{U as default};
