import{u as w,a as m,b as p,j as e,H as N}from"./app-CpTrn_zj.js";import{A as v}from"./AuthenticatedLayout-Du1ilKJG.js";import{u as S}from"./useCurrentSpace-BBxOMrc3.js";import"./ApplicationLogo-CIVcEVux.js";import"./transition-D8AHnLll.js";import"./createLucideIcon-C0075d5o.js";function I(r){const n=document.cookie.match(new RegExp("(^| )"+r+"=([^;]+)"));return n?n[2]:null}function H(){const r=S();if(!r)return null;const n=r.slug,h=r.title,x=new Date().toISOString().split("T")[0],{data:t,setData:i,post:f,errors:o,processing:b}=w({date:x,message:""}),[c,u]=m.useState(!1),[l,y]=m.useState("");m.useEffect(()=>{const a=I("XSRF-TOKEN");a&&(p.defaults.headers.common["X-XSRF-TOKEN"]=a)},[]);function j(a){if(a.preventDefault(),!t.date){alert("Tanggal harus dipilih!");return}f(route("daily.store",{space:n}))}async function k(){if(!t.date){alert("Pilih tanggal terlebih dahulu!");return}u(!0);const a=t.message.trim().length>0;try{const s={date:t.date};a&&(s.message=t.message),l.trim().length>0&&(s.mood=l);const d=route("daily.regenerate",{space:n})+"?json=true",g=(await p.post(d,s,{headers:{"Content-Type":"application/json"}})).data.message.message;g?i("message",g):alert("AI tidak mengembalikan pesan.")}catch(s){console.error("Generate AI error:",s.response??s);const d=s.response?.data?.error||"Gagal generate AI, silakan coba lagi.";alert(d)}finally{u(!1)}}return e.jsxs(v,{header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800",children:"Tambah Pesan Harian Manual"}),children:[e.jsx(N,{title:`Tambah Pesan Harian - ${h}`}),e.jsx("div",{className:"p-6 max-w-xl mx-auto bg-white shadow-md rounded-xl space-y-6 mt-8",children:e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Tanggal"}),e.jsx("input",{type:"date",value:t.date,onChange:a=>i("date",a.target.value),className:"mt-1 w-full border-gray-300 rounded-lg shadow-sm focus:border-pink-500 focus:ring-pink-500 transition"}),o.date&&e.jsx("p",{className:"mt-1 text-red-500 text-sm",children:o.date})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Pesan"}),e.jsx("textarea",{value:t.message,onChange:a=>i("message",a.target.value),className:"mt-1 w-full border-gray-300 rounded-lg shadow-sm focus:border-pink-500 focus:ring-pink-500 transition",rows:4}),o.message&&e.jsx("p",{className:"mt-1 text-red-500 text-sm",children:o.message})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-gray-700 font-medium",children:"Mood atau Prompt Tambahan (Opsional)"}),e.jsx("input",{type:"text",value:l,onChange:a=>y(a.target.value),placeholder:"Contoh: Sedang merasa romantis hari ini",className:"mt-1 w-full border-gray-300 rounded-lg shadow-sm focus:border-pink-500 focus:ring-pink-500 transition"})]}),e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsx("button",{type:"button",onClick:k,disabled:c,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg shadow-md transition duration-200",children:c?"Memproses...":t.message?"Improvisasi Pesan":"Generate Pesan AI"}),e.jsx("button",{type:"submit",disabled:b,className:"flex-1 bg-pink-600 hover:bg-pink-700 text-white px-6 py-2 rounded-lg shadow-md transition duration-200",children:"Simpan Pesan"})]})]})})]})}export{H as default};
