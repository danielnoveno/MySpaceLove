# Security Configuration for Production
# Add these to your .env file

# ============================================
# CORE SECURITY SETTINGS
# ============================================

# Force HTTPS in production
FORCE_HTTPS=true

# Content Security Policy
CSP_ENABLED=true

# ============================================
# RATE LIMITING
# ============================================

# Global rate limit (requests per minute)
RATE_LIMIT_GLOBAL=60

# API rate limit
RATE_LIMIT_API=100

# Login attempts per minute
RATE_LIMIT_LOGIN=5

# Registration attempts per minute
RATE_LIMIT_REGISTER=3

# Password reset attempts per minute
RATE_LIMIT_PASSWORD_RESET=3

# ============================================
# FILE UPLOAD SECURITY
# ============================================

# Maximum image size (bytes) - 10MB
MAX_IMAGE_SIZE=10485760

# Maximum video size (bytes) - 50MB
MAX_VIDEO_SIZE=52428800

# Scan uploads for malware
SCAN_UPLOADS=true

# Strip EXIF data from images
STRIP_EXIF=true

# ============================================
# PASSWORD SECURITY
# ============================================

# Minimum password length
PASSWORD_MIN_LENGTH=8

# Require uppercase letters
PASSWORD_REQUIRE_UPPERCASE=true

# Require lowercase letters
PASSWORD_REQUIRE_LOWERCASE=true

# Require numbers
PASSWORD_REQUIRE_NUMBERS=true

# Require special characters
PASSWORD_REQUIRE_SPECIAL=true

# Bcrypt rounds (higher = more secure but slower)
BCRYPT_ROUNDS=12

# ============================================
# SESSION SECURITY
# ============================================

# Use secure cookies (HTTPS only)
SESSION_SECURE_COOKIE=true

# HTTP only cookies (prevent JavaScript access)
SESSION_HTTP_ONLY=true

# Same site cookie policy
SESSION_SAME_SITE=lax

# Encrypt session data
SESSION_ENCRYPT=true

# Session lifetime (minutes)
SESSION_LIFETIME=1440

# ============================================
# AUTHENTICATION SECURITY
# ============================================

# Maximum login attempts before lockout
MAX_LOGIN_ATTEMPTS=5

# Lockout duration (seconds) - 15 minutes
LOCKOUT_DURATION=900

# Enable two-factor authentication
TWO_FACTOR_ENABLED=false

# Password reset token timeout (seconds) - 1 hour
PASSWORD_RESET_TIMEOUT=3600

# ============================================
# IP SECURITY
# ============================================

# Enable IP whitelist for admin access
IP_WHITELIST_ENABLED=false

# Comma-separated list of allowed IPs
IP_WHITELIST=

# Enable IP blacklist
IP_BLACKLIST_ENABLED=true

# Comma-separated list of blocked IPs
IP_BLACKLIST=

# ============================================
# SECURITY LOGGING
# ============================================

# Log failed login attempts
LOG_FAILED_LOGINS=true

# Log suspicious activity
LOG_SUSPICIOUS_ACTIVITY=true

# Log file uploads
LOG_FILE_UPLOADS=true

# Log API requests (can be verbose)
LOG_API_REQUESTS=false

# Email for security alerts
SECURITY_ALERT_EMAIL=security@your-domain.com

# ============================================
# CORS CONFIGURATION
# ============================================

# Allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://your-domain.com

# ============================================
# DATABASE SECURITY
# ============================================

# Enable database backups
DB_BACKUP_ENABLED=true

# Backup schedule (daily, weekly, monthly)
DB_BACKUP_SCHEDULE=daily

# ============================================
# API SECURITY
# ============================================

# API token expiration (minutes)
API_TOKEN_EXPIRATION=60

# Require API key for public endpoints
REQUIRE_API_KEY=false

# API key header name
API_KEY_HEADER=X-API-Key

# ============================================
# INTRUSION DETECTION
# ============================================

# Enable intrusion detection
INTRUSION_DETECTION_ENABLED=true

# Block suspicious requests automatically
BLOCK_SUSPICIOUS_REQUESTS=true

# Send alerts on detection
ALERT_ON_DETECTION=true

# ============================================
# MAINTENANCE MODE
# ============================================

# Comma-separated IPs allowed during maintenance
MAINTENANCE_ALLOWED_IPS=

# Secret token to bypass maintenance mode
MAINTENANCE_SECRET=

# ============================================
# ADDITIONAL SECURITY HEADERS
# ============================================

# Enable HSTS (HTTP Strict Transport Security)
HSTS_ENABLED=true

# HSTS max age (seconds) - 1 year
HSTS_MAX_AGE=31536000

# Include subdomains in HSTS
HSTS_INCLUDE_SUBDOMAINS=true

# HSTS preload
HSTS_PRELOAD=true

# ============================================
# CLOUDFLARE / CDN SETTINGS (if using)
# ============================================

# Trust Cloudflare proxy
TRUST_PROXIES=*

# Cloudflare API token (for automatic SSL)
CLOUDFLARE_API_TOKEN=

# ============================================
# MONITORING & ALERTS
# ============================================

# Slack webhook for security alerts
SLACK_WEBHOOK_URL=

# Discord webhook for security alerts
DISCORD_WEBHOOK_URL=

# Email notifications for critical events
CRITICAL_ALERT_EMAIL=admin@your-domain.com

# ============================================
# BACKUP & RECOVERY
# ============================================

# Backup encryption key
BACKUP_ENCRYPTION_KEY=

# Backup storage location
BACKUP_STORAGE=s3

# Backup retention days
BACKUP_RETENTION_DAYS=30

# ============================================
# NOTES
# ============================================

# 1. Generate strong random keys for all secrets
# 2. Never commit this file to version control
# 3. Use different values for each environment
# 4. Regularly rotate API keys and secrets
# 5. Enable all security features in production
# 6. Monitor logs regularly for suspicious activity
# 7. Keep all dependencies updated
# 8. Perform regular security audits
